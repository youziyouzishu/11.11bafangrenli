import"./adapter-vue-24f22062.js";import{q as G,o as P,z as n,J as K,B as _,R as S,r as m,_ as Z}from"./@tencentcloud-7fc831ec.js";import Q from"./index-c49585c2.js";import tt from"./index-faa4755e.js";import et from"./index-a27f8461.js";import ot from"./index-07258cd8.js";import{_ as rt}from"./index.vue_vue_type_script_setup_true_lang-9ec32410.js";import it from"./index-6146692d.js";import{c as u,a as p,d as at,e as st}from"./env-a593fd1d.js";import{T as U}from"./config-58aee8b5.js";import{d as pt,r,aZ as lt,a$ as nt,b as w,o as i,c,a as mt,a_ as e,ae as a,ap as ut,y,M as E,aB as R,x as B,F as ct}from"./@vue-a164be7a.js";import"./tim-upload-plugin-4412696f.js";import"./tim-profanity-filter-plugin-a7e08ee8.js";import"./vue-84471dcb.js";import"./marked-7f3c3653.js";import"./trtc-cloud-js-sdk-6995d964.js";import"./trtc-sdk-v5-5ba82a9e.js";import"./pinia-ec219911.js";import"./mitt-f7ef348c.js";import"./interactjs-0d94d9f4.js";import"./rtc-detect-b2f0fa0a.js";import"./tuicall-engine-webrtc-9ec0a575.js";import"./Icon-2c0593f3.js";import"./back-16f17fde.js";import"./lodash-f986f62a.js";import"./index-7f4dadfc.js";import"./index-6b0c1d9b.js";import"./index-95ee9b8a.js";import"./index-cfa97a9d.js";import"./close-dark-98fe05f7.js";import"./message-text-fa779d57.js";import"./index-7909557f.js";import"./constant-bad60a54.js";import"./message-image-5b640b78.js";import"./utils-14df48f1.js";import"./message-audio-c2671f84.js";import"./index-79ddaf2a.js";import"./video-play-6934d780.js";import"./message-container-d845128f.js";import"./message-file-66d98bfb.js";import"./files-37ebf78f.js";import"./message-face-a8df59a3.js";import"./message-custom-f995a3d6.js";import"./type-check-5e73d261.js";import"./star-light-645157ed.js";import"./message-tip-5fd87ded.js";import"./message-bubble-03765614.js";import"./index-63059e66.js";import"./index-7077c717.js";import"./index-cfdb213d.js";import"./index-e4ac2ab7.js";import"./index-e69feb26.js";import"./translation-content-19d02e38.js";import"./index-1a28bf3f.js";import"./convert-content-ac4eeb47.js";import"./index-c630b3a2.js";import"./message-location-f4d00aa4.js";import"./message-timestamp-4c57a5eb.js";import"./message-video-ab63f1fe.js";import"./icon-close-7ee462f2.js";import"./index-27a06473.js";import"./enableSampleTaskStatus-a12ec87d.js";import"./message-revoked-5cb51986.js";import"./message-plugin-b82b97f2.js";import"./message-plugin-layout-b05ad9de.js";import"./message-call-group-b36cd21c.js";import"./message-call-c2c-215680ac.js";import"./index-0978e08a.js";import"./message-customer-service-0c77f761.js";import"./message-room-default-e8ce0c6a.js";import"./index-fd7f70ae.js";import"./index-9d4666cb.js";import"./index-315de94f.js";import"./index-1dfefc7d.js";import"./index-f37edc42.js";import"./image-item.vue_vue_type_style_index_0_lang-58c86db8.js";import"./index-944a8f08.js";import"./message-input-editor-1f6c7004.js";import"./@tiptap-57ba56f9.js";import"./prosemirror-state-c6000de8.js";import"./prosemirror-model-4222e734.js";import"./orderedmap-1b52af60.js";import"./prosemirror-transform-8a42477f.js";import"./prosemirror-view-88df7d8c.js";import"./prosemirror-keymap-55db6e93.js";import"./w3c-keyname-a25e4cc1.js";import"./prosemirror-commands-6d2c6479.js";import"./prosemirror-schema-list-d5a5352e.js";import"./index-0fa64378.js";import"./index-b5b8c0ea.js";import"./message-input-button-b0c1c96c.js";import"./index-bb7b8f99.js";import"./index-20817905.js";import"./selected-a3efc726.js";import"./index-043f784c.js";import"./emoji-picker-dialog-66c4a991.js";import"./index-ca5aad75.js";import"./index-9da5d87d.js";import"./camera-uni-de12e41a.js";import"./index-09f1251e.js";import"./index-088f9895.js";import"./index-b0dc35a7.js";import"./documentLink-a7b030c0.js";import"./index-a7c8e24e.js";import"./index.vue_vue_type_script_setup_true_lang-71ceb69d.js";const dt={class:"chat"},ht=pt({__name:"index",emits:["closeChat"],setup(Tt,{emit:A}){const F=A,f=r(void 0),C=r(!1),d=r(!1),I=r(),g=r(),h=r(!1),l=r("none"),T=r(),v=r(),s=r([]),L=U.getFeatureConfig();lt(()=>{G.watch(P.CONV,{currentConversationID:O,currentConversation:N})}),nt(()=>{G.unwatch(P.CONV,{currentConversationID:O,currentConversation:N}),k()});const H=w(()=>u?l.value!=="none":!0),Y=w(()=>{let t="";switch(I.value){case 4:t=n.t("TUIChat.您已被管理员移出群聊");break;case 5:t=n.t("TUIChat.该群聊已被解散");break;case 8:t=n.t("TUIChat.您已退出该群聊");break;default:t=n.t("TUIChat.您已退出该群聊");break}return t}),k=()=>{K.switchConversation("")},$=t=>{F("closeChat",t),k()},j=t=>{var o;(o=T.value)==null||o.insertEmoji(t)},z=(t,o)=>{var x,D,V;if(!(!t||!o))switch(o){case"reference":break;case"reply":break;case"reedit":(x=t==null?void 0:t.payload)!=null&&x.text&&((V=T==null?void 0:T.value)==null||V.reEdit((D=t==null?void 0:t.payload)==null?void 0:D.text));break}},W=()=>{s.value[0].listener.onClicked({groupID:f.value})};function M(t){l.value=l.value===t?"none":t,l.value!=="none"&&u&&uni.$emit("scroll-to-bottom")}function q(){var t;(t=v.value)==null||t.scrollToLatestMessage()}function b(t){h.value=t===void 0?!h.value:t}function J(){var t;(t=v.value)==null||t.mergeForwardMessage()}function X(){var t;(t=v.value)==null||t.oneByOneForwardMessage()}function N(t){(t==null?void 0:t.operationType)>0?(s.value=[],d.value=!0,I.value=t==null?void 0:t.operationType):(d.value=!1,I.value=void 0)}function O(t){if(g.value===t)return;C.value=!1;let o=_.TYPES.CONV_C2C;t.startsWith(_.TYPES.CONV_GROUP)&&(o=_.TYPES.CONV_GROUP,C.value=!0,f.value=t.replace(_.TYPES.CONV_GROUP,"")),s.value=[],g.value=t,h.value=!1,U.setChatType(o),S.notifyEvent(m.TUIChat.EVENT.CHAT_STATE_CHANGED,m.TUIChat.EVENT_SUB_KEY.CHAT_OPENED,{groupID:f.value}),S.callService({serviceName:m.TUICustomerServicePlugin.SERVICE.NAME,method:m.TUICustomerServicePlugin.SERVICE.METHOD.ACTIVE_CONVERSATION,params:{conversationID:t}}),U.getChatType()===m.TUIChat.TYPE.GROUP&&(s.value=S.getExtensionList(m.TUIChat.EXTENSION.CHAT_HEADER.EXT_ID))}return(t,o)=>(i(),c("div",dt,[mt("div",{class:a(["tui-chat",!e(p)&&"tui-chat-h5"])},[e(g)?y("",!0):(i(),c("div",{key:0,class:a(["tui-chat-default",!e(p)&&"tui-chat-h5-default"])},[ut(t.$slots,"default",{},void 0,!0)],2)),e(g)?(i(),c("div",{key:1,class:a(["tui-chat",!e(p)&&"tui-chat-h5"])},[E(Q,{class:a(["tui-chat-header",!e(p)&&"tui-chat-H5-header",e(u)&&"tui-chat-uniapp-header"]),headerExtensionList:e(s),onCloseChat:$},null,8,["class","headerExtensionList"]),E(rt,{onToggleMultipleSelectMode:b}),E(tt,{ref_key:"messageListRef",ref:v,class:a(["tui-chat-message-list",!e(p)&&"tui-chat-h5-message-list"]),isGroup:e(C),groupID:e(f),isNotInGroup:e(d),isMultipleSelectMode:e(h),onHandleEditor:z,onCloseInputToolBar:o[0]||(o[0]=()=>M("none")),onToggleMultipleSelectMode:b},null,8,["class","isGroup","groupID","isNotInGroup","isMultipleSelectMode"]),e(d)?(i(),c("div",{key:0,class:a({"tui-chat-leave-group":!0,"tui-chat-leave-group-mobile":e(at)})},R(e(Y)),3)):e(h)?(i(),B(ot,{key:1,onOneByOneForwardMessage:X,onMergeForwardMessage:J,onToggleMultipleSelectMode:b})):(i(),c(ct,{key:2},[e(H)?(i(),B(it,{key:0,class:a(["tui-chat-message-input-toolbar",!e(p)&&"tui-chat-h5-message-input-toolbar",e(u)&&"tui-chat-uni-message-input-toolbar"]),displayType:e(l),onInsertEmoji:j,onChangeToolbarDisplayType:M,onScrollToLatestMessage:q},null,8,["class","displayType"])):y("",!0),E(et,{ref_key:"messageInputRef",ref:T,class:a(["tui-chat-message-input",!e(p)&&"tui-chat-h5-message-input",e(u)&&"tui-chat-uni-message-input",e(st)&&"tui-chat-wx-message-input"]),enableAt:e(L).InputMention,isMuted:!1,muteText:e(n).t("TUIChat.您已被管理员禁言"),placeholder:e(n).t("TUIChat.请输入消息"),inputToolbarDisplayType:e(l),onChangeToolbarDisplayType:M},null,8,["class","enableAt","muteText","placeholder","inputToolbarDisplayType"])],64))],2)):y("",!0),!e(d)&&e(u)&&e(C)&&e(s).length>0?(i(),c("div",{key:2,class:"group-profile",onClick:W},R(e(s)[0].text),1)):y("",!0)],2)]))}});const ho=Z(ht,[["__scopeId","data-v-5abe79ff"]]);export{ho as default};
