import{d as Y,b as C,r as M,aZ as j,a$ as O,o as r,c as i,a as y,a_ as s,aB as k,M as P,y as m,F as E,ao as R,ae as f,ap as H,aW as I,L as ee,x as ae}from"./@vue-a164be7a.js";import"./adapter-vue-24f22062.js";import{q as n,o as l,z as p,_ as se}from"./@tencentcloud-7fc831ec.js";import"./dayjs-0ab82212.js";import{c as re,g as te,s as U}from"./search-type-list-f8ecda48.js";import x from"./Icon-2c0593f3.js";import ie from"./index-7552e016.js";import{d as oe}from"./down-icon-f2c30b56.js";import{c as ce}from"./input-close-0334b363.js";import{c as ne}from"./close-dark-98fe05f7.js";import{a as T,c as L}from"./env-a593fd1d.js";import"./type-b7afadd9.js";const D=24*60*60,N={all:{key:"all",label:"全部",value:{timePosition:0,timePeriod:0}},oneDay:{key:"today",label:"今天",value:{timePosition:0,timePeriod:D}},threeDay:{key:"threeDays",label:"近三天",value:{timePosition:0,timePeriod:3*D}},sevenDay:{key:"sevenDays",label:"近七天",value:{timePosition:0,timePeriod:7*D}}},S=N.all,le={key:0,class:"tui-search-header"},ue={class:"tui-search-header-title"},he={class:"tui-search-tabs"},de=["onClick"],ye={key:1,class:"tui-search-time"},me=["onClick"],pe={key:0,class:"tui-search-time-item-picker"},Te={key:1},ve=Y({__name:"index",props:{popupPosition:{type:String,default:"bottom"},searchType:{type:String,default:"global",validator(g){return["global","conversation"].includes(g)}}},emits:["searchConfigChange","closeInConversationSearch"],setup(g,{emit:B}){const a=g,F=B,z=C(()=>(a==null?void 0:a.searchType)==="conversation"?re:te),v=M(U[a==null?void 0:a.searchType]),c=M(S),V=C(()=>v.value.key!=="contact"&&v.value.key!=="group"),b=C(()=>T&&a.searchType==="global"&&!L?"two":"one"),o=M(!1);function w(e){(e==null?void 0:e.searchType)===(a==null?void 0:a.searchType)&&(v.value=(e==null?void 0:e.value)||U[a==null?void 0:a.searchType])}function $(e){(e==null?void 0:e.searchType)===(a==null?void 0:a.searchType)&&(c.value=(e==null?void 0:e.value)||S)}j(()=>{n.watch(l.SEARCH,{currentSearchMessageType:w,currentSearchMessageTime:$})}),O(()=>{n.unwatch(l.SEARCH,{currentSearchMessageType:w,currentSearchMessageTime:$})});const q=e=>{n.update(l.SEARCH,"currentSearchMessageType",{value:e,searchType:a.searchType})},W=e=>{o.value&&e.key==="all"?o.value=!1:(o.value=!1,n.update(l.SEARCH,"currentSearchMessageTime",{value:e,searchType:a.searchType}))},Z=()=>{var e;((e=c.value)==null?void 0:e.key)!=="all"?n.update(l.SEARCH,"currentSearchMessageTime",{value:S,searchType:a.searchType}):o.value=!0},G=e=>{var h,t,u;if(((h=c.value)==null?void 0:h.key)==="all"){const{startDate:d,endDate:_}=e,A=Number((((t=_==null?void 0:_.toDate())==null?void 0:t.getTime())/1e3).toFixed(0)),Q=A-Number((((u=d==null?void 0:d.toDate())==null?void 0:u.getTime())/1e3).toFixed(0)),X={key:c.value.key,label:c.value.label,value:{timePosition:A,timePeriod:Q}};n.update(l.SEARCH,"currentSearchMessageTime",{value:X,searchType:a.searchType})}},J=()=>{var e;o.value=!1,((e=c.value)==null?void 0:e.key)==="all"&&n.update(l.SEARCH,"currentSearchMessageTime",{value:S,searchType:a.searchType})},K=()=>{F("closeInConversationSearch")};return(e,h)=>(r(),i("div",{class:f(["tui-search-container",!s(T)&&"tui-search-container-h5",s(T)&&`container-${a.popupPosition}`,`container-${a.searchType}`])},[y("div",{class:f([s(T)&&`tui-search-container-${a.popupPosition}`,!s(T)&&"tui-search-container-h5-main"])},[a.searchType==="conversation"&&!s(L)?(r(),i("div",le,[y("div",ue,k(s(p).t("TUISearch.搜索会话内容")),1),y("div",{class:"tui-search-header-close",onClick:K},[P(x,{file:s(ne),width:"14px",height:"14px"},null,8,["file"])])])):m("",!0),y("div",he,[(r(!0),i(E,null,R(s(z),(t,u)=>(r(),i("div",{key:u,class:f(["tui-search-tabs-item",s(v).key===t.key&&"tui-search-tabs-item-selected"]),onClick:d=>q(t)},k(s(p).t(`TUISearch.${t.label}`)),11,de))),128))]),H(e.$slots,"input",{},void 0,!0),s(V)?(r(),i("div",ye,[(r(!0),i(E,null,R(s(N),(t,u)=>(r(),i("div",{key:u,class:f(["tui-search-time-item",s(c).key===t.key&&"tui-search-time-item-selected"]),onClick:d=>W(t)},[t.key==="all"?(r(),i("div",pe,[s(o)?m("",!0):(r(),i("div",{key:0,class:"tui-search-time-item-all",onClick:I(Z,["stop"])},[ee(k(s(p).t("TUISearch.选择时间")+":  "+s(p).t("TUISearch.全部"))+" ",1),P(x,{file:s(oe),width:"14px",height:"14px"},null,8,["file"])])),y("div",{onClick:h[0]||(h[0]=I(()=>{},["stop"]))},[s(o)?(r(),ae(ie,{key:0,type:"range",rangeTableType:s(b),onPick:G},null,8,["rangeTableType"])):m("",!0)]),s(o)?(r(),i("div",{key:1,class:"tui-search-time-item-close",onClick:J},[P(x,{class:"icon",file:s(ce),width:"14px",height:"14px"},null,8,["file"])])):m("",!0)])):(r(),i("div",Te,k(s(p).t(`TUISearch.${t.label}`)),1))],10,me))),128))])):m("",!0),H(e.$slots,"result",{},void 0,!0)],2)],2))}});const ke=se(ve,[["__scopeId","data-v-fec6713a"]]),Ee=Object.freeze(Object.defineProperty({__proto__:null,default:ke},Symbol.toStringTag,{value:"Module"}));export{ke as S,Ee as i,S as s};
