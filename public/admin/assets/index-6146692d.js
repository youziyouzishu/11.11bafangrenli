import"./adapter-vue-24f22062.js";import{q as H,o as R,B as M,r as B,R as te,_ as oe}from"./@tencentcloud-7fc831ec.js";import re from"./index-043f784c.js";import ae from"./index-9da5d87d.js";import ie from"./index-09f1251e.js";import le from"./index-088f9895.js";import se from"./index-b0dc35a7.js";import ne from"./index-a7c8e24e.js";import W from"./index-ca5aad75.js";import{_ as ce}from"./index.vue_vue_type_script_setup_true_lang-71ceb69d.js";import{a as g,c as m,i as _}from"./env-a593fd1d.js";import{T as G}from"./config-58aee8b5.js";import{e as pe}from"./enableSampleTaskStatus-a12ec87d.js";import{d as ue,r as s,aZ as me,a$ as de,w as fe,b as $,o as l,c as v,a as ge,a_ as r,x as u,y as n,F as Y,ao as q,ae as k,M as ve}from"./@vue-a164be7a.js";import"./tim-upload-plugin-4412696f.js";import"./tim-profanity-filter-plugin-a7e08ee8.js";import"./vue-84471dcb.js";import"./marked-7f3c3653.js";import"./trtc-cloud-js-sdk-6995d964.js";import"./trtc-sdk-v5-5ba82a9e.js";import"./pinia-ec219911.js";import"./mitt-f7ef348c.js";import"./interactjs-0d94d9f4.js";import"./rtc-detect-b2f0fa0a.js";import"./tuicall-engine-webrtc-9ec0a575.js";import"./emoji-picker-dialog-66c4a991.js";import"./Icon-2c0593f3.js";import"./constant-bad60a54.js";import"./utils-14df48f1.js";import"./index-7909557f.js";import"./camera-uni-de12e41a.js";import"./index-0978e08a.js";import"./files-37ebf78f.js";import"./documentLink-a7b030c0.js";import"./star-light-645157ed.js";import"./index-b5b8c0ea.js";import"./index-1dfefc7d.js";import"./index-20817905.js";import"./selected-a3efc726.js";import"./back-16f17fde.js";const Ce={key:0,class:k(["message-input-toolbar-list-end"])},he=ue({__name:"index",props:{displayType:{default:"none"}},emits:["scrollToLatestMessage","changeToolbarDisplayType","insertEmoji"],setup(X,{emit:z}){const Q=X,y=z,d=s(),i=s(),I=s(!1),E=s(""),f=s(),T=s(),C=s(),h=s([]),c=G.getFeatureConfig(),S=s(!0);S.value=c.InputEmoji||c.InputStickers,me(()=>{H.watch(R.CONV,{currentConversation:b})}),de(()=>{H.unwatch(R.CONV,{currentConversation:b})}),fe(()=>Q.displayType,e=>{var o;e==="none"?(o=T.value)==null||o.closeEmojiPicker():y("scrollToLatestMessage")});const b=e=>{var o,t;e!=null&&e.conversationID&&e.conversationID!==((o=i.value)==null?void 0:o.conversationID)&&Z(e.conversationID),i.value=e,I.value=((t=i==null?void 0:i.value)==null?void 0:t.type)===M.TYPES.CONV_GROUP},Z=e=>{if(!e)return;const o=G.getChatType(),t={chatType:o};o===B.TUIChat.TYPE.CUSTOMER_SERVICE&&(t.filterVoice=!0,t.filterVideo=!0,pe("customerService")),h.value=[...te.getExtensionList(B.TUIChat.EXTENSION.INPUT_MORE.EXT_ID,t)].filter(a=>{var p;return((p=a==null?void 0:a.data)==null?void 0:p.name)==="search"?c.MessageSearch:!0})},D=$(()=>g?h.value.filter(o=>{var t;return((t=o==null?void 0:o.data)==null?void 0:t.name)!=="search"}):h.value),U=$(()=>{if(g){const e=h.value.find(o=>{var t;return((t=o==null?void 0:o.data)==null?void 0:t.name)==="search"});return e?[e]:[]}return[]}),w=e=>{var o,t,a;switch((o=e==null?void 0:e.data)==null?void 0:o.name){case"voiceCall":O(e,1);break;case"videoCall":O(e,2);break;default:(a=e==null?void 0:e.listener)==null||a.onClicked((t=i.value)==null?void 0:t._conversation);break}},O=(e,o)=>{var t,a,p,P,j,F,N;E.value=(t=e==null?void 0:e.data)==null?void 0:t.name,((a=i==null?void 0:i.value)==null?void 0:a.type)===M.TYPES.CONV_C2C?(F=(p=e.listener)==null?void 0:p.onClicked)==null||F.call(p,{userIDList:[(j=(P=i==null?void 0:i.value)==null?void 0:P.conversationID)==null?void 0:j.slice(3)],type:o}):I.value&&(C.value=e,(N=f==null?void 0:f.value)!=null&&N.toggleShow&&f.value.toggleShow(!0))},V=e=>e==null?void 0:e.icon,L=e=>e==null?void 0:e.text,A=e=>{var o,t,a;(a=(t=(o=C.value)==null?void 0:o.listener)==null?void 0:t.onClicked)==null||a.call(t,e),C.value=void 0},J=()=>{C.value=void 0},K=e=>{y("insertEmoji",e)},x=e=>{var o,t;_&&(o=d.value)!=null&&o.appendChild&&((t=d.value)==null||t.appendChild(e))},ee=e=>{var o,t;_&&e&&(o=d.value)!=null&&o.removeChild&&((t=d.value)==null||t.removeChild(e))};return(e,o)=>(l(),v("div",{class:k(["message-input-toolbar",!r(g)&&"message-input-toolbar-h5",r(m)&&"message-input-toolbar-uni"])},[ge("div",{class:k(["message-input-toolbar-list",!r(g)&&"message-input-toolbar-h5-list",r(m)&&"message-input-toolbar-uni-list"])},[r(S)?(l(),u(re,{key:0,ref_key:"emojiPickerRef",ref:T,onInsertEmoji:K,onDialogShowInH5:x,onDialogCloseInH5:ee,onChangeToolbarDisplayType:o[0]||(o[0]=t=>y("changeToolbarDisplayType",t))},null,512)):n("",!0),r(c).InputImage?(l(),u(ae,{key:1,imageSourceType:"album"})):n("",!0),r(c).InputFile?(l(),u(ie,{key:2})):n("",!0),r(c).InputVideo?(l(),u(le,{key:3,videoSourceType:"album"})):n("",!0),r(c).InputEvaluation?(l(),u(se,{key:4})):n("",!0),r(c).InputQuickReplies?(l(),u(ne,{key:5})):n("",!0),r(D)[0]?(l(!0),v(Y,{key:6},q(r(D),t=>(l(),u(W,{key:t.id,iconFile:V(t),title:L(t),iconWidth:r(m)?"25px":"20px",iconHeight:r(m)?"25px":"20px",needDialog:!1,onOnIconClick:a=>w(t)},null,8,["iconFile","title","iconWidth","iconHeight","onOnIconClick"]))),128)):n("",!0)],2),r(U)[0]&&r(g)?(l(),v("div",Ce,[(l(!0),v(Y,null,q(r(U),(t,a)=>(l(),u(W,{key:a,iconFile:V(t),title:L(t),iconWidth:r(m)?"25px":"20px",iconHeight:r(m)?"25px":"20px",needDialog:!1,onOnIconClick:p=>w(t)},null,8,["iconFile","title","iconWidth","iconHeight","onOnIconClick"]))),128))])):n("",!0),ve(ce,{ref_key:"userSelectorRef",ref:f,type:r(E),currentConversation:r(i),isGroup:r(I),onSubmit:A,onCancel:J},null,8,["type","currentConversation","isGroup"]),r(_)?(l(),v("div",{key:1,ref_key:"h5Dialog",ref:d,class:k(["message-input-toolbar-h5-dialog"])},null,512)):n("",!0)],2))}});const it=oe(he,[["__scopeId","data-v-bc48d0ec"]]);export{it as default};
