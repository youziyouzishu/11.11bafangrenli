import{q as m,o as f,Z as E,z as g,R as D}from"./@tencentcloud-7fc831ec.js";import"./adapter-vue-24f22062.js";import{T as _}from"./index-cfdb213d.js";import{_ as C}from"./index.vue_vue_type_script_setup_true_lang-b448363d.js";import{T as U}from"./server-fb151bb0.js";import{T as L}from"./index-e4ac2ab7.js";import{d as G,r as o,b6 as b,o as M,x as N,a_ as l}from"./@vue-a164be7a.js";const V=G({__name:"index",setup(O){const n=U.getInstance(),c=n.constants,v=o(!1),a=o([]),s=o([]),i=o({}),r=o({groupID:"",isRadio:!1,isNeedSearch:!1,title:"",filterUserIDList:[]}),u=o(null),S=e=>{u.value=D.getService(c.TUISearch.SERVICE.NAME),u.value?v.value=e:console.warn("请添加 TUISearch 组件")};b(()=>{const e=n.getOnCallParams(c.TUIContact.SERVICE.METHOD.SELECT_FRIEND);r.value.groupID=e.groupID,r.value.title=e.title,r.value.isRadio=e.isRadio,r.value.isNeedSearch=e.isNeedSearch,r.value.filterUserIDList=e.filterUserIDList,e.isNeedSearch&&S(e.isNeedSearch)}),m.watch(f.GRP,{currentGroup:e=>{i.value=e},currentGroupMemberList:e=>{a.value=e.map(t=>{r.value.filterUserIDList.indexOf(t.userID)>-1&&(t.isDisabled=!0)}),s.value=a.value}});const d=async()=>{const t={groupID:i.value.groupID,count:100,offset:a.value.length};await E.getGroupMemberList(t)},h=e=>{m.update(f.GRP,"isShowSelectComponent",!1);const t=n.getOnCallCallback(c.TUIGroup.SERVICE.METHOD.SELECT_GROUP_MEMBER);t&&t(e)},p=()=>{_({message:g.t("TUIGroup.该用户不存在"),type:L.ERROR}),s.value=[...a.value]},I=async e=>{if(!e)return s.value=a.value;try{const t=await u.value.searchGroupMember(e);if(!t.data[0])return p();s.value=t.data;const R=a.value.filter(T=>T.userID===t.data[0].userID);a.value=R.length?a.value:[...a.value,...s.value]}catch{return p()}};return(e,t)=>(M(),N(C,{isRadio:l(r).isRadio,isNeedSearch:l(r).isNeedSearch,title:l(r).title,userList:l(s),total:l(i).memberCount,onGetMore:d,onSearch:I,onComplete:h},null,8,["isRadio","isNeedSearch","title","userList","total"]))}});export{V as _};
