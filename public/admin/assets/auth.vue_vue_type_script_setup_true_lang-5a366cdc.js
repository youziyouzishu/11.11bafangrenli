import{B as P,U,y as q,E as H,A as O,I as j}from"./element-plus-69d92160.js";import{a as z}from"./role-e3d4b914.js";import{P as G}from"./index-943d816c.js";import{p as J}from"./index-90bac5cf.js";import{m as Q}from"./menu-18b4c21e.js";import{d as W,b5 as f,r,b2 as X,o as k,c as Y,M as o,aR as d,aT as Z,x as $,a_ as c,a as y,b0 as ee,b7 as x}from"./@vue-a164be7a.js";const te={class:"edit-popup"},ie=W({__name:"auth",emits:["success","close"],setup(le,{expose:b,emit:C}){const _=C,a=f(),h=f(),u=f(),g=r(!1),i=r(!0),m=r(!1),v=r([]),p=r([]),s=X({id:"",name:"",desc:"",sort:0,menu_id:[]}),E={name:[{required:!0,message:"请输入名称",trigger:["blur"]}]},R=()=>{m.value=!0,Q().then(e=>{p.value=e,v.value=J(e),x(()=>{A()}),m.value=!1})},w=()=>{var l,n;const e=(l=a.value)==null?void 0:l.getCheckedKeys(),t=(n=a.value)==null?void 0:n.getHalfCheckedKeys();return e==null||e.unshift.apply(e,t),e},A=()=>{s.menu_id.forEach(e=>{x(()=>{var t;(t=a.value)==null||t.setChecked(e,!0,!1)})})},K=e=>{const t=p.value;for(let l=0;l<t.length;l++)a.value.store.nodesMap[t[l].id].expanded=e},B=e=>{var t,l;e?(t=a.value)==null||t.setCheckedKeys(v.value.map(n=>n.id)):(l=a.value)==null||l.setCheckedKeys([])},D=async()=>{var e,t;await((e=h.value)==null?void 0:e.validate()),s.menu_id=w(),await z(s),(t=u.value)==null||t.close(),_("success")},T=()=>{_("close")},V=()=>{var e;(e=u.value)==null||e.open()},S=async e=>{for(const t in s)e[t]!=null&&e[t]!=null&&(s[t]=e[t])};return R(),b({open:V,setFormData:S}),(e,t)=>{const l=P,n=U,F=q,I=H,L=O,M=j;return k(),Y("div",te,[o(G,{ref_key:"popupRef",ref:u,title:"分配权限",async:!0,width:"550px",onConfirm:D,onClose:T},{default:d(()=>[Z((k(),$(L,{class:"ls-form",ref_key:"formRef",ref:h,rules:E,model:c(s),"label-width":"60px"},{default:d(()=>[o(I,{class:"h-[400px] sm:h-[600px]"},{default:d(()=>[o(F,{label:"权限",prop:"menu_id"},{default:d(()=>[y("div",null,[o(l,{label:"展开/折叠",onChange:K}),o(l,{label:"全选/不全选",onChange:B}),o(l,{modelValue:c(i),"onUpdate:modelValue":t[0]||(t[0]=N=>ee(i)?i.value=N:null),label:"父子联动"},null,8,["modelValue"]),y("div",null,[o(n,{ref_key:"treeRef",ref:a,data:c(p),props:{label:"name",children:"children"},"check-strictly":!c(i),"node-key":"id","default-expand-all":c(g),"show-checkbox":""},null,8,["data","check-strictly","default-expand-all"])])])]),_:1})]),_:1})]),_:1},8,["model"])),[[M,c(m)]])]),_:1},512)])}}});export{ie as _};
