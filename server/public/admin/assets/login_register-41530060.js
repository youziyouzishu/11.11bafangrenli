import{_ as E}from"./index-581f66c5.js";import{B as C,a8 as B,y as U,Q as D,H as R,C as W,A as F}from"./element-plus-69d92160.js";import{g as L,s as N}from"./user-06e901ad.js";import{d as y,r as P,b2 as h,ar as S,o as b,c as A,M as t,aR as a,a as e,a_ as r,L as s,aB as c,aT as T,x as j}from"./@vue-a164be7a.js";import"./@tencentcloud-7fc831ec.js";import"./tim-upload-plugin-4412696f.js";import"./tim-profanity-filter-plugin-a7e08ee8.js";import"./vue-84471dcb.js";import"./marked-7f3c3653.js";import"./trtc-cloud-js-sdk-6995d964.js";import"./trtc-sdk-v5-5ba82a9e.js";import"./pinia-ec219911.js";import"./mitt-f7ef348c.js";import"./interactjs-0d94d9f4.js";import"./rtc-detect-b2f0fa0a.js";import"./tuicall-engine-webrtc-9ec0a575.js";import"./lodash-es-fbce1780.js";import"./async-validator-dee29e8b.js";import"./@element-plus-21ebab28.js";import"./dayjs-0ab82212.js";import"./@ctrl-f8748455.js";import"./@popperjs-c75af06c.js";import"./normalize-wheel-es-ed76fb12.js";import"./index-90bac5cf.js";import"./@vueuse-ebd2cc93.js";import"./lodash-f986f62a.js";import"./axios-9669b5e1.js";import"./vue-router-b1515852.js";import"./css-color-function-7acc3e97.js";import"./color-9254db0b.js";import"./clone-db6b0f3b.js";import"./color-convert-946e453a.js";import"./color-name-b7949e8c.js";import"./color-string-6fa48439.js";import"./balanced-match-51764fed.js";import"./ms-f6814399.js";import"./nprogress-e3c843bc.js";import"./vue-clipboard3-b827321c.js";import"./clipboard-e27f968b.js";import"./echarts-d6620a89.js";import"./zrender-9797a04d.js";import"./tslib-54e39b60.js";import"./highlight.js-7476ba27.js";import"./@highlightjs-10fbb12e.js";import"./path-to-regexp-767716ea.js";const G={class:"login-register"},H=e("div",{class:"font-medium mb-7"},"通用设置",-1),I=e("div",{class:"form-tips"},"系统通用登录方式，至少选择一项",-1),M={class:"mt-1 ml-2"},Q=e("div",{class:"form-tips"},[s(" 登陆注册后强制绑定用户身份角色"),e("br")],-1),z={class:"mt-1 ml-2"},J=e("div",{class:"form-tips"},[s(" 1、如果开启，则新用户在注册完成之后要强制绑定手机号"),e("br"),s(" 2、老用户登录时如果检测到没有绑定手机，则要重新绑定手机号 ")],-1),K={class:"mt-1 ml-2"},O=e("div",{class:"form-tips"},"登录/注册会员时，是否显示服务协议和隐私政策",-1),X=e("div",{class:"font-medium mb-7"},"第三方设置",-1),Y={class:"mt-1 ml-2"},Z=e("div",{class:"form-tips"},"登录时支持第三方登录，新用户授权即自动注册账号",-1),$={href:"https://open.weixin.qq.com/",target:"_blank"},ee=e("div",{class:"form-tips"},[s(" 1、在各渠道使用微信授权登录时，强烈建议配置微信开放平台"),e("br"),s(" 2、微信开放平台关联公众号、小程序和APP后，可实现各端用户账号统一，识别买家唯一微信身份"),e("br"),s(" 3、没有配置微信开放平台，同一微信号会生成多个用户，配置微信开放平台后已生成的用户账号无法合并 ")],-1),oe=y({name:"loginRegister"}),Ke=y({...oe,setup(te){const d=P(),o=h({login_way:[],coerce_mobile:0,login_agreement:0,third_auth:0,wechat_auth:0,qq_auth:0}),V=h({loginWay:[{required:!0,validator:(n,l,m)=>{if(o.login_way.join("").length===0)m(new Error("登录方式至少选择一项！"));else{if(o.login_way!==""){if(!d.value)return;d.value.validateField("checkPass",()=>null)}m()}},trigger:"change"}],coerce_mobile:[{required:!0,trigger:"blur"}],login_agreement:[{required:!0,trigger:"blur"}],third_auth:[{required:!0,trigger:"blur"}],coerce_role:[{required:!0,trigger:"blur"}]}),p=async()=>{try{const n=await L();for(const l in o)o[l]=n[l]}catch(n){console.log("获取=>",n)}},w=async()=>{var n;await((n=d.value)==null?void 0:n.validate());try{await N(o),p()}catch(l){console.log("保存=>",l)}};return p(),(n,l)=>{const m=C,f=B,_=U,u=D,g=R,v=W,k=F,x=E,q=S("perms");return b(),A("div",G,[t(k,{ref_key:"formRef",ref:d,rules:r(V),model:r(o),"label-width":"120px"},{default:a(()=>[t(g,{shadow:"never",class:"!border-none"},{default:a(()=>[H,t(_,{label:"登录方式",prop:"loginWay"},{default:a(()=>[e("div",null,[t(f,{modelValue:r(o).login_way,"onUpdate:modelValue":l[0]||(l[0]=i=>r(o).login_way=i)},{default:a(()=>[t(m,{label:"1"},{default:a(()=>[s("账号密码登录")]),_:1}),t(m,{label:"2"},{default:a(()=>[s("手机验证码登录")]),_:1})]),_:1},8,["modelValue"]),I])]),_:1}),t(_,{label:"强制绑定角色",prop:"coerce_role"},{default:a(()=>[e("div",null,[t(u,{modelValue:r(o).coerce_role,"onUpdate:modelValue":l[1]||(l[1]=i=>r(o).coerce_role=i),disabled:!0,"active-value":1,"inactive-value":0},null,8,["modelValue"]),e("span",M,c(r(o).coerce_role?"开启":"关闭"),1),Q])]),_:1}),t(_,{label:"强制绑定手机",prop:"coerce_mobile"},{default:a(()=>[e("div",null,[t(u,{modelValue:r(o).coerce_mobile,"onUpdate:modelValue":l[2]||(l[2]=i=>r(o).coerce_mobile=i),"active-value":1,"inactive-value":0},null,8,["modelValue"]),e("span",z,c(r(o).coerce_mobile?"开启":"关闭"),1),J])]),_:1}),t(_,{label:"政策协议",prop:"login_agreement"},{default:a(()=>[e("div",null,[t(u,{modelValue:r(o).login_agreement,"onUpdate:modelValue":l[3]||(l[3]=i=>r(o).login_agreement=i),"active-value":1,"inactive-value":0},null,8,["modelValue"]),e("span",K,c(r(o).login_agreement?"开启":"关闭"),1),O])]),_:1})]),_:1}),t(g,{shadow:"never",class:"!border-none mt-4"},{default:a(()=>[X,t(_,{label:"第三方登录",prop:"third_auth"},{default:a(()=>[e("div",null,[t(u,{modelValue:r(o).third_auth,"onUpdate:modelValue":l[4]||(l[4]=i=>r(o).third_auth=i),"active-value":1,"inactive-value":0},null,8,["modelValue"]),e("span",Y,c(r(o).third_auth?"开启":"关闭"),1),Z,e("div",null,[t(m,{modelValue:r(o).wechat_auth,"onUpdate:modelValue":l[5]||(l[5]=i=>r(o).wechat_auth=i),"true-label":1,"false-label":0},{default:a(()=>[s(" 微信登录 ")]),_:1},8,["modelValue"])])])]),_:1}),t(_,{label:"微信开放平台"},{default:a(()=>[e("div",null,[e("a",$,[t(v,{type:"primary",link:"",class:"underline"},{default:a(()=>[s(" 前往微信开放平台 ")]),_:1})]),ee])]),_:1})]),_:1})]),_:1},8,["rules","model"]),T((b(),j(x,null,{default:a(()=>[t(v,{type:"primary",onClick:w},{default:a(()=>[s("保存")]),_:1})]),_:1})),[[q,["setting.user.user/setRegisterConfig"]]])])}}});export{Ke as default};
