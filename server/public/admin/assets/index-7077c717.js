import"./adapter-vue-24f22062.js";import{q as g,z as n,o as A,E as S,P as U,_ as h}from"./@tencentcloud-7fc831ec.js";import{c as v}from"./env-a593fd1d.js";import{T as G}from"./index-cfdb213d.js";import{t as w}from"./index-7909557f.js";import{T as x}from"./index-e4ac2ab7.js";import{d as u,r as _,b as F,aZ as V,a_ as c,o as T,c as m,aB as E,ae as B,y as X}from"./@vue-a164be7a.js";import"./tim-upload-plugin-4412696f.js";import"./tim-profanity-filter-plugin-a7e08ee8.js";import"./vue-84471dcb.js";import"./marked-7f3c3653.js";import"./trtc-cloud-js-sdk-6995d964.js";import"./trtc-sdk-v5-5ba82a9e.js";import"./pinia-ec219911.js";import"./mitt-f7ef348c.js";import"./interactjs-0d94d9f4.js";import"./rtc-detect-b2f0fa0a.js";import"./tuicall-engine-webrtc-9ec0a575.js";import"./constant-bad60a54.js";var a=(e=>(e[e.TYPE_NONE=0]="TYPE_NONE",e[e.TYPE_TEXT=1]="TYPE_TEXT",e[e.TYPE_CUSTOM=2]="TYPE_CUSTOM",e[e.TYPE_IMAGE=3]="TYPE_IMAGE",e[e.TYPE_SOUND=4]="TYPE_SOUND",e[e.TYPE_VIDEO=5]="TYPE_VIDEO",e[e.TYPE_FILE=6]="TYPE_FILE",e[e.TYPE_LOCATION=7]="TYPE_LOCATION",e[e.TYPE_FACE=8]="TYPE_FACE",e[e.TYPE_GROUP_TIPS=9]="TYPE_GROUP_TIPS",e[e.TYPE_MERGER=10]="TYPE_MERGER",e))(a||{});const z={key:0,class:"revoked-text"},W={key:1,class:"max-double-line"},q=u({__name:"index",props:{message:{default:()=>({})}},emits:["scrollTo","blinkMessage"],setup(e,{emit:R}){const P=R,d=e;let b=0;const Y=_(""),i=_(!1),l=_({}),f=F(()=>{var t;try{const s=JSON.parse(((t=d.message)==null?void 0:t.cloudCustomData)||"{}"),o=g.getMessageModel(s.messageReply.messageID);return o==null?void 0:o.isRevoked}catch{return!0}});V(()=>{var t;try{const s=JSON.parse(((t=d.message)==null?void 0:t.cloudCustomData)||"{}");i.value=!!s.messageReply,i.value&&(l.value=s.messageReply,Y.value=N(l.value))}catch{i.value=!1}});function N(t){let s="",o="";switch(t.messageType){case a.TYPE_TEXT:s="[文本]";break;case a.TYPE_CUSTOM:s="[自定义消息]";break;case a.TYPE_IMAGE:s="[图片]";break;case a.TYPE_SOUND:s="[音频]";break;case a.TYPE_VIDEO:s="[视频]";break;case a.TYPE_FILE:s="[文件]";break;case a.TYPE_LOCATION:s="[地理位置]";break;case a.TYPE_FACE:s="[动画表情]";break;case a.TYPE_GROUP_TIPS:s="[群提示]";break;case a.TYPE_MERGER:s="[聊天记录]";break;default:s="[消息]";break}return[a.TYPE_TEXT,a.TYPE_MERGER].includes(t.messageType)&&(o=t.messageAbstract),o||n.t(`TUIChat.${s}`)}async function D(){var p;if(f.value)return;const t=(p=l.value)==null?void 0:p.messageID,o=g.getData(A.CHAT,"messageList").some(r=>r.ID===t);if(t&&o)try{const r=await S("#messageScrollList","messageList"),I=await S("#tui-"+t,"messageList"),{scrollTop:L}=await U("#messageScrollList","messageList"),C=I.top+L-r.top-b++%2,O=I.top<r.top;if(!v&&window){const k=document.getElementById("messageScrollList");O&&k&&(k.scrollTop=C)}else v&&O&&P("scrollTo",C);P("blinkMessage",t)}catch(r){console.error(r)}else G({message:n.t("TUIChat.无法定位到原消息"),type:x.WARNING})}return(t,s)=>c(i)?(T(),m("div",{key:0,class:B({"reference-content":!0,reverse:t.message.flow==="out"}),onClick:D},[c(f)?(T(),m("div",z,E(c(n).t("TUIChat.引用内容已撤回")),1)):(T(),m("div",W,E(c(l).messageSender)+": "+E(c(w)(c(Y))),1))],2)):X("",!0)}});const _e=h(q,[["__scopeId","data-v-d0749b87"]]);export{_e as default};
