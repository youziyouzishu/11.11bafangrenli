import{d as ve,r as S,b as M,aZ as me,a$ as Ce,a_ as t,o as d,c as f,ae as u,a as y,M as P,aB as D,y as O,F as L,ao as w,aT as ne,aO as ie,aU as ke}from"./@vue-a164be7a.js";import{q as T,o as I,z as x,i as ce,B as R,_ as ye}from"./@tencentcloud-7fc831ec.js";import"./adapter-vue-24f22062.js";import{a as l}from"./env-a593fd1d.js";import{u as he,r as be,a as Te,d as Ie,q as _e,j as oe,e as le,b as ge,c as Se,f as De,g as Ae,i as Ue,h as Fe,k as Oe,l as Ee,m as Me}from"./index-cb5533b0.js";import{a as E,b as A,c as k}from"./constant-bad60a54.js";import ue from"./Icon-2c0593f3.js";import{e as xe}from"./edit-3cf9aa40.js";import{b as Ge}from"./back-16f17fde.js";import Ne from"./index-20504119.js";import{d as Pe}from"./utils-14df48f1.js";import"./tim-upload-plugin-4412696f.js";import"./tim-profanity-filter-plugin-a7e08ee8.js";import"./vue-84471dcb.js";import"./marked-7f3c3653.js";import"./trtc-cloud-js-sdk-6995d964.js";import"./trtc-sdk-v5-5ba82a9e.js";import"./pinia-ec219911.js";import"./mitt-f7ef348c.js";import"./interactjs-0d94d9f4.js";import"./rtc-detect-b2f0fa0a.js";import"./tuicall-engine-webrtc-9ec0a575.js";import"./index-cfdb213d.js";import"./index-e4ac2ab7.js";const h={setRemark:{key:"setRemark",label:"备注名",data:"",labelPosition:E.LEFT,editable:!0,editType:A.INPUT,editing:!1,editSubmitHandler:e=>{var o,v,i,_,m,c;if(e!=null&&e.isBothFriend){const G=(o=e==null?void 0:e.item)==null?void 0:o.data;he((v=e==null?void 0:e.contactInfoData)==null?void 0:v.userID,G),(i=e==null?void 0:e.item)!=null&&i.editing&&(e.item.editing=!1),(_=e==null?void 0:e.item)!=null&&_.data&&(e.item.data=(m=e==null?void 0:e.contactInfoData)==null?void 0:m.remark)}else(c=e==null?void 0:e.item)!=null&&c.editing&&(e.item.editing=!1)}},blackList:{key:"blackList",label:"加入黑名单",data:!1,labelPosition:E.LEFT,editable:!0,editType:A.SWITCH,editing:!0,editSubmitHandler:e=>{var o,v;e!=null&&e.isInBlackList?be((o=e==null?void 0:e.contactInfoData)==null?void 0:o.userID):(Te((v=e==null?void 0:e.contactInfoData)==null?void 0:v.userID),T.update(I.CUSTOM,"currentContactListKey","blackList"))}},setWords:{key:"setWords",label:"请填写验证信息",data:"",labelPosition:E.TOP,editable:!0,editType:A.TEXTAREA,editing:!0},displayWords:{key:"displayWords",label:"验证信息",data:"",labelPosition:E.LEFT,editable:!1}},C={dismissGroup:{key:"dismissGroup",label:"解散群聊",type:k.CANCEL,onClick:e=>{var o;Ie((o=e==null?void 0:e.contactInfoData)==null?void 0:o.groupID)}},quitGroup:{key:"quitGroup",label:"退出群聊",type:k.CANCEL,onClick:e=>{var o;_e((o=e==null?void 0:e.contactInfoData)==null?void 0:o.groupID)}},joinGroup:{key:"joinGroup",label:"发送申请",type:k.SUBMIT,onClick:e=>{var o,v;oe((o=e==null?void 0:e.contactInfoData)==null?void 0:o.groupID,(v=e==null?void 0:e.contactInfoMoreList[0])==null?void 0:v.data)}},joinAVChatGroup:{key:"joinAVChatGroup",label:"加入直播群",type:k.SUBMIT,onClick:e=>{var o;oe((o=e==null?void 0:e.contactInfoData)==null?void 0:o.groupID)}},enterGroupConversation:{key:"enterGroupConversation",label:"进入群聊",type:k.SUBMIT,onClick:e=>{le(e==null?void 0:e.contactInfoData)}},addFriend:{key:"addFriend",label:"发送申请",type:k.SUBMIT,onClick:e=>{var o,v,i;ge({to:(o=e==null?void 0:e.contactInfoData)==null?void 0:o.userID,source:"AddSource_Type_Web",remark:(v=e==null?void 0:e.contactInfoMoreList[1])==null?void 0:v.data,wording:(i=e==null?void 0:e.contactInfoMoreList[0])==null?void 0:i.data})}},deleteFriend:{key:"deleteFriend",label:"删除好友",type:k.CANCEL,onClick:e=>{var o;Se((o=e==null?void 0:e.contactInfoData)==null?void 0:o.userID)}},enterC2CConversation:{key:"enterC2CConversation",label:"发送消息",type:k.SUBMIT,onClick:e=>{le(e==null?void 0:e.contactInfoData)}},acceptFriendApplication:{key:"acceptFriendApplication",label:"同意",type:k.SUBMIT,onClick:e=>{var o;De((o=e==null?void 0:e.contactInfoData)==null?void 0:o.userID),T.update(I.CUSTOM,"currentContactListKey","friendList")}},refuseFriendApplication:{key:"refuseFriendApplication",label:"拒绝",type:k.CANCEL,onClick:e=>{var o;Ae((o=e==null?void 0:e.contactInfoData)==null?void 0:o.userID)}}},Le=["src"],we=["onClick"],Re=["onUpdate:modelValue","onConfirm","onKeyup"],Be=["onUpdate:modelValue"],Ve=["onClick"],$e=["onClick"],je=ve({__name:"index",emits:["switchConversation"],setup(e,{emit:o}){const v=o,i=S({}),_=S([]),m=S([]),c=S([]),G=n=>{n.editing=!0},b=M(()=>{var n;return!!((n=i.value)!=null&&n.groupID)}),B=M(()=>Ue(i==null?void 0:i.value)),U=S(!1),V=M(()=>{var n,s;return!!((s=(n=i.value)==null?void 0:n.selfInfo)!=null&&s.userID)}),g=M(()=>{var n;return!b.value&&((n=$.value)==null?void 0:n.findIndex(s=>{var a;return(s==null?void 0:s.userID)===((a=i.value)==null?void 0:a.userID)}))>=0}),$=S([]);me(()=>{T.watch(I.CUSTOM,{currentContactInfo:K}),T.watch(I.USER,{userBlacklist:W})}),Ce(()=>{T.unwatch(I.CUSTOM,{currentContactInfo:K}),T.unwatch(I.USER,{userBlacklist:W})});const se=()=>{i.value={},_.value=[],m.value=[],c.value=[]},j=()=>{var n,s;T.update(I.CUSTOM,"currentContactInfo",{}),T.update(I.CUSTOM,"currentContactSearchingStatus",!1),(n=ce)!=null&&n.closeSearching&&((s=ce)==null||s.closeSearching())},N=n=>{n.editSubmitHandler&&n.editSubmitHandler({item:n,contactInfoData:i.value,isBothFriend:U.value,isInBlackList:g.value})},re=n=>{n.onClick&&n.onClick({contactInfoData:i.value,contactInfoMoreList:m.value}),(n.key==="enterGroupConversation"||n.key==="enterC2CConversation")&&(v("switchConversation",i.value),j())},de=async()=>{var n,s,a,r,F;B.value?(h.displayWords.data=((F=i.value)==null?void 0:F.wording)||"",m.value.push(h.displayWords)):((!b.value&&!U.value&&!g.value||b.value&&!V.value&&((n=i.value)==null?void 0:n.type)!==((a=(s=R)==null?void 0:s.TYPES)==null?void 0:a.GRP_AVCHATROOM))&&(h.setWords.data="",m.value.push(h.setWords)),!b.value&&!g.value&&(h.setRemark.data=((r=i.value)==null?void 0:r.remark)||"",h.setRemark.editing=!1,m.value.push(h.setRemark)),!b.value&&(U.value||g.value)&&(h.blackList.data=g.value||!1,m.value.push(h.blackList)))},fe=()=>{var n,s,a,r,F,H,q,Y,z,J,X,Z,Q,p,ee,te,ae;if(!g.value)if(B.value)((n=i.value)==null?void 0:n.type)===((a=(s=R)==null?void 0:s.TYPES)==null?void 0:a.SNS_APPLICATION_SENT_TO_ME)&&((r=c==null?void 0:c.value)==null||r.push(C.refuseFriendApplication),(F=c==null?void 0:c.value)==null||F.push(C.acceptFriendApplication));else if(b.value&&V.value){switch((q=(H=i.value)==null?void 0:H.selfInfo)==null?void 0:q.role){case"Owner":(Y=c==null?void 0:c.value)==null||Y.push(C.dismissGroup);break;default:(z=c==null?void 0:c.value)==null||z.push(C.quitGroup);break}(J=c==null?void 0:c.value)==null||J.push(C.enterGroupConversation)}else!b.value&&U.value?((X=c==null?void 0:c.value)==null||X.push(C.deleteFriend),(Z=c==null?void 0:c.value)==null||Z.push(C.enterC2CConversation)):b.value?(te=c==null?void 0:c.value)==null||te.push(((Q=i.value)==null?void 0:Q.type)===((ee=(p=R)==null?void 0:p.TYPES)==null?void 0:ee.GRP_AVCHATROOM)?C.joinAVChatGroup:C.joinGroup):(ae=c==null?void 0:c.value)==null||ae.push(C.addFriend)};function W(n){$.value=n}async function K(n){var s;i.value&&n&&JSON.stringify(i.value)===JSON.stringify(n)||(se(),i.value=Pe(n)||{},!(!i.value||((s=Object.keys(i.value))==null?void 0:s.length)===0)&&(_.value=Fe(i.value),U.value=await Oe(i.value),de(),fe(),n.infoKeyList&&(m.value=n.infoKeyList.map(a=>h[a])),n.btnKeyList&&(c.value=n.btnKeyList.map(a=>C[a]))))}return(n,s)=>typeof t(i)=="object"&&Object.keys(t(i)).length?(d(),f("div",{key:0,class:u(["tui-contact-info",!t(l)&&"tui-contact-info-h5"])},[t(l)?O("",!0):(d(),f("div",{key:0,class:u(["tui-contact-info-header",!t(l)&&"tui-contact-info-h5-header"])},[y("div",{class:u(["tui-contact-info-header-icon",!t(l)&&"tui-contact-info-h5-header-icon"]),onClick:j},[P(ue,{file:t(Ge)},null,8,["file"])],2),y("div",{class:u(["tui-contact-info-header-title",!t(l)&&"tui-contact-info-h5-header-title"])},D(t(x).t("TUIContact.添加好友/群聊")),3)],2)),y("div",{class:u(["tui-contact-info-basic",!t(l)&&"tui-contact-info-h5-basic"])},[y("div",{class:u(["tui-contact-info-basic-text",!t(l)&&"tui-contact-info-h5-basic-text"])},[y("div",{class:u(["tui-contact-info-basic-text-name",!t(l)&&"tui-contact-info-h5-basic-text-name"])},D(t(Ee)(t(i))),3),(d(!0),f(L,null,w(t(_),a=>(d(),f("div",{key:a.label,class:u(["tui-contact-info-basic-text-other",!t(l)&&"tui-contact-info-h5-basic-text-other"])},D(`${t(x).t(`TUIContact.${a.label}`)}:
          ${a.data}`),3))),128))],2),y("img",{class:u(["tui-contact-info-basic-avatar",!t(l)&&"tui-contact-info-h5-basic-avatar"]),src:t(Me)(t(i))},null,10,Le)],2),t(m)[0]?(d(),f("div",{key:1,class:u(["tui-contact-info-more",!t(l)&&"tui-contact-info-h5-more"])},[(d(!0),f(L,null,w(t(m),a=>(d(),f("div",{key:a.key,class:u(["tui-contact-info-more-item",!t(l)&&"tui-contact-info-h5-more-item",a.labelPosition===t(E).TOP?"tui-contact-info-more-item-top":"tui-contact-info-more-item-left"])},[y("div",{class:u(["tui-contact-info-more-item-label",!t(l)&&"tui-contact-info-h5-more-item-label"])},D(`${t(x).t(`TUIContact.${a.label}`)}`),3),y("div",{class:u(["tui-contact-info-more-item-content",!t(l)&&"tui-contact-info-h5-more-item-content"])},[a.editing?a.editType===t(A).INPUT?ne((d(),f("input",{key:1,"onUpdate:modelValue":r=>a.data=r,class:u(["tui-contact-info-more-item-content-input",!t(l)&&"tui-contact-info-h5-more-item-content-input"]),type:"text",onConfirm:r=>N(a),onKeyup:ke(r=>N(a),["enter"])},null,42,Re)),[[ie,a.data]]):a.editType===t(A).TEXTAREA?ne((d(),f("textarea",{key:2,"onUpdate:modelValue":r=>a.data=r,class:u(["tui-contact-info-more-item-content-textarea",!t(l)&&"tui-contact-info-h5-more-item-content-textarea"]),"confirm-type":"done"},null,10,Be)),[[ie,a.data]]):a.editType===t(A).SWITCH?(d(),f("div",{key:3,onClick:r=>N(a)},[P(Ne,{value:a.data},null,8,["value"])],8,Ve)):O("",!0):(d(),f("div",{key:0,class:u(["tui-contact-info-more-item-content-text",!t(l)&&"tui-contact-info-h5-more-item-content-text"])},[y("div",{class:u(["tui-contact-info-more-item-content-text-data",!t(l)&&"tui-contact-info-h5-more-item-content-text-data"])},D(a.data),3),a.editable?(d(),f("div",{key:0,class:u(["tui-contact-info-more-item-content-text-icon",!t(l)&&"tui-contact-info-h5-more-item-content-text-icon"]),onClick:r=>G(a)},[P(ue,{file:t(xe),width:"14px",height:"14px"},null,8,["file"])],10,we)):O("",!0)],2))],2)],2))),128))],2)):O("",!0),y("div",{class:u(["tui-contact-info-button",!t(l)&&"tui-contact-info-h5-button"])},[(d(!0),f(L,null,w(t(c),a=>(d(),f("button",{key:a.key,class:u(["tui-contact-info-button-item",!t(l)&&"tui-contact-info-h5-button-item",a.type===t(k).CANCEL?"tui-contact-info-button-item-cancel":"tui-contact-info-button-item-submit"]),onClick:r=>re(a)},D(t(x).t(`TUIContact.${a.label}`)),11,$e))),128))],2)],2)):O("",!0)}});const vt=ye(je,[["__scopeId","data-v-1c48c398"]]);export{vt as default};
