import{q as i,o as s,R as Y,W as j,z as k,Q as tt,r as et,_ as nt}from"./@tencentcloud-7fc831ec.js";import"./adapter-vue-24f22062.js";import at from"./Icon-2c0593f3.js";import{d as it}from"./down-icon-f2c30b56.js";import{e as st}from"./right-icon-89a49395.js";import X from"./index-654c371f.js";import{a as ot}from"./env-a593fd1d.js";import{d as rt,r as h,b as ut,aZ as ct,a$ as lt,b1 as dt,a_ as u,o as c,c as l,F as D,ao as O,a as m,M,aB as T,y as x,ae as A}from"./@vue-a164be7a.js";import"./tim-upload-plugin-4412696f.js";import"./tim-profanity-filter-plugin-a7e08ee8.js";import"./vue-84471dcb.js";import"./marked-7f3c3653.js";import"./trtc-cloud-js-sdk-6995d964.js";import"./trtc-sdk-v5-5ba82a9e.js";import"./pinia-ec219911.js";import"./mitt-f7ef348c.js";import"./interactjs-0d94d9f4.js";import"./rtc-detect-b2f0fa0a.js";import"./tuicall-engine-webrtc-9ec0a575.js";import"./index-6b0c1d9b.js";import"./index-cb5533b0.js";import"./index-cfdb213d.js";import"./index-e4ac2ab7.js";const pt=["onClick"],ft={class:"tui-contact-list-item-header-left"},Ct={class:"tui-contact-list-item-header-right"},vt={key:0,class:"tui-contact-list-item-header-right-unread"},Lt=["onClick"],_t={key:1,class:"tui-contact-list"},ht={key:0,class:"tui-contact-search-list"},mt={class:"tui-contact-search-list-title"},It=["onClick"],St={key:0,class:"tui-contact-search-list-default"},gt=rt({__name:"index",setup(Ut){const L=h(""),o=h({}),f=h({friendApplicationList:{key:"friendApplicationList",title:"新的联系人",list:[],unreadCount:0},blackList:{key:"blackList",title:"黑名单",list:[]},groupList:{key:"groupList",title:"我的群聊",list:[]},friendList:{key:"friendList",title:"我的好友",list:[]}}),g=h(!1),v=h(),w=h(!1),E=h(),Z=ut(()=>{var t,r,n,a;return!((r=(t=v==null?void 0:v.value)==null?void 0:t.user)!=null&&r.list[0])&&!((a=(n=v==null?void 0:v.value)==null?void 0:n.group)!=null&&a.list[0])});ct(()=>{i.watch(s.APP,{enabledCustomerServicePlugin:R}),i.watch(s.GRP,{groupList:F}),i.watch(s.USER,{userBlacklist:N,displayOnlineStatus:P,userStatusList:b}),i.watch(s.FRIEND,{friendList:B,friendApplicationList:z,friendApplicationUnreadCount:$}),i.watch(s.CUSTOM,{currentContactSearchingStatus:q,currentContactSearchResult:V,currentContactListKey:W,currentContactInfo:Q})}),lt(()=>{i.unwatch(s.APP,{enabledCustomerServicePlugin:R}),i.unwatch(s.GRP,{groupList:F}),i.unwatch(s.USER,{userBlacklist:N,displayOnlineStatus:P,userStatusList:b}),i.unwatch(s.FRIEND,{friendList:B,friendApplicationList:z,friendApplicationUnreadCount:$}),i.unwatch(s.CUSTOM,{currentContactSearchingStatus:q,currentContactSearchResult:V,currentContactListKey:W,currentContactInfo:Q})});function H(t){L.value===t?(L.value="",o.value={},i.update(s.CUSTOM,"currentContactListKey",""),i.update(s.CUSTOM,"currentContactInfo",{})):(L.value=t,i.update(s.CUSTOM,"currentContactListKey",t),t==="friendApplicationList"&&tt.setFriendApplicationRead())}function K(t){var r,n,a,e,d,p,I,y;if(o.value=t,g.value){let _;(r=o.value)!=null&&r.userID?_=(e=(a=(n=f.value)==null?void 0:n.friendList)==null?void 0:a.list)==null?void 0:e.find(C=>{var S;return(C==null?void 0:C.userID)===((S=o.value)==null?void 0:S.userID)}):(d=o.value)!=null&&d.groupID&&(_=(y=(I=(p=f.value)==null?void 0:p.groupList)==null?void 0:I.list)==null?void 0:y.find(C=>{var S;return(C==null?void 0:C.groupID)===((S=o.value)==null?void 0:S.groupID)})),_&&(o.value=_)}i.update(s.CUSTOM,"currentContactInfo",o.value)}function P(t){w.value=t}function b(t){(t==null?void 0:t.size)>0&&(E.value=Object.fromEntries(t==null?void 0:t.entries()))}function R(t){if(!t)return;const r=et.TUIContact.EXTENSION.CONTACT_LIST.EXT_ID,a=Y.getExtensionList(r).find(e=>{const{name:d,accountList:p=[]}=e.data||{};return d==="customer"&&p.length>0});if(a){const{data:e,text:d}=a,{accountList:p}=e||{};j.getUserProfile({userIDList:p}).then(I=>{if(I.data.length>0){const y={title:d,list:I.data.map((_,C)=>({..._,renderKey:G("customerList",_,C),infoKeyList:[],btnKeyList:["enterC2CConversation"]})),key:"customerList"};f.value={...f.value,customerList:y}}}).catch(()=>{})}}function F(t){U("groupList",t)}function N(t){U("blackList",t)}function $(t){f.value.friendApplicationList.unreadCount=t}function B(t){U("friendList",t)}function z(t){U("friendApplicationList",t)}function U(t,r){f.value[t].list=r,f.value[t].list.map((n,a)=>n.renderKey=G(t,n,a)),J(f.value[t].list,t)}function J(t,r){var n,a;!((n=o.value)!=null&&n.userID)&&!((a=o.value)!=null&&a.groupID)||(r===L.value||g.value)&&(o.value=(t==null?void 0:t.find(e=>{var d,p;return(e==null?void 0:e.groupID)&&(e==null?void 0:e.groupID)===((d=o.value)==null?void 0:d.groupID)||(e==null?void 0:e.userID)&&(e==null?void 0:e.userID)===((p=o.value)==null?void 0:p.userID)}))||{},i.update(s.CUSTOM,"currentContactInfo",o.value))}function G(t,r,n){return`${t}-${r.userID||r.groupID||"index"+n}`}function V(t){v.value=t}function q(t){g.value=t,i.update(s.CUSTOM,"currentContactInfo",{}),i.update(s.CUSTOM,"currentContactListKey","")}function Q(t){o.value=t}function W(t){L.value=t}return dt("userOnlineStatusMap",E),(t,r)=>u(g)?(c(),l("ul",_t,[(c(!0),l(D,null,O(u(v),(n,a)=>(c(),l("li",{key:a,class:"tui-contact-list-item"},[n.list[0]?(c(),l("div",ht,[m("div",mt,T(u(k).t(`TUIContact.${n.label}`)),1),(c(!0),l(D,null,O(n.list,(e,d)=>(c(),l("div",{key:d,class:A(["tui-contact-search-list-item",["selected"]]),onClick:p=>K(e)},[M(X,{item:e,displayOnlineStatus:!1},null,8,["item"])],8,It))),128))])):x("",!0)]))),128)),u(Z)?(c(),l("div",St,T(u(k).t("TUIContact.无搜索结果")),1)):x("",!0)])):(c(),l("ul",{key:0,class:A(["tui-contact-list",!u(ot)&&"tui-contact-list-h5"])},[(c(!0),l(D,null,O(u(f),(n,a)=>(c(),l("li",{key:a,class:"tui-contact-list-item"},[m("header",{class:"tui-contact-list-item-header",onClick:e=>H(a)},[m("div",ft,[M(at,{file:u(L)===a?u(it):u(st),width:"16px",height:"16px"},null,8,["file"]),m("div",null,T(u(k).t(`TUIContact.${n.title}`)),1)]),m("div",Ct,[n.unreadCount?(c(),l("span",vt,T(n.unreadCount),1)):x("",!0)])],8,pt),m("ul",{class:A(["tui-contact-list-item-main",u(L)===a?"":"hidden"])},[(c(!0),l(D,null,O(n.list,e=>(c(),l("li",{key:e.renderKey,class:A(["tui-contact-list-item-main-item",["selected"]]),onClick:d=>K(e)},[M(X,{item:e,displayOnlineStatus:u(w)&&a==="friendList"},null,8,["item","displayOnlineStatus"])],8,Lt))),128))],2)]))),128))],2))}});const Wt=nt(gt,[["__scopeId","data-v-b494aa22"]]);export{Wt as default};
