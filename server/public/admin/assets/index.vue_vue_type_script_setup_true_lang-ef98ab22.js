var U=Object.defineProperty;var N=(l,e,s)=>e in l?U(l,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[e]=s;var o=(l,e,s)=>(N(l,typeof e!="symbol"?e+"":e,s),s);import{R as f,r as d,q as T,o as v,i as O,Q as _,z as k}from"./@tencentcloud-7fc831ec.js";import"./adapter-vue-24f22062.js";import{T as L}from"./index-cfdb213d.js";import{_ as w}from"./index.vue_vue_type_script_setup_true_lang-b448363d.js";import{c as F}from"./env-a593fd1d.js";import{T as b}from"./index-e4ac2ab7.js";import{d as D,r as u,b6 as P,o as x,x as V,a_ as C}from"./@vue-a164be7a.js";const r=class r{constructor(){o(this,"onCallParamsMap");o(this,"onCallCallbackMap");o(this,"constants");f.registerService(d.TUIContact.SERVICE.NAME,this),this.onCallParamsMap=new Map,this.onCallCallbackMap=new Map,this.constants=d}static getInstance(){return r.instance||(r.instance=new r),r.instance}getOnCallParams(e){return this.onCallParamsMap.get(e)}getOnCallCallback(e){return this.onCallCallbackMap.get(e)}async onCall(e,s,p){var n;this.onCallParamsMap.set(e,s),this.onCallCallbackMap.set(e,p),e===d.TUIContact.SERVICE.METHOD.SELECT_FRIEND&&(T.update(v.CUSTOM,"isShowSelectFriendComponent",!0),F&&((n=O)==null||n.reLaunch({url:"/TUIKit/components/TUIContact/index"})))}};o(r,"instance");let m=r;const G=D({__name:"index",setup(l){const e=m.getInstance(),s=e.constants,p=u(!1),n=u([]),c=u([]),h=u(null),i=u({isRadio:!1,isNeedSearch:!1,title:""}),I=a=>{h.value=f.getService(s.TUISearch.SERVICE.NAME),h.value?p.value=a:console.warn("请添加 TUISearch 组件")};P(()=>{const a=e.getOnCallParams(s.TUIContact.SERVICE.METHOD.SELECT_FRIEND);i.value.title=a.title,i.value.isRadio=a.isRadio,i.value.isNeedSearch=a.isNeedSearch,a.isNeedSearch&&I(a.isNeedSearch),_.getFriendList().then(t=>{n.value=t.data.map(S=>S.profile),c.value=n.value}).catch(t=>{console.warn("getFriendList error:",t)})});const R=a=>{T.update(v.CUSTOM,"isShowSelectFriendComponent",!1);const t=e.getOnCallCallback(s.TUIContact.SERVICE.METHOD.SELECT_FRIEND);t&&t(a)},E=()=>{L({message:k.t("TUIGroup.该用户不存在"),type:b.ERROR}),c.value=[...n.value]},M=async a=>{if(!a)return c.value=n.value;try{const t=await h.value.searchUser(a);if(!t.data[0])return E();c.value=t.data;const S=n.value.filter(g=>g.userID===t.data[0].userID);n.value=S.length?n.value:[...n.value,...c.value]}catch{return E()}};return(a,t)=>(x(),V(w,{isRadio:C(i).isRadio,isNeedSearch:C(i).isNeedSearch,title:C(i).title,userList:C(c),onSearch:M,onComplete:R},null,8,["isRadio","isNeedSearch","title","userList"]))}});export{m as T,G as _};
