import"./adapter-vue-24f22062.js";import{q as w,o as A,z as c,Z as D,W as U,_ as T}from"./@tencentcloud-7fc831ec.js";import N from"./Icon-2c0593f3.js";import P from"./index-6b0c1d9b.js";import z from"./index-95ee9b8a.js";import{c as B}from"./close-dark-98fe05f7.js";import{a as F,d as f}from"./env-a593fd1d.js";import{d as M,r as v,w as x,aZ as V,a$ as Z,o as l,c as m,a_ as e,a,aB as s,y as $,M as L,aR as j,x as q,F as E,ao as H,ae as G}from"./@vue-a164be7a.js";import"./tim-upload-plugin-4412696f.js";import"./tim-profanity-filter-plugin-a7e08ee8.js";import"./vue-84471dcb.js";import"./marked-7f3c3653.js";import"./trtc-cloud-js-sdk-6995d964.js";import"./trtc-sdk-v5-5ba82a9e.js";import"./pinia-ec219911.js";import"./mitt-f7ef348c.js";import"./interactjs-0d94d9f4.js";import"./rtc-detect-b2f0fa0a.js";import"./tuicall-engine-webrtc-9ec0a575.js";import"./index-cfa97a9d.js";const O={key:0,class:"application-tips"},W={class:G({"application-contaienr":!0})},J={class:"application-header"},K={key:1},Q={class:"application-item-info"},X={class:"application-item-nick"},Y={class:"application-item-note"},tt={class:"application-item-operation"},et=["onClick"],ot=["onClick"],at=M({__name:"index",props:{groupID:{default:""}},setup(R){const S=R,b=v(),r=v(0),u=v(!1),p=v([]);x(u,t=>{t&&k().then(n=>{p.value=n,r.value=n.length})}),x(()=>p.value.length,(t,n)=>{n>0&&t===0&&(u.value=!1)});async function g(){return(await D.getGroupApplicationList()).data.applicationList.filter(o=>o.groupID===S.groupID)}function h(){u.value=!u.value}async function k(){const t=await g();if(t.length===0)return[];const n=t.map(i=>i.applicationType===0?i.applicant:i.userID),{data:o}=await U.getUserProfile({userIDList:n}),d={};return o.forEach(i=>{d[i.userID]=i}),t.map(i=>{const _=d[i.applicationType===0?i.applicant:i.userID];return{nick:_.nick||_.userID||"anonymous",avatar:_.avatar||"",isRemoved:!1,application:i}})}function y(t,n,o){D.handleGroupApplication({handleAction:n,application:t.application}).then(()=>{p.value[o].isRemoved=!0,setTimeout(()=>{p.value.splice(o,1),r.value-=1},150)}).catch(()=>{})}V(()=>{g().then(t=>{r.value=t.length}),w.watch(A.GRP,{groupSystemNoticeList:C})}),Z(()=>{w.unwatch(A.GRP,{groupSystemNoticeList:C})});function C(){k().then(t=>{p.value=t,r.value=t.length})}return(t,n)=>(l(),m("div",null,[e(r)>0?(l(),m("div",O,[a("div",null,s(e(r))+s(e(c).t("TUIChat.条入群申请")),1),a("div",{class:"application-tips-btn",onClick:h},s(e(c).t("TUIChat.点击处理")),1)])):$("",!0),L(z,{ref_key:"drawerDomInstanceRef",ref:b,visible:e(u),zIndex:998,popDirection:e(f)?"bottom":"right",isFullScreen:e(f),overlayColor:e(f)?void 0:"transparent",drawerStyle:{bottom:{minHeight:"60vh",maxHeight:"80vh",borderRadius:"12px 12px 0 0"},right:{width:"360px",borderRadius:"12px 0 0 12px",boxShadow:"0 0 10px 0 #d0d0d0"}},onOnOverlayClick:h},{default:j(()=>[a("div",W,[a("header",J,[a("div",{onClick:h},[e(F)?(l(),q(N,{key:0,file:e(B),size:"16px"},null,8,["file"])):(l(),m("div",K,s(e(c).t("关闭")),1))])]),a("main",null,[(l(!0),m(E,null,H(e(p),(o,d)=>(l(),m("div",{key:o.nick,class:G({"application-item":!0,removed:o.isRemoved})},[L(P,{style:{flex:"0 0 auto"},url:o.avatar,useSkeletonAnimation:!0},null,8,["url"]),a("div",Q,[a("div",X,s(o.nick),1),a("div",Y,s(e(c).t("TUIChat.申请加入")),1)]),a("div",tt,[a("div",{class:"agree",onClick:I=>y(o,"Agree",d)},s(e(c).t("TUIChat.同意")),9,et),a("div",{class:"reject",onClick:I=>y(o,"Reject",d)},s(e(c).t("TUIChat.拒绝")),9,ot)])],2))),128))])])]),_:1},8,["visible","popDirection","isFullScreen","overlayColor"])]))}});const At=T(at,[["__scopeId","data-v-93af1320"]]);export{At as default};
