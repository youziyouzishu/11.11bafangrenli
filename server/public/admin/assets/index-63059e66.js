import{d as w,r as x,aZ as D,a$ as G,b as r,aT as B,aP as E,a_ as i,o as b,c as k,a as z,aB as Y,ae as $}from"./@vue-a164be7a.js";import"./adapter-vue-24f22062.js";import{B as q,q as o,o as m,z as c,_ as A}from"./@tencentcloud-7fc831ec.js";import{T as F}from"./config-58aee8b5.js";import"./tim-upload-plugin-4412696f.js";import"./tim-profanity-filter-plugin-a7e08ee8.js";import"./vue-84471dcb.js";import"./marked-7f3c3653.js";import"./trtc-cloud-js-sdk-6995d964.js";import"./trtc-sdk-v5-5ba82a9e.js";import"./pinia-ec219911.js";import"./mitt-f7ef348c.js";import"./interactjs-0d94d9f4.js";import"./rtc-detect-b2f0fa0a.js";import"./tuicall-engine-webrtc-9ec0a575.js";const H=w({__name:"index",props:{message:{default:()=>({})}},emits:["openReadUserPanel"],setup(U,{emit:S}){const T=S,t=U,y=F.getFeatureConfig("ReadStatus"),u=q.TYPES,g=x(o.getData(m.USER,"displayMessageReadReceipt"));D(()=>{o.watch(m.USER,{displayMessageReadReceipt:_})}),G(()=>{o.unwatch(m.USER,{displayMessageReadReceipt:_})});const M=r(()=>{if(!y||!g.value)return!1;const{ID:e,type:n,flow:l,status:p,hasRiskContent:d,conversationID:f,conversationType:v,needReadReceipt:O=!1}=t.message;if(d)return!1;const{groupProfile:a}=o.getConversationModel(f)||{};if((a==null?void 0:a.type)===u.GRP_AVCHATROOM||(a==null?void 0:a.type)===u.GRP_COMMUNITY)return!1;if(n===u.MSG_CUSTOM){const R=o.getMessageModel(e);if((R==null?void 0:R.getSignalingInfo())!==null)return!1}return l!=="out"||p!=="success"?!1:v==="GROUP"?O:v==="C2C"}),s=r(()=>{const{conversationType:e,needReadReceipt:n=!1,isPeerRead:l=!1}=t.message,{readCount:p=0,unreadCount:d=0,isPeerRead:f=!1}=t.message.readReceiptInfo;return e==="C2C"?n?f?0:1:l?0:1:e==="GROUP"?n?p===0?1:d===0?2:4:3:1}),h=r(()=>{const{readCount:e=0}=t.message.readReceiptInfo;switch(s.value){case 0:return c.t("TUIChat.已读");case 1:return c.t("TUIChat.未读");case 2:return c.t("TUIChat.全部已读");case 4:return`${e}${c.t("TUIChat.人已读")}`;default:return""}}),P=r(()=>{const{conversationType:e}=t.message;return e==="C2C"?s.value!==0:e==="GROUP"?s.value!==2:!1}),C=r(()=>t.message.needReadReceipt&&t.message.conversationType==="GROUP"&&(s.value===4||s.value===1));function I(){C.value&&T("openReadUserPanel")}function _(e){g.value=e}return(e,n)=>B((b(),k("div",{class:$({"message-label":!0,unread:i(P),"finger-point":i(C)}),onClick:I},[z("span",null,Y(i(h)),1)],2)),[[E,i(M)]])}});const re=A(H,[["__scopeId","data-v-6f029fb7"]]);export{re as default};
