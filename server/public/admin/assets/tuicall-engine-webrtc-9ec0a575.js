import{r as ge}from"./trtc-cloud-js-sdk-6995d964.js";import{b as Ie}from"./@tencentcloud-7fc831ec.js";var fe={exports:{}};(function(Ee,ve){(function(_e,pe){Ee.exports=pe(ge(),Ie)})(window,function(_e,pe){return function(H){var c={};function a(e){if(c[e])return c[e].exports;var r=c[e]={i:e,l:!1,exports:{}};return H[e].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=H,a.c=c,a.d=function(e,r,o){a.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:o})},a.r=function(e){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,r){if(1&r&&(e=a(e)),8&r||4&r&&typeof e=="object"&&e&&e.__esModule)return e;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&r&&typeof e!="string")for(var f in e)a.d(o,f,(function(S){return e[S]}).bind(null,f));return o},a.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(r,"a",r),r},a.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},a.p="",a(a.s=33)}([function(H,c,a){a.r(c),a.d(c,"mainUrl",function(){return o}),a.d(c,"backupUrl",function(){return f}),a.d(c,"Mode",function(){return S}),a.d(c,"Role",function(){return u}),a.d(c,"VIDEO_STAT_BIT",function(){return d}),a.d(c,"AUDIO_STAT_BIT",function(){return v}),a.d(c,"AUDIO_MUTE_BIT",function(){return t}),a.d(c,"VIDEO_MUTE_BIT",function(){return l}),a.d(c,"VIDEO_MUTED_MASK",function(){return T}),a.d(c,"AUX_VIDEO_MUTED_MASK",function(){return y}),a.d(c,"AUDIO_MUTED_MASK",function(){return C}),a.d(c,"MAIN_STREAM_MSID",function(){return L}),a.d(c,"AUX_STREAM_MSID",function(){return i}),a.d(c,"StreamType",function(){return s}),a.d(c,"TRTC_QUALITY_UNKNOWN",function(){return R}),a.d(c,"TRTC_QUALITY_EXCELLENT",function(){return I}),a.d(c,"TRTC_QUALITY_GOOD",function(){return h}),a.d(c,"TRTC_QUALITY_POOR",function(){return _}),a.d(c,"TRTC_QUALITY_BAD",function(){return D}),a.d(c,"TRTC_QUALITY_VBAD",function(){return E}),a.d(c,"TRTC_QUALITY_DISCONNECTED",function(){return b}),a.d(c,"DTLS_STATE_UNKNOWN",function(){return A}),a.d(c,"SuccessRate",function(){return p}),a.d(c,"MTA_API_PENDING",function(){return m}),a.d(c,"MTA_API_SUCCESS",function(){return U}),a.d(c,"ConnectionState",function(){return P}),a.d(c,"UPLINK_RECONNECTION_COUNT",function(){return k}),a.d(c,"DOWNLINK_RECONNECTION_COUNT",function(){return V}),a.d(c,"SIGNAL_RECONNECTION_COUNT",function(){return x}),a.d(c,"KIBANA_EVENT",function(){return j}),a.d(c,"SIGNAL_PING_TIMEOUT",function(){return O}),a.d(c,"SIGNAL_PING_PONG_INTERVAL",function(){return n}),a.d(c,"INNER_EVENT",function(){return g}),a.d(c,"AI_NOISE_REDUCE_ASSETS_PATH",function(){return N}),a.d(c,"MAX_NUMBER_ROOM_ID",function(){return w}),a.d(c,"NAME",function(){return G}),a.d(c,"CUSTOM_STATUS_MAP",function(){return B}),a.d(c,"VIDEO_ENCODER_MAP",function(){return F}),a.d(c,"CONSOLE_DOMESTIC",function(){return J}),a.d(c,"CONSOLE_FOREIGN",function(){return q}),a.d(c,"BUY_ADDRESS_DOMESTIC",function(){return K}),a.d(c,"BUY_ADDRESS_FOREIGN",function(){return Q}),a.d(c,"REGION_CHINA",function(){return M}),a.d(c,"REGION_SINGAPORE",function(){return Y}),a.d(c,"REGION_FRANKFURT",function(){return W}),a.d(c,"REGION_SEOUL",function(){return X}),a.d(c,"REGION_BOMBAY",function(){return z}),a.d(c,"REGION_SILICON",function(){return ne});var e=a(6),r=a(14);const o="wss://qcloud.rtc.qq.com:8687",f="wss://bk.rtc.qq.com:8687",S={RTC:1,LIVE:2},u={HOST:20,AUDIENCE:21},d=1,v=8,t=64,l=16,T=1,y=2,C=4,L="5Y2wZK8nANNAoVw6dSAHVjNxrD1ObBM2kBPV",i="224d130c-7b5c-415b-aaa2-79c2eb5a6df2",s={NONE:0,AUDIO:1,MAIN:2,AUX:7},R=0,I=1,h=2,_=3,D=4,E=5,b=6,A="unknown",p={JOIN:"join",PUBLISH:"publish",UNPUBLISH:"unpublish",LOCAL_STREAM_INITIALIZE:"local_stream_initialize",SUBSCRIBE:"subscribe",UNSUBSCRIBE:"unsubscibe",UPLINK_CONNECTION:"uplink_connection",UPLINK_RECONNECTION:"uplink_reconnection",DOWNLINK_CONNECTION:"downlink_connection",DOWNLINK_RECONNECTION:"downlink_reconnection",SIGNAL_CONNECTION:"signal_connection",SIGNAL_RECONNECTION:"signal_reconnection",UPDATE_STREAM:"update_stream"},m="pending",U="success",P={CONNECTING:"connecting",CONNECTED:"connected",DISCONNECTED:"disconnected"},k=30,V=30,x=30,j={SDK_CONSTRUCT:"sdkConstruct",SDK_LOGIN:"sdkLogin",DELTA_JOIN:"delta-join",REJOIN:"rejoin",LEAVE:"leave",DELTA_LEAVE:"delta-leave",PUBLISH:"publish",DELTA_PUBLISH:"delta-publish",UNPUBLISH:"unpublish",SUBSCRIBE:"subscribe",UNSUBSCRIBE:"unsubscribe",UPLINK_CONNECTION:"uplink-connection",UPLINK_RECONNECTION:"uplink-reconnection",DOWNLINK_CONNECTION:"downlink-connection",DOWNLINK_RECONNECTION:"downlink-reconnection",ON_TRACK:"ontrack",SET_LOCAL_DESCRIPTION:"setLocalDescription",SET_REMOTE_DESCRIPTION:"setRemoteDescription",ICE_CONNECTION_STATE:"iceConnectionState",LOCAL_STREAM_INITIALIZE:"stream-initialize",SIGNAL_CONNECTION:"websocketConnectionState",SIGNAL_RECONNECTION:"websocketReconnectionState",UPDATE_STREAM:"update-stream",RECOVER_SUBSCRIPTION:"recover-subscription"},O=6e3,n=1e4,g={SET_REMOTE_OFFER_FINISHED:"set-remote-offer-finished"},N="https://web.sdk.qcloud.com/trtc/webrtc/download/aiNoiseReduce/",w=2147483647,G={DEFAULT:"default",BOOLEAN:"boolean",STRING:"string",NUMBER:"number",OBJECT:"object",ARRAY:"array",FUNCTION:"function",FILE:"file",MAP:"map",SET:"set",UNDEFINED:"undefined",VIDEO:"video",AUDIO:"audio",ON_ERROR:"onError",MAIN:"main",RTC:"rtc",LIVE:"live",SMALL:"small",BIG:"big",AUXILIARY:"auxiliary",INVITER:"inviter",INVITEE:"invitee",VIDEO_INPUT:"videoinput",AUDIO_INPUT:"audioinput",LOCAL:"local",REMOTE:"remote",TRTC:"TRTC",WEB:"web",NORMAL:"normal",REJECT:"reject",IGNORE:"ignore",TIMEOUT:"timeout",RIC:"ric",RAF:"raf",INTERVAL:"interval",CANCEL:"cancel",BUSYLINE:"busyline",UNKNOWN:"unknown",SINGLE_CALL:"SingleCall",GROUP_CALL:"groupCall",CALLER:"caller",CALLEE:"callee",COVER:"cover",CONTAIN:"contain",FILL:"fill",AV_CALL:"av_call",CALLKIT_RECORDS_SVR:"callkit_records_svr",SINGLE:"single",GROUP:"group",START_CALL:"start_call",RECEIVE_CALL:"receive_call",CALL_ACCEPTED:"call_accepted",ACCEPT_CALL:"accept_call",CALL_MISSED:"call_missed",NOT_ANSWER_CALL:"not_answer_call",CALL_REJECTED:"call_rejected",REJECT_CALL:"reject_call",CALL_BUSY:"call_busy",IGNORE_CALL:"ignore_call",CANCEL_CALL:"cancel_call",CALL_CANCELED:"call_canceled",CALL_FAILED:"call_failed",CALL_END:"call_end",CALL_INTERRUPTED:"call_interrupted",INVITE_USER:"invite_user",JOIN_IN_GROUP_CALL:"join_in_group_call",EVENT_REPORT:"event_report",HEART_BEAT:"heartbeat",CALLING:"calling",BANNED:"banned",WAITING:"waiting",CONNECTED:"connected",MICROPHONE:"microphone",CAMERA:"camera",MICROPHONES:"microphones",SPEAKER:"speaker",ENABLE_VIRTUAL_BACKGROUND:"enableVirtualBackground",BLUR:"blur",IMAGE:"image"},B={"":e.CALL_STATUS.IDLE,call_wait:e.CALL_STATUS.CALLING,call_accept:e.CALL_STATUS.CONNECTED},F={"480p":{videoResolution:r.TRTCVideoResolution.TRTCVideoResolution_640_480,videoFps:15,videoBitrate:900},"720p":{videoResolution:r.TRTCVideoResolution.TRTCVideoResolution_1280_720,videoFps:15,videoBitrate:1500},"1080p":{videoResolution:r.TRTCVideoResolution.TRTCVideoResolution_1920_1080,videoFps:15,videoBitrate:2e3}},J="https://console.cloud.tencent.com/im/detail",q="https://console.intl.cloud.tencent.com/im/detail",K="https://buy.cloud.tencent.com/avc?addRavLicense=1",Q="https://buy.tencentcloud.com/avc?addRavLicense=1",M=1,Y=9,W=17,X=18,z=21,ne=15},function(H,c,a){a.r(c),a.d(c,"isMap",function(){return f}),a.d(c,"isSet",function(){return S}),a.d(c,"isFile",function(){return u}),a.d(c,"isNumber",function(){return d}),a.d(c,"isString",function(){return v}),a.d(c,"isObject",function(){return t}),a.d(c,"isBoolean",function(){return l}),a.d(c,"isPlainObject",function(){return T}),a.d(c,"isArray",function(){return y}),a.d(c,"isUndefined",function(){return C}),a.d(c,"isNativeClass",function(){return i}),a.d(c,"isArrayOrObject",function(){return s}),a.d(c,"isFunction",function(){return R}),a.d(c,"isInstanceOfError",function(){return I}),a.d(c,"getType",function(){return h}),a.d(c,"TimeUtil",function(){return D}),a.d(c,"stringifyError",function(){return E}),a.d(c,"map2String",function(){return b}),a.d(c,"randomString",function(){return m}),a.d(c,"isValidType",function(){return U}),a.d(c,"mapKeys",function(){return P}),a.d(c,"mapValues",function(){return k}),a.d(c,"generateRandomRoomID",function(){return V}),a.d(c,"analyzeRoomId",function(){return x}),a.d(c,"formatDuration",function(){return O}),a.d(c,"compareVersion",function(){return n}),a.d(c,"date2ISOString",function(){return g}),a.d(c,"getHostType",function(){return N}),a.d(c,"isCallSignaling",function(){return w}),a.d(c,"performanceNow",function(){return G}),a.d(c,"isDomesticSDKAppID",function(){return B}),a.d(c,"getPurchaseAddress",function(){return F}),a.d(c,"getRegionId",function(){return J}),a.d(c,"timeoutForFun",function(){return q}),a.d(c,"analyzeVideoRenderParams",function(){return K}),a.d(c,"getValueType",function(){return Q});var e=a(5),r=a(9),o=a(0);const f=function(M){return h(M)===o.NAME.MAP},S=function(M){return h(M)===o.NAME.SET},u=function(M){return h(M)===o.NAME.FILE},d=function(M){return M!==null&&(typeof M===o.NAME.NUMBER&&!isNaN(M-0)||typeof M===o.NAME.OBJECT&&M.constructor===Number)},v=function(M){return typeof M===o.NAME.STRING},t=function(M){return M!==null&&typeof M===o.NAME.OBJECT},l=function(M){return typeof M===o.NAME.BOOLEAN},T=function(M){if(typeof M!==o.NAME.OBJECT||M===null)return!1;const Y=Object.getPrototypeOf(M);if(Y===null)return!0;let W=Y;for(;Object.getPrototypeOf(W)!==null;)W=Object.getPrototypeOf(W);return Y===W},y=function(M){return typeof Array.isArray===o.NAME.FUNCTION?Array.isArray(M):h(M)===o.NAME.ARRAY},C=function(M){return typeof M===o.NAME.UNDEFINED},L=/^class\s/,i=function(M){return typeof M===o.NAME.FUNCTION&&L.test(M.toString())},s=function(M){return y(M)||t(M)},R=function(M){return typeof M===o.NAME.FUNCTION},I=function(M){return M instanceof Error},h=function(M){return Object.prototype.toString.call(M).match(/^\[object (.*)\]$/)[1].toLowerCase()};let _=0;Date.now||(Date.now=function(){return new Date().getTime()});const D={now(){_===0&&(_=Date.now()-1);const M=Date.now()-_;return M>4294967295?(_+=4294967295,Date.now()-_):M},utc:()=>Math.round(Date.now()/1e3)},E=function(M){return JSON.stringify(M,["message","code"])},b=function(M){if(!f(M))return"not a map!!!";let Y="";for(const[W,X]of M.entries()){if(f(X))return`[k=${W} -> ${b(X)}`;Y+=`[k=${W} v=${X}] `}return Y},A="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",p=A.length,m=function(){let M="";for(let Y=32;Y>0;--Y)M+=A[Math.floor(Math.random()*p)];return M},U=function(M,Y){for(const W in M)if(M[W]===Y)return!0;return!1};function P(M,Y){const W={};return Object.keys(M).forEach(X=>{W[Y(M[X],X)]=M[X]}),W}function k(M,Y){const W={};return Object.keys(M).forEach(X=>{W[X]=Y(M[X],X)}),W}function V(){return Math.round(1e8*Math.random())}function x(M,Y){return d(M)&&M>0?M:M===0&&Y?Y:V()}function j(M){return M<10?"0"+M:M}function O(M){if(M<60)return"00:00:"+j(M);if(M<3600){const ne=parseInt(M/60),ae=M-60*ne;return`00:${j(ne)}:${j(ae)}`}const Y=parseInt(M/3600),W=M-3600*Y,X=parseInt(W/60),z=W-60*X;return`${j(Y)}:${j(X)}:${j(z)}`}function n(M,Y){M=M.split("."),Y=Y.split(".");const W=Math.max(M.length,Y.length);for(;M.length<W;)M.push("0");for(;Y.length<W;)Y.push("0");for(let X=0;X<W;X++){const z=parseInt(M[X]),ne=parseInt(Y[X]);if(z>ne)return 1;if(z<ne)return-1}return 0}const g=function(){const M=new Date,Y=M.toISOString(),W=M.getTimezoneOffset()/60;let X="";return X=W<0?W>-10?"+0"+Math.abs(100*W):"+"+Math.abs(100*W):W>=10?"-"+100*W:"-0"+100*W,Y.replace("Z",X)};function N(){let M="unknown";return e.IS_MAC&&(M="mac"),e.IS_WIN&&(M="windows"),e.IS_IOS&&(M="ios"),e.IS_ANDROID&&(M="android"),M}function w(M){return M===o.NAME.AV_CALL}function G(){return performance&&performance.now?Math.floor(performance.now()):Date.now()}function B(M){const Y=String(M);return Y.startsWith("14")||Y.startsWith("16")||Y.startsWith("17")}function F(M){return`${B(M)?o.BUY_ADDRESS_DOMESTIC:o.BUY_ADDRESS_FOREIGN}&position=${M}&regionId=${J(M)}`}function J(M){return M>=2e7&&M<3e7||M>=172e7&&M<173e7?o.REGION_SINGAPORE:M>=3e7&&M<4e7||M>=173e7&&M<174e7?o.REGION_SEOUL:M>=4e7&&M<5e7||M>=174e7&&M<175e7?o.REGION_FRANKFURT:M>=5e7&&M<6e7||M>=175e7&&M<176e7?o.REGION_BOMBAY:M>=7e7&&M<8e7||M>=177e7&&M<178e7?o.REGION_SILICON:o.REGION_CHINA}async function q(M,Y){return Promise.race([M(),new Promise((W,X)=>{setTimeout(()=>{W()},Y)})])}function K(M){const Y={};return M.rotation&&(Y.rotation=M.rotation),M.objectFit&&(M.objectFit===o.NAME.COVER?Y.fillMode=r.TRTCVideoFillMode.TRTCVideoFillMode_Fill:Y.fillMode=r.TRTCVideoFillMode.TRTCVideoFillMode_Fit),l(M.mirror)&&(Y.mirrorType=M.mirror?r.TRTCVideoMirrorType.TRTCVideoMirrorType_Enable:r.TRTCVideoMirrorType.TRTCVideoMirrorType_Disable),Y}function Q(M){return Reflect.apply(Object.prototype.toString,M,[]).replace(/^\[object\s(\w+)\]$/,"$1").toLowerCase()}},function(H,c,a){a.r(c),a.d(c,"LOGLEVEL_INFO",function(){return f});var e=a(4),r=a(1),o=a(5);const f=1;let S=0;const u=new Map,d="%cCallEngine%c%s",v="padding: 1px 4px;border-radius: 3px;color: #fff;background: #444;",t="display: inline",l=!(o.IS_IOS||o.IS_ANDROID||o.IS_HEADLESS_CHROME);function T(){const C=new Date;return`[${C.toLocaleTimeString("en-US",{hour12:!1})}.${function(L){let i;switch(L.toString().length){case 1:i="00"+L;break;case 2:i="0"+L;break;default:i=L}return i}(C.getMilliseconds())}]`}const y={_data:[],_length:0,_visible:!1,arguments2String(C,L){let i;if(L.length===1)i=`${T()} <${C}> ${L[0]}`;else{i=`${T()} <${C}> `;for(let s=0,{length:R}=L;s<R;s++)Object(r.isArrayOrObject)(L[s])?Object(r.isInstanceOfError)(L[s])?i+=Object(r.stringifyError)(L[s]):i+=JSON.stringify(L[s]):i+=L[s],i+=" "}return i},debug(){if(S<=-1){const C=this.arguments2String("DEBUG",arguments);y.record(C,"debug"),l?e.a.debug(d,v,t,C):e.a.debug(C)}},log(){if(S<=0){const C=this.arguments2String("LOG",arguments);y.record(C,"log"),l?e.a.log(d,v,t,C):e.a.log(C)}},info(){if(S<=f){const C=this.arguments2String("INFO",arguments);y.record(C,"info"),l?e.a.info(d,v,t,C):e.a.info(C)}},warn(){if(S<=2){const C=this.arguments2String("WARN",arguments);y.record(C,"warn"),l?e.a.warn(d,v,t,C):e.a.warn(C)}},error(){if(S<=3){const C=this.arguments2String("ERROR",arguments);y.record(C,"error"),l?e.a.error(d,v,t,C):e.a.error(C)}},time(C){u.set(C,r.TimeUtil.now())},timeEnd(C){if(u.has(C)){const L=r.TimeUtil.now()-u.get(C);return u.delete(C),L}return e.a.warn(`未找到对应label: ${C}, 请在调用 logger.timeEnd 前，调用 logger.time`),0},setLevel(C){C<4&&e.a.log(`${T()}set level from ${S} to ${C}`),S=C},getLevel:()=>S,record(C,L){y._length===1100&&(y._data.splice(0,100),y._length=1e3),y._length++,y._data.push(`${C} [${L}] 
`)},getLog:()=>y._data};c.default=y},function(H,c,a){var e=a(21),r=Object.prototype.toString;function o(t){return r.call(t)==="[object Array]"}function f(t){return t===void 0}function S(t){return t!==null&&typeof t=="object"}function u(t){if(r.call(t)!=="[object Object]")return!1;var l=Object.getPrototypeOf(t);return l===null||l===Object.prototype}function d(t){return r.call(t)==="[object Function]"}function v(t,l){if(t!=null)if(typeof t!="object"&&(t=[t]),o(t))for(var T=0,y=t.length;T<y;T++)l.call(null,t[T],T,t);else for(var C in t)Object.prototype.hasOwnProperty.call(t,C)&&l.call(null,t[C],C,t)}H.exports={isArray:o,isArrayBuffer:function(t){return r.call(t)==="[object ArrayBuffer]"},isBuffer:function(t){return t!==null&&!f(t)&&t.constructor!==null&&!f(t.constructor)&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)},isFormData:function(t){return typeof FormData<"u"&&t instanceof FormData},isArrayBufferView:function(t){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return typeof t=="string"},isNumber:function(t){return typeof t=="number"},isObject:S,isPlainObject:u,isUndefined:f,isDate:function(t){return r.call(t)==="[object Date]"},isFile:function(t){return r.call(t)==="[object File]"},isBlob:function(t){return r.call(t)==="[object Blob]"},isFunction:d,isStream:function(t){return S(t)&&d(t.pipe)},isURLSearchParams:function(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return(typeof navigator>"u"||navigator.product!=="ReactNative"&&navigator.product!=="NativeScript"&&navigator.product!=="NS")&&typeof window<"u"&&typeof document<"u"},forEach:v,merge:function t(){var l={};function T(L,i){u(l[i])&&u(L)?l[i]=t(l[i],L):u(L)?l[i]=t({},L):o(L)?l[i]=L.slice():l[i]=L}for(var y=0,C=arguments.length;y<C;y++)v(arguments[y],T);return l},extend:function(t,l,T){return v(l,function(y,C){t[C]=T&&typeof y=="function"?e(y,T):y}),t},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},stripBOM:function(t){return t.charCodeAt(0)===65279&&(t=t.slice(1)),t}}},function(H,c,a){(function(e){let r,o;r=typeof console<"u"?console:e!==void 0&&e.console?e.console:typeof window<"u"&&window.console?window.console:{};const f=function(){},S=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"];let{length:u}=S;for(;u--;)o=S[u],console[o]||(r[o]=f);r.methods=S,c.a=r}).call(this,a(37))},function(H,c,a){a.r(c),a.d(c,"IN_Browser",function(){return e}),a.d(c,"IN_WXMiniProgram",function(){return r}),a.d(c,"USER_AGENT",function(){return o}),a.d(c,"IS_IPAD",function(){return u}),a.d(c,"IS_IPHONE",function(){return d}),a.d(c,"IS_IPOD",function(){return v}),a.d(c,"IS_IOS",function(){return t}),a.d(c,"IOS_VERSION",function(){return l}),a.d(c,"IS_ANDROID",function(){return T}),a.d(c,"ANDROID_VERSION",function(){return y}),a.d(c,"IS_OLD_ANDROID",function(){return C}),a.d(c,"IS_NATIVE_ANDROID",function(){return L}),a.d(c,"IS_FIREFOX",function(){return i}),a.d(c,"FIREFOX_VERSION",function(){return s}),a.d(c,"IS_EDGE",function(){return R}),a.d(c,"EDGE_VERSION",function(){return I}),a.d(c,"IS_EDG",function(){return h}),a.d(c,"EDG_VERSION",function(){return _}),a.d(c,"IS_CHROME",function(){return D}),a.d(c,"CHROME_MAJOR_VERSION",function(){return E}),a.d(c,"CHROME_VERSION",function(){return b}),a.d(c,"IS_IE8",function(){return A}),a.d(c,"IE_VERSION",function(){return p}),a.d(c,"IS_SAFARI",function(){return m}),a.d(c,"IS_ANY_SAFARI",function(){return U}),a.d(c,"SAFARI_VERSION",function(){return P}),a.d(c,"IS_TBS",function(){return k}),a.d(c,"TBS_VERSION",function(){return V}),a.d(c,"IS_X5MQQB",function(){return x}),a.d(c,"IS_MQQB",function(){return j}),a.d(c,"MQQB_VERSION",function(){return O}),a.d(c,"IS_QQB",function(){return n}),a.d(c,"IS_WECHAT",function(){return g}),a.d(c,"WECHAT_VERSION",function(){return N}),a.d(c,"IS_WIN",function(){return w}),a.d(c,"IS_MAC",function(){return G}),a.d(c,"IS_LINUX",function(){return B}),a.d(c,"IS_WX",function(){return F}),a.d(c,"IS_UCBROWSER",function(){return J}),a.d(c,"IS_MIUIBROWSER",function(){return q}),a.d(c,"IS_HUAWEIBROWSER",function(){return K}),a.d(c,"HUAWEI_VERSION",function(){return Q}),a.d(c,"BROWSER_VERSION",function(){return M}),a.d(c,"IS_LOCAL",function(){return Y}),a.d(c,"IS_HEADLESS_CHROME",function(){return W}),a.d(c,"getBrowserInfo",function(){return z}),a.d(c,"getOsInfo",function(){return ne}),a.d(c,"isMobile",function(){return ae});const e=typeof window<"u",r=typeof wx<"u",o=window.navigator&&window.navigator.userAgent||"",f=/AppleWebKit\/([\d.]+)/i.exec(o),S=f?parseFloat(f.pop()):null,u=/iPad/i.test(o),d=/iPhone/i.test(o)&&!u,v=/iPod/i.test(o),t=d||u||v,l=function(){const $=o.match(/OS (\d+)_/i);return $&&$[1]?$[1]:null}(),T=/Android/i.test(o),y=function(){const $=o.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!$)return null;const te=$[1]&&parseFloat($[1]),se=$[2]&&parseFloat($[2]);return te&&se?parseFloat(`${$[1]}.${$[2]}`):te||null}(),C=T&&/webkit/i.test(o)&&y<2.3,L=T&&y<5&&S<537,i=/Firefox/i.test(o),s=function(){const $=o.match(/Firefox\/(\d+)/);return $&&$[1]?parseFloat($[1]):null}(),R=/Edge\//i.test(o),I=R&&function(){const $=o.match(/Edge\/(\d+)/i);if($&&$[1])return $[1]}(),h=/Edg\//i.test(o),_=function(){const $=o.match(/Edg\/(\d+)/);return $&&$[1]?parseFloat($[1]):null}(),D=!R&&/Chrome/i.test(o),E=function(){const $=o.match(/Chrome\/(\d+)/);return $&&$[1]?parseFloat($[1]):null}(),b=function(){const $=o.match(/Chrome\/([\d.]+)/);return $&&$[1]?$[1]:null}(),A=/MSIE\s8\.0/.test(o),p=function(){const $=/MSIE\s(\d+)\.\d/.exec(o);let te=$&&parseFloat($[1]);return!te&&/Trident\/7.0/i.test(o)&&/rv:11.0/.test(o)&&(te=11),te}(),m=/Safari/i.test(o)&&!D&&!T&&!R,U=m||t,P=function(){const $=o.match(/Version\/([\d.]+)/);return $&&$[1]?$[1]:null}(),k=/TBS\/\d+/i.test(o),V=function(){const $=o.match(/TBS\/(\d+)/i);if($&&$[1])return $[1]}(),x=!k&&/MQQBrowser\/\d+/i.test(o)&&/COVC\/\d+/i.test(o),j=!k&&/MQQBrowser\/\d+/i.test(o),O=(j||x)&&function(){const $=o.match(/ MQQBrowser\/([\d.]+)/);return $&&$[1]?$[1]:null}(),n=!k&&/ QQBrowser\/\d+/i.test(o),g=/(micromessenger|webbrowser)/i.test(o),N=g&&function(){const $=o.match(/MicroMessenger\/(\d+)/i);if($&&$[1])return $[1]}(),w=/Windows/i.test(o),G=/MAC OS X/i.test(o),B=/Linux/i.test(o),F=/MicroMessenger/i.test(o),J=/UCBrowser/i.test(o),q=/MiuiBrowser/i.test(o),K=/HuaweiBrowser/i.test(o),Q=K&&function(){const $=o.match(/HuaweiBrowser\/([\d.]+)/);return $&&$[1]?$[1]:null}(),M=D?"Chrome/"+b:m?"Safari/"+P:"NotSupportedBrowser",Y=location.protocol==="file:"||location.hostname==="localhost"||/^\d+\.\d+\.\d+\.\d+$/.test(location.hostname),W=new RegExp("HeadlessChrome","i").test(o),X=new Map([[i,["Firefox",s]],[h,["Edg",_]],[D,["Chrome",b]],[m,["Safari",P]],[k,["TBS",V]],[g&&d,["WeChat",N]],[j,["QQ(Mobile)",O]],[x,["QQ(Mobile X5)",O]],[K,["HW",Q]],[R,["EDGE",I]]]);function z(){let $="unknown",te="unknown";return X.get(!0)&&($=X.get(!0)[0],te=X.get(!0)[1]),{name:$,version:te}}function ne(){let $="unknown";return G&&($="mac"),w&&($="windows"),T&&($="android"),t&&($="iOS"),{name:$}}function ae(){return T||d||u}},function(H,c,a){Object.defineProperty(c,"__esModule",{value:!0}),c.USER_CUSTOM_STATUS=c.CALL_EXPERMENTEL_API_TYPE=c.LOG_LEVEL=c.MODE_TYPE=c.VALID_VIDEO_PROFILE_LIST=c.BUSINESS_ID=c.ACTION_TYPE=c.CALL_ROLE=c.CALL_STATUS=c.CMD_TYPE=c.CMD_TYPE_LIST=c.CALL_TYPE=c.IOSOfflinePushType=void 0;var e=a(12);(function(r){r[r.APNs=0]="APNs",r[r.VoIP=1]="VoIP"})(c.IOSOfflinePushType||(c.IOSOfflinePushType={})),function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.AUDIO_CALL=1]="AUDIO_CALL",r[r.VIDEO_CALL=2]="VIDEO_CALL"}(c.CALL_TYPE||(c.CALL_TYPE={})),c.CMD_TYPE_LIST=["","audioCall","videoCall"],function(r){r.AUDIO_CALL="audioCall",r.VIDEO_CALL="videoCall",r.HANG_UP="hangup",r.SWITCH_TO_AUDIO="switchToAudio",r.SWITCH_TO_AUDIO_CALL="switch_to_audio_call",r.SWITCH_TO_VIDEO="switchToVideo"}(c.CMD_TYPE||(c.CMD_TYPE={})),function(r){r.IDLE="idle",r.CALLING="calling",r.CONNECTED="connected"}(c.CALL_STATUS||(c.CALL_STATUS={})),function(r){r.UNKNOWN="",r.INVITER="inviter",r.INVITEE="invitee"}(c.CALL_ROLE||(c.CALL_ROLE={})),function(r){r[r.INVITE=1]="INVITE",r[r.CANCEL_INVITE=2]="CANCEL_INVITE",r[r.ACCEPT_INVITE=3]="ACCEPT_INVITE",r[r.REJECT_INVITE=4]="REJECT_INVITE",r[r.INVITE_TIMEOUT=5]="INVITE_TIMEOUT"}(c.ACTION_TYPE||(c.ACTION_TYPE={})),function(r){r[r.SIGNAL=1]="SIGNAL"}(c.BUSINESS_ID||(c.BUSINESS_ID={})),c.VALID_VIDEO_PROFILE_LIST=Object.keys(e.TUICommonDefine.VideoEncoderParams),function(r){r.AUDIO="audio",r.VIDEO="video"}(c.MODE_TYPE||(c.MODE_TYPE={})),function(r){r[r.NORMAL=0]="NORMAL",r[r.RELEASE=1]="RELEASE",r[r.WARNING=2]="WARNING",r[r.ERROR=3]="ERROR",r[r.NONE=4]="NONE"}(c.LOG_LEVEL||(c.LOG_LEVEL={})),function(r){r[r.BASE=Math.pow(2,16)]="BASE",r[r.PRO=Math.pow(2,17)]="PRO",r[r.ULTIMATE=Math.pow(2,18)]="ULTIMATE"}(c.CALL_EXPERMENTEL_API_TYPE||(c.CALL_EXPERMENTEL_API_TYPE={})),function(r){r.NULL="",r.CALLING_USER_CUSTOM_STATUS_CALL_WAIT="call_wait",r.CALLING_USER_CUSTOM_STATUS_CALL_ACCEPT="call_accept"}(c.USER_CUSTOM_STATUS||(c.USER_CUSTOM_STATUS={}))},function(H,c,a){Object.defineProperty(c,"__esModule",{value:!0}),c.ErrorCodeDictionary=void 0,function(e){e[e.UNKNOWN=65535]="UNKNOWN",e[e.NO_NETWORK=2805]="NO_NETWORK",e[e.FAILURE_SWITCH_TO_AUDIO=60001]="FAILURE_SWITCH_TO_AUDIO",e[e.FAILURE_SWITCH_TO_VIDEO=60002]="FAILURE_SWITCH_TO_VIDEO",e[e.NOT_MICROPHONE_LIST=60003]="NOT_MICROPHONE_LIST",e[e.NOT_CAMERA_LIST=60004]="NOT_CAMERA_LIST",e[e.NOT_SUPPORT=60006]="NOT_SUPPORT",e[e.ERROR_PACKAGE_NOT_PURCHASED=-1001]="ERROR_PACKAGE_NOT_PURCHASED",e[e.ERROR_PACKAGE_NOT_SUPPORTED=-1002]="ERROR_PACKAGE_NOT_SUPPORTED",e[e.ERROR_TIM_VERSION_OUTDATED=-1003]="ERROR_TIM_VERSION_OUTDATED",e[e.ERROR_PERMISSION_DENIED=-1101]="ERROR_PERMISSION_DENIED",e[e.ERROR_GET_DEVICE_LIST_FAIL=-1102]="ERROR_GET_DEVICE_LIST_FAIL",e[e.ERROR_INIT_FAIL=-1201]="ERROR_INIT_FAIL",e[e.ERROR_PARAM_INVALID=-1202]="ERROR_PARAM_INVALID",e[e.ERROR_REQUEST_REFUSED=-1203]="ERROR_REQUEST_REFUSED",e[e.ERROR_REQUEST_REPEATED=-1204]="ERROR_REQUEST_REPEATED",e[e.ERROR_SCENE_NOT_SUPPORTED=-1205]="ERROR_SCENE_NOT_SUPPORTED",e[e.INVALID_PARAMETER_REQUIRED=-120200]="INVALID_PARAMETER_REQUIRED",e[e.INVALID_PARAMETER_TYPE=-120201]="INVALID_PARAMETER_TYPE",e[e.INVALID_PARAMETER_EMPTY=-120202]="INVALID_PARAMETER_EMPTY",e[e.INVALID_PARAMETER_RANGE=-120203]="INVALID_PARAMETER_RANGE",e[e.ERROR_SIGNALING_SEND_FAIL=-1401]="ERROR_SIGNALING_SEND_FAIL",e[e.ERROR_INVALID_INVITEID=8010]="ERROR_INVALID_INVITEID",e[e.ERROR_INVALID_SEND_FAIL=8021]="ERROR_INVALID_SEND_FAIL",e[e.ERROR_HTTP=3e4]="ERROR_HTTP",e[e.ERROR_BLACKLIST=20007]="ERROR_BLACKLIST"}(c.ErrorCodeDictionary||(c.ErrorCodeDictionary={})),c.default={UNKNOWN:65535,NO_NETWORK:2805,FAILURE_SWITCH_TO_AUDIO:60001,FAILURE_SWITCH_TO_VIDEO:60002,NOT_MICROPHONE_LIST:60003,NOT_CAMERA_LIST:60004,NOT_SUPPORT:60006,ERROR_PACKAGE_NOT_PURCHASED:-1001,ERROR_PACKAGE_NOT_SUPPORTED:-1002,ERROR_TIM_VERSION_OUTDATED:-1003,ERROR_PERMISSION_DENIED:-1101,ERROR_GET_DEVICE_LIST_FAIL:-1102,ERROR_INIT_FAIL:-1201,ERROR_PARAM_INVALID:-1202,ERROR_REQUEST_REFUSED:-1203,ERROR_REQUEST_REPEATED:-1204,ERROR_SCENE_NOT_SUPPORTED:-1205,INVALID_PARAMETER_REQUIRED:-120200,INVALID_PARAMETER_TYPE:-120201,INVALID_PARAMETER_EMPTY:-120202,INVALID_PARAMETER_RANGE:-120203,ERROR_SIGNALING_SEND_FAIL:-1401,ERROR_INVALID_INVITEID:8010,ERROR_INVALID_SEND_FAIL:8021,ERROR_HTTP:3e4,ERROR_BLACKLIST:20007}},function(H,c,a){var e;e=()=>(()=>{var r={530:function(u,d,v){var t=this&&this.__assign||function(){return(t=Object.assign||function(p){for(var m,U=1,P=arguments.length;U<P;U++)for(var k in m=arguments[U])Object.prototype.hasOwnProperty.call(m,k)&&(p[k]=m[k]);return p}).apply(this,arguments)},l=this&&this.__awaiter||function(p,m,U,P){return new(U||(U=Promise))(function(k,V){function x(n){try{O(P.next(n))}catch(g){V(g)}}function j(n){try{O(P.throw(n))}catch(g){V(g)}}function O(n){var g;n.done?k(n.value):(g=n.value,g instanceof U?g:new U(function(N){N(g)})).then(x,j)}O((P=P.apply(p,m||[])).next())})},T=this&&this.__generator||function(p,m){var U,P,k,V,x={label:0,sent:function(){if(1&k[0])throw k[1];return k[1]},trys:[],ops:[]};return V={next:j(0),throw:j(1),return:j(2)},typeof Symbol=="function"&&(V[Symbol.iterator]=function(){return this}),V;function j(O){return function(n){return function(g){if(U)throw new TypeError("Generator is already executing.");for(;V&&(V=0,g[0]&&(x=0)),x;)try{if(U=1,P&&(k=2&g[0]?P.return:g[0]?P.throw||((k=P.return)&&k.call(P),0):P.next)&&!(k=k.call(P,g[1])).done)return k;switch(P=0,k&&(g=[2&g[0],k.value]),g[0]){case 0:case 1:k=g;break;case 4:return x.label++,{value:g[1],done:!1};case 5:x.label++,P=g[1],g=[0];continue;case 7:g=x.ops.pop(),x.trys.pop();continue;default:if(!((k=(k=x.trys).length>0&&k[k.length-1])||g[0]!==6&&g[0]!==2)){x=0;continue}if(g[0]===3&&(!k||g[1]>k[0]&&g[1]<k[3])){x.label=g[1];break}if(g[0]===6&&x.label<k[1]){x.label=k[1],k=g;break}if(k&&x.label<k[2]){x.label=k[2],x.ops.push(g);break}k[2]&&x.ops.pop(),x.trys.pop();continue}g=m.call(p,x)}catch(N){g=[6,N],P=0}finally{U=k=0}if(5&g[0])throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}([O,n])}}};Object.defineProperty(d,"__esModule",{value:!0});var y,C=v(928),L=v(434),i=v(757),s=v(150),R=v(758),I=v(23),h=v(391),_=v(365);(function(p){p[p.DEBUG=0]="DEBUG",p[p.INFO=1]="INFO",p[p.WARING=2]="WARING",p[p.ERROR=3]="ERROR"})(y||(y={}));var D={metric:!0,context:!0},E=function(p,m,U){return U===void 0&&(U=0),(0,C.isPlainObject)(p)?((0,C.isPlainObject)(m)&&Object.keys(m).forEach(function(P){var k=p[P],V=m[P];p[P]=D[P]&&U===0?E(k,V,1):V}),p):(0,C.isPlainObject)(m)?m:{}},b={clsConfig:{endpoint:"",topicId:""}},A=function(){function p(m){var U=this;this.url="",this.uploadChannel="",this.sendPipe=null,this.sendEsPipe=null,this._logLevel=y.INFO,this._getReportDataList=[],this._blacklist=[];var P=m||b,k=P.clsConfig,V=P.esConfig,x=k.endpoint,j=k.topicId;this.esConfig=V,this.endpoint=x,this.topicId=j;var O=this.buildUploadUrl();this.url=O,this.initPageUnloadMonitor(),this.sendPipe=(0,i.createPipeline)([(0,h.filterSdkappIdPipe)(this),(0,I.createThrottlePipe)(this,5),(0,s.formatClsLog)(),(0,R.limitLengthPipe)(),function(n){return l(U,void 0,void 0,function(){var g,N,w=this;return T(this,function(G){return g=0,(N=function(){return l(w,void 0,void 0,function(){var B;return T(this,function(F){switch(F.label){case 0:return F.trys.push([0,2,,3]),[4,this.send({url:O,data:n})];case 1:return F.sent(),[3,3];case 2:return B=F.sent(),g<=2?(g++,setTimeout(function(){N()},1e3)):console.debug(B),[3,3];case 3:return[2]}})})})(),[2]})})}]),this.updateBlacklist()}return p.prototype.initPageUnloadMonitor=function(){var m=this,U=this;!(0,C.isMiniProgram)()&&document&&typeof document.addEventListener=="function"&&document.addEventListener("visibilitychange",function(){if(document.visibilityState==="hidden"){var P=m.getCommonReportData(),k=E(P,{level:y.WARING,method:"PAGE_UNLOAD",type:"event"});if(U.esConfig)try{var V=U.esConfig,x=V.url,j=V.table;(0,i.createPipeline)([(0,h.filterSdkappIdPipe)(U),(0,I.createThrottlePipe)(U,1),(0,s.formatESLog)({table:j}),(0,R.limitLengthPipe)(),function(O){return l(m,void 0,void 0,function(){var n;return T(this,function(g){try{n=new Blob([JSON.stringify(O)],{type:"application/x-www-form-urlencoded"}),navigator==null||navigator.sendBeacon(x,n)}catch(N){console.debug(N)}return[2]})})}])(k)}catch(O){console.debug(O)}}})},p.prototype.updateEsConfig=function(m){var U=this;try{if(m){this.esConfig=m;var P=m.url,k=m.table;P&&k&&(this.uploadChannel=P,this.sendEsPipe=(0,i.createPipeline)([(0,h.filterSdkappIdPipe)(this),(0,I.createThrottlePipe)(this,5),(0,s.formatESLog)({table:k}),(0,R.limitLengthPipe)(),function(V){return l(U,void 0,void 0,function(){var x,j,O=this;return T(this,function(n){return x=0,(j=function(){return l(O,void 0,void 0,function(){var g;return T(this,function(N){switch(N.label){case 0:return N.trys.push([0,2,,3]),[4,this.send({url:P,data:V})];case 1:return N.sent(),[3,3];case 2:return g=N.sent(),x<=2?(x++,setTimeout(function(){j()},1e3)):console.debug(g),[3,3];case 3:return[2]}})})})(),[2]})})}]))}}catch(V){console.debug(V)}},p.prototype.updateGetReportData=function(m){typeof m=="function"&&this._getReportDataList.push(m)},p.prototype.updateBlacklist=function(){return l(this,void 0,void 0,function(){var m,U,P;return T(this,function(k){switch(k.label){case 0:return k.trys.push([0,2,,3]),[4,(0,L.request)({url:_.RAINBOW_BLACK_LIST_API})];case 1:return m=k.sent().data,typeof(U=m==null?void 0:m.blackList)=="string"&&(this._blacklist=U.split(",")),[3,3];case 2:return P=k.sent(),console.debug("update blacklist fail",P),[3,3];case 3:return[2]}})})},p.prototype.getBlackList=function(){return this._blacklist},p.prototype.setLogLevel=function(m){typeof m!="number"&&(m=y.INFO),this._logLevel=m},p.prototype.createLogFunc=function(m){var U=this;return function(P,k){U.log(P,k,{level:m})}},p.prototype.buildUploadUrl=function(){return this.endpoint&&this.topicId?"".concat(this.endpoint,"/tracklog?topic_id=").concat(this.topicId):""},p.prototype.info=function(m,U){this.log(m,U,{level:y.INFO})},p.prototype.debug=function(m,U){this.log(m,U,{level:y.DEBUG})},p.prototype.warn=function(m,U){this.log(m,U,{level:y.WARING})},p.prototype.error=function(m,U){this.log(m,U,{level:y.ERROR})},p.prototype.log=function(m,U,P){try{var k=P||{},V=k.level;if(k.topicId,this._logLevel<=V){var x=this.getCommonReportData(),j=E(x,t({level:V,method:m},U));this.sendPipe(j),typeof this.sendEsPipe=="function"&&this.sendEsPipe(j)}}catch(O){console.debug(O)}},p.prototype.getCommonReportData=function(){for(var m={},U=0;U<this._getReportDataList.length;U++)m=E(m,this._getReportDataList[U]());return m},p.prototype.send=function(m){return l(this,void 0,void 0,function(){var U,P,k,V;return T(this,function(x){switch(x.label){case 0:P=(U=m||{}).url,k=U.data,x.label=1;case 1:return x.trys.push([1,4,,5]),P?[4,(0,L.request)({url:P,data:k,method:"post"})]:[3,3];case 2:x.sent(),x.label=3;case 3:return[3,5];case 4:throw V=x.sent(),console.debug(V),new Error(V);case 5:return[2]}})})},p}();d.default=A},391:(u,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.filterSdkappIdPipe=void 0,d.filterSdkappIdPipe=function(v){return function(t,l){try{var T=t.sdkappid,y=v.getBlackList();if(y!=null&&y.includes(String(T)))throw new Error("this sdkappid in blacklist");l(t)}catch(C){console.debug(C)}}}},314:(u,d,v)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.formatClsLog=void 0;var t=v(928);d.formatClsLog=function(){return function(l,T){try{T({logs:l==null?void 0:l.map(function(y){var C={};return Object.keys(y).forEach(function(L){if((0,t.isPlainObject)(y[L]))try{C[L]=(0,t.stringifyPlus)(y[L])}catch(i){console.debug(i)}else L==="time"&&(C[L]=new Date(y[L]).toISOString()),C[L]=y[L]+""}),{contents:C,time:y.time}}),source:""})}catch(y){console.debug(y)}}}},597:(u,d,v)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.formatESLog=void 0;var t=v(928);d.formatESLog=function(l){var T=l.table;return function(y,C){try{var L=y==null?void 0:y.map(function(i){var s={};return Object.keys(i).forEach(function(R){if((0,t.isPlainObject)(i[R]))try{s[R]=(0,t.stringifyPlus)(i[R])}catch(I){console.debug(I)}else s[R]=R==="level"?i[R]+"":R==="time"?new Date(i[R]).toISOString():i[R]}),s});C({table:T,report:L})}catch(i){console.debug(i)}}}},150:(u,d,v)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.formatClsLog=d.formatESLog=void 0;var t=v(314);Object.defineProperty(d,"formatClsLog",{enumerable:!0,get:function(){return t.formatClsLog}});var l=v(597);Object.defineProperty(d,"formatESLog",{enumerable:!0,get:function(){return l.formatESLog}})},757:(u,d,v)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.createPipeline=void 0;var t=v(928);d.createPipeline=function(l){if(!l||!l.reduce||!l.length)throw new TypeError("createPipeline need at least one function param");return l.length===1?function(T,y){l[0](T,y||t.noop)}:l.reduce(function(T,y){return function(C,L){return L===void 0&&(L=t.noop),T(C,function(i){return y==null?void 0:y(i,L)})}})}},758:(u,d,v)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.limitLengthPipe=d.MAX_LOG_LENGTH=void 0;var t=v(928);d.MAX_LOG_LENGTH=102400,d.limitLengthPipe=function(){return function(l,T){try{var y=(l=l||{}).logs,C=y===void 0?[]:y;l.logs=C==null?void 0:C.map(function(L){var i=d.MAX_LOG_LENGTH,s=L.contents;return Object.keys(s).forEach(function(R){var I=s[R];try{I&&I.length>i&&(s[R]=I==null?void 0:I.substring(0,i))}catch{console.debug("size of content > limitSize"),s[R]=(0,t.stringifyPlus)(I).substring(0,i)}}),L}),T(l)}catch(L){console.debug(L)}}}},23:(u,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.createThrottlePipe=void 0,d.createThrottlePipe=function(v,t){var l,T=[];return function(y,C){if(Array.isArray(y)?T=T.concat(y):T.push(y),t&&T.length>=t||v.sendNow&&T.length>0)return C(T.splice(0,T.length)),void(l&&clearTimeout(l));l&&clearTimeout(l),l=setTimeout(function(){l=null,T.length>0&&C(T.splice(0,T.length))},v.delay||1e3)}}},434:function(u,d,v){var t=this&&this.__assign||function(){return(t=Object.assign||function(s){for(var R,I=1,h=arguments.length;I<h;I++)for(var _ in R=arguments[I])Object.prototype.hasOwnProperty.call(R,_)&&(s[_]=R[_]);return s}).apply(this,arguments)},l=this&&this.__awaiter||function(s,R,I,h){return new(I||(I=Promise))(function(_,D){function E(p){try{A(h.next(p))}catch(m){D(m)}}function b(p){try{A(h.throw(p))}catch(m){D(m)}}function A(p){var m;p.done?_(p.value):(m=p.value,m instanceof I?m:new I(function(U){U(m)})).then(E,b)}A((h=h.apply(s,R||[])).next())})},T=this&&this.__generator||function(s,R){var I,h,_,D,E={label:0,sent:function(){if(1&_[0])throw _[1];return _[1]},trys:[],ops:[]};return D={next:b(0),throw:b(1),return:b(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function b(A){return function(p){return function(m){if(I)throw new TypeError("Generator is already executing.");for(;D&&(D=0,m[0]&&(E=0)),E;)try{if(I=1,h&&(_=2&m[0]?h.return:m[0]?h.throw||((_=h.return)&&_.call(h),0):h.next)&&!(_=_.call(h,m[1])).done)return _;switch(h=0,_&&(m=[2&m[0],_.value]),m[0]){case 0:case 1:_=m;break;case 4:return E.label++,{value:m[1],done:!1};case 5:E.label++,h=m[1],m=[0];continue;case 7:m=E.ops.pop(),E.trys.pop();continue;default:if(!((_=(_=E.trys).length>0&&_[_.length-1])||m[0]!==6&&m[0]!==2)){E=0;continue}if(m[0]===3&&(!_||m[1]>_[0]&&m[1]<_[3])){E.label=m[1];break}if(m[0]===6&&E.label<_[1]){E.label=_[1],_=m;break}if(_&&E.label<_[2]){E.label=_[2],E.ops.push(m);break}_[2]&&E.ops.pop(),E.trys.pop();continue}m=R.call(s,E)}catch(U){m=[6,U],h=0}finally{I=_=0}if(5&m[0])throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}([A,p])}}},y=this&&this.__rest||function(s,R){var I={};for(var h in s)Object.prototype.hasOwnProperty.call(s,h)&&R.indexOf(h)<0&&(I[h]=s[h]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function"){var _=0;for(h=Object.getOwnPropertySymbols(s);_<h.length;_++)R.indexOf(h[_])<0&&Object.prototype.propertyIsEnumerable.call(s,h[_])&&(I[h[_]]=s[h[_]])}return I};Object.defineProperty(d,"__esModule",{value:!0}),d.request=void 0;var C=v(147),L=v(310),i=v(928);d.request=function(s){return l(void 0,void 0,void 0,function(){var R=s.url,I=s.data,h=s.header,_=h===void 0?{}:h,D=s.method,E=D===void 0?"GET":D,b=s.dataType,A=s.responseType,p=y(s,["url","data","header","method","dataType","responseType"]);return T(this,function(m){return(0,i.isBrowser)()?[2,(0,L.requestXHR)(R,I,{headers:_,method:E,responseType:A,dataType:b})]:(0,i.isMiniProgram)()?[2,(0,C.requestWeapp)(t({url:R,data:I,header:_,method:E,dataType:b,responseType:A},p))]:(console.debug("unsupport env"),[2])})})}},147:function(u,d,v){var t=this&&this.__assign||function(){return(t=Object.assign||function(L){for(var i,s=1,R=arguments.length;s<R;s++)for(var I in i=arguments[s])Object.prototype.hasOwnProperty.call(i,I)&&(L[I]=i[I]);return L}).apply(this,arguments)},l=this&&this.__awaiter||function(L,i,s,R){return new(s||(s=Promise))(function(I,h){function _(b){try{E(R.next(b))}catch(A){h(A)}}function D(b){try{E(R.throw(b))}catch(A){h(A)}}function E(b){var A;b.done?I(b.value):(A=b.value,A instanceof s?A:new s(function(p){p(A)})).then(_,D)}E((R=R.apply(L,i||[])).next())})},T=this&&this.__generator||function(L,i){var s,R,I,h,_={label:0,sent:function(){if(1&I[0])throw I[1];return I[1]},trys:[],ops:[]};return h={next:D(0),throw:D(1),return:D(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function D(E){return function(b){return function(A){if(s)throw new TypeError("Generator is already executing.");for(;h&&(h=0,A[0]&&(_=0)),_;)try{if(s=1,R&&(I=2&A[0]?R.return:A[0]?R.throw||((I=R.return)&&I.call(R),0):R.next)&&!(I=I.call(R,A[1])).done)return I;switch(R=0,I&&(A=[2&A[0],I.value]),A[0]){case 0:case 1:I=A;break;case 4:return _.label++,{value:A[1],done:!1};case 5:_.label++,R=A[1],A=[0];continue;case 7:A=_.ops.pop(),_.trys.pop();continue;default:if(!((I=(I=_.trys).length>0&&I[I.length-1])||A[0]!==6&&A[0]!==2)){_=0;continue}if(A[0]===3&&(!I||A[1]>I[0]&&A[1]<I[3])){_.label=A[1];break}if(A[0]===6&&_.label<I[1]){_.label=I[1],I=A;break}if(I&&_.label<I[2]){_.label=I[2],_.ops.push(A);break}I[2]&&_.ops.pop(),_.trys.pop();continue}A=i.call(L,_)}catch(p){A=[6,p],R=0}finally{s=I=0}if(5&A[0])throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}([E,b])}}};Object.defineProperty(d,"__esModule",{value:!0}),d.requestWeapp=void 0;var y=v(690),C=0;d.requestWeapp=function(L){return l(this,void 0,void 0,function(){var i;return T(this,function(s){switch(s.label){case 0:s.trys.push([0,5,6,7]),s.label=1;case 1:return C>=2?[4,(0,y.startBlocking)()]:[3,3];case 2:return s.sent(),[3,1];case 3:return C++,[4,new Promise(function(R,I){wx.request(t(t({},L),{success:function(h){R(h)},fail:function(h){I(h)}}))})];case 4:return[2,s.sent()];case 5:return i=s.sent(),[2,Promise.reject(i)];case 6:return C--,(0,y.resolveFirstBlock)(),[7];case 7:return[2]}})})}},310:function(u,d,v){var t=this&&this.__awaiter||function(i,s,R,I){return new(R||(R=Promise))(function(h,_){function D(A){try{b(I.next(A))}catch(p){_(p)}}function E(A){try{b(I.throw(A))}catch(p){_(p)}}function b(A){var p;A.done?h(A.value):(p=A.value,p instanceof R?p:new R(function(m){m(p)})).then(D,E)}b((I=I.apply(i,s||[])).next())})},l=this&&this.__generator||function(i,s){var R,I,h,_,D={label:0,sent:function(){if(1&h[0])throw h[1];return h[1]},trys:[],ops:[]};return _={next:E(0),throw:E(1),return:E(2)},typeof Symbol=="function"&&(_[Symbol.iterator]=function(){return this}),_;function E(b){return function(A){return function(p){if(R)throw new TypeError("Generator is already executing.");for(;_&&(_=0,p[0]&&(D=0)),D;)try{if(R=1,I&&(h=2&p[0]?I.return:p[0]?I.throw||((h=I.return)&&h.call(I),0):I.next)&&!(h=h.call(I,p[1])).done)return h;switch(I=0,h&&(p=[2&p[0],h.value]),p[0]){case 0:case 1:h=p;break;case 4:return D.label++,{value:p[1],done:!1};case 5:D.label++,I=p[1],p=[0];continue;case 7:p=D.ops.pop(),D.trys.pop();continue;default:if(!((h=(h=D.trys).length>0&&h[h.length-1])||p[0]!==6&&p[0]!==2)){D=0;continue}if(p[0]===3&&(!h||p[1]>h[0]&&p[1]<h[3])){D.label=p[1];break}if(p[0]===6&&D.label<h[1]){D.label=h[1],h=p;break}if(h&&D.label<h[2]){D.label=h[2],D.ops.push(p);break}h[2]&&D.ops.pop(),D.trys.pop();continue}p=s.call(i,D)}catch(m){p=[6,m],I=0}finally{R=h=0}if(5&p[0])throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}([b,A])}}};Object.defineProperty(d,"__esModule",{value:!0}),d.requestXHR=void 0;var T=v(580),y=v(690),C=0;function L(i,s,R){R.status?s(new Error("Request failed with status code "+R.status)):i(R)}d.default=L,d.requestXHR=function(i,s,R){return s===void 0&&(s={}),R===void 0&&(R={}),t(this,void 0,void 0,function(){var I,h=this;return l(this,function(_){switch(_.label){case 0:return _.trys.push([0,2,3,4]),[4,new Promise(function(D,E){return t(h,void 0,void 0,function(){var b,A,p,m,U,P;return l(this,function(k){switch(k.label){case 0:return C>=2?[4,(0,y.startBlocking)()]:[3,2];case 1:return k.sent(),[3,0];case 2:return C++,b=R.method,A=R.headers,p=A===void 0?{}:A,m=R.responseType,U=m===void 0?"json":m,b=(b||"get").toUpperCase(),Object.assign(p,{"Content-type":"application/json"}),(P=new window.XMLHttpRequest).responseType=U,P.timeout=1e4,P.onreadystatechange=function(){P.readyState===4&&(P.status===200?D({data:P.response}):E({code:P.status,msg:P.statusText}))},P.ontimeout=function(V){E({code:P.status,msg:P.statusText})},P.onloadend=function(){P&&(L(function(V){D(V)},function(V){E(V)},{status:P.status,statusText:P.statusText}),P=null)},P.onabort=function(){P&&(E(new Error("Request aborted")),P=null)},P.onerror=function(){E(new Error("Network Error")),P=null},b==="GET"?i="".concat(i).concat(i.indexOf("?")===-1?"?":"&").concat(T.default.stringify(s)):b==="POST"&&(s=JSON.stringify(s)),P.open(b,i,!0),Object.keys(p).forEach(function(V){P.setRequestHeader(V,p[V])}),P.send(b==="POST"?s:null),[2]}})})})];case 1:return[2,_.sent()];case 2:throw I=_.sent(),new Error(I);case 3:return C--,(0,y.resolveFirstBlock)(),[7];case 4:return[2]}})})}},365:(u,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.RAINBOW_BLACK_LIST_API=void 0,d.RAINBOW_BLACK_LIST_API="https://jsonschema.qpic.cn/87084b1b6d263426b92926cfa5fa23af/18f29786d25587b5eb162d5e9f724b1e/blackList"},928:(u,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.date2ISOString=d.stringifyPlus=d.noop=d.isBrowser=d.isMiniProgram=d.isPlainObject=d.appendParams=void 0,d.appendParams=function(t,l){l===void 0&&(l={});var T=[];return Object.keys(l).forEach(function(y){var C=l[y];if(C!==void 0){if((0,d.isPlainObject)(C))try{C=JSON.stringify(C)}catch{}T.push("".concat(y,"=").concat(encodeURIComponent(C)))}}),T.length?(t.indexOf("?")>-1?"".concat(t,"&"):"".concat(t,"?"))+T.join("&"):t},d.isPlainObject=function(t){if(typeof t!="object"||t===null)return!1;var l=Object.getPrototypeOf(t);if(l===null)return!0;for(var T=l;Object.getPrototypeOf(T)!==null;)T=Object.getPrototypeOf(T);return l===T},d.isMiniProgram=function(){try{return!(!(wx!=null&&wx.request)||!(wx!=null&&wx.connectSocket))}catch{return!1}},d.isBrowser=function(){try{return!(0,d.isMiniProgram)()&&typeof window<"u"&&window.document!==void 0}catch{return!1}},d.noop=function(){};var v=function(){var t=new WeakSet;return function(l,T){if(T instanceof Error)return"Error.message: ".concat(T.message,` 
  Error.stack: `).concat(T.stack);if(typeof T=="object"&&T!==null){if(t.has(T))return"[Circular ".concat(l||"root","]");t.add(T)}return T}};d.stringifyPlus=function(t){if(typeof t=="string")return t;try{return t instanceof Error?(JSON.stringify(t,v())||"undefined").replace(/"/gim,""):JSON.stringify(t,v())||"undefined"}catch(l){return`error happen when aegis stringify: 
 `.concat(l.message,` 
 `).concat(l.stack)}},d.date2ISOString=function(){var t,l=new Date,T=l.toISOString(),y=l.getTimezoneOffset()/60;return t=y<0?y>-10?"+0".concat(Math.abs(100*y)):"+".concat(Math.abs(100*y)):y>=10?"-".concat(100*y):"-0".concat(100*y),T.replace("Z",t)}},580:(u,d,v)=>{Object.defineProperty(d,"__esModule",{value:!0});var t=v(928);d.default={stringify:function(l){return l?Object.keys(l).map(function(T){var y=l[T];if((0,t.isPlainObject)(y))y=JSON.stringify(y);else{if(typeof y!="string"&&typeof y!="number")return"";y=+y}return encodeURIComponent(T)+"="+encodeURIComponent(y)}).filter(function(T){return T.length>0}).join("&"):""}}},690:(u,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.startBlocking=d.resolveFirstBlock=void 0;var v=[];d.startBlocking=function(){var t,l=new Promise(function(T){t=T});return v.push({promise:l,resolve:t}),l},d.resolveFirstBlock=function(){v.length&&(v[0].resolve(),v.shift())}}},o={};function f(u){var d=o[u];if(d!==void 0)return d.exports;var v=o[u]={exports:{}};return r[u].call(v.exports,v,v.exports,f),v.exports}var S={};return(()=>{var u=S;Object.defineProperty(u,"__esModule",{value:!0});var d=f(530),v={debug:console.debug,info:console.info,warn:console.warn,error:console.error,updateGetReportData:function(l){console.debug(l)}},t=null;u.default=function(l){if(!t){var T=l||{},y=T.clsConfig,C=(T.esConfig,y.endpoint),L=y.topicId;if(!C||!L)return console.debug("endpoint and topicId must not be null"),v;t=new d.default(l)}return t}})(),S})(),H.exports=e()},function(H,c,a){Object.defineProperty(c,"__esModule",{value:!0}),c.TRTCQuality=c.DEVICE_TYPE=c.TRTCVideoMirrorType=c.TRTCVideoFillMode=c.TRTCVideoRotation=void 0,function(e){e[e.TRTCVideoRotation0=0]="TRTCVideoRotation0",e[e.TRTCVideoRotation90=1]="TRTCVideoRotation90",e[e.TRTCVideoRotation180=2]="TRTCVideoRotation180",e[e.TRTCVideoRotation270=3]="TRTCVideoRotation270"}(c.TRTCVideoRotation||(c.TRTCVideoRotation={})),function(e){e[e.TRTCVideoFillMode_Fill=0]="TRTCVideoFillMode_Fill",e[e.TRTCVideoFillMode_Fit=1]="TRTCVideoFillMode_Fit"}(c.TRTCVideoFillMode||(c.TRTCVideoFillMode={})),function(e){e[e.TRTCVideoMirrorType_Auto=0]="TRTCVideoMirrorType_Auto",e[e.TRTCVideoMirrorType_Enable=1]="TRTCVideoMirrorType_Enable",e[e.TRTCVideoMirrorType_Disable=2]="TRTCVideoMirrorType_Disable"}(c.TRTCVideoMirrorType||(c.TRTCVideoMirrorType={})),function(e){e.CAMERA="camera",e.SPEAKER="speaker",e.MICROPHONES="microphones",e.MICROPHONE="microphone",e.AUDIO="audio",e.VIDEO="video"}(c.DEVICE_TYPE||(c.DEVICE_TYPE={})),function(e){e[e.TRTCQuality_Unknown=0]="TRTCQuality_Unknown",e[e.TRTCQuality_Excellent=1]="TRTCQuality_Excellent",e[e.TRTCQuality_Good=2]="TRTCQuality_Good",e[e.TRTCQuality_Poor=3]="TRTCQuality_Poor",e[e.TRTCQuality_Bad=4]="TRTCQuality_Bad",e[e.TRTCQuality_Vbad=5]="TRTCQuality_Vbad",e[e.TRTCQuality_Down=6]="TRTCQuality_Down"}(c.TRTCQuality||(c.TRTCQuality={}))},function(H,c,a){var e,r=this&&this.__extends||(e=function(d,v){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,l){t.__proto__=l}||function(t,l){for(var T in l)l.hasOwnProperty(T)&&(t[T]=l[T])})(d,v)},function(d,v){function t(){this.constructor=d}e(d,v),d.prototype=v===null?Object.create(v):(t.prototype=v.prototype,new t)}),o=this&&this.__assign||function(){return(o=Object.assign||function(d){for(var v,t=1,l=arguments.length;t<l;t++)for(var T in v=arguments[t])Object.prototype.hasOwnProperty.call(v,T)&&(d[T]=v[T]);return d}).apply(this,arguments)};Object.defineProperty(c,"__esModule",{value:!0});var f=a(7),S=a(15),u=function(d){function v(t){var l=t.name,T=l===void 0?"":l,y=t.code,C=y===void 0?f.default.UNKNOWN:y,L=t.message,i=L===void 0?"":L,s=t.messageParams,R=s===void 0?{}:s,I=(t.extraCode,t.fnName),h=I===void 0?"":I,_=d.call(this,i||S.getErrorMessage({code:C,params:o({fnName:h},R)}))||this;return _.name="TUICallEngineError",_.functionName="",_.name=T||_.name,_.code=C,_.functionName=h||_.functionName,_}return r(v,d),v.prototype.getCode=function(){return this.code},v}(Error);c.default=u},function(H,c,a){Object.defineProperty(c,"__esModule",{value:!0}),c.ERROR_CN_MESSAGE=c.ERROR_MESSAGE=void 0,c.ERROR_MESSAGE={NO_NETWORK:"未连接到网络",FAILURE_SWITCH_TO_AUDIO:"switch to audio call error",FAILURE_SWITCH_TO_VIDEO:"switch to video call error",NOT_MICROPHONE_LIST:"No microphone device",NOT_CAMERA_LIST:"No camera device",ERROR_PACKAGE_NOT_PURCHASED:"You do not have TUICallKit package, please open the free experience in the console: https://console.intl.cloud.tencent.com/im/detail or purchase the official package: ${purchaseAddress}",ERROR_PACKAGE_NOT_SUPPORTED:"The package you purchased does not support this ability. You can refer to here to purchase: ${purchaseAddress}",ERROR_TIM_VERSION_OUTDATED:"TIM SDK version is too old, Please upgrade version",ERROR_PERMISSION_DENIED:"camera permission refused / microphone permission refused. You can perform the trtc capability test at https://web.sdk.qcloud.com/trtc/webrtc/demo/detect/index.html to check whether the current environment supports audio and video calls",ERROR_GET_DEVICE_LIST_FAIL:"Failed to get device list",ERROR_INIT_FAIL:"init or login is not complete, this API needs to be used after init. To solve the problem, please go to: https://cloud.tencent.com/document/product/647/78769#3a61f42b-e06f-49af-88bf-362d40025887",ERROR_REQUEST_REFUSED:"The API is not support in the current state. To solve the problem, please go to: https://cloud.tencent.com/document/product/647/78769#5e65043d-e3dc-4bd3-8220-3ac7694dfa42",ERROR_REQUEST_REPEATED:"The current method is being executed, please do not call it repeatedly",ERROR_REQUEST_REPEATED_SWITCH:"Consistent with the current call type, please do not switch repeatedly",ERROR_SCENE_NOT_SUPPORTED:"In the current call scene, this function is not supported",ERROR_SIGNALING_SEND_FAIL:"signaling failed to send",ERROR_INVALID_INVITEID:"inviteID is invalid or invitation has been processed. To solve the problem, please go to: https://cloud.tencent.com/document/product/647/84363#e97ea97b-7812-42ed-89b7-2a3840ac0e3f",ERROR_INVALID_SEND_FAIL:"Failed to send message, common reasons: the called userID or groupID does not exist. To solve the problem, please go to: https://cloud.tencent.com/document/product/647/84363#661be1b0-f649-4199-a343-958c3f4f4bbb",ERROR_PARAM_INVALID:"invalid parameter",ERROR_HTTP:"The current page is detected to be using the http protocol(or localhost). To ensure smooth access and experience of all functions of TUICallEngine SDK for production environment users, please use the https protocol to access the audio and video application page. More Info: https://web.sdk.qcloud.com/trtc/webrtc/v5/doc/en/tutorial-05-info-browser.html#h2-3",NOT_SUPPORT:"The current page does not have webRTC capability. You can perform the trtc capability test at https://web.sdk.qcloud.com/trtc/webrtc/demo/detect/index.html to check whether the current environment supports audio and video calls"},c.ERROR_CN_MESSAGE={NO_NETWORK:"未连接到网络",FAILURE_SWITCH_TO_AUDIO:"切换语音通话失败",FAILURE_SWITCH_TO_VIDEO:"切换视频通话失败",NOT_MICROPHONE_LIST:"没有麦克风设备",NOT_CAMERA_LIST:"没有摄像头设备",ERROR_PACKAGE_NOT_PURCHASED:"您的应用还未开通音视频通话（TUICallKit）能力，您可以去控制台申请免费体验: https://console.cloud.tencent.com/im/detail 或购买通话能力套餐包: ${purchaseAddress}",ERROR_PACKAGE_NOT_SUPPORTED:"您暂不支持使用该能力，请前往如下购买页购买开通: ${purchaseAddress}",ERROR_TIM_VERSION_OUTDATED:"TIM SDK 版本太旧，请升级版本",ERROR_PERMISSION_DENIED:"摄像头/麦克风权限被拒绝，可以前往: https://web.sdk.qcloud.com/trtc/webrtc/demo/detect/index.html 进行 trtc 能力测试，查看当前环境是否支持音视频通话",ERROR_GET_DEVICE_LIST_FAIL:"获取设备列表失败",ERROR_INIT_FAIL:"TUICallEngine 初始化登录未完成，需要在 init 或 login 完成后使用此 API 。解决方案请前往: https://cloud.tencent.com/document/product/647/78769#3a61f42b-e06f-49af-88bf-362d40025887",ERROR_REQUEST_REFUSED:"当前通话状态无法使用该 API。解决方案请前往: https://cloud.tencent.com/document/product/647/78769#5e65043d-e3dc-4bd3-8220-3ac7694dfa42",ERROR_REQUEST_REPEATED:"当前方法正在执行中，请勿重复调用",ERROR_REQUEST_REPEATED_SWITCH:"与当前通话类型一致，请勿重复切换",ERROR_SCENE_NOT_SUPPORTED:"当前通话场景不支持该功能",ERROR_SIGNALING_SEND_FAIL:"信令发送失败",ERROR_INVALID_INVITEID:"邀请 ID 无效或邀请已处理。解决方案请前往: https://cloud.tencent.com/document/product/647/84363#e97ea97b-7812-42ed-89b7-2a3840ac0e3f",ERROR_INVALID_SEND_FAIL:"消息发送失败，常见原因：被叫用户 userID 或群 groupID 不存在。解决方案请前往: https://cloud.tencent.com/document/product/647/84363#661be1b0-f649-4199-a343-958c3f4f4bbb",ERROR_PARAM_INVALID:"参数错误",ERROR_HTTP:"检测到当前页面正处于 http 协议下，为确保生产环境用户顺畅接入和体验 TUICallEngine SDK 的全部功能，请使用 https 协议(或 localhost)访问音视频应用页面。详情请前往：https://web.sdk.qcloud.com/trtc/webrtc/v5/doc/zh-cn/tutorial-05-info-browser.html#h2-3",NOT_SUPPORT:"当前页面不具备 webRTC 能力。可以前往: https://web.sdk.qcloud.com/trtc/webrtc/demo/detect/index.html 进行 trtc 能力测试，查看当前环境是否支持音视频通话"}},function(H,c,a){Object.defineProperty(c,"__esModule",{value:!0}),c.TUICallCameraPosition=c.TUICommonDefine=c.TUICallType=void 0,c.TUICallType={AUDIO_CALL:1,VIDEO_CALL:2,DEVCIED_CAMERA:"camera",DEVCIED_MICROPHONES:"microphones"},c.TUICommonDefine={VideoEncoderParams:{"120p":"120p","120p_2":"120p_2","180p":"180p","180p_2":"180p_2","240p":"240p","360p":"360p","360p_2":"360p_2","480p":"480p","480p_2":"480p_2","720p":"720p","1080p":"1080p","1440p":"1440p","4K":"4K"}},function(e){e[e.FRONT=0]="FRONT",e[e.BACK=1]="BACK"}(c.TUICallCameraPosition||(c.TUICallCameraPosition={}))},function(H,c,a){a.r(c);var e=a(1),r=a(2),o=a(7),f=a.n(o),S=a(11);class u{constructor(v){this.sdkappid="",this.version="",this.userid="",this.platform="",this.useragent="",this.method=v,this.codeint=1,this.calltype=1,this.talktime=0,this.message="",this.text="",this.startts=Date.now(),this.endts=0,this.timespan=0,this.time="",this.networktype="",this.host=Object(e.getHostType)()}static bindController(v){u.prototype._eventStatController=v}setCommonInfo(v){const{SDKAppID:t,version:l,userID:T,platform:y,scene:C}=v;this.sdkappid=t,this.version=""+l,this.userid=T,this.platform=y,this.scene=C,this.time=Object(e.date2ISOString)(),this.startts&&this.endts&&!this.timespan&&(this.timespan=Math.abs(this.endts-this.startts))}setEnd(v=!1){this.endts=Date.now(),v?this._eventStatController.pushIn(this):setTimeout(()=>{this._eventStatController.pushIn(this)},0)}setError(v,t,l){return this.setNetworkType(l),t?(v.code&&this.setCode(v.code),v.message&&this.setMessage(v.message)):(this.setCode(f.a.NO_NETWORK),this.setMessage(S.ERROR_MESSAGE.NO_NETWORK)),this}setCode(v){return v==="ECONNABORTED"&&(this.codeint=103),Object(e.isNumber)(v)?this.codeint=v:r.default.warn("SSOLogData.setCode value not a number, please check!",v,typeof v),this}setMessage(v){return Object(e.isString)(v)?(this.message=v,this):this}setText(v){return Object(e.isNumber)(v)?this.text=v.toString():Object(e.isString)(v)&&(this.text=v),this}setTalkTime(v){return this.talktime=v,this}setMessageType(v){return this.msgType=v,this}setCallType(v){return this.calltype=v,this}setNetworkType(v){return Object(e.isUndefined)(v)?r.default.warn("SSOLogData.setNetworkType value is undefined, please check!"):this.networktype=v,this}}c.default=u},function(H,c){H.exports=_e},function(H,c,a){Object.defineProperty(c,"__esModule",{value:!0}),c.ErrorMessageCN=c.ErrorMessage=c.getErrorMessage=void 0;var e=a(1),r=a(7),o=a(11);c.getErrorMessage=function(f){var S,u=f.code,d=f.params,v=f.enableDocLink,t=v!==void 0&&v,l=f.languageList,T=l===void 0?["en","zh-CN"]:l,y="",C=r.ErrorCodeDictionary[u];try{T.forEach(function(L){switch(L){case"en":S=c.ErrorMessage[C];break;case"zh-CN":S=c.ErrorMessageCN[C]}e.isFunction(S)?(y=y&&y+" ",y+=S(d)):e.isString(S)&&(y=S)})}catch{S=c.ErrorMessage.UNKNOWN_ERROR}return t&&(y+=" doc:"),y},c.ErrorMessage={ERROR_INIT_FAIL:function(f){return f.fnName+": "+o.ERROR_MESSAGE.ERROR_INIT_FAIL+"."},ERROR_SCENE_NOT_SUPPORTED:function(f){return f.fnName+": "+o.ERROR_MESSAGE.ERROR_SCENE_NOT_SUPPORTED+"."},ERROR_REQUEST_REFUSED:function(f){var S=f.value;return o.ERROR_MESSAGE.ERROR_REQUEST_REFUSED+". customStatus: "+S+"."},ERROR_PARAM_INVALID:function(f){return"the parameters of the '"+f.fnName+"' you called does not meet the requirements, please check the API documentation."},INVALID_PARAMETER_REQUIRED:function(f){var S=f.key,u=f.rule,d=f.fnName,v=f.value;return"'"+(S||u.name)+"' is a required param when calling "+d+"(), received: "+v+"."},INVALID_PARAMETER_TYPE:function(f){var S=f.key,u=f.rule,d=f.fnName,v=f.value;return"'"+(""+(S||u.name))+"' must be type of "+(Array.isArray(u.type)?u.type.join("|"):u.type)+" when calling "+d+"(), received type: "+e.getValueType(v)+"."},INVALID_PARAMETER_EMPTY:function(f){var S=f.key,u=f.rule,d=f.fnName;return"'"+(S||u.name)+"' cannot be empty when calling "+d+"()."},INVALID_PARAMETER_RANGE:function(f){var S=f.key,u=f.rule,d=f.fnName,v=f.value;return e.isArray(u.values)?"'"+(S||u.name)+"' must be one of "+u.values.join("|")+" when calling "+d+"(), received: "+v+".":e.isString(u.values)&&u.values.indexOf("~")!==-1?"'"+(S||u.name)+"' must be the range of "+u.values+" when calling "+d+"(), received: "+v+".":void 0},ERROR_REQUEST_REPEATED:function(f){var S=f.fnName;return"you are already "+S+"(), cannot repeated call '"+S+"'."},ERROR_HTTP:function(){return o.ERROR_MESSAGE.ERROR_HTTP+"."},ERROR_TIM_VERSION_OUTDATED:function(){return o.ERROR_MESSAGE.ERROR_TIM_VERSION_OUTDATED+" >= 2.21.2."},ERROR_PACKAGE_NOT_SUPPORTED:function(){return o.ERROR_MESSAGE.ERROR_PACKAGE_NOT_SUPPORTED+"."},FAILURE_SWITCH_TO_AUDIO:function(){return o.ERROR_MESSAGE.FAILURE_SWITCH_TO_AUDIO+"."},NOT_MICROPHONE_LIST:function(f){var S=f.fnName,u=f.error;return"NotFoundError, no microphone detected, please check your device and the configuration on '"+S+"'"+(u?", error: "+u.toString()+".":".")},NOT_CAMERA_LIST:function(f){var S=f.fnName,u=f.error;return"NotFoundError, no camera detected, please check your device and the configuration on '"+S+"'"+(u?", error: "+u.toString()+".":".")},ERROR_PERMISSION_DENIED:function(f){var S=f.fnName,u=f.error;return"NotAllowedError, you have disabled camera/microphone access, please allow the current application "+S+" to use the camera/microphone. "+(u?", error: "+u.toString()+".":".")},ERROR_INVALID_SEND_FAIL:function(){return o.ERROR_MESSAGE.ERROR_INVALID_SEND_FAIL+"."},UNKNOWN_ERROR:function(f){var S=f.fnName,u=f.error;return"'"+S+"' throw unknown exception"+(u?", error: "+u.toString()+".":".")}},c.ErrorMessageCN={ERROR_INIT_FAIL:function(f){return f.fnName+": "+o.ERROR_CN_MESSAGE.ERROR_INIT_FAIL+"。"},ERROR_SCENE_NOT_SUPPORTED:function(f){return f.fnName+": "+o.ERROR_CN_MESSAGE.ERROR_SCENE_NOT_SUPPORTED+"。"},ERROR_REQUEST_REFUSED:function(f){var S=f.value;return o.ERROR_CN_MESSAGE.ERROR_REQUEST_REFUSED+". customStatus: "+S+"。"},ERROR_PARAM_INVALID:function(f){return"the parameters of the '"+f.fnName+"' you called does not meet the requirements, please check the API documentation."},INVALID_PARAMETER_REQUIRED:function(f){var S=f.key,u=f.rule,d=f.fnName,v=f.value;return"调用 "+d+"() 方法的时候 '"+(S||u.name)+"' 是必须的参数, 收到的值为: "+v+"。"},INVALID_PARAMETER_TYPE:function(f){var S=f.key,u=f.rule,d=f.fnName,v=f.value;return"调用 "+d+"() 方法的时候 '"+(""+(S||u.name))+"' 必须是 "+(Array.isArray(u.type)?u.type.join("|"):u.type)+" 类型, 收到的类型是: "+e.getValueType(v)+"。"},INVALID_PARAMETER_EMPTY:function(f){var S=f.key,u=f.rule,d=f.fnName;return f.value,"调用 "+d+"() 的时候 '"+(S||u.name)+"' 不能是空。"},INVALID_PARAMETER_RANGE:function(f){var S=f.key,u=f.rule,d=f.fnName,v=f.value;return e.isArray(u.values)?"调用 "+d+"() 的时候 '"+(S||u.name)+"' 必须是 "+u.values.join("|")+" 的其中一种, 收到的是: "+v+"。":e.isString(u.values)&&u.values.indexOf("~")!==-1?"调用 "+d+"() 的时候 '"+(S||u.name)+"' 范围是 "+u.values+", 收到的是: "+v+"。":void 0},ERROR_REQUEST_REPEATED:function(f){var S=f.fnName;return"你已经调用 "+S+"(), 请勿重复调用 '"+S+"'。"},ERROR_HTTP:function(){return o.ERROR_CN_MESSAGE.ERROR_HTTP+"。"},ERROR_TIM_VERSION_OUTDATED:function(){return o.ERROR_CN_MESSAGE.ERROR_TIM_VERSION_OUTDATED+" >= 2.21.2。"},ERROR_PACKAGE_NOT_SUPPORTED:function(){return o.ERROR_CN_MESSAGE.ERROR_PACKAGE_NOT_SUPPORTED+"。"},FAILURE_SWITCH_TO_AUDIO:function(){return o.ERROR_CN_MESSAGE.FAILURE_SWITCH_TO_AUDIO+"。"},NOT_MICROPHONE_LIST:function(f){var S=f.fnName,u=f.error;return"NotFoundError，未检测到麦克风设备，请检查您的设备和麦克风上的配置 '"+S+"'"+(u?", error: "+u.toString()+".":".")},NOT_CAMERA_LIST:function(f){var S=f.fnName,u=f.error;return"NotFoundError，未检测到摄像头设备，请检查您的设备和摄像头上的配置 '"+S+"'"+(u?", error: "+u.toString()+".":".")},ERROR_PERMISSION_DENIED:function(f){f.fnName;var S=f.error;return"NotAllowedError, 您已禁用摄像头/麦克风访问权限，请允许当前应用程序使用摄像头/麦克风。"+(S?", error: "+S.toString()+".":".")},ERROR_INVALID_SEND_FAIL:function(){return o.ERROR_CN_MESSAGE.ERROR_INVALID_SEND_FAIL+"."}}},function(H,c,a){Object.defineProperty(c,"__esModule",{value:!0}),c.TUICallEvent=void 0,c.TUICallEvent={ERROR:"onError",SDK_READY:"sdkReady",ON_CALL_BEGIN:"onCallBegin",INVITED:"onInvited",ON_CALL_RECEIVED:"onCallReceived",USER_ACCEPT:"onUserAccept",USER_ENTER:"onUserEnter",USER_LEAVE:"onUserLeave",REJECT:"onReject",NO_RESP:"onNoResp",LINE_BUSY:"onLineBusy",CALLING_CANCEL:"onCallingCancel",ON_CALL_CANCELED:"onCallCanceled",KICKED_OUT:"onKickedOut",CALLING_TIMEOUT:"onCallingTimeout",CALL_END:"onCallEnd",CALLING_END:"onCallEnd",USER_VIDEO_AVAILABLE:"onUserVideoAvailable",USER_AUDIO_AVAILABLE:"onUserAudioAvailable",USER_VOICE_VOLUME:"onUserVoiceVolume",GROUP_CALL_INVITEE_LIST_UPDATE:"onGroupCallInviteeListUpdate",CALL_TYPE_CHANGED:"onCallTypeChanged",DEVICED_UPDATED:"onDeviceUpdated",ON_USER_NETWORK_QUALITY_CHANGED:"onUserNetworkQualityChanged",MESSAGE_SENT_BY_ME:"onMessageSentByMe"}},function(H,c,a){(function(e){var r=a(3),o=a(47),f=a(23),S={"Content-Type":"application/x-www-form-urlencoded"};function u(t,l){!r.isUndefined(t)&&r.isUndefined(t["Content-Type"])&&(t["Content-Type"]=l)}var d,v={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:((typeof XMLHttpRequest<"u"||e!==void 0&&Object.prototype.toString.call(e)==="[object process]")&&(d=a(24)),d),transformRequest:[function(t,l){return o(l,"Accept"),o(l,"Content-Type"),r.isFormData(t)||r.isArrayBuffer(t)||r.isBuffer(t)||r.isStream(t)||r.isFile(t)||r.isBlob(t)?t:r.isArrayBufferView(t)?t.buffer:r.isURLSearchParams(t)?(u(l,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):r.isObject(t)||l&&l["Content-Type"]==="application/json"?(u(l,"application/json"),function(T,y,C){if(r.isString(T))try{return(y||JSON.parse)(T),r.trim(T)}catch(L){if(L.name!=="SyntaxError")throw L}return(C||JSON.stringify)(T)}(t)):t}],transformResponse:[function(t){var l=this.transitional,T=l&&l.silentJSONParsing,y=l&&l.forcedJSONParsing,C=!T&&this.responseType==="json";if(C||y&&r.isString(t)&&t.length)try{return JSON.parse(t)}catch(L){if(C)throw L.name==="SyntaxError"?f(L,this,"E_JSON_PARSE"):L}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300}};v.headers={common:{Accept:"application/json, text/plain, */*"}},r.forEach(["delete","get","head"],function(t){v.headers[t]={}}),r.forEach(["post","put","patch"],function(t){v.headers[t]=r.merge(S)}),H.exports=v}).call(this,a(46))},function(H,c,a){a.r(c),a.d(c,"default",function(){return y});var e=a(2),r=a(1);class o{constructor(){this._table="timweb-trtccalling",this._report=[]}pushIn(L){e.default.debug("SSOLogBody.pushIn",this._report.length,L),this._report.push(L)}backfill(L){Object(r.isArray)(L)&&L.length!==0&&(e.default.debug("SSOLogBody.backfill",this._report.length,L.length),this._report.unshift(...L))}getLogsNumInMemory(){return this._report.length}isEmpty(){return this._report.length===0}_reset(){this._report.length=0,this._report=[]}getTable(){return this._table}getLogsInMemory(){const L=this._report.slice();return this._reset(),L}}var f=a(13),S=a(19),u=a(31),d=a.n(u);const v={CURRENT:{COMMON:"https://webim.tim.qq.com"},PRODUCTION:{COMMON:"https://webim.tim.qq.com"},OVERSEA_PRODUCTION:{COMMON:"https://api.im.qcloud.com"},SANDBOX:{COMMON:"https://events.tim.qq.com"},TEST:{COMMON:"https://test.tim.qq.com"}},t={IM_OPEN_STAT:"imopenstat"},l={TIM_WEB_TRTCCALLING_REPORT:"tweb_trtccalling_report"},T={imopenstat:"v4"};class y{constructor(){this.TAG="trtccalling-ssolog-event",this._reportBody=new o,this._version=S.version||"",this.MIN_THRESHOLD=20,this.MAX_THRESHOLD=100,this.WAITING_TIME=6e4,this.INTERVAL=2e4,this._timerID=0,this._resetLastReportTime(),this._startReportTimer(),this._retryCount=0,this.MAX_RETRY_COUNT=3}reportAtOnce(){e.default.debug("EventStatController.reportAtOnce"),this._report()}pushIn(L){L instanceof f.default&&(L.setCommonInfo({SDKAppID:Number(sessionStorage.getItem("sdkAppId")),version:this._version,userID:sessionStorage.getItem("userId")}),this._reportBody.pushIn(L),this._report())}_resetLastReportTime(){this._lastReportTime=Date.now()}_startReportTimer(){this._timerID=setInterval(()=>{Date.now()<this._lastReportTime+this.WAITING_TIME||this._reportBody.isEmpty()||this._report()},this.INTERVAL)}_stopReportTimer(){this._timerID>0&&(clearInterval(this._timerID),this._timerID=0)}_report(){if(this._reportBody.isEmpty())return;const L=Math.ceil(+new Date/1e3),i=sessionStorage.getItem("sdkAppId"),s=this._reportBody.getLogsInMemory(),R={table:this._reportBody.getTable(),report:s},I=`${v.CURRENT.COMMON}/${T.imopenstat}/${t.IM_OPEN_STAT}/${l.TIM_WEB_TRTCCALLING_REPORT}/?sdkappid=${i}&reqtime=${L}`;d.a.post(I,JSON.stringify(R)).then(()=>{this._resetLastReportTime(),this._retryCount>0&&(e.default.debug("EventStatController.report retry success"),this._retryCount=0)}).catch(h=>{e.default.warn("EventStatController.report, error:"+Object(r.stringifyError)(h)),this._reportBody.backfill(s),this._reportBody.getLogsNumInMemory()>this.MAX_THRESHOLD||this._retryCount===this.MAX_RETRY_COUNT||this._timerID===0?this._retryCount=0:this._retryCount+=1})}reset(){e.default.log("EventStatController.reset"),this._stopReportTimer(),this._report()}}},function(H){H.exports=JSON.parse(`{"name":"tuicall-engine-webrtc","version":"3.1.2","description":"腾讯云 tuicall-engine-webrtc","main":"index","private":true,"dependencies":{"@tencentcloud/chat":"latest","axios":"^0.21.0","dayjs":"^1.11.7","EventEmitter":"^1.0.0","pope-test-logger":"^0.0.39","rtc-ai-denoiser":"latest","trtc-cloud-js-sdk":"^2.4.0","trtc-js-sdk":"latest","tuikit-logger":"latest"},"devDependencies":{"@babel/preset-typescript":"^7.12.7","@typescript-eslint/eslint-plugin":"^4.33.0","@typescript-eslint/parser":"^4.33.0","docdash-blue":"^1.1.9","eslint":"^7.27.0","eslint-config-google":"^0.14.0","eslint-plugin-prettier":"^4.0.0","fs-extra":"^9.0.1","jsdoc":"^3.6.11","prettier":"^2.5.0","pretty":"^2.0.0","replace":"^1.2.2","rimraf":"^4.1.2","ts-loader":"^8.4.0","typescript":"^3.9.7","watch":"^1.0.2","webpack":"^4.44.1","webpack-cli":"^3.3.12"},"scripts":{"watch":"watch 'npm run build_withcopy4' src","dev":"npm run watch","build":"webpack --config webpack.config.js","build_withcopy":"npm run build && cp dist/npm/tuicall-engine-webrtc.js ../../github/TUICalling/Web/node_modules/tuicall-engine-webrtc/tuicall-engine-webrtc.js","build_withcopy2":"npm run build && cp dist/npm/tuicall-engine-webrtc.js ../sdk/trtc-calling-webrtc-demo/node_modules/tuicall-engine-webrtc/tuicall-engine-webrtc.js","build_withcopy3":"npm run build && cp dist/npm/tuicall-engine-webrtc.js ./example-js/tuicall-engine-webrtc.js","build_withcopy4":"npm run build && cp dist/npm/tuicall-engine-webrtc.js ./example/node_modules/tuicall-engine-webrtc/tuicall-engine-webrtc.js","build_demo3":"npm run build && cp dist/npm/tuicall-engine-webrtc.js ./examples/call-engine-demo-vue3//node_modules/tuicall-engine-webrtc/tuicall-engine-webrtc.js","build:package":"node build/package-bundle.js","lint":"./node_modules/.bin/eslint ./src; exit 0","fix":"./node_modules/.bin/eslint --fix ./src; exit 0","prerelease":"npm run lint && npm run build && npm run doc && npm run build:package","doc":"npm run doc:clean && tsc  --target ESNEXT && npm run doc:build","doc:build":"npm run changelog && npm run main && ./node_modules/.bin/jsdoc -c build/jsdoc/jsdoc.json && node ./build/jsdoc/fix-doc.js","doc:clean":"node ./build/jsdoc/clean-doc.js","doc-en":"npm run doc:clean && tsc  --target ESNEXT && npm run doc:build-en","doc:build-en":"npm run changelog && npm run main && ./node_modules/.bin/jsdoc -c build/jsdoc/jsdoc-en.json && node ./build/jsdoc/fix-doc-en.js","changelog":"cp CHANGELOG.md build/jsdoc/tutorials/20-CHANGELOG.md","main":"cp README.md build/jsdoc/main.md"},"repository":{"type":"git","url":"https://github.com/tencentyun/TUICallKit/tree/main/Web"},"author":"Tencent Cloud Terminal R&D Center","license":"ISC"}`)},function(H,c){H.exports=pe},function(H,c,a){H.exports=function(e,r){return function(){for(var o=new Array(arguments.length),f=0;f<o.length;f++)o[f]=arguments[f];return e.apply(r,o)}}},function(H,c,a){var e=a(3);function r(o){return encodeURIComponent(o).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}H.exports=function(o,f,S){if(!f)return o;var u;if(S)u=S(f);else if(e.isURLSearchParams(f))u=f.toString();else{var d=[];e.forEach(f,function(t,l){t!=null&&(e.isArray(t)?l+="[]":t=[t],e.forEach(t,function(T){e.isDate(T)?T=T.toISOString():e.isObject(T)&&(T=JSON.stringify(T)),d.push(r(l)+"="+r(T))}))}),u=d.join("&")}if(u){var v=o.indexOf("#");v!==-1&&(o=o.slice(0,v)),o+=(o.indexOf("?")===-1?"?":"&")+u}return o}},function(H,c,a){H.exports=function(e,r,o,f,S){return e.config=r,o&&(e.code=o),e.request=f,e.response=S,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},function(H,c,a){var e=a(3),r=a(48),o=a(49),f=a(22),S=a(50),u=a(53),d=a(54),v=a(25);H.exports=function(t){return new Promise(function(l,T){var y=t.data,C=t.headers,L=t.responseType;e.isFormData(y)&&delete C["Content-Type"];var i=new XMLHttpRequest;if(t.auth){var s=t.auth.username||"",R=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";C.Authorization="Basic "+btoa(s+":"+R)}var I=S(t.baseURL,t.url);function h(){if(i){var D="getAllResponseHeaders"in i?u(i.getAllResponseHeaders()):null,E={data:L&&L!=="text"&&L!=="json"?i.response:i.responseText,status:i.status,statusText:i.statusText,headers:D,config:t,request:i};r(l,T,E),i=null}}if(i.open(t.method.toUpperCase(),f(I,t.params,t.paramsSerializer),!0),i.timeout=t.timeout,"onloadend"in i?i.onloadend=h:i.onreadystatechange=function(){i&&i.readyState===4&&(i.status!==0||i.responseURL&&i.responseURL.indexOf("file:")===0)&&setTimeout(h)},i.onabort=function(){i&&(T(v("Request aborted",t,"ECONNABORTED",i)),i=null)},i.onerror=function(){T(v("Network Error",t,null,i)),i=null},i.ontimeout=function(){var D="timeout of "+t.timeout+"ms exceeded";t.timeoutErrorMessage&&(D=t.timeoutErrorMessage),T(v(D,t,t.transitional&&t.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",i)),i=null},e.isStandardBrowserEnv()){var _=(t.withCredentials||d(I))&&t.xsrfCookieName?o.read(t.xsrfCookieName):void 0;_&&(C[t.xsrfHeaderName]=_)}"setRequestHeader"in i&&e.forEach(C,function(D,E){y===void 0&&E.toLowerCase()==="content-type"?delete C[E]:i.setRequestHeader(E,D)}),e.isUndefined(t.withCredentials)||(i.withCredentials=!!t.withCredentials),L&&L!=="json"&&(i.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&i.addEventListener("progress",t.onDownloadProgress),typeof t.onUploadProgress=="function"&&i.upload&&i.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(D){i&&(i.abort(),T(D),i=null)}),y||(y=null),i.send(y)})}},function(H,c,a){var e=a(23);H.exports=function(r,o,f,S,u){var d=new Error(r);return e(d,o,f,S,u)}},function(H,c,a){H.exports=function(e){return!(!e||!e.__CANCEL__)}},function(H,c,a){var e=a(3);H.exports=function(r,o){o=o||{};var f={},S=["url","method","data"],u=["headers","auth","proxy","params"],d=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],v=["validateStatus"];function t(C,L){return e.isPlainObject(C)&&e.isPlainObject(L)?e.merge(C,L):e.isPlainObject(L)?e.merge({},L):e.isArray(L)?L.slice():L}function l(C){e.isUndefined(o[C])?e.isUndefined(r[C])||(f[C]=t(void 0,r[C])):f[C]=t(r[C],o[C])}e.forEach(S,function(C){e.isUndefined(o[C])||(f[C]=t(void 0,o[C]))}),e.forEach(u,l),e.forEach(d,function(C){e.isUndefined(o[C])?e.isUndefined(r[C])||(f[C]=t(void 0,r[C])):f[C]=t(void 0,o[C])}),e.forEach(v,function(C){C in o?f[C]=t(r[C],o[C]):C in r&&(f[C]=t(void 0,r[C]))});var T=S.concat(u).concat(d).concat(v),y=Object.keys(r).concat(Object.keys(o)).filter(function(C){return T.indexOf(C)===-1});return e.forEach(y,l),f}},function(H,c,a){function e(r){this.message=r}e.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},e.prototype.__CANCEL__=!0,H.exports=e},function(H,c,a){a.r(c),c.default={SDK_CONSTRUCT:"sdkConstruct",SDK_READY:"sdkReady",SDK_NOT_READY:"sdkNotReady",LOGIN:"login",LOGOUT:"logout",CALL:"call",GROUP_CALL:"groupCall",ACCEPT:"accept",REJECT:"reject",HANGUP:"hangup",START_REMOTE_VIEW:"startRemoteView",STOP_REMOTE_VIEW:"stopRemoteView",START_LOCAL_VIEW:"startLocalView",STOP_LOCAL_VIEW:"stopLocalView",OPEN_CAMERA:"openCamera",CLOSE_CAMERA:"closeCamera",SET_MIC_MUTE:"setMicMute",SET_VIDEO_QUALITY:"setVideoQuality",SWITCH_TO_AUDIO_CALL:"switchToAudioCall",SWITCH_TO_VIDEO_CALL:"switchToVideoCall",CHANGE_CALL_STATUS:"changeCallStatus",TALK_TIME:"talktime",ERROR:"error",INVITED:"invited",GROUP_CALL_INVITEE_LIST_UPDATE:"group_call_invitee_list_update",USER_ENTER:"user_enter",USER_LEAVE:"user_leave",NO_RESP:"no_resp",LINE_BUSY:"line_busy",CALLING_CANCEL:"calling_cancel",KICKED_OUT:"kicked_out",CALLING_TIMEOUT:"calling_timeout",CALLING_END:"calling_end",USER_VIDEO_AVAILABLE:"user_video_available",USER_AUDIO_AVAILABLE:"user_audio_available",USER_VOICE_VOLUME:"user_voice_volume",CALL_TYPE_CHANGED:"call_type_changed",DEVICED_UPDATED:"deviced_updated",QUALITY_REPORT:"quality_report"}},function(H,c,a){Object.defineProperty(c,"__esModule",{value:!0}),c.callRoleMapping=c.callTypeMapping=void 0;var e=a(6),r=a(0);c.callTypeMapping=function(o){var f=r.NAME.UNKNOWN;switch(o){case e.CALL_TYPE.AUDIO_CALL:f=r.NAME.AUDIO;break;case e.CALL_TYPE.VIDEO_CALL:f=r.NAME.VIDEO}return f},c.callRoleMapping=function(o){var f=o;return f===e.CALL_ROLE.INVITER?f=r.NAME.CALLER:f===e.CALL_ROLE.INVITEE&&(f=r.NAME.CALLEE),f}},function(H,c,a){H.exports=a(41)},function(H,c,a){H.exports=function(){var e=6e4,r=36e5,o="millisecond",f="second",S="minute",u="hour",d="day",v="week",t="month",l="quarter",T="year",y="date",C="Invalid Date",L=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,i=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,s={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(P){var k=["th","st","nd","rd"],V=P%100;return"["+P+(k[(V-20)%10]||k[V]||k[0])+"]"}},R=function(P,k,V){var x=String(P);return!x||x.length>=k?P:""+Array(k+1-x.length).join(V)+P},I={s:R,z:function(P){var k=-P.utcOffset(),V=Math.abs(k),x=Math.floor(V/60),j=V%60;return(k<=0?"+":"-")+R(x,2,"0")+":"+R(j,2,"0")},m:function P(k,V){if(k.date()<V.date())return-P(V,k);var x=12*(V.year()-k.year())+(V.month()-k.month()),j=k.clone().add(x,t),O=V-j<0,n=k.clone().add(x+(O?-1:1),t);return+(-(x+(V-j)/(O?j-n:n-j))||0)},a:function(P){return P<0?Math.ceil(P)||0:Math.floor(P)},p:function(P){return{M:t,y:T,w:v,d,D:y,h:u,m:S,s:f,ms:o,Q:l}[P]||String(P||"").toLowerCase().replace(/s$/,"")},u:function(P){return P===void 0}},h="en",_={};_[h]=s;var D="$isDayjsObject",E=function(P){return P instanceof m||!(!P||!P[D])},b=function P(k,V,x){var j;if(!k)return h;if(typeof k=="string"){var O=k.toLowerCase();_[O]&&(j=O),V&&(_[O]=V,j=O);var n=k.split("-");if(!j&&n.length>1)return P(n[0])}else{var g=k.name;_[g]=k,j=g}return!x&&j&&(h=j),j||!x&&h},A=function(P,k){if(E(P))return P.clone();var V=typeof k=="object"?k:{};return V.date=P,V.args=arguments,new m(V)},p=I;p.l=b,p.i=E,p.w=function(P,k){return A(P,{locale:k.$L,utc:k.$u,x:k.$x,$offset:k.$offset})};var m=function(){function P(V){this.$L=b(V.locale,null,!0),this.parse(V),this.$x=this.$x||V.x||{},this[D]=!0}var k=P.prototype;return k.parse=function(V){this.$d=function(x){var j=x.date,O=x.utc;if(j===null)return new Date(NaN);if(p.u(j))return new Date;if(j instanceof Date)return new Date(j);if(typeof j=="string"&&!/Z$/i.test(j)){var n=j.match(L);if(n){var g=n[2]-1||0,N=(n[7]||"0").substring(0,3);return O?new Date(Date.UTC(n[1],g,n[3]||1,n[4]||0,n[5]||0,n[6]||0,N)):new Date(n[1],g,n[3]||1,n[4]||0,n[5]||0,n[6]||0,N)}}return new Date(j)}(V),this.init()},k.init=function(){var V=this.$d;this.$y=V.getFullYear(),this.$M=V.getMonth(),this.$D=V.getDate(),this.$W=V.getDay(),this.$H=V.getHours(),this.$m=V.getMinutes(),this.$s=V.getSeconds(),this.$ms=V.getMilliseconds()},k.$utils=function(){return p},k.isValid=function(){return this.$d.toString()!==C},k.isSame=function(V,x){var j=A(V);return this.startOf(x)<=j&&j<=this.endOf(x)},k.isAfter=function(V,x){return A(V)<this.startOf(x)},k.isBefore=function(V,x){return this.endOf(x)<A(V)},k.$g=function(V,x,j){return p.u(V)?this[x]:this.set(j,V)},k.unix=function(){return Math.floor(this.valueOf()/1e3)},k.valueOf=function(){return this.$d.getTime()},k.startOf=function(V,x){var j=this,O=!!p.u(x)||x,n=p.p(V),g=function(K,Q){var M=p.w(j.$u?Date.UTC(j.$y,Q,K):new Date(j.$y,Q,K),j);return O?M:M.endOf(d)},N=function(K,Q){return p.w(j.toDate()[K].apply(j.toDate("s"),(O?[0,0,0,0]:[23,59,59,999]).slice(Q)),j)},w=this.$W,G=this.$M,B=this.$D,F="set"+(this.$u?"UTC":"");switch(n){case T:return O?g(1,0):g(31,11);case t:return O?g(1,G):g(0,G+1);case v:var J=this.$locale().weekStart||0,q=(w<J?w+7:w)-J;return g(O?B-q:B+(6-q),G);case d:case y:return N(F+"Hours",0);case u:return N(F+"Minutes",1);case S:return N(F+"Seconds",2);case f:return N(F+"Milliseconds",3);default:return this.clone()}},k.endOf=function(V){return this.startOf(V,!1)},k.$set=function(V,x){var j,O=p.p(V),n="set"+(this.$u?"UTC":""),g=(j={},j[d]=n+"Date",j[y]=n+"Date",j[t]=n+"Month",j[T]=n+"FullYear",j[u]=n+"Hours",j[S]=n+"Minutes",j[f]=n+"Seconds",j[o]=n+"Milliseconds",j)[O],N=O===d?this.$D+(x-this.$W):x;if(O===t||O===T){var w=this.clone().set(y,1);w.$d[g](N),w.init(),this.$d=w.set(y,Math.min(this.$D,w.daysInMonth())).$d}else g&&this.$d[g](N);return this.init(),this},k.set=function(V,x){return this.clone().$set(V,x)},k.get=function(V){return this[p.p(V)]()},k.add=function(V,x){var j,O=this;V=Number(V);var n=p.p(x),g=function(G){var B=A(O);return p.w(B.date(B.date()+Math.round(G*V)),O)};if(n===t)return this.set(t,this.$M+V);if(n===T)return this.set(T,this.$y+V);if(n===d)return g(1);if(n===v)return g(7);var N=(j={},j[S]=e,j[u]=r,j[f]=1e3,j)[n]||1,w=this.$d.getTime()+V*N;return p.w(w,this)},k.subtract=function(V,x){return this.add(-1*V,x)},k.format=function(V){var x=this,j=this.$locale();if(!this.isValid())return j.invalidDate||C;var O=V||"YYYY-MM-DDTHH:mm:ssZ",n=p.z(this),g=this.$H,N=this.$m,w=this.$M,G=j.weekdays,B=j.months,F=j.meridiem,J=function(Q,M,Y,W){return Q&&(Q[M]||Q(x,O))||Y[M].slice(0,W)},q=function(Q){return p.s(g%12||12,Q,"0")},K=F||function(Q,M,Y){var W=Q<12?"AM":"PM";return Y?W.toLowerCase():W};return O.replace(i,function(Q,M){return M||function(Y){switch(Y){case"YY":return String(x.$y).slice(-2);case"YYYY":return p.s(x.$y,4,"0");case"M":return w+1;case"MM":return p.s(w+1,2,"0");case"MMM":return J(j.monthsShort,w,B,3);case"MMMM":return J(B,w);case"D":return x.$D;case"DD":return p.s(x.$D,2,"0");case"d":return String(x.$W);case"dd":return J(j.weekdaysMin,x.$W,G,2);case"ddd":return J(j.weekdaysShort,x.$W,G,3);case"dddd":return G[x.$W];case"H":return String(g);case"HH":return p.s(g,2,"0");case"h":return q(1);case"hh":return q(2);case"a":return K(g,N,!0);case"A":return K(g,N,!1);case"m":return String(N);case"mm":return p.s(N,2,"0");case"s":return String(x.$s);case"ss":return p.s(x.$s,2,"0");case"SSS":return p.s(x.$ms,3,"0");case"Z":return n}return null}(Q)||n.replace(":","")})},k.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},k.diff=function(V,x,j){var O,n=this,g=p.p(x),N=A(V),w=(N.utcOffset()-this.utcOffset())*e,G=this-N,B=function(){return p.m(n,N)};switch(g){case T:O=B()/12;break;case t:O=B();break;case l:O=B()/3;break;case v:O=(G-w)/6048e5;break;case d:O=(G-w)/864e5;break;case u:O=G/r;break;case S:O=G/e;break;case f:O=G/1e3;break;default:O=G}return j?O:p.a(O)},k.daysInMonth=function(){return this.endOf(t).$D},k.$locale=function(){return _[this.$L]},k.locale=function(V,x){if(!V)return this.$L;var j=this.clone(),O=b(V,x,!0);return O&&(j.$L=O),j},k.clone=function(){return p.w(this.$d,this)},k.toDate=function(){return new Date(this.valueOf())},k.toJSON=function(){return this.isValid()?this.toISOString():null},k.toISOString=function(){return this.$d.toISOString()},k.toString=function(){return this.$d.toUTCString()},P}(),U=m.prototype;return A.prototype=U,[["$ms",o],["$s",f],["$m",S],["$H",u],["$W",d],["$M",t],["$y",T],["$D",y]].forEach(function(P){U[P[1]]=function(k){return this.$g(k,P[0],P[1])}}),A.extend=function(P,k){return P.$i||(P(k,m,A),P.$i=!0),A},A.locale=b,A.isDayjs=E,A.unix=function(P){return A(1e3*P)},A.en=_[h],A.Ls=_,A.p={},A}()},function(H,c,a){Object.defineProperty(c,"__esModule",{value:!0});var e=a(34),r=a(16),o=a(12);c.default={TUICallEngine:e.default,TUICallEvent:r.TUICallEvent,TUICallType:o.TUICallType,TUICallCameraPosition:o.TUICallCameraPosition}},function(H,c,a){var e=this&&this.__assign||function(){return(e=Object.assign||function(O){for(var n,g=1,N=arguments.length;g<N;g++)for(var w in n=arguments[g])Object.prototype.hasOwnProperty.call(n,w)&&(O[w]=n[w]);return O}).apply(this,arguments)},r=this&&this.__decorate||function(O,n,g,N){var w,G=arguments.length,B=G<3?n:N===null?N=Object.getOwnPropertyDescriptor(n,g):N;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(O,n,g,N);else for(var F=O.length-1;F>=0;F--)(w=O[F])&&(B=(G<3?w(B):G>3?w(n,g,B):w(n,g))||B);return G>3&&B&&Object.defineProperty(n,g,B),B},o=this&&this.__metadata||function(O,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(O,n)},f=this&&this.__awaiter||function(O,n,g,N){return new(g||(g=Promise))(function(w,G){function B(q){try{J(N.next(q))}catch(K){G(K)}}function F(q){try{J(N.throw(q))}catch(K){G(K)}}function J(q){var K;q.done?w(q.value):(K=q.value,K instanceof g?K:new g(function(Q){Q(K)})).then(B,F)}J((N=N.apply(O,n||[])).next())})},S=this&&this.__generator||function(O,n){var g,N,w,G,B={label:0,sent:function(){if(1&w[0])throw w[1];return w[1]},trys:[],ops:[]};return G={next:F(0),throw:F(1),return:F(2)},typeof Symbol=="function"&&(G[Symbol.iterator]=function(){return this}),G;function F(J){return function(q){return function(K){if(g)throw new TypeError("Generator is already executing.");for(;B;)try{if(g=1,N&&(w=2&K[0]?N.return:K[0]?N.throw||((w=N.return)&&w.call(N),0):N.next)&&!(w=w.call(N,K[1])).done)return w;switch(N=0,w&&(K=[2&K[0],w.value]),K[0]){case 0:case 1:w=K;break;case 4:return B.label++,{value:K[1],done:!1};case 5:B.label++,N=K[1],K=[0];continue;case 7:K=B.ops.pop(),B.trys.pop();continue;default:if(w=B.trys,!((w=w.length>0&&w[w.length-1])||K[0]!==6&&K[0]!==2)){B=0;continue}if(K[0]===3&&(!w||K[1]>w[0]&&K[1]<w[3])){B.label=K[1];break}if(K[0]===6&&B.label<w[1]){B.label=w[1],w=K;break}if(w&&B.label<w[2]){B.label=w[2],B.ops.push(K);break}w[2]&&B.ops.pop(),B.trys.pop();continue}K=n.call(O,B)}catch(Q){K=[6,Q],N=0}finally{g=w=0}if(5&K[0])throw K[1];return{value:K[0]?K[1]:void 0,done:!0}}([J,q])}}},u=this&&this.__spreadArrays||function(){for(var O=0,n=0,g=arguments.length;n<g;n++)O+=arguments[n].length;var N=Array(O),w=0;for(n=0;n<g;n++)for(var G=arguments[n],B=0,F=G.length;B<F;B++,w++)N[w]=G[B];return N};Object.defineProperty(c,"__esModule",{value:!0});var d=a(35),v=a(8),t=a(1),l=a(36),T=a(20),y=a(39),C=a(40),L=a(13),i=a(29),s=a(18),R=a(5),I=a(60),h=a(2),_=a(6),D=a(9),E=a(10),b=a(7),A=a(11),p=a(0),m=a(61),U=a(68),P=a(70),k=a(72),V=(a(12),a(19)),x=v.default({clsConfig:{endpoint:k.CLS_ENDPOINT,topicId:k.CLS_TOPIC_ID}}),j=function(){function O(n){this._roomID=0,this._strRoomId="",this._quality="1080p",this._localPlayOptions={rotation:D.TRTCVideoRotation.TRTCVideoRotation0,fillMode:D.TRTCVideoFillMode.TRTCVideoFillMode_Fill,mirrorType:D.TRTCVideoMirrorType.TRTCVideoMirrorType_Enable,muted:!0},this._remotePlayOptions={rotation:D.TRTCVideoRotation.TRTCVideoRotation0,fillMode:D.TRTCVideoFillMode.TRTCVideoFillMode_Fill,mirrorType:D.TRTCVideoMirrorType.TRTCVideoMirrorType_Disable,muted:!1},this._initialCallId="",this._isEnableMultiDeviceAbility=!1,this._logLevel=h.LOGLEVEL_INFO,this._component=17,this._sdkAppID=n.SDKAppID,this._isLogin=!1,this._trtcClient=null,this._userID="",this._userSig="",this._switchCallModeStatus=!0,this._timExternal=!1,this._inviterInviteID={},this._audioVideoSwitchIdList=[],this._acceptedUserObject={},this._callTimeout=30,this._callStatus=_.CALL_STATUS.IDLE,this._callType=_.CALL_TYPE.UNKNOWN,this._isInviter=!1,this._isGroupCall=!1,this._inviteeList=[],this._unHandledInviteeList=[],this._handledInviteeList=[],sessionStorage.setItem("sdkAppId",""+this._sdkAppID),this._language=n.language,this._initLogger(n),n.component&&this.setComponent(n.component),this._netMonitor=new I.default,this._outerEmitter=new d.default,this._delegate=new C.default(this._outerEmitter),this._callDataReport=new U.CallDataReport({version:V.version,sdkAppId:n.SDKAppID}),this._dataReportObserver=new U.TUICallEngineObserver(this._outerEmitter,this._callDataReport),this._connectStartTime=0,n.tim&&(this._timExternal=!0,t.isFunction(n.tim.addSignalingListener)||(this._logger.info("constructor.start",{text:{data:n},type:"api"}),h.default.error("constructor.start, you need to pass in an instance of @tencentcloud/chat, please use @tencentcloud/chat instead of tim-js-sdk. 需要传入 @tencentcloud/chat 的实例"))),this.tim=n.tim||T.create(n),this._tsignalingClient=new y.default(this,e(e({},n),{tim:this.tim,isRejectNotifyAll:!0})),this.setLogLevel(this._logLevel),this._callRecordReport=new P.CallRecordReport({version:V.version,tim:this.tim}),this._recordReportObserver=new P.TUICallEngineRecordObserver(this._outerEmitter,this._callRecordReport);var g=new L.default(i.default.SDK_CONSTRUCT);this._eventStatController=new s.default,L.default.bindController(this._eventStatController),g.setText("version="+V.version+"-ua="+R.USER_AGENT).setEnd(),this._logger.info("constructor.start",{text:{data:n},type:"api"}),h.default.info("SDK Version:"+V.version+", SDKAppID:"+n.SDKAppID+".")}return O.prototype._initLogger=function(n){var g=this;this._logger=x,this._logger.updateGetReportData(function(){return{app:"TUICallEngine-web",version:V.version,useragent:{userAgent:window.navigator.userAgent,language:window.navigator.language,platform:window.navigator.platform},platform:p.NAME.WEB,sdkappid:n.SDKAppID,time:+new Date,userid:g.getUserId(),callinfo:{roomid:g.getRoomId(),inviteid:g.getInitialCallId(),callrole:g.isInviter()?p.NAME.INVITER:p.NAME.INVITEE,groupid:g.getGroupId(),calltype:g.getCallType(),handledInviteeList:g.getHandledInviteeList(),unHandledInviteeList:g.getUnHandledInviteeList()},callkitversion:n.callkitVersion||p.NAME.UNKNOWN,framework:n.frameWork||p.NAME.UNKNOWN,isfromchat:n.chat?"true":"false"}})},O.prototype.getTrtcClient=function(){var n;return(n=this._trtcClient)===null||n===void 0?void 0:n.getClient()},O.prototype.getCallType=function(){return this._callType},O.prototype.setCallType=function(n){this._callType=n},O.prototype.isInviter=function(){return this._isInviter},O.prototype.setConnectStartTime=function(n){this._connectStartTime=n},O.prototype.getConnectStartTime=function(){return this._connectStartTime},O.prototype.getInviteeList=function(){return this._inviteeList},O.prototype.setInviteeList=function(n){this._inviteeList=u(n)},O.prototype.getCallDataReport=function(){return this._callDataReport},O.prototype.getCallRecordReport=function(){return this._callRecordReport},O.prototype.getUnHandledInviteeList=function(){return this._unHandledInviteeList||[]},O.prototype.setUnHandledInviteeList=function(n){this._unHandledInviteeList=u(n),h.default.log("setUnHandledInviteeList",this._unHandledInviteeList)},O.prototype.addUnHandledInviteeList=function(n){var g=this;n===void 0&&(n=[]),n.length!==0&&n.forEach(function(N){g._unHandledInviteeList.indexOf(N)===-1&&g._unHandledInviteeList.push(N)})},O.prototype.deleteUnHandledInviteeList=function(n){var g=this;n===void 0&&(n=[]),n.length!==0&&n.forEach(function(N){g._unHandledInviteeList=g._unHandledInviteeList.filter(function(w){return w!==N})})},O.prototype.getHandledInviteeList=function(){return this._handledInviteeList||[]},O.prototype.setHandledInviteeList=function(n){this._handledInviteeList=u(n),h.default.log("setHandledInviteeList",this._handledInviteeList)},O.prototype.addHandledInviteeList=function(n){var g=this;n===void 0&&(n=[]),n.length!==0&&n.forEach(function(N){g._handledInviteeList.indexOf(N)===-1&&g._handledInviteeList.push(N)})},O.prototype.deleteHandledInviteeList=function(n){var g=this;n===void 0&&(n=[]),n.length!==0&&n.forEach(function(N){g._handledInviteeList=g._handledInviteeList.filter(function(w){return w!==N})})},O.prototype.isGroupCall=function(){return this._isGroupCall},O.prototype.setIsGroupCall=function(n){this._isGroupCall=n},O.prototype.getGroupId=function(){return this._groupID},O.prototype.setGroupId=function(n){this._groupID=n},O.prototype.setLocalPlayOptions=function(n){n===void 0&&(n={}),this._localPlayOptions=e(e({},this._localPlayOptions),n)},O.prototype.getLocalPlayOptions=function(){return this._localPlayOptions||{}},O.prototype.setRemotePlayOptions=function(n){n===void 0&&(n={}),this._remotePlayOptions=e(e({},this._remotePlayOptions),n)},O.prototype.getRemotePlayOptions=function(){return this._remotePlayOptions||{}},O.prototype.addAcceptedUserList=function(n,g){var N=this;if(g.length!==0)if(n)(this._acceptedUserObject[n]||[]).length===0?this._acceptedUserObject[n]=g:g.forEach(function(J){N._acceptedUserObject[n].indexOf(J)===-1&&N._acceptedUserObject[n].push(J)});else for(var w=this.getInviterInviteIdList(),G=function(J){var q=w[J],K=B.getInviterInviteIdUserList(q),Q=g.filter(function(M){return K.indexOf(M)!==-1});(B._acceptedUserObject[q]||[]).length===0?B._acceptedUserObject[q]=Q:Q.forEach(function(M){N._acceptedUserObject[q].indexOf(M)===-1&&N._acceptedUserObject[q].push(M)})},B=this,F=0;F<w.length;F++)G(F)},O.prototype.getAcceptedUserList=function(n){return this._acceptedUserObject[n]||[]},O.prototype.setIsLogin=function(n){this._isLogin=n},O.prototype.getIsLogin=function(){return this._isLogin},O.createInstance=function(n){return x.updateEsConfig({url:k.ES_URL+"?sdkappid="+(n==null?void 0:n.SDKAppID),table:k.ES_TABLE}),O.instance||(O.instance=new O(n)),O.instance},O.prototype.destroyInstance=function(){var n,g;return f(this,void 0,void 0,function(){return S(this,function(N){switch(N.label){case 0:return this.getIsLogin()?this._timExternal?[4,this.logout()]:[3,2]:[3,4];case 1:return N.sent(),[3,4];case 2:return[4,this.tim.destroy()];case 3:N.sent(),N.label=4;case 4:return this._callDataReport.reset(),this._dataReportObserver.removeLister(),this._callRecordReport.reset(),this._recordReportObserver.removeLister(),(n=this._trtcClient)===null||n===void 0||n.removeTRTCEvents(),this._trtcClient=null,(g=this._tsignalingClient)===null||g===void 0||g.removeTSignalEvents(),this._tsignalingClient=null,O.instance=null,[2]}})})},O.prototype.setLogLevel=function(n){h.default.info("setLogLevel level: "+n),this._logLevel=n,h.default.setLevel(n),this._tsignalingClient&&this._tsignalingClient.setLogLevel(n),this._trtcClient&&this._trtcClient.setLogLevel(n)},O.prototype.on=function(n,g,N){this._outerEmitter.on(n,g,N||this)},O.prototype.off=function(n,g,N){this._outerEmitter.off(n,g,N||this)},O.prototype.init=function(n){return f(this,void 0,void 0,function(){return S(this,function(g){return[2,this.login(n)]})})},O.prototype.login=function(n){return f(this,void 0,void 0,function(){var g,N,w,G,B;return S(this,function(F){switch(F.label){case 0:if(this._logger.updateGetReportData(function(){return{userid:n.userID}}),this._logger.info("login.start",{text:{data:e(e({},n),{userSig:""})},type:"api"}),this.getIsLogin())return this._logger.warn("login.fail",{text:{error:"userId has been login"},type:"api"}),h.default.warn("login - userId has been login"),[2];F.label=1;case 1:return F.trys.push([1,4,,5]),h.default.log("login - params:",n),this._netMonitor.start(),g=n.userID,N=n.userSig,w=n.assetsPath,this._userID=g,this._callDataReport.setUserID(g),this._userSig=N,this._trtcClient=new l.default({sdkAppID:this._sdkAppID,userID:g,userSig:N,tuiCallEngine:this,assetsPath:w,logLevel:this._logLevel}),sessionStorage.setItem("userId",""+this._userID),[4,this._tsignalingClient.login({userID:g,userSig:N})];case 2:return G=F.sent(),this.setIsLogin(!0),[4,this.setSelfIMCallStatus(_.CALL_STATUS.IDLE)];case 3:return F.sent(),[2,G];case 4:throw B=F.sent(),this._logger.error("login.fail",{text:{error:B},type:"api"}),new Error("login - userId: "+this._userID+" login failed, error: "+B+" ");case 5:return[2]}})})},O.prototype.logout=function(){var n;return f(this,void 0,void 0,function(){var g;return S(this,function(N){switch(N.label){case 0:if(this._logger.info("logout.start",{text:{data:{userID:this._userID,timExternal:this._timExternal}},type:"api"}),h.default.debug("logout"),!this.getIsLogin())return[2];this._userID="",this._userSig="",N.label=1;case 1:return N.trys.push([1,5,,6]),[4,this._resetTUICallEngine()];case 2:return N.sent(),(n=this._trtcClient)===null||n===void 0||n.removeTRTCEvents(),this._trtcClient=null,this.setIsLogin(!1),this._timExternal?[3,4]:[4,this._tsignalingClient.logout()];case 3:N.sent(),N.label=4;case 4:return[2,!0];case 5:throw g=N.sent(),this._logger.error("logout.fail",{text:{data:{userID:this._userID},error:g},type:"api"}),new Error("logout failed, error: "+g+" ");case 6:return[2]}})})},O.prototype.call=function(n){var g,N;return f(this,void 0,void 0,function(){var w,G,B,F,J,q,K,Q,M,Y,W,X;return S(this,function(z){switch(z.label){case 0:return this._logger.info("call.start",{text:{data:n},type:"api"}),h.default.info("call - params:",n),[4,this.getSelfIMCallStatus([this.getUserId()])];case 1:if((w=z.sent())!==_.CALL_STATUS.IDLE)throw this._logger.error("call.failed",{text:{data:{params:n,customStatus:w}},type:"api"}),new E.default({code:b.default.ERROR_REQUEST_REFUSED,messageParams:{value:w},fnName:"call"});return this._callDataReport.setAbilityBit(!0),this._callDataReport.setCallScene(p.NAME.SINGLE_CALL),[4,(g=this._trtcClient)===null||g===void 0?void 0:g.getMediaDevicesAuth({audio:!0})];case 2:if(z.sent(),G=n.userID,B=n.type,F=n.offlinePushInfo,J=n.roomID,q=n.strRoomID,K=n.timeout,Q=n.userData,this.getUserId()===G)throw this._logger.error("call.fail",{text:{error:"Called id can not be yourself. userId:"+this.getUserId()+", inviteeId:"+G},type:"api"}),h.default.error("call failed. Called id can't be yourself. userId:"+this.getUserId()+", inviteeId:"+G),new Error("call failed. Called id can't be yourself. userId:"+this.getUserId()+", inviteeId:"+G);this._callStatus=_.CALL_STATUS.CALLING,this._callType=B,this._isInviter=!0,this._inviterID=this._userID,this._inviteeID=G,this._isGroupCall=!1,this.setGroupId(""),this.analyzeAndSetRoomId(J,q),this._callTimeout=t.isUndefined(K)?this._callTimeout:K,M={callType:p.NAME.SINGLE,mediaType:B,inviteeList:[G]},z.label=3;case 3:return z.trys.push([3,9,,11]),[4,(N=this._trtcClient)===null||N===void 0?void 0:N.enterRoom({roomId:this.getRoomId(),strRoomId:this.getStrRoomId()})];case 4:return z.sent(),this._callDataReport.setEnterRoomTime(new Date().getTime()),this._tsignalingClient.setTSignalingIsJoined(!0),Y=this._callDataReport.getCallData(),Y=e(e({},Y),{roomID:this.getRoomId(),callRole:_.CALL_ROLE.INVITER,callType:this._callType,inviteeList:[G]}),this._callDataReport.setCallData(Y),[4,this._tsignalingClient.invite({userID:G,type:B,roomId:this.getRoomId(),strRoomId:this.getStrRoomId(),timeout:this._callTimeout,offlinePushInfo:F,userIDList:[G],userData:Q})];case 5:return W=z.sent(),this._callDataReport.setSendSignalingTime(new Date().getTime()),this.setHandledInviteeList([this._userID]),this.setUnHandledInviteeList([G]),W.code!==0?[3,6]:(this.addInviterInviteId(W.inviteID,[this._userID,G]),this._callDataReport.setInviteID(W.inviteID),this.setInitialCallId(W.inviteID),this._callRecordUpload(e({eventType:p.NAME.START_CALL},M)),this._callRecordReport.startHeartbeat(),[3,8]);case 6:return this._callDataReport.setCodeAndMessage(W.code,W.message),this._callDataReport.uploadToKibana(),this._callRecordUpload(e({eventType:p.NAME.CALL_FAILED},M)),this._logger.error("call.fail",{text:{error:W},type:"api"}),[4,this._resetTUICallEngine()];case 7:z.sent(),z.label=8;case 8:return[2,W];case 9:return(X=z.sent()).getCode?this._callDataReport.setCodeAndMessage(X.getCode(),X.message):X.code===b.default.ERROR_BLACKLIST?(this._delegate.onError(b.default.ERROR_BLACKLIST,X.message),this._callDataReport.setCodeAndMessage(b.default.ERROR_BLACKLIST,X.message)):this._callDataReport.setCodeAndMessage(b.default.UNKNOWN,JSON.stringify(X)),this._callDataReport.uploadToKibana(),this._callRecordUpload(e({eventType:p.NAME.CALL_FAILED},M)),this._logger.error("call.fail",{text:{error:X},type:"api"}),[4,this._resetTUICallEngine()];case 10:throw z.sent(),new E.default({message:"<call>: failed "+X.message,code:X.code});case 11:return[2]}})})},O.prototype.reportLog=function(n){var g,N;try{if(t.isObject(n)){var w=n||{},G=w.name,B=G===void 0?"":G,F=w.data,J=w.error,q=w.type,K=q===void 0?"api":q,Q=w.level,M=Q===void 0?"info":Q,Y=M==="error"?{error:J,data:F}:{data:F};(N=(g=this._logger)===null||g===void 0?void 0:g[M])===null||N===void 0||N.call(g,B,{text:Y,type:K})}}catch(W){console.debug("reportLog fail: ",W)}},O.prototype.addAudioVideoSwitchIdList=function(n){n&&this._audioVideoSwitchIdList.push(n)},O.prototype.getAudioVideoSwitchIdList=function(){return this._audioVideoSwitchIdList||[]},O.prototype.addInviterInviteId=function(n,g){g.length!==0&&((this._inviterInviteID[n]||[]).length===0?this._inviterInviteID[n]=g:this._inviterInviteID[n]=u(this._inviterInviteID[n],g))},O.prototype.getInviterInviteIdList=function(){return Object.keys(this._inviterInviteID||{})},O.prototype.getTotalInviterInviteIdList=function(){var n=this.getInviterInviteIdList();return u(this._audioVideoSwitchIdList,n)},O.prototype.getInviterInviteIdUserList=function(n){var g=this,N=[];return n?N=this._inviterInviteID[n]||[]:this.getInviterInviteIdList().forEach(function(w){N=u(N,g.getInviterInviteIdUserList(w))}),N},O.prototype.getInviterID=function(){return this._inviterID},O.prototype.setInviterID=function(n){this._inviterID=n},O.prototype.groupCall=function(n){var g,N;return f(this,void 0,void 0,function(){var w,G,B,F,J,q,K,Q,M,Y,W,X;return S(this,function(z){switch(z.label){case 0:return this._logger.info("groupCall.start",{text:{data:n},type:"api"}),h.default.debug("groupCall - params:",n),[4,this.getSelfIMCallStatus([this.getUserId()])];case 1:if((w=z.sent())!==_.CALL_STATUS.IDLE)throw this._logger.error("groupCall.failed",{text:{data:{params:n,customStatus:w}},type:"api"}),new E.default({code:b.default.ERROR_REQUEST_REFUSED,messageParams:{value:w},fnName:"groupCall"});return[4,(g=this._trtcClient)===null||g===void 0?void 0:g.getMediaDevicesAuth({audio:!0})];case 2:if(z.sent(),G=n.userIDList,B=n.type,F=n.groupID,J=n.offlinePushInfo,q=n.roomID,K=n.strRoomID,Q=n.timeout,M=n.userData,(G=u(G)).indexOf(this.getUserId())!==-1)throw h.default.error("groupCall failed. Called list can't contain yourself. userId:"+this.getUserId()+", inviteeIdList:"+G),new Error("groupCall failed. Called list can't contain yourself. userId:"+this.getUserId()+", inviteeIdList:"+G);this._callStatus=_.CALL_STATUS.CALLING,this._callType=B,this._isInviter=!0,this._isGroupCall=!0,this._inviterID=this._userID,this.setGroupId(F||""),this.setInviteeList(G),this.setHandledInviteeList([this._userID]),this.setUnHandledInviteeList(G),this.analyzeAndSetRoomId(q,K),this._callTimeout=t.isUndefined(Q)?this._callTimeout:Q,this._callDataReport.setCallScene(p.NAME.GROUP_CALL),Y={callType:p.NAME.GROUP,mediaType:B,inviteeList:G},z.label=3;case 3:return z.trys.push([3,9,,11]),[4,(N=this._trtcClient)===null||N===void 0?void 0:N.enterRoom({roomId:this.getRoomId(),strRoomId:this.getStrRoomId()})];case 4:return z.sent(),this._tsignalingClient.setTSignalingIsJoined(!0),[4,this._tsignalingClient.inviteInGroup({groupID:this.getGroupId(),userIDList:G,type:B,roomId:this.getRoomId(),strRoomId:this.getStrRoomId(),timeout:this._callTimeout,offlinePushInfo:J,userData:M})];case 5:return W=z.sent(),h.default.log("groupCall res",W),F?W.code!==0?[3,6]:(this.addInviterInviteId(W.inviteID,u([this._userID],G)),this.setInitialCallId(W.inviteID),this._callRecordUpload(e({eventType:p.NAME.START_CALL},Y)),this._callRecordReport.startHeartbeat(),[3,8]):[3,8];case 6:return this._callRecordUpload(e({eventType:p.NAME.CALL_FAILED},Y)),this._logger.error("inviteInGroup.fail",{text:{data:W},type:"api"}),[4,this._resetTUICallEngine()];case 7:z.sent(),z.label=8;case 8:return[2,W];case 9:return X=z.sent(),this._callRecordUpload(e({eventType:p.NAME.CALL_FAILED},Y)),this._logger.error("groupCall.fail",{text:{error:X},type:"api"}),[4,this._resetTUICallEngine()];case 10:throw z.sent(),new E.default({message:"<groupCall>: failed "+X.message,code:X.code});case 11:return[2]}})})},O.prototype.joinInGroupCall=function(n){var g,N;return f(this,void 0,void 0,function(){var w,G,B,F,J,q,K;return S(this,function(Q){switch(Q.label){case 0:return this._logger.info("joinInGroupCall.start",{text:{data:n},type:"api"}),[4,this.getSelfIMCallStatus([this.getUserId()])];case 1:if((w=Q.sent())!==_.CALL_STATUS.IDLE)throw this._logger.error("joinInGroupCall.failed",{text:{data:{params:n,customStatus:w}},type:"api"}),new E.default({code:b.default.ERROR_REQUEST_REFUSED,messageParams:{value:w},fnName:"joinInGroupCall"});return[4,(g=this._trtcClient)===null||g===void 0?void 0:g.getMediaDevicesAuth({audio:!0})];case 2:Q.sent(),Q.label=3;case 3:return Q.trys.push([3,6,,8]),G=n.roomID,B=n.strRoomID,F=n.type,J=n.groupID,this._callType=F,this.setGroupId(J||""),this.analyzeAndSetRoomId(G,B),this._isGroupCall=!0,this._isInviter=!1,this.addHandledInviteeList([this.getUserId()]),this.changeCallStatus(_.CALL_STATUS.CALLING),[4,(N=this._trtcClient)===null||N===void 0?void 0:N.enterRoom({roomId:this.getRoomId(),strRoomId:this.getStrRoomId()})];case 4:return Q.sent(),[4,this.setSelfIMCallStatus(_.CALL_STATUS.CONNECTED)];case 5:return Q.sent(),this.changeCallStatus(_.CALL_STATUS.CONNECTED),this.getCallRecordReport().setBodyStatus(_.CALL_STATUS.CONNECTED),h.default.log("joinInGroupCall roomID:"+G+",type:"+F+",userID:"+this.getUserId()),q={eventType:p.NAME.JOIN_IN_GROUP_CALL,callType:p.NAME.GROUP,mediaType:this._callType},this._callRecordUpload(q),this._callRecordReport.startHeartbeat(),[3,8];case 6:return K=Q.sent(),this._logger.error("joinInGroupCall.fail",{text:{error:K},type:"api"}),[4,this._resetTUICallEngine()];case 7:throw Q.sent(),new Error("joinInGroupCall failed error: "+K);case 8:return[2]}})})},O.prototype.inviteUser=function(n){return f(this,void 0,void 0,function(){var g,N,w,G,B,F,J,q,K,Q,M,Y=this;return S(this,function(W){switch(W.label){case 0:if(this._logger.info("inviteUser.start",{text:{data:n},type:"api"}),!this.isGroupCall())throw this._logger.error("inviteUser.fail",{text:{error:"inviteUser failed",data:n},type:"api"}),h.default.error("inviteUser failed - groupID:"+this.getGroupId()+", roomID:"+this.getRoomId()+", type:"+this._callType),new Error("inviteUser failed - groupID:"+this.getGroupId()+", roomID:"+this.getRoomId()+", type:"+this._callType);if(!this.isInviter()&&this._callStatus!==_.CALL_STATUS.CONNECTED)throw this._logger.error("inviteUser.fail",{text:{error:"current status:"+this._callStatus+" not support"},type:"api"}),h.default.error("inviteUser failed - current status:"+this._callStatus+" not support"),new Error("inviteUser failed - current status:"+this._callStatus+" not support");if(g=n.userIDList,N=g===void 0?[]:g,w=n.offlinePushInfo,N.length===0)throw this._logger.error("inviteUser.fail",{text:{error:"userIDList is empty"},type:"api"}),h.default.error("inviteUser failed - userIDList is empty"),new Error("inviteUser failed - userIDList is empty");if(G=this.getHandledInviteeList(),B=this.getUnHandledInviteeList(),F=u(G,B),(J=N.filter(function(X){return F.indexOf(X)===-1})).length===0)return this._logger.error("inviteUser.fail",{text:{error:"userIDList in call list",data:{userIDList:N,totalUserList:F}},type:"api"}),h.default.error("inviteUser failed - userIDList in call list. userIDList:"+JSON.stringify(N)+", call list:"+JSON.stringify(F)),[2,Promise.reject("inviteUser failed - userIDList in call list. userIDList:"+JSON.stringify(N)+", call list:"+JSON.stringify(F))];N=J,W.label=1;case 1:return W.trys.push([1,3,,4]),q=this._handledInviteeList.filter(function(X){return X!==Y._userID}),[4,this._tsignalingClient.inviteInGroup({groupID:this.getGroupId(),userIDList:N,type:this._callType,roomId:this.getRoomId(),strRoomId:this.getStrRoomId(),timeout:this._callTimeout,inCallUserIDs:u(this._unHandledInviteeList,q),offlinePushInfo:w,initialCallId:this.getInitialCallId()})];case 2:return K=W.sent(),h.default.log("inviteUser res",K),K.code===0?(this.addUnHandledInviteeList(N),this.addInviterInviteId(K.inviteID,u([this._userID],N)),Q={eventType:p.NAME.INVITE_USER,callType:p.NAME.GROUP,mediaType:this._callType,inviteeList:N},this._callRecordUpload(Q)):this._logger.error("inviteUser.fail",{type:"api"}),[2,K];case 3:throw M=W.sent(),new Error("inviteUser failed, userId:"+this.getUserId()+", inviteeIdList:"+N+", error: "+M);case 4:return[2]}})})},O.prototype.accept=function(){var n,g;return f(this,void 0,void 0,function(){var N,w,G,B,F,J,q,K,Q;return S(this,function(M){switch(M.label){case 0:return this._logger.info("accept.start",{text:{data:{callStatus:this.getCallStatus(),inviteData:this._tsignalingClient.getInviteData()},type:"api"}}),h.default.debug("accept"),this.getCallStatus()===_.CALL_STATUS.CONNECTED?(this._logger.error("accept.fail",{text:{error:"already connected, avoid repeat accept"},type:"api"}),h.default.warn("accept - already connected, avoid repeat accept"),[2]):this._tsignalingClient.getInviteData()?(this._callDataReport.setCallAcceptTime(new Date().getTime()),[4,(n=this._trtcClient)===null||n===void 0?void 0:n.getMediaDevicesAuth({audio:!0})]):(this._logger.error("accept.fail",{text:{error:"there are no calls to accept"},type:"api"}),h.default.warn("accept - there are no calls to accept"),[2]);case 1:return M.sent().audio?[3,3]:[4,this._resetTUICallEngine()];case 2:M.sent(),M.label=3;case 3:N=this._tsignalingClient.getInviteData(),w=N.inviteID,G=N.inviteData,B=G.roomID,F=G.callType,h.default.debug("accept - params","inviteID: "+w+",callType: "+F+",roomID: "+B+"."),this._callType=F,this._callStatus=_.CALL_STATUS.CALLING,console.log("accept roomId: "+B),J={},M.label=4;case 4:return M.trys.push([4,6,,8]),this._callDataReport.setEnterRoomTime(new Date().getTime()),[4,(g=this._trtcClient)===null||g===void 0?void 0:g.enterRoom({roomId:this.getRoomId(),strRoomId:this.getStrRoomId()})];case 5:return M.sent(),this.addHandledInviteeList([this.getUserId()]),this.deleteUnHandledInviteeList([this.getUserId()]),this.addAcceptedUserList(w,[this.getUserId()]),this._tsignalingClient.setInviteData(null),this.changeCallStatus(_.CALL_STATUS.CONNECTED),this.getCallRecordReport().setBodyStatus(_.CALL_STATUS.CONNECTED),[3,8];case 6:return q=M.sent(),this.isGroupCall()||(q.getCode?this._callDataReport.setCodeAndMessage(q.getCode(),q.message):this._callDataReport.setCodeAndMessage(b.default.UNKNOWN,JSON.stringify(q)),this._callDataReport.uploadToKibana()),this._logger.error("accept.join.fail",{text:{error:q},type:"api"}),[4,this._resetTUICallEngine()];case 7:throw M.sent(),new Error("accept failed, error: "+q);case 8:J={roomID:B,callType:F},M.label=9;case 9:return M.trys.push([9,13,,15]),[4,this.modifyInvitation(w)];case 10:return M.sent(),[4,this._tsignalingClient.accept({inviteID:w,callType:F})];case 11:return K=M.sent(),[4,this.setSelfIMCallStatus(_.CALL_STATUS.CONNECTED)];case 12:return M.sent(),this._callRecordUpload({eventType:p.NAME.ACCEPT_CALL}),[3,15];case 13:return Q=M.sent(),this._logger.error("accept.fail",{text:{error:Q},type:"api"}),h.default.error(Q),[4,this._resetTUICallEngine()];case 14:throw M.sent(),this.isGroupCall()||(this._callDataReport.setCodeAndMessage(b.default.UNKNOWN,JSON.stringify(Q)),this._callDataReport.uploadToKibana()),new E.default({message:"<accept>: failed "+Q.message,code:Q.code});case 15:return[2,e(e({},J),K)]}})})},O.prototype.reject=function(){return f(this,void 0,void 0,function(){var n,g,N,w,G,B,F,J;return S(this,function(q){switch(q.label){case 0:if(this._logger.info("reject.start",{text:{data:{inviteData:this._tsignalingClient.getInviteData(),callStatus:this._callStatus},type:"api"}}),!this._tsignalingClient.getInviteData())return h.default.warn("reject - there are no calls to reject"),[2];n=this._callStatus===_.CALL_STATUS.CONNECTED,g=this._tsignalingClient.getInviteData(),N=g.inviteID,w=g.inviteData,G=w.callType,h.default.warn("reject - params","inviteID: "+N+",callType: "+G+",isBusy: "+n+"."),q.label=1;case 1:return q.trys.push([1,5,,6]),[4,this._tsignalingClient.reject({inviteID:N,callType:G,isBusy:n})];case 2:return B=q.sent(),this._callRecordUpload({eventType:p.NAME.REJECT_CALL}),n?[3,4]:(F=this.generateEventData(),[4,this._resetTUICallEngine()]);case 3:q.sent(),this._delegate.onCallingCancel(e(e({userID:this._userID},F),{reason:p.NAME.REJECT})),q.label=4;case 4:return[2,B];case 5:throw J=q.sent(),this._logger.error("reject.fail",{text:{error:J},type:"api"}),new E.default({message:"<reject>: failed "+J.message,code:J.code});case 6:return[2]}})})},O.prototype.hangup=function(){var n;return f(this,void 0,void 0,function(){var g,N,w,G,B,F,J,q,K,Q,M,Y,W,X,z,ne,ae,$,te,se;return S(this,function(Z){switch(Z.label){case 0:if(this._logger.info("hangup.start",{text:{data:{inviteData:this._tsignalingClient.getInviteData(),callStatus:this._callStatus,inviterInviteID:this._acceptedUserObject,inviteIdList:this.getInviterInviteIdList(),isInviter:this.isInviter(),isGroupCall:this.isGroupCall(),callType:this.getCallType(),currentUserID:this.getUserId()}},type:"api"}),h.default.warn(" - callStatus:"+this._callStatus+" _inviterInviteID:"+JSON.stringify(this._acceptedUserObject)),this._callStatus===_.CALL_STATUS.IDLE)throw this._logger.error("hangup.fail",{text:{error:"current status:"+this._callStatus,type:"api"}}),new Error("hangup failed. current status:"+this._callStatus);if(this._callStatus===_.CALL_STATUS.CALLING&&this.getInviterInviteIdList().length===0)throw this._logger.error("hangup.fail",{text:{error:"call/groupCall incomplete。please wait cancel"},type:"api"}),new Error("call/groupCall incomplete。please wait cancel");if(g=this.isGroupCall(),N=this.isInviter(),w=this.getUserId(),G=this.generateCallTotalTime(),B=this.getCallType(),J=this.getInviterInviteIdList(),this._callStatus!==_.CALL_STATUS.CONNECTED)return[3,7];Z.label=1;case 1:return Z.trys.push([1,5,,7]),[4,(n=this._trtcClient)===null||n===void 0?void 0:n.exitRoom()];case 2:return Z.sent(),J.length!==0?[3,4]:(Y=this.generateCallEndData({callMediaType:B,totalTime:G}),this._delegate.onCallEnd(Y),[4,this._resetTUICallEngine()]);case 3:Z.sent(),Z.label=4;case 4:return[3,7];case 5:return q=Z.sent(),this._logger.error("hangup.fail",{text:{error:q},type:"api"}),[4,this._resetTUICallEngine()];case 6:throw Z.sent(),new Error(q);case 7:K=this.getHandledInviteeList(),Q=this.getUnHandledInviteeList(),M=this.generateEventData(),Z.label=8;case 8:return Z.trys.push([8,30,,31]),g?[3,15]:(Y=this.generateCallEndData(),N?Q.length!==1?[3,10]:[4,this._cancel()]:[3,12]);case 9:return F=Z.sent(),this._delegate.onCallingCancel(e(e({userID:w},M),{reason:p.NAME.NORMAL})),[3,11];case 10:this._delegate.onCallEnd(Y),Z.label=11;case 11:return[3,13];case 12:this._delegate.onCallEnd(Y),Z.label=13;case 13:return[4,this._resetTUICallEngine()];case 14:return Z.sent(),[3,29];case 15:return W=this.getCallStatus(),X={callType:B,userIDList:u(K.filter(function(le){return le!==w}),Q),callEnd:G},N?W!==_.CALL_STATUS.CALLING?[3,18]:[4,this._cancel(this.getInviterInviteIdList())]:[3,23];case 16:return F=Z.sent(),[4,this._resetTUICallEngine()];case 17:Z.sent(),this._delegate.onCallingCancel(e(e({userID:w},M),{reason:p.NAME.NORMAL})),Z.label=18;case 18:if(W!==_.CALL_STATUS.CONNECTED)return[3,22];z=function(le){var re,oe,ue,ce,de,he;return S(this,function(ie){switch(ie.label){case 0:return re=J[le],oe=ne.getInviterInviteIdUserList(re),(ue=ne.getAcceptedUserList(re)).length>0?(ce=ue.filter(function(ee){return K.indexOf(ee)!==-1}),de=oe.filter(function(ee){return Q.indexOf(ee)!==-1}),X.userIDList=u(ce,de).filter(function(ee){return ee!==w}),h.default.warn("inviter emit hangup signal, notify userIDList:"+JSON.stringify(X.userIDList)),X.userIDList.length===0?[3,2]:[4,ne._tsignalingClient.hangup(X)]):[3,5];case 1:return F=ie.sent(),[3,4];case 2:return K.length>1?(X.userIDList=K.filter(function(ee){return ee!==w}),[4,ne._tsignalingClient.hangup(X)]):[3,4];case 3:F=ie.sent(),ie.label=4;case 4:return[3,7];case 5:return he=ne.getUnHandledInviteeList(),oe.filter(function(ee){return he.indexOf(ee)!==-1}).length>0?(h.default.warn("inviter emit cancel signal, userIdList:"+oe),[4,ne._cancel([re])]):[3,7];case 6:F=ie.sent(),ie.label=7;case 7:return[2]}})},ne=this,te=0,Z.label=19;case 19:return te<J.length?[5,z(te)]:[3,22];case 20:Z.sent(),Z.label=21;case 21:return te++,[3,19];case 22:return[3,27];case 23:ae=function(le){var re,oe,ue,ce,de,he;return S(this,function(ie){switch(ie.label){case 0:return re=J[le],oe=$.getInviterInviteIdUserList(re),(ue=$.getAcceptedUserList(re)).length>0?(ce=ue.filter(function(ee){return K.indexOf(ee)!==-1}),de=oe.filter(function(ee){return Q.indexOf(ee)!==-1}),X.userIDList=u(ce,de).filter(function(ee){return ee!==w}),h.default.warn("invitee emit hangup signal, notify userIDList:"+JSON.stringify(X.userIDList)),X.userIDList.length===0?[3,2]:[4,$._tsignalingClient.hangup(X)]):[3,5];case 1:return F=ie.sent(),[3,4];case 2:return K.length>1?(X.userIDList=K.filter(function(ee){return ee!==w}),[4,$._tsignalingClient.hangup(X)]):[3,4];case 3:F=ie.sent(),ie.label=4;case 4:return[3,7];case 5:return he=$.getUnHandledInviteeList(),oe.filter(function(ee){return he.indexOf(ee)!==-1}).length>0?(h.default.warn("invitee emit cancel signal, inviteID:"+re),[4,$._cancel([re])]):[3,7];case 6:F=ie.sent(),ie.label=7;case 7:return[2]}})},$=this,te=0,Z.label=24;case 24:return te<J.length?[5,ae(te)]:[3,27];case 25:Z.sent(),Z.label=26;case 26:return te++,[3,24];case 27:return[4,this._resetTUICallEngine()];case 28:Z.sent(),Z.label=29;case 29:return[2,F];case 30:throw se=Z.sent(),this._logger.error("hangup.fail",{text:{error:se},type:"api"}),h.default.warn("hangup failed, error: "+se),new Error("hangup failed, error: "+se);case 31:return[2]}})})},O.prototype._cancel=function(n){return f(this,void 0,void 0,function(){var g,N,w,G,B,F;return S(this,function(J){switch(J.label){case 0:this._logger.info("_cancel.start",{text:{data:{inviteIDList:n,inviterInviteID:this._inviterInviteID},type:"api"}}),h.default.info("_cancel _inviterInviteID",this._inviterInviteID),g=[],J.label=1;case 1:return J.trys.push([1,7,,8]),(n||[]).length===0&&(n=this.getInviterInviteIdList().slice(0,1)),[4,this.modifyInvitation(n[0])];case 2:J.sent(),N=0,J.label=3;case 3:return N<n.length?(w=n[N],[4,this._tsignalingClient.cancel({inviteID:w})]):[3,6];case 4:G=J.sent(),g.push(G),J.label=5;case 5:return N++,[3,3];case 6:return[3,8];case 7:throw B=J.sent(),this._logger.error("_cancel.fail",{text:{error:B},type:"api"}),new E.default({message:"<_cancel>: failed "+B.message,code:B.code});case 8:return F="cancel "+JSON.stringify(g)+" succeeded",h.default.log("_cancel "+F),[2,g]}})})},O.prototype.startRemoteView=function(n){var g;return f(this,void 0,void 0,function(){var N,w,G,B;return S(this,function(F){return this._logger.info("startRemoteView.start",{text:{data:n},type:"api"}),h.default.info("startRemoteView - params:",n),N=n.userID,w=n.videoViewDomID,(G=n.options)&&(B=t.analyzeVideoRenderParams(G),this.setRemotePlayOptions(B)),[2,(g=this._trtcClient)===null||g===void 0?void 0:g.startRemoteView({userId:N,videoViewDomId:w,options:G})]})})},O.prototype.stopRemoteView=function(n){var g;return f(this,void 0,void 0,function(){return S(this,function(N){return this._logger.info("stopRemoteView.start",{text:{data:n},type:"api"}),h.default.debug("stopRemoteView - params:",n),[2,(g=this._trtcClient)===null||g===void 0?void 0:g.stopRemoteView({userId:n.userID})]})})},O.prototype.startLocalView=function(n){return f(this,void 0,void 0,function(){return S(this,function(g){return h.default.warn("startLocalView interface is deprecated after v3.0.0"),[2]})})},O.prototype.stopLocalView=function(n){return f(this,void 0,void 0,function(){return S(this,function(g){return h.default.warn("stopLocalView interface is deprecated after v3.0.0"),[2]})})},O.prototype.openCamera=function(n,g){var N,w;return f(this,void 0,void 0,function(){var G;return S(this,function(B){switch(B.label){case 0:return B.trys.push([0,3,,4]),this._logger.info("openCamera.start",{text:{data:{videoViewDomID:n,isFrontCamera:g}},type:"api"}),[4,(N=this._trtcClient)===null||N===void 0?void 0:N.getMediaDevicesAuth({video:!0})];case 1:return B.sent(),[4,(w=this._trtcClient)===null||w===void 0?void 0:w.startLocalPreview(n,g)];case 2:return B.sent(),[3,4];case 3:throw G=B.sent(),this._logger.error("openCamera.fail",{text:{error:G},type:"api"}),h.default.error("openCamera failed. error: "+G),new Error("openCamera failed. error: "+G);case 4:return[2]}})})},O.prototype.closeCamera=function(){var n;return f(this,void 0,void 0,function(){return S(this,function(g){try{return this._logger.info("closeCamera.start",{type:"api"}),[2,(n=this._trtcClient)===null||n===void 0?void 0:n.stopLocalPreview()]}catch(N){throw new Error("closeCamera failed. error: "+N)}return[2]})})},O.prototype.openMicrophone=function(){var n;return f(this,void 0,void 0,function(){return S(this,function(g){switch(g.label){case 0:return this._logger.info("openMicrophone.start",{type:"api"}),[4,(n=this._trtcClient)===null||n===void 0?void 0:n.unMuteLocalAudio()];case 1:return g.sent(),[2]}})})},O.prototype.closeMicrophone=function(){var n;return f(this,void 0,void 0,function(){return S(this,function(g){switch(g.label){case 0:return this._logger.info("closeMicrophone.start",{type:"api"}),[4,(n=this._trtcClient)===null||n===void 0?void 0:n.muteLocalAudio()];case 1:return g.sent(),[2]}})})},O.prototype.setVideoQuality=function(n){var g;return f(this,void 0,void 0,function(){return S(this,function(N){switch(N.label){case 0:return this._logger.info("setVideoQuality.start",{text:{data:{profile:n,currentProfile:this.getVideoQuality(),hasTrtcClient:!!this._trtcClient}},type:"api"}),h.default.debug("setVideoQuality - quality:"+JSON.stringify(n)),n===this.getVideoQuality()?(h.default.warn("setVideoQuality failed - profile not change"),[2]):(this._quality=n,[4,(g=this._trtcClient)===null||g===void 0?void 0:g.setVideoEncoderParam(n)]);case 1:return N.sent(),[2]}})})},O.prototype.getVideoQuality=function(){return this._quality},O.prototype.setVideoRenderParams=function(n){var g;return f(this,void 0,void 0,function(){var N;return S(this,function(w){switch(w.label){case 0:return this._logger.info("setVideoRenderParams.start",{text:{data:{params:n,hasTRTCClient:!!this._trtcClient}},type:"api"}),console.warn("setVideoRenderParams params: "+JSON.stringify(n)),N=t.analyzeVideoRenderParams(n),n.userID===this.getUserId()?(this.setLocalPlayOptions(N),N=this.getLocalPlayOptions()):(this.setRemotePlayOptions(N),N=this.getRemotePlayOptions()),[4,(g=this._trtcClient)===null||g===void 0?void 0:g.setVideoRenderParams(e({userId:n.userID},N))];case 1:return w.sent(),[2]}})})},O.prototype.switchCallMediaType=function(n){return f(this,void 0,void 0,function(){var g,N;return S(this,function(w){switch(w.label){case 0:if(this._logger.info("switchCallMediaType.start",{text:{data:{newMediaType:n,currentCallType:this._callType}},type:"api"}),this._callType===n)throw this._logger.error("switchCallMediaType.fail",{text:{error:A.ERROR_MESSAGE.ERROR_REQUEST_REPEATED_SWITCH},type:"api"}),new E.default({message:"<switchCallMediaType>: "+A.ERROR_MESSAGE.ERROR_REQUEST_REPEATED_SWITCH,code:b.default.ERROR_REQUEST_REPEATED});if(!this._switchCallModeStatus)throw this._logger.error("switchCallMediaType.fail",{text:{error:"audio and video call switching"},type:"api"}),new Error("audio and video call switching.");h.default.info("switchCallMediaType",this._inviterID,this._inviteeID),w.label=1;case 1:return w.trys.push([1,3,,4]),[4,this._tsignalingClient.switchCallMode({userID:this._isInviter?this._inviteeID:this._inviterID,callType:this._callType,roomID:this.getRoomId(),timeout:this._callTimeout,mode:n===_.CALL_TYPE.AUDIO_CALL?_.MODE_TYPE.AUDIO:_.MODE_TYPE.VIDEO})];case 2:return g=w.sent(),this.setSwitchCallModeStatus(!1),[2,g];case 3:throw N=w.sent(),this._logger.error("switchCallMediaType.fail",{text:{error:N},type:"api"}),new Error("switchCallMediaType failed, error: "+N);case 4:return[2]}})})},O.prototype.setSwitchCallModeStatus=function(n){this._switchCallModeStatus=n},O.prototype.getSwitchCallModeStatus=function(){return this._switchCallModeStatus},O.prototype.getDeviceList=function(n){return f(this,void 0,void 0,function(){return S(this,function(g){switch(g.label){case 0:return this._logger.info("getDeviceList.start",{text:{data:{deviceType:n}},type:"api"}),(n=n===D.DEVICE_TYPE.MICROPHONES?D.DEVICE_TYPE.MICROPHONE:n)!==D.DEVICE_TYPE.MICROPHONE&&n!==D.DEVICE_TYPE.SPEAKER?[3,2]:[4,this._trtcClient.getMediaDevicesAuth({audio:!0})];case 1:g.sent(),g.label=2;case 2:return n!==D.DEVICE_TYPE.CAMERA?[3,4]:[4,this._trtcClient.getMediaDevicesAuth({video:!0,isThrowVideoError:!0})];case 3:g.sent(),g.label=4;case 4:return[4,this._trtcClient.getDeviceList(n)];case 5:return[2,g.sent()]}})})},O.prototype.getCurrentDevice=function(n){return this._trtcClient.getCurrentDevice(n)},O.prototype.switchCamera=function(n){return f(this,void 0,void 0,function(){return S(this,function(g){switch(g.label){case 0:this._logger.info("switchCamera.start",{text:{data:{cameraPosition:n}},type:"api"}),g.label=1;case 1:return g.trys.push([1,3,,4]),[4,this._trtcClient.switchCamera(n)];case 2:return g.sent(),[3,4];case 3:throw g.sent();case 4:return[2]}})})},O.prototype.switchDevice=function(n){var g;return f(this,void 0,void 0,function(){var N,w;return S(this,function(G){switch(G.label){case 0:return this._logger.info("switchDevice.start",{text:{data:{params:n}},type:"api"}),N=n.deviceType,w=n.deviceId,N===D.DEVICE_TYPE.VIDEO&&(N=D.DEVICE_TYPE.CAMERA),N!==D.DEVICE_TYPE.AUDIO&&N!==D.DEVICE_TYPE.MICROPHONES||(N=D.DEVICE_TYPE.MICROPHONE),h.default.debug("switchDevice - params: deviceType:"+N+",deviceID:"+w),[4,(g=this._trtcClient)===null||g===void 0?void 0:g.switchDevice(N,w)];case 1:return[2,G.sent()]}})})},O.prototype.setSelfInfo=function(n){return f(this,void 0,void 0,function(){var g,N,w;return S(this,function(G){return this._logger.info("setSelfInfo.start",{text:{data:{params:n}},type:"api"}),g=n.nickName,N=n.avatar,w={nick:g,avatar:N},!g&&delete w.nick,!N&&delete w.avatar,h.default.info("setSelfInfo -params: nickName:"+w.nick+",avatar:"+w.avatar),[2,this.tim.updateMyProfile(w)]})})},O.prototype.generateCallEndData=function(n){var g=n||{},N=g.roomId,w=g.callMediaType,G=g.callRole,B=g.totalTime,F=g.userId;return N=N||this.getRoomId(),w=w||this.getCallType(),G||(G=this.isInviter()?_.CALL_ROLE.INVITER:_.CALL_ROLE.INVITEE),B=t.isUndefined(B)?this.generateCallTotalTime():B,F=F||this.getUserId(),{roomID:N,strRoomID:this.getStrRoomId(),callMediaType:w,callRole:G,totalTime:B,userID:F}},O.prototype.generateEventData=function(){return{callID:this.getInviterInviteIdList()[0],roomID:this.getRoomId(),strRoomID:this.getStrRoomId(),callRole:this._isInviter?p.NAME.INVITER:p.NAME.INVITEE,callMediaType:this._callType}},O.prototype.enableMultiDeviceAbility=function(n){this._logger.info("enableMultiDeviceAbility.start",{text:{data:{enable:n}},type:"api"}),this.setIsEnableMultiDeviceAbility(n)},O.prototype.enableAIVoice=function(n){var g;return f(this,void 0,void 0,function(){return S(this,function(N){switch(N.label){case 0:return this._logger.info("enableAIVoice.start",{text:{data:{enable:n}},type:"api"}),this._trtcClient?[4,(g=this._trtcClient)===null||g===void 0?void 0:g.enableAIVoice(n)]:[3,2];case 1:N.sent(),N.label=2;case 2:return[2]}})})},O.prototype.setBlurBackground=function(n){var g;return f(this,void 0,void 0,function(){var N;return S(this,function(w){switch(w.label){case 0:return w.trys.push([0,2,,3]),this._logger.info("setBlurBackground.start",{type:"api",text:{data:{blurLevel:n}}}),[4,(g=this._trtcClient)===null||g===void 0?void 0:g.setVirtualBackground({enable:n!==0,type:p.NAME.BLUR,blurLevel:n})];case 1:return w.sent(),[3,3];case 2:throw N=w.sent(),this._logger.error("setBlurBackground.fail",{text:{error:N},type:"api"}),N;case 3:return[2]}})})},O.prototype.setVirtualBackground=function(n){var g;return f(this,void 0,void 0,function(){var N;return S(this,function(w){switch(w.label){case 0:return w.trys.push([0,2,,3]),this._logger.info("setVirtualBackground.start",{type:"api",text:{data:{imagePath:n}}}),[4,(g=this._trtcClient)===null||g===void 0?void 0:g.setVirtualBackground({enable:!!n,type:p.NAME.IMAGE,imagePath:n})];case 1:return w.sent(),[3,3];case 2:throw N=w.sent(),this._logger.error("setVirtualBackground.fail",{text:{error:N},type:"api"}),N;case 3:return[2]}})})},O.prototype._resetTUICallEngine=function(){var n;return f(this,void 0,void 0,function(){var g;return S(this,function(N){switch(N.label){case 0:return this.getCallStatus()===_.CALL_STATUS.IDLE?[3,2]:(this._callStatus=_.CALL_STATUS.IDLE,this.getIsLogin()?[4,this.setSelfIMCallStatus(_.CALL_STATUS.IDLE)]:[3,2]);case 1:N.sent(),N.label=2;case 2:return h.default.debug("_resetTUICallEngine"),this._roomID=0,this._strRoomId="",this._isInviter=!1,this._isGroupCall=!1,this.setSwitchCallModeStatus(!0),this._groupID="",this._inviteeList=[],this._unHandledInviteeList=[],this._handledInviteeList=[],this._inviterInviteID={},this._initialInviteData={},this._audioVideoSwitchIdList=[],this._acceptedUserObject={},this._connectStartTime=0,this._switchCallModeStatus=!0,this._initialCallId="",this._callTimeout=30,this.setIsEnableMultiDeviceAbility(!1),[4,(n=this._trtcClient)===null||n===void 0?void 0:n.resetTRTCClient()];case 3:return N.sent(),this._tsignalingClient.setInviteData(null),this._tsignalingClient.resetJoined(),(g=document.getElementById("_trtc_calling_layer"))&&(g.innerHTML=""),[2]}})})},O.prototype.getCallStatus=function(){return this._callStatus},O.prototype.changeCallStatus=function(n){this._callStatus!==n&&(this._logger.info("changeCallStatus.start",{text:{data:{newCallStatus:n,currentStatus:this._callStatus}},type:"api"}),h.default.debug("changeCallStatus from "+this._callStatus+" to "+n),this._callStatus=n)},O.prototype.setInitialInviteData=function(n){this._initialInviteData=n},O.prototype.modifyInvitation=function(n){return f(this,void 0,void 0,function(){var g,N;return S(this,function(w){switch(w.label){case 0:if(this.isGroupCall())return[2];g=e(e({},this._initialInviteData.data),{consumed:!0}),w.label=1;case 1:return w.trys.push([1,3,,4]),[4,this.tim.modifyInvitation({inviteID:n,data:JSON.stringify(e(e({},this._initialInviteData),{data:g}))})];case 2:return w.sent(),[3,4];case 3:return N=w.sent(),h.default.error("modifyInvitation fail "+N),[3,4];case 4:return[2]}})})},O.prototype._callRecordUpload=function(n){var g=e(e({},n),{callRole:this.isInviter()?p.NAME.INVITER:p.NAME.INVITEE,userID:this.getUserId(),roomID:this.getRoomId(),inviteID:this.getInitialCallId(),strRoomId:this.getStrRoomId(),groupId:this.getGroupId()});this._callRecordReport.eventUpload(g)},O.prototype.extractCallingInfoFromMessage=function(n){if(!n||n.type!=="TIMCustomElem")return"";var g=JSON.parse(n.payload.data);if(h.default.debug("extractCallingInfoFromMessage - signalingData:",n.payload.data),g.businessID!==_.BUSINESS_ID.SIGNAL)return"";switch(g.actionType){case _.ACTION_TYPE.INVITE:var N=JSON.parse(g.data);return N.call_end>0?"结束通话，通话时长："+t.formatDuration(N.call_end):N.call_end!==0&&N.room_id?"发起通话":"结束群聊";case _.ACTION_TYPE.CANCEL_INVITE:return"取消通话";case _.ACTION_TYPE.ACCEPT_INVITE:return"已接听";case _.ACTION_TYPE.REJECT_INVITE:return"拒绝通话";case _.ACTION_TYPE.INVITE_TIMEOUT:return"无应答";default:return""}},O.prototype.setInitialCallId=function(n){this._initialCallId=n},O.prototype.getInitialCallId=function(){return this._initialCallId},O.prototype.setIsEnableMultiDeviceAbility=function(n){this._isEnableMultiDeviceAbility=!!n},O.prototype.getIsEnableMultiDeviceAbility=function(){return this._isEnableMultiDeviceAbility},O.prototype.generateCallTotalTime=function(){return this.getConnectStartTime()===0?0:Math.round((Date.now()-this.getConnectStartTime())/1e3)},O.prototype.setSelfIMCallStatus=function(n){var g;return f(this,void 0,void 0,function(){var N,w;return S(this,function(G){switch(G.label){case 0:if(this._logger.info("setSelfIMCallStatus.start",{text:{data:{callStatus:n,isEnableMultiDeviceAbility:this.getIsEnableMultiDeviceAbility()}},type:"api"}),!this.getIsEnableMultiDeviceAbility())return[2];if(!this.tim||!n||!this.getIsLogin())return[2];N=_.USER_CUSTOM_STATUS.NULL,G.label=1;case 1:switch(G.trys.push([1,3,,4]),n){case _.CALL_STATUS.CALLING:N=_.USER_CUSTOM_STATUS.CALLING_USER_CUSTOM_STATUS_CALL_WAIT;break;case _.CALL_STATUS.CONNECTED:N=_.USER_CUSTOM_STATUS.CALLING_USER_CUSTOM_STATUS_CALL_ACCEPT}return[4,(g=this.tim)===null||g===void 0?void 0:g.setSelfStatus({customStatus:N})];case 2:return G.sent(),[3,4];case 3:return w=G.sent(),this._logger.error("setSelfIMCallStatus.fail",{text:{error:w},type:"api"}),[3,4];case 4:return[2]}})})},O.prototype.getSelfIMCallStatus=function(n){var g;return n===void 0&&(n=[]),f(this,void 0,void 0,function(){var N,w,G,B;return S(this,function(F){switch(F.label){case 0:if(N=_.CALL_STATUS.IDLE,!this.getIsEnableMultiDeviceAbility())return[2,N];F.label=1;case 1:return F.trys.push([1,3,,4]),this._logger.info("getSelfIMCallStatus.start",{text:{data:n},type:"api"}),this.tim&&n.length!==0&&this.getIsLogin()?[4,(g=this.tim)===null||g===void 0?void 0:g.getUserStatus({userIDList:n})]:[2,N];case 2:if((w=F.sent()).code===0)switch(G=(w.data||{}).successUserList,((G===void 0?[]:G)[0]||{}).customStatus){case _.USER_CUSTOM_STATUS.CALLING_USER_CUSTOM_STATUS_CALL_WAIT:N=_.CALL_STATUS.CALLING;break;case _.USER_CUSTOM_STATUS.CALLING_USER_CUSTOM_STATUS_CALL_ACCEPT:N=_.CALL_STATUS.CONNECTED}return[3,4];case 3:return B=F.sent(),this._logger.error("getSelfIMCallStatus.fail",{text:{error:B},type:"api"}),[3,4];case 4:return[2,N]}})})},O.prototype.setSdkAppId=function(n){this._sdkAppID=n},O.prototype.getSdkAppId=function(){return this._sdkAppID},O.prototype.setUserId=function(n){this._userID=n},O.prototype.getUserId=function(){return this._userID},O.prototype.setRoomId=function(n){this._roomID=n},O.prototype.getRoomId=function(){return this._roomID},O.prototype.setStrRoomId=function(n){this._strRoomId=n},O.prototype.getStrRoomId=function(){return this._strRoomId},O.prototype.analyzeAndSetRoomId=function(n,g){var N=t.analyzeRoomId(n,g);t.isNumber(N)&&this.setRoomId(N),g&&this.setStrRoomId(g)},O.prototype.setUserSig=function(n){this._userSig=n},O.prototype.getUserSig=function(){return this._userSig},O.prototype.getLanguage=function(){return this._language},O.prototype.setComponent=function(n){this._component=n},O.prototype.getComponent=function(){return this._component},O.prototype.getDevicePermission=function(){var n;!((n=this._trtcClient)===null||n===void 0)&&n._getDevicePermission&&this._trtcClient._getDevicePermission()},O.CALL_TYPE=_.CALL_TYPE,r([m.paramValidate(m.VALIDATE_PARAMS.login),o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",Promise)],O.prototype,"init",null),r([m.paramValidate(m.VALIDATE_PARAMS.login),o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",Promise)],O.prototype,"login",null),r([m.avoidRepeatedCall(),m.paramValidate(m.VALIDATE_PARAMS.call),m.statusValidate({init:!0,callStatus:[_.CALL_STATUS.IDLE]}),m.businessValidate(_.CALL_EXPERMENTEL_API_TYPE.BASE),o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",Promise)],O.prototype,"call",null),r([m.avoidRepeatedCall(),m.paramValidate(m.VALIDATE_PARAMS.groupCall),m.statusValidate({init:!0,callStatus:[_.CALL_STATUS.IDLE]}),m.businessValidate(_.CALL_EXPERMENTEL_API_TYPE.PRO),o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",Promise)],O.prototype,"groupCall",null),r([m.paramValidate(m.VALIDATE_PARAMS.joinInGroupCall),m.statusValidate({init:!0,callStatus:[_.CALL_STATUS.IDLE]}),m.businessValidate(_.CALL_EXPERMENTEL_API_TYPE.PRO),o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",Promise)],O.prototype,"joinInGroupCall",null),r([m.paramValidate(m.VALIDATE_PARAMS.inviteUser),m.statusValidate({init:!0,callStatus:[_.CALL_STATUS.CALLING,_.CALL_STATUS.CONNECTED]}),m.businessValidate(_.CALL_EXPERMENTEL_API_TYPE.PRO),o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",Promise)],O.prototype,"inviteUser",null),r([m.avoidRepeatedCall(),m.statusValidate({init:!0,callStatus:[_.CALL_STATUS.CALLING]}),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],O.prototype,"accept",null),r([m.avoidRepeatedCall(),m.statusValidate({init:!0,callStatus:[_.CALL_STATUS.CALLING]}),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],O.prototype,"reject",null),r([m.avoidRepeatedCall(),m.statusValidate({init:!0,callStatus:[_.CALL_STATUS.CALLING,_.CALL_STATUS.CONNECTED]}),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],O.prototype,"hangup",null),r([m.paramValidate(m.VALIDATE_PARAMS.startRemoteView),m.statusValidate({init:!0,callStatus:[_.CALL_STATUS.CONNECTED]}),o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",Promise)],O.prototype,"startRemoteView",null),r([m.paramValidate(m.VALIDATE_PARAMS.stopRemoteView),m.statusValidate({init:!0,callStatus:[_.CALL_STATUS.CONNECTED]}),o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",Promise)],O.prototype,"stopRemoteView",null),r([m.paramValidate(m.VALIDATE_PARAMS.startLocalView),m.statusValidate({init:!0,callStatus:[_.CALL_STATUS.CALLING,_.CALL_STATUS.CONNECTED]}),m.apiCallQueue(),o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",Promise)],O.prototype,"startLocalView",null),r([m.paramValidate(m.VALIDATE_PARAMS.stopLocalView),m.statusValidate({init:!0,callStatus:[_.CALL_STATUS.CALLING,_.CALL_STATUS.CONNECTED]}),m.apiCallQueue(),o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",Promise)],O.prototype,"stopLocalView",null),r([m.paramValidate(m.VALIDATE_PARAMS.openCamera),m.statusValidate({init:!0,callStatus:[_.CALL_STATUS.CALLING,_.CALL_STATUS.CONNECTED]}),o("design:type",Function),o("design:paramtypes",[String,Boolean]),o("design:returntype",Promise)],O.prototype,"openCamera",null),r([m.statusValidate({init:!0,callStatus:[_.CALL_STATUS.CALLING,_.CALL_STATUS.CONNECTED]}),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],O.prototype,"closeCamera",null),r([m.statusValidate({init:!0,callStatus:[_.CALL_STATUS.CALLING,_.CALL_STATUS.CONNECTED]}),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],O.prototype,"openMicrophone",null),r([m.statusValidate({init:!0,callStatus:[_.CALL_STATUS.CALLING,_.CALL_STATUS.CONNECTED]}),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],O.prototype,"closeMicrophone",null),r([m.paramValidate(m.VALIDATE_PARAMS.setVideoQuality),o("design:type",Function),o("design:paramtypes",[String]),o("design:returntype",Promise)],O.prototype,"setVideoQuality",null),r([m.paramValidate(m.VALIDATE_PARAMS.setVideoRenderParams),o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",Promise)],O.prototype,"setVideoRenderParams",null),r([m.paramValidate(m.VALIDATE_PARAMS.switchCallMediaType),m.statusValidate({init:!0,callStatus:[_.CALL_STATUS.CONNECTED,_.CALL_STATUS.CALLING],scene:!0}),o("design:type",Function),o("design:paramtypes",[Number]),o("design:returntype",Promise)],O.prototype,"switchCallMediaType",null),r([m.paramValidate(m.VALIDATE_PARAMS.getDeviceList),m.statusValidate({init:!0}),o("design:type",Function),o("design:paramtypes",[String]),o("design:returntype",Promise)],O.prototype,"getDeviceList",null),r([m.paramValidate(m.VALIDATE_PARAMS.getCurrentDevice),m.statusValidate({init:!0}),o("design:type",Function),o("design:paramtypes",[String]),o("design:returntype",void 0)],O.prototype,"getCurrentDevice",null),r([m.paramValidate(m.VALIDATE_PARAMS.switchCamera),m.statusValidate({init:!0,callStatus:[_.CALL_STATUS.CALLING,_.CALL_STATUS.CONNECTED]}),o("design:type",Function),o("design:paramtypes",[Number]),o("design:returntype",Promise)],O.prototype,"switchCamera",null),r([m.paramValidate(m.VALIDATE_PARAMS.switchDevice),m.statusValidate({init:!0,callStatus:[_.CALL_STATUS.CALLING,_.CALL_STATUS.CONNECTED]}),o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",Promise)],O.prototype,"switchDevice",null),r([m.paramValidate(m.VALIDATE_PARAMS.setSelfInfo),m.statusValidate({init:!0}),o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",Promise)],O.prototype,"setSelfInfo",null),r([m.avoidRepeatedCall(),m.paramValidate(m.VALIDATE_PARAMS.enableMultiDeviceAbility),m.businessValidate(_.CALL_EXPERMENTEL_API_TYPE.PRO),o("design:type",Function),o("design:paramtypes",[Boolean]),o("design:returntype",void 0)],O.prototype,"enableMultiDeviceAbility",null),r([m.statusValidate({init:!0}),o("design:type",Function),o("design:paramtypes",[Boolean]),o("design:returntype",Promise)],O.prototype,"enableAIVoice",null),r([m.statusValidate({init:!0}),m.businessValidate(_.CALL_EXPERMENTEL_API_TYPE.ULTIMATE),o("design:type",Function),o("design:paramtypes",[Number]),o("design:returntype",Promise)],O.prototype,"setBlurBackground",null),r([m.statusValidate({init:!0}),m.businessValidate(_.CALL_EXPERMENTEL_API_TYPE.ULTIMATE),o("design:type",Function),o("design:paramtypes",[String]),o("design:returntype",Promise)],O.prototype,"setVirtualBackground",null),r([m.paramValidate(m.VALIDATE_PARAMS.createInstance),o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],O,"createInstance",null),O}();c.default=j},function(H,c,a){a.r(c),a.d(c,"default",function(){return f});const e=Function.prototype.apply,r=new WeakMap;function o(S){return r.has(S)||r.set(S,{}),r.get(S)}class f{constructor(u=null,d=console){const v=o(this);return v._events=new Set,v._callbacks={},v._console=d,v._maxListeners=u===null?null:parseInt(u,10),this}_addCallback(u,d,v,t){return this._getCallbacks(u).push({callback:d,context:v,weight:t}),this._getCallbacks(u).sort((l,T)=>l.weight>T.weight),this}_getCallbacks(u){return o(this)._callbacks[u]}_getCallbackIndex(u,d){return this._has(u)?this._getCallbacks(u).findIndex(v=>v.callback===d):null}_achieveMaxListener(u){return o(this)._maxListeners!==null&&o(this)._maxListeners<=this.listenersNumber(u)}_callbackIsExists(u,d,v){const t=this._getCallbackIndex(u,d),l=t!==-1?this._getCallbacks(u)[t]:void 0;return t!==-1&&l&&l.context===v}_has(u){return o(this)._events.has(u)}on(u,d,v=null,t=1){const l=o(this);if(typeof d!="function")throw new TypeError(d+" is not a function");return this._has(u)?(this._achieveMaxListener(u)&&l._console.warn(`Max listeners (${l._maxListeners}) for event "${u}" is reached!`),this._callbackIsExists(...arguments)&&l._console.warn(`Event "${u}" already has the callback ${d}.`)):(l._events.add(u),l._callbacks[u]=[]),this._addCallback(...arguments),this}once(u,d,v=null,t=1){const l=(...T)=>(this.off(u,l),e.call(d,v,T));return this.on(u,l,v,t)}off(u,d=null){const v=o(this);let t;return this._has(u)&&(d===null?(v._events.delete(u),v._callbacks[u]=null):(t=this._getCallbackIndex(u,d),t!==-1&&(v._callbacks[u].splice(t,1),this.off(...arguments)))),this}emit(u,...d){return this._has(u)&&this._getCallbacks(u).forEach(v=>e.call(v.callback,v.context,d)),this}clear(){const u=o(this);return u._events.clear(),u._callbacks={},this}listenersNumber(u){return this._has(u)?this._getCallbacks(u).length:null}}},function(H,c,a){var e=this&&this.__assign||function(){return(e=Object.assign||function(D){for(var E,b=1,A=arguments.length;b<A;b++)for(var p in E=arguments[b])Object.prototype.hasOwnProperty.call(E,p)&&(D[p]=E[p]);return D}).apply(this,arguments)},r=this&&this.__awaiter||function(D,E,b,A){return new(b||(b=Promise))(function(p,m){function U(V){try{k(A.next(V))}catch(x){m(x)}}function P(V){try{k(A.throw(V))}catch(x){m(x)}}function k(V){var x;V.done?p(V.value):(x=V.value,x instanceof b?x:new b(function(j){j(x)})).then(U,P)}k((A=A.apply(D,E||[])).next())})},o=this&&this.__generator||function(D,E){var b,A,p,m,U={label:0,sent:function(){if(1&p[0])throw p[1];return p[1]},trys:[],ops:[]};return m={next:P(0),throw:P(1),return:P(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function P(k){return function(V){return function(x){if(b)throw new TypeError("Generator is already executing.");for(;U;)try{if(b=1,A&&(p=2&x[0]?A.return:x[0]?A.throw||((p=A.return)&&p.call(A),0):A.next)&&!(p=p.call(A,x[1])).done)return p;switch(A=0,p&&(x=[2&x[0],p.value]),x[0]){case 0:case 1:p=x;break;case 4:return U.label++,{value:x[1],done:!1};case 5:U.label++,A=x[1],x=[0];continue;case 7:x=U.ops.pop(),U.trys.pop();continue;default:if(p=U.trys,!((p=p.length>0&&p[p.length-1])||x[0]!==6&&x[0]!==2)){U=0;continue}if(x[0]===3&&(!p||x[1]>p[0]&&x[1]<p[3])){U.label=x[1];break}if(x[0]===6&&U.label<p[1]){U.label=p[1],p=x;break}if(p&&U.label<p[2]){U.label=p[2],U.ops.push(x);break}p[2]&&U.ops.pop(),U.trys.pop();continue}x=E.call(D,U)}catch(j){x=[6,j],A=0}finally{b=p=0}if(5&x[0])throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}([k,V])}}},f=this&&this.__spreadArrays||function(){for(var D=0,E=0,b=arguments.length;E<b;E++)D+=arguments[E].length;var A=Array(D),p=0;for(E=0;E<b;E++)for(var m=arguments[E],U=0,P=m.length;U<P;U++,p++)A[p]=m[U];return A};Object.defineProperty(c,"__esModule",{value:!0});var S=a(14),u=a(8),d=a(2),v=a(38),t=a(1),l=a(10),T=a(7),y=a(11),C=a(6),L=a(9),i=a(0),s=a(5),R=a(12),I=a(15),h="TRTCClient",_=function(){function D(E){var b;this._trtcCloud=null,this._tuiCallEngine=null,this._isVideoPublish=!1,this._isAudioPublish=!1,this._isEnterRoom=!1,this._videoStreamType=S.TRTCVideoStreamType.TRTCVideoStreamTypeBig,this._frameWorkType=30,this._permission={audio:!1,video:!1},this._devices={microphone:[],camera:[],speaker:[]},this._currentDevices={microphone:null,camera:null,speaker:null},this._isRegisterVirtualBackgroundModelFile=!1,this._tuiCallEngine=E.tuiCallEngine,this._component=this._tuiCallEngine.getComponent(),(!((b=window==null?void 0:window.localStorage)===null||b===void 0)&&b.getItem("_isTIMCallKit")||window!=null&&window._isTIMCallKit)&&(this._component=15),this._trtcCloud=S.default.getTRTCShareInstance({frameWorkType:this._frameWorkType,component:this._component,language:this._tuiCallEngine.getLanguage()}),t.isUndefined(E.logLevel)||this.setLogLevel(E.logLevel),this._addTRTCEvents(),this._logger=u.default(),v.isHttpProtocols()&&(this._logger.error(h+".constructor.error",{text:{data:{code:T.default.ERROR_HTTP,msg:y.ERROR_MESSAGE.ERROR_HTTP}},type:"api"}),d.default.error("code: "+T.default.ERROR_HTTP+", "+y.ERROR_MESSAGE.ERROR_HTTP+", "+y.ERROR_CN_MESSAGE.ERROR_HTTP))}return D.prototype.enterRoom=function(E){var b,A;return r(this,void 0,void 0,function(){var p,m;return o(this,function(U){switch(U.label){case 0:return U.trys.push([0,2,,3]),this._logger.info(h+".enterRoom.start",{text:{data:E},type:"api"}),this.getIsEnterRoom()?[2]:(p=e(e({sdkAppId:(b=this._tuiCallEngine)===null||b===void 0?void 0:b.getSdkAppId(),userId:this._tuiCallEngine.getUserId(),userSig:this._tuiCallEngine.getUserSig()},E),{role:S.TRTCRoleType.TRTCRoleAnchor}),[4,(A=this._trtcCloud)===null||A===void 0?void 0:A.enterRoom(p)]);case 1:return U.sent(),this.setIsEnterRoom(!0),[3,3];case 2:throw m=U.sent(),this._logger.error(h+".enterRoom.fail",{text:{error:m},type:"api"}),d.default.error(h+".enterRoom failed error = "+m),new Error(h+".enterRoom failed! "+m);case 3:return[2]}})})},D.prototype.exitRoom=function(){var E;return r(this,void 0,void 0,function(){var b;return o(this,function(A){switch(A.label){case 0:return this._logger.info(h+".exitRoom.start",{text:{data:{isJoined:this.getIsEnterRoom()}},type:"api"}),d.default.info(h+".exitRoom isEnterRoom = "+this.getIsEnterRoom()),this.getIsEnterRoom()?(this._closeAudioVolumeEvaluation(),this.getIsRegisterVirtualBackgroundModelFile()?[4,this.setVirtualBackground({enable:!1})]:[3,2]):[2];case 1:A.sent(),A.label=2;case 2:return[4,this.stopLocalPreview()];case 3:return A.sent(),[4,this._trtcCloud.stopLocalAudio()];case 4:return A.sent(),[4,(E=this._trtcCloud)===null||E===void 0?void 0:E.exitRoom()];case 5:return A.sent(),this.resetTRTCClient(),b=new Date().getTime(),this._tuiCallEngine.getCallDataReport().setExitRoomTime(b),[2]}})})},D.prototype.startLocalPreview=function(E,b){var A,p;return r(this,void 0,void 0,function(){var m,U;return o(this,function(P){switch(P.label){case 0:return P.trys.push([0,8,,9]),m=b,s.isMobile()&&t.isUndefined(b)&&(m=!0),[4,(A=this._trtcCloud)===null||A===void 0?void 0:A.startLocalPreview(m,E)];case 1:return P.sent(),[4,this.setVideoEncoderParam()];case 2:return P.sent(),[4,(p=this._trtcCloud)===null||p===void 0?void 0:p.setLocalRenderParams(this._tuiCallEngine.getLocalPlayOptions())];case 3:return P.sent(),this._tuiCallEngine.isInviter()&&this._tuiCallEngine.getCallStatus()===C.CALL_STATUS.CALLING?[4,this.muteLocalVideo(!0)]:[3,5];case 4:P.sent(),P.label=5;case 5:return this._tuiCallEngine.isInviter()?[3,7]:[4,this.muteLocalVideo(!1)];case 6:P.sent(),P.label=7;case 7:return[3,9];case 8:throw U=P.sent(),this._logger.error(h+".startLocalPreview.fail",{text:{error:U},type:"api"}),new Error(h+".startLocalPreview failed, error:"+U);case 9:return[2]}})})},D.prototype.stopLocalPreview=function(){var E;return r(this,void 0,void 0,function(){var b;return o(this,function(A){switch(A.label){case 0:return A.trys.push([0,2,,3]),this._logger.info(h+".stopLocalPreview.start",{text:{},type:"api"}),[4,(E=this._trtcCloud)===null||E===void 0?void 0:E.stopLocalPreview()];case 1:return A.sent(),this.setIsVideoPublish(!1),[3,3];case 2:throw b=A.sent(),this._logger.error(h+".stopLocalPreview.fail",{text:{error:b},type:"api"}),d.default.error(h+".stopLocalPreview failed to play local video "+b),new Error(h+".stopLocalPreview failed to play local video "+b);case 3:return[2]}})})},D.prototype.startRemoteView=function(E){var b,A;return r(this,void 0,void 0,function(){var p,m,U,P,k;return o(this,function(V){switch(V.label){case 0:d.default.info(h+".startRemoteView params = "+E),p=E.videoViewDomId,m=E.userId,V.label=1;case 1:return V.trys.push([1,4,,5]),U=this._tuiCallEngine.getRemotePlayOptions(),P=this.getVideoStreamType(),[4,(b=this._trtcCloud)===null||b===void 0?void 0:b.startRemoteView(m,p,P)];case 2:return V.sent(),[4,(A=this._trtcCloud)===null||A===void 0?void 0:A.setRemoteRenderParams(m,P,U)];case 3:return V.sent(),[3,5];case 4:throw k=V.sent(),this._logger.error(h+".startRemoteView.fail",{text:{error:k},type:"api"}),d.default.error(h+".startRemoteView failed error "+k),new Error(h+".startRemoteView failed error "+k);case 5:return[2]}})})},D.prototype.stopRemoteView=function(E){var b;return r(this,void 0,void 0,function(){var A,p;return o(this,function(m){switch(m.label){case 0:d.default.debug(h+".stopRemoteView params = "+E),m.label=1;case 1:return m.trys.push([1,3,,4]),A=this.getVideoStreamType(),[4,(b=this._trtcCloud)===null||b===void 0?void 0:b.stopRemoteView(E.userId,A)];case 2:return m.sent(),[3,4];case 3:throw p=m.sent(),this._logger.error(h+".stopRemoteView.fail",{text:{error:p},type:"api"}),d.default.error(h+".stopRemoteView failed error "+p),new Error(h+".stopRemoteView failed error "+p);case 4:return[2]}})})},D.prototype.muteLocalAudio=function(){var E;return r(this,void 0,void 0,function(){return o(this,function(b){switch(b.label){case 0:return[4,(E=this._trtcCloud)===null||E===void 0?void 0:E.muteLocalAudio(!0)];case 1:return b.sent(),this.setIsAudioPublish(!1),[2]}})})},D.prototype.unMuteLocalAudio=function(){var E;return r(this,void 0,void 0,function(){return o(this,function(b){switch(b.label){case 0:return[4,(E=this._trtcCloud)===null||E===void 0?void 0:E.muteLocalAudio(!1)];case 1:return b.sent(),this.setIsAudioPublish(!0),[2]}})})},D.prototype.muteLocalVideo=function(E){var b;return r(this,void 0,void 0,function(){return o(this,function(A){switch(A.label){case 0:return[4,(b=this._trtcCloud)===null||b===void 0?void 0:b.muteLocalVideo(E)];case 1:return A.sent(),this.setIsVideoPublish(!E),[2]}})})},D.prototype.setVideoEncoderParam=function(E){var b;return r(this,void 0,void 0,function(){var A;return o(this,function(p){switch(p.label){case 0:return p.trys.push([0,3,,4]),this._logger.info(h+".setVideoEncoderParam.start",{type:"api",text:{data:E}}),E=E||this._tuiCallEngine.getVideoQuality(),i.VIDEO_ENCODER_MAP[E]?[4,(b=this._trtcCloud)===null||b===void 0?void 0:b.setVideoEncoderParam(i.VIDEO_ENCODER_MAP[E])]:[3,2];case 1:p.sent(),p.label=2;case 2:return[3,4];case 3:return A=p.sent(),this._logger.error(h+".setVideoEncoderParam.fail",{text:{error:A},type:"api"}),d.default.error(h+".setVideoEncoderParam.failed, error: "+A),[3,4];case 4:return[2]}})})},D.prototype.setVideoRenderParams=function(E){var b,A;return r(this,void 0,void 0,function(){var p,m;return o(this,function(U){switch(U.label){case 0:return U.trys.push([0,5,,6]),E.userId!==this._tuiCallEngine.getUserId()?[3,2]:[4,(b=this._trtcCloud)===null||b===void 0?void 0:b.setLocalRenderParams(E)];case 1:return U.sent(),[3,4];case 2:return p=this.getVideoStreamType(),[4,(A=this._trtcCloud)===null||A===void 0?void 0:A.setRemoteRenderParams(E.userId,p,E)];case 3:U.sent(),U.label=4;case 4:return[3,6];case 5:return m=U.sent(),this._logger.error(h+".setVideoRenderParams.fail",{text:{error:m},type:"api"}),d.default.warn(h+"._setVideoRenderParams failed error = "+m),[3,6];case 6:return[2]}})})},D.prototype.switchCallMode=function(E){return r(this,void 0,void 0,function(){var b;return o(this,function(A){switch(A.label){case 0:if(d.default.info(h+".switchCallMode - type",E),E!==C.CALL_TYPE.VIDEO_CALL)return[2];b=C.CALL_TYPE.AUDIO_CALL,A.label=1;case 1:return A.trys.push([1,3,,4]),[4,this.stopLocalPreview()];case 2:return A.sent(),this._tuiCallEngine.setCallType(b),this._tuiCallEngine.setSwitchCallModeStatus(!0),this._tuiCallEngine._delegate.onCallTypeChanged(E,b),[3,4];case 3:return A.sent(),E===C.CALL_TYPE.VIDEO_CALL&&this._tuiCallEngine._delegate.onError(T.default.FAILURE_SWITCH_TO_AUDIO,I.getErrorMessage({code:T.default.FAILURE_SWITCH_TO_AUDIO})),[3,4];case 4:return[2]}})})},D.prototype.resetTRTCClient=function(){return r(this,void 0,void 0,function(){return o(this,function(E){switch(E.label){case 0:return this.getIsEnterRoom()?[4,this.exitRoom()]:[3,2];case 1:E.sent(),E.label=2;case 2:return this.setIsEnterRoom(!1),this.setIsVideoPublish(!1),this.setIsAudioPublish(!1),[2]}})})},D.prototype.getMediaDevicesAuth=function(E){return E===void 0&&(E={}),r(this,void 0,void 0,function(){var b,A,p,m;return o(this,function(U){switch(U.label){case 0:if(this._logger.info(h+".getMediaDevicesAuth.start",{text:{data:{params:E}},type:"api"}),v.isHttpProtocols())throw this._logger.error(h+".getMediaDevicesAuth.fail",{text:{error:y.ERROR_MESSAGE.ERROR_HTTP},type:"api"}),new l.default({code:T.default.ERROR_HTTP});if(b=this._getDevicePermission(),!E.audio)return[3,4];if(s.IS_IOS&&b.audio)return[2,b];U.label=1;case 1:return U.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia({audio:!0})];case 2:return p=U.sent(),this._releaseStream(p),this._setDevicePermission(i.NAME.AUDIO,!0),[3,4];case 3:return A=U.sent(),this._logger.error(h+".getMediaDevicesAuth.fail",{text:{error:A},type:"api"}),this._setDevicePermission(i.NAME.AUDIO,!1),this._handleMediaError(A,"getMediaDevicesAuth",i.NAME.AUDIO),[3,4];case 4:if(!E.video)return[3,8];if(s.IS_IOS&&b.video)return[2,b];U.label=5;case 5:return U.trys.push([5,7,,8]),[4,navigator.mediaDevices.getUserMedia({video:!0})];case 6:return p=U.sent(),this._releaseStream(p),this._setDevicePermission(i.NAME.VIDEO,!0),[3,8];case 7:return m=U.sent(),this._logger.error(h+".getMediaDevicesAuth.fail",{text:{error:m},type:"api"}),this._setDevicePermission(i.NAME.VIDEO,!1),E.isThrowVideoError&&this._handleMediaError(m,"getMediaDevicesAuth",i.NAME.VIDEO),[3,8];case 8:return[2,this._getDevicePermission()]}})})},D.prototype.switchDevice=function(E,b){return r(this,void 0,void 0,function(){var A;return o(this,function(p){switch(p.label){case 0:return this._logger.info(h+".getMediaDevicesAuth.start",{text:{data:{deviceType:E,deviceId:b}},type:"api"}),A=!1,E!==L.DEVICE_TYPE.CAMERA?[3,2]:[4,this._trtcCloud.setCurrentCameraDevice(b)];case 1:A=p.sent(),p.label=2;case 2:return E!==L.DEVICE_TYPE.MICROPHONE?[3,4]:[4,this._trtcCloud.setCurrentMicDevice(b)];case 3:A=p.sent(),p.label=4;case 4:return E!==L.DEVICE_TYPE.SPEAKER?[3,6]:[4,this._trtcCloud.setCurrentSpeakerDevice(b)];case 5:A=p.sent(),p.label=6;case 6:return this._updateCurrentDevice(),this._tuiCallEngine._delegate.onDeviceUpdated(this._devices,this._currentDevices),[2,A]}})})},D.prototype.switchCamera=function(E){var b;return r(this,void 0,void 0,function(){var A,p;return o(this,function(m){switch(m.label){case 0:this._logger.info(h+".switchCamera.start",{text:{data:{cameraType:E}},type:"api"}),m.label=1;case 1:return m.trys.push([1,3,,4]),A=E===R.TUICallCameraPosition.FRONT,[4,(b=this._trtcCloud)===null||b===void 0?void 0:b.switchCamera(A)];case 2:return m.sent(),[3,4];case 3:throw p=m.sent(),this._logger.error(h+".switchCamera.fail",{text:{error:p},type:"api"}),p;case 4:return[2]}})})},D.prototype.getDeviceList=function(E){return r(this,void 0,void 0,function(){var b,A;return o(this,function(p){switch(p.label){case 0:this._logger.info(h+".getDeviceList.start",{text:{data:{deviceType:E}},type:"api"}),p.label=1;case 1:switch(p.trys.push([1,12,,13]),b=[],E){case L.DEVICE_TYPE.CAMERA:return[3,2];case L.DEVICE_TYPE.MICROPHONE:return[3,5];case L.DEVICE_TYPE.SPEAKER:return[3,8]}return[3,11];case 2:return this._getDevicePermission().video?[4,this._trtcCloud.getCameraDevicesList()]:[3,4];case 3:b=p.sent(),p.label=4;case 4:return[3,11];case 5:return this._getDevicePermission().audio?[4,this._trtcCloud.getMicDevicesList()]:[3,7];case 6:b=p.sent(),p.label=7;case 7:return[3,11];case 8:return this._getDevicePermission().audio?[4,this._trtcCloud.getSpeakerDevicesList()]:[3,10];case 9:b=p.sent(),p.label=10;case 10:return[3,11];case 11:return this._setDevice(E,b),[2,b];case 12:throw A=p.sent(),this._logger.error(h+".getDeviceList.fail",{text:{error:A},type:"api"}),A;case 13:return[2]}})})},D.prototype.getCurrentDevice=function(E){return this._updateCurrentDevice(),this._currentDevices[E]},D.prototype.setLogLevel=function(E){!(S.default===null||S.default===void 0)&&S.default.setLogLevel&&S.default.setLogLevel(E+1)},D.prototype.setVirtualBackground=function(E){var b;return r(this,void 0,void 0,function(){var A,p,m;return o(this,function(U){switch(U.label){case 0:return U.trys.push([0,4,,5]),A=E.enable,this.getIsRegisterVirtualBackgroundModelFile()||!A?[3,2]:[4,this._trtcCloud.useVirtualBackground()];case 1:U.sent(),this.setIsRegisterVirtualBackgroundModelFile(!0),U.label=2;case 2:return p={api:i.NAME.ENABLE_VIRTUAL_BACKGROUND,params:e({sdkAppId:this._tuiCallEngine.getSdkAppId(),userId:this._tuiCallEngine.getUserId(),userSig:this._tuiCallEngine.getUserSig()},E)},this._logger.info(h+".setVirtualBackground.start",{type:"api",text:{data:p}}),[4,(b=this._trtcCloud)===null||b===void 0?void 0:b.callExperimentalAPI(JSON.stringify(p))];case 3:return U.sent(),[3,5];case 4:throw m=U.sent(),d.default.error(h+".setVirtualBackground.fail, "+m),this._logger.error(h+".setVirtualBackground.fail",{text:{error:m},type:"api"}),m;case 5:return[2]}})})},D.prototype._openAudioVolumeEvaluation=function(E){var b;E===void 0&&(E=1e3),(b=this._trtcCloud)===null||b===void 0||b.enableAudioVolumeEvaluation(E)},D.prototype._closeAudioVolumeEvaluation=function(){var E;(E=this._trtcCloud)===null||E===void 0||E.enableAudioVolumeEvaluation(-1)},D.prototype._releaseStream=function(E){for(var b=E.getTracks(),A=0;A<b.length;A++)b[A].stop()},D.prototype._handleMediaError=function(E,b,A){var p=T.default.UNKNOWN,m=i.NAME.UNKNOWN;switch(E==null?void 0:E.name){case"NotFoundError":A===L.DEVICE_TYPE.AUDIO&&(p=T.default.NOT_MICROPHONE_LIST),A===L.DEVICE_TYPE.VIDEO&&(p=T.default.NOT_CAMERA_LIST);break;case"NotAllowedError":p=T.default.ERROR_PERMISSION_DENIED}throw m=I.getErrorMessage({code:p,params:{error:E,fnName:b}}),this._tuiCallEngine._delegate.onError(p,JSON.stringify(m)),new l.default({code:p,message:m})},D.prototype._updateCurrentDevice=function(){this._currentDevices[i.NAME.CAMERA]=this._trtcCloud.getCurrentCameraDevice(),this._currentDevices[i.NAME.MICROPHONE]=this._trtcCloud.getCurrentMicDevice(),this._currentDevices[i.NAME.SPEAKER]=this._trtcCloud.getCurrentSpeakerDevice(),this._logger.info(h+"._getCurrentDevice.start",{text:{data:e({},this._currentDevices)},type:"api"})},D.prototype._addTRTCEvents=function(){var E,b,A,p,m,U,P,k,V,x,j,O=this;(E=this._trtcCloud)===null||E===void 0||E.on("onEnterRoom",function(n){return r(O,void 0,void 0,function(){var g;return o(this,function(N){switch(N.label){case 0:return this._logger.info(h+".enterRoom.success",{type:"api",text:{cost:n}}),n>0?[4,this._trtcCloud.startLocalAudio()]:[3,5];case 1:return N.sent(),this._tuiCallEngine.isInviter()?[4,this._tuiCallEngine.setSelfIMCallStatus(C.CALL_STATUS.CALLING)]:[3,4];case 2:return N.sent(),[4,this.muteLocalAudio()];case 3:return N.sent(),[3,5];case 4:this.setIsVideoPublish(!0),this.setIsAudioPublish(!0),g=this._tuiCallEngine.generateEventData(),this._tuiCallEngine._delegate.onCallBegin(g),N.label=5;case 5:return[2]}})})}),(b=this._trtcCloud)===null||b===void 0||b.on("onExitRoom",function(n){return r(O,void 0,void 0,function(){var g,N;return o(this,function(w){switch(w.label){case 0:return d.default.warn("退房, reason = "+n),n===0?[3,4]:(d.default.warn("leave room, reason: "+n),this._tuiCallEngine.getCallStatus()===C.CALL_STATUS.CONNECTED&&(g=this._tuiCallEngine.generateCallEndData(),this._tuiCallEngine._delegate.onCallEnd(g)),this._tuiCallEngine.getCallStatus()!==C.CALL_STATUS.CALLING?[3,2]:(N=e(e({},this._tuiCallEngine.generateEventData()),{reason:n}),this._tuiCallEngine._delegate.onCallingCancel(e({userID:this._tuiCallEngine.getUserId()},N)),[4,this._tuiCallEngine._cancel()]));case 1:w.sent(),w.label=2;case 2:return[4,this._tuiCallEngine._resetTUICallEngine()];case 3:w.sent(),w.label=4;case 4:return[2]}})})}),(A=this._trtcCloud)===null||A===void 0||A.on("onRemoteUserEnterRoom",function(n){return r(O,void 0,void 0,function(){var g,N;return o(this,function(w){switch(w.label){case 0:return d.default.info(h+".onRemoteUserEnterRoom userId = "+n),this._tuiCallEngine.getConnectStartTime()||(this._tuiCallEngine.setConnectStartTime(Date.now()),this._openAudioVolumeEvaluation()),this._tuiCallEngine._delegate.onUserEnter(n),this._tuiCallEngine.addHandledInviteeList([n]),this._tuiCallEngine.deleteUnHandledInviteeList([n]),this._tuiCallEngine.addAcceptedUserList(null,[n]),this._tuiCallEngine.getCallStatus()!==C.CALL_STATUS.CALLING?[3,6]:(this._tuiCallEngine.changeCallStatus(C.CALL_STATUS.CONNECTED),this._tuiCallEngine.isInviter()?(g=this._tuiCallEngine.generateEventData(),this._tuiCallEngine._delegate.onCallBegin(g),this.getIsVideoPublish()?[3,2]:[4,this.muteLocalVideo(!1)]):[3,6]);case 1:w.sent(),w.label=2;case 2:return this.getIsAudioPublish()?[3,4]:[4,this.unMuteLocalAudio()];case 3:w.sent(),w.label=4;case 4:return[4,this._tuiCallEngine.setSelfIMCallStatus(C.CALL_STATUS.CONNECTED)];case 5:w.sent(),w.label=6;case 6:return this._tuiCallEngine.isGroupCall()&&(N=this._tuiCallEngine.getHandledInviteeList(),this._tuiCallEngine._delegate.onGroupCallInviteeListUpdate(N)),[2]}})})}),(p=this._trtcCloud)===null||p===void 0||p.on("onRemoteUserLeaveRoom",function(n,g){return r(O,void 0,void 0,function(){var N,w,G,B,F,J;return o(this,function(q){switch(q.label){case 0:return d.default.info(h+".onRemoteUserLeaveRoom userId = "+n+", reason = "+g),this._tuiCallEngine.getCallStatus()===C.CALL_STATUS.IDLE?[2]:(N=this._tuiCallEngine.isGroupCall(),this._tuiCallEngine.deleteHandledInviteeList([n]),this._tuiCallEngine._delegate.onUserLeave(n),w=this._tuiCallEngine.getHandledInviteeList(),N?(G=this._tuiCallEngine.getUnHandledInviteeList(),w.length!==0&&this._tuiCallEngine._delegate.onGroupCallInviteeListUpdate(w),B=this._tuiCallEngine.getUserId(),w.length!==1||w[0]!==B||G.length!==0?[3,2]:(F=this._tuiCallEngine.generateCallEndData(),this._tuiCallEngine._delegate.onCallEnd(F),[4,this._tuiCallEngine._resetTUICallEngine()])):[3,3]);case 1:q.sent(),q.label=2;case 2:return[3,6];case 3:return J={callType:this._tuiCallEngine.getCallType(),userIDList:[n],callEnd:this._tuiCallEngine.generateCallTotalTime()},w.length!==1?[3,6]:[4,this._tuiCallEngine._tsignalingClient.hangup(J)];case 4:return q.sent(),[4,this._tuiCallEngine._resetTUICallEngine()];case 5:q.sent(),q.label=6;case 6:return[2]}})})}),(m=this._trtcCloud)===null||m===void 0||m.on("onUserVideoAvailable",function(n,g){O._tuiCallEngine._delegate.onUserVideoAvailable({userID:n,isVideoAvailable:g})}),(U=this._trtcCloud)===null||U===void 0||U.on("onUserAudioAvailable",function(n,g){O._tuiCallEngine._delegate.onUserAudioAvailable({userID:n,isAudioAvailable:g})}),(P=this._trtcCloud)===null||P===void 0||P.on("onUserVoiceVolume",function(n){n=n.map(function(g){return{userId:g.userId===""?O._tuiCallEngine.getUserId():g.userId,audioVolume:g.volume}}),O._tuiCallEngine._delegate.onUserVoiceVolume(n)}),(k=this._trtcCloud)===null||k===void 0||k.on("onDeviceChange",function(n,g,N){return r(O,void 0,void 0,function(){var w,G;return o(this,function(B){switch(B.label){case 0:return(G={})[S.TRTCDeviceType.TRTCDeviceTypeMi]=L.DEVICE_TYPE.MICROPHONE,G[S.TRTCDeviceType.TRTCDeviceTypeSpeaker]=L.DEVICE_TYPE.SPEAKER,G[S.TRTCDeviceType.TRTCDeviceTypeCamera]=L.DEVICE_TYPE.CAMERA,w=G,[4,this.getDeviceList(w[g])];case 1:return B.sent(),this._updateCurrentDevice(),this._tuiCallEngine._delegate.onDeviceUpdated(this._devices,this._currentDevices),[2]}})})}),(V=this._trtcCloud)===null||V===void 0||V.on("onNetworkQuality",function(n,g){return r(O,void 0,void 0,function(){var N;return o(this,function(w){return N=this._tuiCallEngine.getUserId(),this._tuiCallEngine._delegate.onUserNetworkQualityChanged(f([e(e({},n),{userId:N})],g)),[2]})})}),(x=this._trtcCloud)===null||x===void 0||x.on("onError",function(n,g){d.default.error(h+".onError, code = "+n+", message = "+g),O._tuiCallEngine._delegate.onError(n,g)}),(j=this._trtcCloud)===null||j===void 0||j.on("onWarning",function(n){var g=n.code;if(g===10000003||g===10000006){var N="Insufficient device performance causes high latency, please turn off the virtual background";O._logger.info("setVirtualBackground.error",{text:{data:{code:g,message:N}},type:"api"}),O._tuiCallEngine._delegate.onError(g,N)}})},D.prototype.removeTRTCEvents=function(){var E;(E=this._trtcCloud)===null||E===void 0||E.removeAllListeners()},D.prototype.getClient=function(){return this._trtcCloud},D.prototype.setIsVideoPublish=function(E){this._isVideoPublish=E},D.prototype.getIsVideoPublish=function(){return this._isVideoPublish},D.prototype.setIsAudioPublish=function(E){this._isAudioPublish=E},D.prototype.getIsAudioPublish=function(){return this._isAudioPublish},D.prototype.setIsEnterRoom=function(E){this._isEnterRoom=E},D.prototype.getIsEnterRoom=function(){return this._isEnterRoom},D.prototype.setVideoStreamType=function(E){this._videoStreamType=E||this._videoStreamType},D.prototype.getVideoStreamType=function(){return this._videoStreamType},D.prototype.enableAIVoice=function(E){},D.prototype._setDevice=function(E,b){this._devices[E]=b},D.prototype._getDevicePermission=function(){return this._permission},D.prototype._setDevicePermission=function(E,b){this._permission[E]=b},D.prototype.setIsRegisterVirtualBackgroundModelFile=function(E){this._isRegisterVirtualBackgroundModelFile=E},D.prototype.getIsRegisterVirtualBackgroundModelFile=function(){return this._isRegisterVirtualBackgroundModelFile},D}();c.default=_},function(H,c){var a;a=function(){return this}();try{a=a||new Function("return this")()}catch{typeof window=="object"&&(a=window)}H.exports=a},function(H,c,a){Object.defineProperty(c,"__esModule",{value:!0}),c.isHttpProtocols=void 0,c.isHttpProtocols=function(){if(!window||!window.location)return!1;var e=window.location,r=e.protocol,o=e.hostname;return r==="http:"&&o!=="localhost"&&o!=="127.0.0.1"}},function(H,c,a){var e=this&&this.__assign||function(){return(e=Object.assign||function(L){for(var i,s=1,R=arguments.length;s<R;s++)for(var I in i=arguments[s])Object.prototype.hasOwnProperty.call(i,I)&&(L[I]=i[I]);return L}).apply(this,arguments)},r=this&&this.__awaiter||function(L,i,s,R){return new(s||(s=Promise))(function(I,h){function _(b){try{E(R.next(b))}catch(A){h(A)}}function D(b){try{E(R.throw(b))}catch(A){h(A)}}function E(b){var A;b.done?I(b.value):(A=b.value,A instanceof s?A:new s(function(p){p(A)})).then(_,D)}E((R=R.apply(L,i||[])).next())})},o=this&&this.__generator||function(L,i){var s,R,I,h,_={label:0,sent:function(){if(1&I[0])throw I[1];return I[1]},trys:[],ops:[]};return h={next:D(0),throw:D(1),return:D(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function D(E){return function(b){return function(A){if(s)throw new TypeError("Generator is already executing.");for(;_;)try{if(s=1,R&&(I=2&A[0]?R.return:A[0]?R.throw||((I=R.return)&&I.call(R),0):R.next)&&!(I=I.call(R,A[1])).done)return I;switch(R=0,I&&(A=[2&A[0],I.value]),A[0]){case 0:case 1:I=A;break;case 4:return _.label++,{value:A[1],done:!1};case 5:_.label++,R=A[1],A=[0];continue;case 7:A=_.ops.pop(),_.trys.pop();continue;default:if(I=_.trys,!((I=I.length>0&&I[I.length-1])||A[0]!==6&&A[0]!==2)){_=0;continue}if(A[0]===3&&(!I||A[1]>I[0]&&A[1]<I[3])){_.label=A[1];break}if(A[0]===6&&_.label<I[1]){_.label=I[1],I=A;break}if(I&&_.label<I[2]){_.label=I[2],_.ops.push(A);break}I[2]&&_.ops.pop(),_.trys.pop();continue}A=i.call(L,_)}catch(p){A=[6,p],R=0}finally{s=I=0}if(5&A[0])throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}([E,b])}}},f=this&&this.__rest||function(L,i){var s={};for(var R in L)Object.prototype.hasOwnProperty.call(L,R)&&i.indexOf(R)<0&&(s[R]=L[R]);if(L!=null&&typeof Object.getOwnPropertySymbols=="function"){var I=0;for(R=Object.getOwnPropertySymbols(L);I<R.length;I++)i.indexOf(R[I])<0&&Object.prototype.propertyIsEnumerable.call(L,R[I])&&(s[R[I]]=L[R[I]])}return s},S=this&&this.__spreadArrays||function(){for(var L=0,i=0,s=arguments.length;i<s;i++)L+=arguments[i].length;var R=Array(L),I=0;for(i=0;i<s;i++)for(var h=arguments[i],_=0,D=h.length;_<D;_++,I++)R[I]=h[_];return R};Object.defineProperty(c,"__esModule",{value:!0});var u=a(20),d=a(8),v=a(2),t=a(6),l="TSignalClient",T=a(0),y=a(1),C=function(){function L(i,s){this._loginResolveList=[],this._tuiCallEngine=i,this._chat=s.tim,this._joined=!1,this._newInvitationData=null,this._logger=d.default(),this.addTSignalEvents()}return L.prototype.setTSignalingIsJoined=function(i){this._joined=i},L.prototype.getTSignalingIsJoined=function(){return this._joined},L.prototype.setLogLevel=function(i){this._chat.setLogLevel(i)},L.prototype.addTSignalEvents=function(){var i,s,R,I,h,_=u,D=_.EVENT,E=_.TSignaling;this._chat.on(D.SDK_READY,this.onSdkReady,this),this._chat.on(D.SDK_NOT_READY,this.onSdkNotReady,this),this._chat.on(D.KICKED_OUT,this.onKickedOut,this),this._chat.on(D.NET_STATE_CHANGE,this.onNetStateChange,this),this._chat.on(D.USER_STATUS_UPDATED,this.onUserStatusUpdated,this),(i=this._chat)===null||i===void 0||i.addSignalingListener(E.NEW_INVITATION_RECEIVED,this.onNewInvitationReceived,this),(s=this._chat)===null||s===void 0||s.addSignalingListener(E.INVITEE_ACCEPTED,this.onInviteeAccepted,this),(R=this._chat)===null||R===void 0||R.addSignalingListener(E.INVITEE_REJECTED,this.onInviteeRejected,this),(I=this._chat)===null||I===void 0||I.addSignalingListener(E.INVITATION_CANCELLED,this.onInvitationCancelled,this),(h=this._chat)===null||h===void 0||h.addSignalingListener(E.INVITATION_TIMEOUT,this.onInvitationTimeout,this)},L.prototype.removeTSignalEvents=function(){var i,s,R,I,h,_=u,D=_.EVENT,E=_.TSignaling;this._chat.off(D.SDK_READY,this.onSdkReady,this),this._chat.off(D.SDK_NOT_READY,this.onSdkNotReady,this),this._chat.off(D.KICKED_OUT,this.onKickedOut,this),this._chat.off(D.NET_STATE_CHANGE,this.onNetStateChange,this),this._chat.off(D.USER_STATUS_UPDATED,this.onUserStatusUpdated,this),(i=this._chat)===null||i===void 0||i.removeSignalingListener(E.NEW_INVITATION_RECEIVED,this.onNewInvitationReceived,this),(s=this._chat)===null||s===void 0||s.removeSignalingListener(E.INVITEE_ACCEPTED,this.onInviteeAccepted,this),(R=this._chat)===null||R===void 0||R.removeSignalingListener(E.INVITEE_REJECTED,this.onInviteeRejected,this),(I=this._chat)===null||I===void 0||I.removeSignalingListener(E.INVITATION_CANCELLED,this.onInvitationCancelled,this),(h=this._chat)===null||h===void 0||h.removeSignalingListener(E.INVITATION_TIMEOUT,this.onInvitationTimeout,this)},L.prototype.onSdkReady=function(i){this._logger.info(l+".onSdkReady",{type:"event"}),this._tuiCallEngine._delegate.onSdkReady(i),this._loginResolveList.forEach(function(s){return s.resolve(s.value)}),this._loginResolveList=[]},L.prototype.onSdkNotReady=function(){this._logger.info(l+".onSdkNotReady",{type:"event"}),v.default.warn("onSdkNotReady")},L.prototype.onNewInvitationReceived=function(i){var s,R,I,h;return r(this,void 0,void 0,function(){var _,D,E,b,A,p,m,U,P,k,V;return o(this,function(x){switch(x.label){case 0:return _=this._tuiCallEngine.getCallStatus(),this._logger.info(l+".onNewInvitationReceived",{type:"event",text:{data:{params:i,currentCallStatus:_}}}),v.default.info(l+".onNewInvitationReceived - params:",i,"currentCallStatus:"+_),D=i.data,E=D.inviter,b=D.inviteeList,A=D.data,p=D.inviteID,m=D.groupID,this._tuiCallEngine.setInitialInviteData(JSON.parse(A)),U=JSON.parse(A),y.isCallSignaling(U==null?void 0:U.businessID)?(U.room_id||(U.room_id=(s=U==null?void 0:U.data)===null||s===void 0?void 0:s.room_id),P=((R=U==null?void 0:U.data)===null||R===void 0?void 0:R.initialCallId)||"",this._tuiCallEngine.getUserId()===E?[2]:(k=!!m)||!(!((I=U==null?void 0:U.data)===null||I===void 0)&&I.consumed)&&!(U!=null&&U.consumed)?(V={inviter:E,inviteeList:b,inviteID:p,isGroupCall:k,inviteData:U,groupID:m,initialCallId:P,currentCallStatus:_,inCallUserIDs:(U==null?void 0:U.inCallUserIDs)||[]},((h=U==null?void 0:U.data)===null||h===void 0?void 0:h.cmd)!==t.CMD_TYPE.HANG_UP?[3,2]:(v.default.info(l+".hangup - params:",E,U,this._tuiCallEngine.getHandledInviteeList(),this._tuiCallEngine.getUnHandledInviteeList(),_,k),_===t.CALL_STATUS.IDLE?[2]:[4,this.handleHangupSignal(V)])):[2]):[2];case 1:return x.sent(),[2];case 2:return m||!this.judgeSwitchCallMode(U)?[3,5]:_===t.CALL_STATUS.IDLE||this._tuiCallEngine.getRoomId()!==U.room_id?[3,4]:[4,this.handleSwitchCallMode(p,U)];case 3:x.sent(),this._tuiCallEngine.addAudioVideoSwitchIdList(p),x.label=4;case 4:return[2];case 5:return _===t.CALL_STATUS.IDLE?[3,7]:[4,this.reject({inviteID:p,callType:U.call_type,isBusy:!0})];case 6:return x.sent(),this._tuiCallEngine.getCallRecordReport().eventUploadNotSave({inviteID:P||p,callRole:T.NAME.INVITEE,eventType:T.NAME.IGNORE_CALL,roomID:U.room_id,mediaType:U.call_type,callType:m?T.NAME.GROUP:T.NAME.SINGLE,groupId:m,strRoomId:U.str_room_id||U.data.str_room_id}),[2];case 7:return this.handleInvitedSignal(V),[2]}})})},L.prototype.handleHangupSignal=function(i){return r(this,void 0,void 0,function(){var s,R,I,h,_,D,E,b,A,p;return o(this,function(m){switch(m.label){case 0:if(this._logger.info(l+".handleHangupSignal",{text:{data:e(e({},i),{isInviter:this._tuiCallEngine.isInviter(),isGroupCall:this._tuiCallEngine.isGroupCall()})},type:"event"}),s=i.inviter,R=i.inviteData,I=i.currentCallStatus,h=i.inviteeList,_=this._tuiCallEngine.isGroupCall(),D=this._tuiCallEngine.isInviter(),I===t.CALL_STATUS.CALLING){if(b=this._tuiCallEngine.getHandledInviteeList(),(A=this._tuiCallEngine.getUnHandledInviteeList()).indexOf(s)!==-1&&this._tuiCallEngine.deleteUnHandledInviteeList([s]),b.indexOf(s)===-1)return[2]}else if(this._tuiCallEngine.deleteHandledInviteeList([s]),(b=this._tuiCallEngine.getHandledInviteeList()).indexOf(s)===-1&&b.length>1)return[2];return E=this._tuiCallEngine.generateCallEndData({totalTime:R.call_end||0}),_?[3,2]:[4,this._tuiCallEngine._resetTUICallEngine()];case 1:return m.sent(),this._tuiCallEngine._delegate.onCallEnd(E),[3,10];case 2:return this._tuiCallEngine.deleteHandledInviteeList([s]),b=this._tuiCallEngine.getHandledInviteeList(),A=this._tuiCallEngine.getUnHandledInviteeList(),D?b.length!==1||A.length!==0?[3,4]:[4,this._tuiCallEngine._resetTUICallEngine()]:[3,5];case 3:m.sent(),this._tuiCallEngine._delegate.onCallEnd(E),m.label=4;case 4:return[3,10];case 5:return I!==t.CALL_STATUS.CALLING?[3,8]:(h.indexOf(this._tuiCallEngine.getUserId())!==-1&&this._tuiCallEngine._delegate.onUserLeave(s),b.length!==0||A.length!==1?[3,7]:(p=this._tuiCallEngine.generateEventData(),[4,this._tuiCallEngine._resetTUICallEngine()]));case 6:m.sent(),this._tuiCallEngine._delegate.onCallingCancel(e(e({userID:s},p),{reason:T.NAME.NORMAL})),m.label=7;case 7:return[3,10];case 8:return b.length!==1||A.length!==0?[3,10]:[4,this._tuiCallEngine._resetTUICallEngine()];case 9:m.sent(),this._tuiCallEngine._delegate.onCallEnd(E),m.label=10;case 10:return[2]}})})},L.prototype.handleInvitedSignal=function(i){return r(this,void 0,void 0,function(){var s,R,I,h,_,D,E,b,A,p,m,U,P,k,V,x,j;return o(this,function(O){switch(O.label){case 0:this._logger.info(l+".handleInvitedSignal",{text:{data:e(e({},i),{isInviter:this._tuiCallEngine.isInviter(),isGroupCall:this._tuiCallEngine.isGroupCall()})},type:"event"}),s=i.inviter,R=i.inviteeList,I=i.isGroupCall,h=i.groupID,_=i.inviteID,D=i.inviteData,E=i.inCallUserIDs,b=E===void 0?[]:E,A=i.initialCallId,p=A===void 0?"":A,this._tuiCallEngine.changeCallStatus(t.CALL_STATUS.CALLING),this._tuiCallEngine.setInviterID(s),this._tuiCallEngine.setInviteeList(R),this._tuiCallEngine.setRoomId(D.room_id),this._tuiCallEngine.setStrRoomId(D.str_room_id||D.data.str_room_id),this._tuiCallEngine.setCallType(D.call_type),this._tuiCallEngine.addUnHandledInviteeList(S(R,b)),this._tuiCallEngine.addHandledInviteeList([s]),this._tuiCallEngine.addAcceptedUserList(_,[s]),this._tuiCallEngine.setInitialCallId(p),I&&(this._tuiCallEngine.setIsGroupCall(I),this._tuiCallEngine.setGroupId(h)),this._tuiCallEngine.addInviterInviteId(_,S([s],R)),m=b.filter(function(n){return R.indexOf(n)===-1}),this._newInvitationData={sponsor:s,userIDList:S(R,m),isFromGroup:I,inviteID:_,groupID:h,inviteData:{version:D.version,callType:D.call_type,roomID:D.room_id},userData:D.userData,calleeIdList:R},U=this._tuiCallEngine.getCallDataReport().getCallData(),U=e(e({},U),{roomID:D.room_id,inviteID:_,callRole:t.CALL_ROLE.INVITEE,callType:D.call_type,inviteeList:R,callScene:h?T.NAME.GROUP_CALL:T.NAME.SINGLE_CALL}),P=this._tuiCallEngine.generateEventData()||{},this._tuiCallEngine.getCallDataReport().setCallData(U),k={eventType:T.NAME.RECEIVE_CALL,callType:h?T.NAME.GROUP:T.NAME.SINGLE,mediaType:D.call_type,callRole:T.NAME.INVITEE,userID:this._tuiCallEngine.getUserId(),roomID:D.room_id,inviteID:p||_,strRoomId:this._tuiCallEngine.getStrRoomId(),groupId:this._tuiCallEngine.getGroupId()},this._tuiCallEngine.getCallRecordReport().eventUpload(k),this._tuiCallEngine._delegate.onInvited(e(e({},P),this._newInvitationData)),V=new Date().getTime(),x=V,O.label=1;case 1:return x-V<100?[4,new Promise(function(n){return setTimeout(n,10)})]:[3,5];case 2:return O.sent(),this._tuiCallEngine.getInviterInviteIdList().indexOf(_)!==-1?[3,4]:(this._logger.warn(l+".onNewInvitationReceived border case",{text:{data:{handleParams:i}},type:"api"}),[4,this._tuiCallEngine._resetTUICallEngine()]);case 3:return O.sent(),[2];case 4:return x=new Date().getTime(),[3,1];case 5:return[4,this._tuiCallEngine.getSelfIMCallStatus([this._tuiCallEngine.getUserId()])];case 6:return(j=O.sent())!==t.CALL_STATUS.IDLE?(this._logger.error(l+".onNewInvitationReceived",{text:{data:{handleParams:i,customStatus:j}},type:"event"}),[2]):[4,this._tuiCallEngine.setSelfIMCallStatus(t.CALL_STATUS.CALLING)];case 7:return O.sent(),[2]}})})},L.prototype.getInviteData=function(){return this._newInvitationData},L.prototype.setInviteData=function(i){this._newInvitationData=i},L.prototype.handleSwitchCallMode=function(i,s){return r(this,void 0,void 0,function(){var R,I,h,_;return o(this,function(D){switch(D.label){case 0:return R={inviteID:i,callType:s.call_type,switch_to_audio_call:null},I={cmd:t.CMD_TYPE.SWITCH_TO_VIDEO},s.call_type===t.CALL_TYPE.VIDEO_CALL?(R.switch_to_audio_call=t.CMD_TYPE.SWITCH_TO_AUDIO_CALL,I.cmd=t.CMD_TYPE.SWITCH_TO_AUDIO):delete R.switch_to_audio_call,h=this._tuiCallEngine.getCallStatus(),this.accept(R,I),h!==t.CALL_STATUS.CALLING?[3,1]:(_=s.call_type===t.CALL_TYPE.VIDEO_CALL?t.CALL_TYPE.AUDIO_CALL:t.CALL_TYPE.VIDEO_CALL,this._tuiCallEngine._delegate.onCallTypeChanged(s.call_type,_),this._newInvitationData.inviteData.callType=_,this._tuiCallEngine.setSwitchCallModeStatus(!1),[3,3]);case 1:return h!==t.CALL_STATUS.CONNECTED?[3,3]:(this._tuiCallEngine.setSwitchCallModeStatus(!1),[4,this._tuiCallEngine._trtcClient.switchCallMode(this._tuiCallEngine.getCallType())]);case 2:D.sent(),D.label=3;case 3:return[2]}})})},L.prototype.judgeSwitchCallMode=function(i){var s=i.switch_to_audio_call&&i.switch_to_audio_call===t.CMD_TYPE.SWITCH_TO_AUDIO_CALL||i.data&&i.data.cmd===t.CMD_TYPE.SWITCH_TO_AUDIO||i.data&&i.data.cmd===t.CMD_TYPE.SWITCH_TO_VIDEO;return v.default.info(l+".switchCallMode:",i,"isSwitchCallMode-"+s),s},L.prototype.onInviteeAccepted=function(i){return r(this,void 0,void 0,function(){var s,R,I,h,_;return o(this,function(D){switch(D.label){case 0:return this._logger.info(l+".onInviteeAccepted",{text:{data:i},type:"event"}),v.default.info(l+".onInviteeAccepted - params:",i),s=JSON.parse(i.data.data),y.isCallSignaling(s==null?void 0:s.businessID)?(R=i.data.invitee,I=i.data.inviteID,this._tuiCallEngine.getTotalInviterInviteIdList().indexOf(I)===-1?[2]:this._tuiCallEngine.isGroupCall()||!this.judgeSwitchCallMode(s)||this._tuiCallEngine.getSwitchCallModeStatus()?[3,2]:[4,this._tuiCallEngine._trtcClient.switchCallMode(this._tuiCallEngine.getCallType())]):[2];case 1:return D.sent(),[2];case 2:return h=this._tuiCallEngine.getCallStatus(),R!==this._tuiCallEngine.getUserId()||h!==t.CALL_STATUS.CALLING?[3,4]:(_=this._tuiCallEngine.generateEventData(),[4,this._tuiCallEngine._resetTUICallEngine()]);case 3:return D.sent(),this._tuiCallEngine._delegate.onCallingCancel(e({userID:R},_)),[2];case 4:return h===t.CALL_STATUS.CALLING&&this._tuiCallEngine.isInviter()?(_=this._tuiCallEngine.generateEventData(),this._tuiCallEngine._delegate.onCallBegin(_),this._tuiCallEngine._trtcClient.getIsVideoPublish()?[3,6]:[4,this._tuiCallEngine._trtcClient.muteLocalVideo(!1)]):[3,9];case 5:D.sent(),D.label=6;case 6:return this._tuiCallEngine._trtcClient.getIsAudioPublish()?[3,8]:[4,this._tuiCallEngine._trtcClient.unMuteLocalAudio()];case 7:D.sent(),D.label=8;case 8:D.label=9;case 9:return this._tuiCallEngine.isInviter()&&this._tuiCallEngine.changeCallStatus(t.CALL_STATUS.CONNECTED),this._tuiCallEngine._delegate.onUserAccept(R),this._tuiCallEngine.addHandledInviteeList([R]),this._tuiCallEngine.deleteUnHandledInviteeList([R]),this._tuiCallEngine.addAcceptedUserList(I,[R]),[2]}})})},L.prototype.onInviteeRejected=function(i){var s;return r(this,void 0,void 0,function(){var R,I,h,_,D,E,b,A,p,m,U,P,k;return o(this,function(V){switch(V.label){case 0:return this._logger.info(l+".onInviteeRejected",{text:{data:e(e({},i),{currentUserID:this._tuiCallEngine.getUserId(),currentCallStatus:this._tuiCallEngine.getCallStatus(),inviteeList:this._tuiCallEngine.getInviterInviteIdList()})},type:"event"}),v.default.info(l+".onInviteeRejected - params:",i),R=i.data.inviteID,I=JSON.parse(i.data.data),y.isCallSignaling(I==null?void 0:I.businessID)?this._tuiCallEngine.isGroupCall()||this._tuiCallEngine.getSwitchCallModeStatus()||this._tuiCallEngine.getAudioVideoSwitchIdList().indexOf(R)===-1?(h=i.data.invitee,_=i.data.inviter,D=this._tuiCallEngine.getUserId(),(E=this._tuiCallEngine.getCallStatus())===t.CALL_STATUS.IDLE?[2]:this._tuiCallEngine.getInviterInviteIdList().indexOf(R)===-1?(this._tuiCallEngine.isInviter()&&this._tuiCallEngine.getInviterInviteIdUserList().indexOf(h)!==-1||this._tuiCallEngine.deleteUnHandledInviteeList([h]),[2]):(b=this._tuiCallEngine.generateEventData(),A=e({userID:h},b),D!==h||E!==t.CALL_STATUS.CALLING?[3,2]:[4,this._tuiCallEngine._resetTUICallEngine()])):(v.default.info(l+".onInviteeRejected - Audio and video switching is not available"),this._tuiCallEngine.setSwitchCallModeStatus(!0),[2]):[2];case 1:return V.sent(),this._tuiCallEngine._delegate.onCallingCancel(A),[2];case 2:return p=this._tuiCallEngine.isGroupCall(),m=this._tuiCallEngine.isInviter(),this._tuiCallEngine.deleteUnHandledInviteeList([h]),U=this._tuiCallEngine.getUnHandledInviteeList(),P=this._tuiCallEngine.getHandledInviteeList(),E===t.CALL_STATUS.CONNECTED&&P.indexOf(h)!==-1?[2]:I.line_busy==="line_busy"||I.line_busy===""||!((s=I==null?void 0:I.data)===null||s===void 0)&&s.message&&I.data.message==="lineBusy"?p?[3,4]:[4,this._tuiCallEngine._resetTUICallEngine()]:[3,7];case 3:return V.sent(),this._tuiCallEngine._delegate.onCallingCancel(e(e({},A),{reason:T.NAME.BUSYLINE})),[3,6];case 4:return U.length!==0||P.length!==1?[3,6]:[4,this._tuiCallEngine._resetTUICallEngine()];case 5:V.sent(),this._tuiCallEngine._delegate.onCallingCancel(e(e({},A),{reason:T.NAME.BUSYLINE})),V.label=6;case 6:return _===this._tuiCallEngine.getInviterID()&&this._tuiCallEngine._delegate.onLineBusy(h),[3,18];case 7:return p?[3,9]:[4,this._tuiCallEngine._resetTUICallEngine()];case 8:return V.sent(),this._tuiCallEngine._delegate.onCallingCancel(e(e({},A),{reason:T.NAME.REJECT})),this._tuiCallEngine._delegate.onReject(h),[3,18];case 9:return E!==t.CALL_STATUS.CALLING?[3,15]:m?U.length!==0||P.length!==1?[3,11]:[4,this._tuiCallEngine._resetTUICallEngine()]:[3,12];case 10:V.sent(),this._tuiCallEngine._delegate.onCallingCancel(e(e({},A),{reason:T.NAME.REJECT})),V.label=11;case 11:return[3,14];case 12:return U.length!==1||P.length!==0?[3,14]:[4,this._tuiCallEngine._resetTUICallEngine()];case 13:V.sent(),this._tuiCallEngine._delegate.onCallingCancel(e(e({},A),{reason:T.NAME.REJECT})),V.label=14;case 14:return[3,17];case 15:return U.length!==0||P.length!==1?[3,17]:(k=this._tuiCallEngine.generateCallEndData({userId:h}),[4,this._tuiCallEngine._resetTUICallEngine()]);case 16:V.sent(),this._tuiCallEngine._delegate.onCallEnd(k),V.label=17;case 17:this._tuiCallEngine._delegate.onReject(h),V.label=18;case 18:return[2]}})})},L.prototype.onInvitationCancelled=function(i){return r(this,void 0,void 0,function(){var s,R;return o(this,function(I){switch(I.label){case 0:return this._logger.info(l+".onInvitationCancelled",{text:{data:e(e({},i),{currentUserID:this._tuiCallEngine.getUserId(),currentCallStatus:this._tuiCallEngine.getCallStatus(),inviteeList:this._tuiCallEngine.getInviterInviteIdList()})},type:"event"}),v.default.info(l+".onInvitationCancelled - params:",i,this._tuiCallEngine.getCallStatus()),s=JSON.parse(i.data.data),y.isCallSignaling(s==null?void 0:s.businessID)?this._tuiCallEngine.getCallStatus()===t.CALL_STATUS.IDLE||this._tuiCallEngine.getInviterInviteIdList().indexOf(i.data.inviteID)===-1?[2]:(R=this._tuiCallEngine.generateEventData(),[4,this._tuiCallEngine._resetTUICallEngine()]):[2];case 1:return I.sent(),this._tuiCallEngine._delegate.onCallingCancel(e(e({userID:this._tuiCallEngine.getUserId()},R),{reason:T.NAME.NORMAL})),[2]}})})},L.prototype.onInvitationTimeout=function(i){var s;return r(this,void 0,void 0,function(){var R,I,h,_,D,E,b,A,p,m,U,P,k,V,x;return o(this,function(j){switch(j.label){case 0:return this._logger.info(l+".onInvitationTimeout",{text:{data:e(e({},i),{currentUserID:this._tuiCallEngine.getUserId(),isGroupCall:this._tuiCallEngine.isGroupCall(),currentCallStatus:this._tuiCallEngine.getCallStatus()})},type:"event"}),R=i.data,I=R.inviter,h=R.inviteeList,_=h===void 0?[]:h,D=R.inviteID,E=this._tuiCallEngine.getUserId(),b=this._tuiCallEngine.isGroupCall(),A=this._tuiCallEngine.isInviter(),p=this._tuiCallEngine.getCallStatus(),this._tuiCallEngine.deleteUnHandledInviteeList(_),v.default.info(l+".onInvitationTimeout - params:",i,"currentUserID:"+E+" isInviter:"+A+" isGroupCall:"+b+" currentCallStatus:"+p+" inviteID:"+((s=this==null?void 0:this._newInvitationData)===null||s===void 0?void 0:s.inviteID)),this._tuiCallEngine.getInviterInviteIdList().indexOf(D)===-1?[2]:p===t.CALL_STATUS.IDLE?[2]:p!==t.CALL_STATUS.CONNECTED||b?(m=this._tuiCallEngine.getHandledInviteeList(),U=this._tuiCallEngine.getUnHandledInviteeList(),P=e(e({},this._tuiCallEngine.generateEventData()),{reason:T.NAME.TIMEOUT}),b?[3,2]:[4,this._tuiCallEngine._resetTUICallEngine()]):[2];case 1:return j.sent(),A?(this._tuiCallEngine._delegate.onCallingCancel(e({userID:_[0]},P)),this._tuiCallEngine._delegate.onNoResp(I,_)):(this._tuiCallEngine._delegate.onCallingCancel(e({userID:_[0]||""},P)),k=this._tuiCallEngine.getCallRecordReport().getCallRecordData().head,this._tuiCallEngine.getCallRecordReport().eventUpload(e(e({},k),{eventType:T.NAME.NOT_ANSWER_CALL,inviteID:this._tuiCallEngine.getInitialCallId()}))),[3,12];case 2:return p!==t.CALL_STATUS.CALLING?[3,10]:A?U.length!==0?[3,4]:[4,this._tuiCallEngine._resetTUICallEngine()]:[3,5];case 3:j.sent(),this._tuiCallEngine._delegate.onCallingCancel(e({userID:_.join(",")},P)),j.label=4;case 4:return this._tuiCallEngine._delegate.onNoResp(I,_),[3,9];case 5:return _.indexOf(E)!==-1?[3,6]:(this._tuiCallEngine._delegate.onNoResp(I,_),[3,8]);case 6:return[4,this._tuiCallEngine._resetTUICallEngine()];case 7:j.sent(),this._tuiCallEngine._delegate.onCallingCancel(e({userID:E},P)),j.label=8;case 8:V=this._tuiCallEngine.getCallRecordReport().getCallRecordData().head,this._tuiCallEngine.getCallRecordReport().eventUpload(e(e({},V),{eventType:T.NAME.NOT_ANSWER_CALL,inviteID:this._tuiCallEngine.getInitialCallId()})),j.label=9;case 9:return[3,12];case 10:return this._tuiCallEngine._delegate.onNoResp(I,_),m.length!==1||U.length!==0?[3,12]:(x=this._tuiCallEngine.generateCallEndData(),[4,this._tuiCallEngine._resetTUICallEngine()]);case 11:j.sent(),this._tuiCallEngine._delegate.onCallEnd(x),j.label=12;case 12:return[2]}})})},L.prototype.onKickedOut=function(){return r(this,void 0,void 0,function(){return o(this,function(i){switch(i.label){case 0:return this._logger.info(l+".onKickedOut",{text:{error:"onKickedOut"},type:"event"}),v.default.info(l+".onKickedOut"),this._tuiCallEngine.setIsLogin(!1),this._tuiCallEngine._trtcClient.removeTRTCEvents(),[4,this._tuiCallEngine._resetTUICallEngine()];case 1:return i.sent(),this._tuiCallEngine._delegate.onKickedOut(),[2]}})})},L.prototype.onNetStateChange=function(){v.default.debug(l+".onNetStateChange")},L.prototype.onUserStatusUpdated=function(i){return r(this,void 0,void 0,function(){var s,R,I,h=this;return o(this,function(_){switch(_.label){case 0:return this._logger.info(l+".onUserStatusUpdated",{text:{data:i},type:"event"}),(s=(i.data||[]).find(function(D){return D.userID===h._tuiCallEngine.getUserId()}))?(R=T.CUSTOM_STATUS_MAP[s.customStatus],(I=this._tuiCallEngine.getCallStatus())===t.CALL_STATUS.IDLE||R===I?[3,2]:[4,this._tuiCallEngine.setSelfIMCallStatus(I)]):[2];case 1:_.sent(),_.label=2;case 2:return[2]}})})},L.prototype.onMessageSentByMe=function(i){this._tuiCallEngine._delegate.onMessageSentByMe(i)},L.prototype.login=function(i){return r(this,void 0,void 0,function(){var s=this;return o(this,function(R){return this._logger.info(l+".login.start",{text:{data:i},type:"api"}),[2,new Promise(function(I,h){s._chat.login(i).then(function(_){var D;!((D=_.data)===null||D===void 0)&&D.repeatLogin&&(s._logger.info(l+".login.success",{text:{error:"The TIM login status has been inherited into Call"},type:"api"}),v.default.info(l+".login - success: The TIM login status has been inherited into Call. IM 登录状态已成功被 Call 继承。"),s._chat.isReady()&&s._tuiCallEngine._delegate.onSdkReady({name:"ts_im_ready"}),I()),s._loginResolveList.push({resolve:I,value:_})}).catch(function(_){var D=_||{},E=D.code,b=D.message;E===2024||E===2025?(s._logger.warn(l+".login.fail",{text:{error:E+", "+b},type:"api"}),v.default.warn(l+".login failed: "+E+", "+b+"."),s._loginResolveList.push({resolve:I,value:{code:0,message:"success"}})):(s._logger.error(l+".login.fail",{text:{error:E+", "+b},type:"api"}),h(_))})})]})})},L.prototype.logout=function(){return r(this,void 0,void 0,function(){return o(this,function(i){return this._joined=!1,this._loginResolveList=[],[2,this._chat.logout()]})})},L.prototype.invite=function(i){return r(this,void 0,void 0,function(){var s,R,I,h,_,D,E,b,A,p,m;return o(this,function(U){switch(U.label){case 0:return this._logger.info(l+".invite.start",{text:{data:i},type:"api"}),s=i.userID,R=i.type,I=i.roomId,h=i.strRoomId,_=i.timeout,D=i.offlinePushInfo,E=i.userIDList,b=i.userData,A=b===void 0?"":b,p=this.handleNewSignaling({version:0,call_type:R,room_id:I,str_room_id:h},{userIDs:E},A),[4,this._chat.invite({userID:s,data:JSON.stringify(p),timeout:_,offlinePushInfo:this._convertOfflinePushParams(D)})];case 1:return m=U.sent(),this._tuiCallEngine.setInitialInviteData(p),[2,e(e({},m),{roomID:I,strRoomID:h,userID:s})]}})})},L.prototype.inviteInGroup=function(i){return r(this,void 0,void 0,function(){var s,R,I,h,_,D,E,b,A,p,m,U,P;return o(this,function(k){switch(k.label){case 0:return this._logger.info(l+".inviteInGroup.start",{text:{data:i},type:"api"}),s=i.groupID,R=i.userIDList,I=i.roomId,h=i.strRoomId,_=i.type,D=i.timeout,E=i.offlinePushInfo,b=i.inCallUserIDs,A=i.userData,p=A===void 0?"":A,m=i.initialCallId,U=m===void 0?"":m,[4,this._chat.inviteInGroup({groupID:s,inviteeList:R,data:JSON.stringify(this.handleNewSignaling({version:0,call_type:_,room_id:I,str_room_id:h,inCallUserIDs:b},{initialCallId:U},p)),timeout:D,offlinePushInfo:this._convertOfflinePushParams(E)})];case 1:return P=k.sent(),[2,e(e({},P),{roomID:I,strRoomID:h,groupID:s})]}})})},L.prototype.hangup=function(i){return r(this,void 0,void 0,function(){var s,R,I,h,_,D,E,b;return o(this,function(A){switch(A.label){case 0:return this._logger.info(l+".hangup.start",{text:{data:i},type:"api"}),v.default.info(l+".hangup - params:",i),s=i.userIDList,R=i.callType,I=i.callEnd,_={version:0,call_type:R,call_end:h=I===void 0?0:I},D={cmd:t.CMD_TYPE.HANG_UP},E=JSON.stringify(this.handleNewSignaling(_,D)),b=this._tuiCallEngine.generateCallEndData({callMediaType:R,totalTime:h}),this._tuiCallEngine._delegate.onCallEnd(b),this._tuiCallEngine.isGroupCall()&&this._tuiCallEngine.getGroupId()?[4,this._chat.inviteInGroup({inviteeList:s,groupID:this._tuiCallEngine.getGroupId(),data:E,timeout:0})]:[3,2];case 1:return A.sent(),[3,4];case 2:return[4,this._chat.invite({userID:s[0],data:E,timeout:0})];case 3:A.sent(),A.label=4;case 4:return this._joined=!1,[2]}})})},L.prototype.accept=function(i,s){return r(this,void 0,void 0,function(){var R,I,h;return o(this,function(_){switch(_.label){case 0:return this._logger.info(l+".accept.start",{text:{data:i},type:"api"}),R=i.inviteID,I=i.callType,h=f(i,["inviteID","callType"]),[4,this._chat.accept({inviteID:R,data:JSON.stringify(this.handleNewSignaling(e({version:0,call_type:I},h),s))})];case 1:return[2,_.sent()]}})})},L.prototype.reject=function(i){return r(this,void 0,void 0,function(){var s,R,I,h;return o(this,function(_){switch(_.label){case 0:return this._logger.info(l+".reject.start",{text:{data:{params:i}},type:"api"}),s=i.inviteID,R=i.callType,I=i.isBusy,[4,this._tuiCallEngine.modifyInvitation(s)];case 1:return _.sent(),h={version:0,call_type:R},I&&(h.line_busy="line_busy"),[2,this._chat.reject({inviteID:s,data:JSON.stringify(this.handleNewSignaling(h,{message:I?"lineBusy":""}))})]}})})},L.prototype.cancel=function(i){return r(this,void 0,void 0,function(){var s,R;return o(this,function(I){return this._logger.info(l+".cancel.start",{text:{data:i},type:"api"}),s=i.inviteID,R=JSON.stringify(this.handleNewSignaling({version:4,businessID:T.NAME.AV_CALL,call_type:this._tuiCallEngine.getCallType()})),[2,this._chat.cancel({inviteID:s,data:R})]})})},L.prototype.resetJoined=function(){this._joined=!1},L.prototype.switchCallMode=function(i){return r(this,void 0,void 0,function(){var s,R,I,h,_,D,E,b;return o(this,function(A){switch(A.label){case 0:return s=i.userID,R=i.callType,I=i.roomID,h=i.timeout,_=i.mode,D={version:0,call_type:R,room_id:I,switch_to_audio_call:null},E={cmd:t.CMD_TYPE.SWITCH_TO_VIDEO},_===t.MODE_TYPE.AUDIO?(D.switch_to_audio_call=t.CMD_TYPE.SWITCH_TO_AUDIO_CALL,E.cmd=t.CMD_TYPE.SWITCH_TO_AUDIO):delete D.switch_to_audio_call,[4,this._chat.invite({userID:s,data:JSON.stringify(this.handleNewSignaling(D,E)),timeout:h})];case 1:return(b=A.sent()).inviteID&&this._tuiCallEngine.addAudioVideoSwitchIdList(b.inviteID),[2]}})})},L.prototype.handleNewSignaling=function(i,s,R){var I=e(e({userData:R||""},i),{version:4,businessID:T.NAME.AV_CALL,platform:"Web",data:e({cmd:t.CMD_TYPE_LIST[i.call_type],room_id:i.room_id,str_room_id:i.str_room_id,inviter:this._tuiCallEngine.getInviterID(),message:""},s)});return delete I.str_room_id,I},L.prototype._convertOfflinePushParams=function(i){if(i===void 0&&(i={}),Object.keys(i).length===0)return{};var s=i.title,R=i.description,I=i.androidOPPOChannelID,h=i.extension,_=i.isDisablePush,D=i.iOSPushType,E=D===void 0?t.IOSOfflinePushType.APNs:D,b=i.ignoreIOSBadge,A=i.iOSSound,p=i.androidSound,m=i.androidVIVOClassification;return{title:s||"",description:R||"",extension:h||"",disablePush:_||!1,androidInfo:{sound:p,XiaoMiChannelID:i.androidXiaoMiChannelID,OPPOChannelID:I,FCMChannelID:i.androidFCMChannelID,VIVOClassification:m,HuaWeiCategory:i.androidHuaWeiCategory},apnsInfo:{sound:A,ignoreIOSBadge:b||!1,disableVoipPush:E!==1}}},L}();c.default=C},function(H,c,a){var e=this&&this.__assign||function(){return(e=Object.assign||function(t){for(var l,T=1,y=arguments.length;T<y;T++)for(var C in l=arguments[T])Object.prototype.hasOwnProperty.call(l,C)&&(t[C]=l[C]);return t}).apply(this,arguments)};Object.defineProperty(c,"__esModule",{value:!0});var r=a(8),o=a(16),f=a(2),S=a(13),u=a(18),d="TUICallObserver",v=function(){function t(l){this._eventEmitter=l,this._callEngineLogger=r.default(),this._eventStatController=new u.default,S.default.bindController(this._eventStatController)}return t.prototype.onError=function(l,T){this._callEngineLogger.error("onError",{type:"event",text:{error:{code:l,msg:T}}}),f.default.debug(d+".onError code:"+l+" msg:"+T),this._eventEmitter.emit(o.TUICallEvent.ERROR,{code:l,msg:T})},t.prototype.onSdkReady=function(l){this._callEngineLogger.info("TUICallEvent.SDK_READY",{type:"event",text:{data:{params:l}}}),f.default.debug(d+".onSdkReady params:"+l),this._eventEmitter.emit(o.TUICallEvent.SDK_READY,l)},t.prototype.onInvited=function(l){this._callEngineLogger.info("TUICallEvent.INVITED",{type:"event",text:{data:{params:l}}}),f.default.debug(d+".onInvited params:",l);var T=l.sponsor,y=l.userIDList,C=l.isFromGroup,L=l.inviteData,i=l.inviteID,s=l.userData,R=s===void 0?"":s,I=l.calleeIdList,h=l.callID,_=l.roomID,D=l.strRoomID,E=l.callMediaType,b=l.callRole,A={callID:h,calleeIdList:I,groupID:l.groupID,callMediaType:E,roomID:_,strRoomID:D,callRole:b,userData:R},p=e({sponsor:T,userIDList:y,isFromGroup:C,inviteData:L,inviteID:i},A);this._eventEmitter.emit(o.TUICallEvent.INVITED,p),this._eventEmitter.emit(o.TUICallEvent.ON_CALL_RECEIVED,A)},t.prototype.onUserAccept=function(l){this._callEngineLogger.info("TUICallEvent.USER_ACCEPT",{type:"event",text:{data:{userID:l}}}),f.default.debug(d+".onUserAccept userID:"+l),this._eventEmitter.emit(o.TUICallEvent.USER_ACCEPT,{userID:l})},t.prototype.onCallBegin=function(l){this._callEngineLogger.info("TUICallEvent.ON_CALL_BEGIN",{type:"event",text:{data:{params:l}}}),f.default.debug(d+".onCallBegin params:"+JSON.stringify(l)),this._eventEmitter.emit(o.TUICallEvent.ON_CALL_BEGIN,l)},t.prototype.onUserEnter=function(l){this._callEngineLogger.info("TUICallEvent.USER_ENTER",{type:"event",text:{data:{userID:l}}}),f.default.debug(d+".onUserEnter userID:"+l),this._eventEmitter.emit(o.TUICallEvent.USER_ENTER,{userID:l})},t.prototype.onUserLeave=function(l){this._callEngineLogger.info("TUICallEvent.USER_LEAVE",{type:"event",text:{data:{userID:l}}}),f.default.debug(d+".onUserLeave userID:"+l),this._eventEmitter.emit(o.TUICallEvent.USER_LEAVE,{userID:l})},t.prototype.onReject=function(l){this._callEngineLogger.info("TUICallEvent.REJECT",{type:"event",text:{data:{userID:l}}}),f.default.debug(d+".onReject userID:"+l),this._eventEmitter.emit(o.TUICallEvent.REJECT,{userID:l})},t.prototype.onNoResp=function(l,T){this._callEngineLogger.info("TUICallEvent.NO_RESP",{type:"event",text:{data:{sponsor:l,userIDList:T}}}),f.default.debug(d+".onNoResp userIDList:",l,T),this._eventEmitter.emit(o.TUICallEvent.NO_RESP,{sponsor:l,userIDList:T})},t.prototype.onLineBusy=function(l){this._callEngineLogger.info("TUICallEvent.LINE_BUSY",{type:"event",text:{data:{userID:l}}}),f.default.debug(d+".onLineBusy userID:"+l),this._eventEmitter.emit(o.TUICallEvent.LINE_BUSY,{userID:l})},t.prototype.onCallingCancel=function(l,T){this._callEngineLogger.info("TUICallEvent.ON_CALL_CANCELED",{type:"event",text:{data:{params:l}}}),f.default.debug(d+".onCallingCancel ",l),this._eventEmitter.emit(o.TUICallEvent.CALLING_CANCEL,l),this._eventEmitter.emit(o.TUICallEvent.ON_CALL_CANCELED,l)},t.prototype.onKickedOut=function(){this._callEngineLogger.info("TUICallEvent.KICKED_OUT",{type:"event"}),f.default.debug(d+".onKickedOut"),this._eventEmitter.emit(o.TUICallEvent.KICKED_OUT,{})},t.prototype.onCallingTimeout=function(l,T){this._callEngineLogger.info("TUICallEvent.CALLING_TIMEOUT",{type:"event",text:{data:{sponsor:l,userIDList:T}}}),f.default.debug(d+".onCallingTimeout userIDList:",T),this._eventEmitter.emit(o.TUICallEvent.CALLING_TIMEOUT,{sponsor:l,userIDList:T})},t.prototype.onCallEnd=function(l){this._callEngineLogger.info("TUICallEvent.CALLING_END",{type:"event",text:{data:{params:l}}}),f.default.debug(d+".onCallEnd params:"+l),this._eventEmitter.emit(o.TUICallEvent.CALLING_END,e(e({},l),{callEnd:l.totalTime}))},t.prototype.onUserVideoAvailable=function(l){this._callEngineLogger.info("TUICallEvent.USER_VIDEO_AVAILABLE",{type:"event",text:{data:{params:l}}}),f.default.debug(d+".onUserVideoAvailable params:",l);var T=l.userID,y=l.isVideoAvailable;this._eventEmitter.emit(o.TUICallEvent.USER_VIDEO_AVAILABLE,{userID:T,isVideoAvailable:y})},t.prototype.onUserAudioAvailable=function(l){this._callEngineLogger.info("TUICallEvent.USER_AUDIO_AVAILABLE",{type:"event",text:{data:{params:l}}}),f.default.debug(d+".onUserAudioAvailable params:",l);var T=l.userID,y=l.isAudioAvailable;this._eventEmitter.emit(o.TUICallEvent.USER_AUDIO_AVAILABLE,{userID:T,isAudioAvailable:y})},t.prototype.onUserVoiceVolume=function(l){this._eventEmitter.emit(o.TUICallEvent.USER_VOICE_VOLUME,{volumeMap:l})},t.prototype.onGroupCallInviteeListUpdate=function(l){this._callEngineLogger.info("TUICallEvent.GROUP_CALL_INVITEE_LIST_UPDATE",{type:"event",text:{data:{userIDList:l}}}),this._eventEmitter.emit(o.TUICallEvent.GROUP_CALL_INVITEE_LIST_UPDATE,{userIDList:l})},t.prototype.onCallTypeChanged=function(l,T){this._callEngineLogger.info("TUICallEvent.CALL_TYPE_CHANGED",{type:"event",text:{data:{oldCallType:l,newCallType:T}}}),this._eventEmitter.emit(o.TUICallEvent.CALL_TYPE_CHANGED,{oldCallType:l,newCallType:T})},t.prototype.onDeviceUpdated=function(l,T){var y=l.microphone,C=l.speaker,L=l.camera,i=T.microphone,s=T.speaker,R=T.camera;this._callEngineLogger.info("TUICallEvent.DEVICED_UPDATED",{type:"event",text:{data:e(e({},l),T)}}),this._eventEmitter.emit(o.TUICallEvent.DEVICED_UPDATED,{microphoneList:y,cameraList:L,speakerList:C,currentMicrophone:i,currentCamera:R,currentSpeaker:s})},t.prototype.onUserNetworkQualityChanged=function(l){this._eventEmitter.emit(o.TUICallEvent.ON_USER_NETWORK_QUALITY_CHANGED,{networkQualityList:l})},t.prototype.onMessageSentByMe=function(l){this._eventEmitter.emit(o.TUICallEvent.MESSAGE_SENT_BY_ME,l)},t}();c.default=v},function(H,c,a){var e=a(3),r=a(21),o=a(42),f=a(27);function S(d){var v=new o(d),t=r(o.prototype.request,v);return e.extend(t,o.prototype,v),e.extend(t,v),t}var u=S(a(17));u.Axios=o,u.create=function(d){return S(f(u.defaults,d))},u.Cancel=a(28),u.CancelToken=a(57),u.isCancel=a(26),u.all=function(d){return Promise.all(d)},u.spread=a(58),u.isAxiosError=a(59),H.exports=u,H.exports.default=u},function(H,c,a){var e=a(3),r=a(22),o=a(43),f=a(44),S=a(27),u=a(55),d=u.validators;function v(t){this.defaults=t,this.interceptors={request:new o,response:new o}}v.prototype.request=function(t){typeof t=="string"?(t=arguments[1]||{}).url=arguments[0]:t=t||{},(t=S(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var l=t.transitional;l!==void 0&&u.assertOptions(l,{silentJSONParsing:d.transitional(d.boolean,"1.0.0"),forcedJSONParsing:d.transitional(d.boolean,"1.0.0"),clarifyTimeoutError:d.transitional(d.boolean,"1.0.0")},!1);var T=[],y=!0;this.interceptors.request.forEach(function(h){typeof h.runWhen=="function"&&h.runWhen(t)===!1||(y=y&&h.synchronous,T.unshift(h.fulfilled,h.rejected))});var C,L=[];if(this.interceptors.response.forEach(function(h){L.push(h.fulfilled,h.rejected)}),!y){var i=[f,void 0];for(Array.prototype.unshift.apply(i,T),i=i.concat(L),C=Promise.resolve(t);i.length;)C=C.then(i.shift(),i.shift());return C}for(var s=t;T.length;){var R=T.shift(),I=T.shift();try{s=R(s)}catch(h){I(h);break}}try{C=f(s)}catch(h){return Promise.reject(h)}for(;L.length;)C=C.then(L.shift(),L.shift());return C},v.prototype.getUri=function(t){return t=S(this.defaults,t),r(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},e.forEach(["delete","get","head","options"],function(t){v.prototype[t]=function(l,T){return this.request(S(T||{},{method:t,url:l,data:(T||{}).data}))}}),e.forEach(["post","put","patch"],function(t){v.prototype[t]=function(l,T,y){return this.request(S(y||{},{method:t,url:l,data:T}))}}),H.exports=v},function(H,c,a){var e=a(3);function r(){this.handlers=[]}r.prototype.use=function(o,f,S){return this.handlers.push({fulfilled:o,rejected:f,synchronous:!!S&&S.synchronous,runWhen:S?S.runWhen:null}),this.handlers.length-1},r.prototype.eject=function(o){this.handlers[o]&&(this.handlers[o]=null)},r.prototype.forEach=function(o){e.forEach(this.handlers,function(f){f!==null&&o(f)})},H.exports=r},function(H,c,a){var e=a(3),r=a(45),o=a(26),f=a(17);function S(u){u.cancelToken&&u.cancelToken.throwIfRequested()}H.exports=function(u){return S(u),u.headers=u.headers||{},u.data=r.call(u,u.data,u.headers,u.transformRequest),u.headers=e.merge(u.headers.common||{},u.headers[u.method]||{},u.headers),e.forEach(["delete","get","head","post","put","patch","common"],function(d){delete u.headers[d]}),(u.adapter||f.adapter)(u).then(function(d){return S(u),d.data=r.call(u,d.data,d.headers,u.transformResponse),d},function(d){return o(d)||(S(u),d&&d.response&&(d.response.data=r.call(u,d.response.data,d.response.headers,u.transformResponse))),Promise.reject(d)})}},function(H,c,a){var e=a(3),r=a(17);H.exports=function(o,f,S){var u=this||r;return e.forEach(S,function(d){o=d.call(u,o,f)}),o}},function(H,c){var a,e,r=H.exports={};function o(){throw new Error("setTimeout has not been defined")}function f(){throw new Error("clearTimeout has not been defined")}function S(L){if(a===setTimeout)return setTimeout(L,0);if((a===o||!a)&&setTimeout)return a=setTimeout,setTimeout(L,0);try{return a(L,0)}catch{try{return a.call(null,L,0)}catch{return a.call(this,L,0)}}}(function(){try{a=typeof setTimeout=="function"?setTimeout:o}catch{a=o}try{e=typeof clearTimeout=="function"?clearTimeout:f}catch{e=f}})();var u,d=[],v=!1,t=-1;function l(){v&&u&&(v=!1,u.length?d=u.concat(d):t=-1,d.length&&T())}function T(){if(!v){var L=S(l);v=!0;for(var i=d.length;i;){for(u=d,d=[];++t<i;)u&&u[t].run();t=-1,i=d.length}u=null,v=!1,function(s){if(e===clearTimeout)return clearTimeout(s);if((e===f||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(s);try{e(s)}catch{try{return e.call(null,s)}catch{return e.call(this,s)}}}(L)}}function y(L,i){this.fun=L,this.array=i}function C(){}r.nextTick=function(L){var i=new Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)i[s-1]=arguments[s];d.push(new y(L,i)),d.length!==1||v||S(T)},y.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=C,r.addListener=C,r.once=C,r.off=C,r.removeListener=C,r.removeAllListeners=C,r.emit=C,r.prependListener=C,r.prependOnceListener=C,r.listeners=function(L){return[]},r.binding=function(L){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(L){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(H,c,a){var e=a(3);H.exports=function(r,o){e.forEach(r,function(f,S){S!==o&&S.toUpperCase()===o.toUpperCase()&&(r[o]=f,delete r[S])})}},function(H,c,a){var e=a(25);H.exports=function(r,o,f){var S=f.config.validateStatus;f.status&&S&&!S(f.status)?o(e("Request failed with status code "+f.status,f.config,null,f.request,f)):r(f)}},function(H,c,a){var e=a(3);H.exports=e.isStandardBrowserEnv()?{write:function(r,o,f,S,u,d){var v=[];v.push(r+"="+encodeURIComponent(o)),e.isNumber(f)&&v.push("expires="+new Date(f).toGMTString()),e.isString(S)&&v.push("path="+S),e.isString(u)&&v.push("domain="+u),d===!0&&v.push("secure"),document.cookie=v.join("; ")},read:function(r){var o=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return o?decodeURIComponent(o[3]):null},remove:function(r){this.write(r,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(H,c,a){var e=a(51),r=a(52);H.exports=function(o,f){return o&&!e(f)?r(o,f):f}},function(H,c,a){H.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(H,c,a){H.exports=function(e,r){return r?e.replace(/\/+$/,"")+"/"+r.replace(/^\/+/,""):e}},function(H,c,a){var e=a(3),r=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];H.exports=function(o){var f,S,u,d={};return o&&e.forEach(o.split(`
`),function(v){if(u=v.indexOf(":"),f=e.trim(v.substr(0,u)).toLowerCase(),S=e.trim(v.substr(u+1)),f){if(d[f]&&r.indexOf(f)>=0)return;d[f]=f==="set-cookie"?(d[f]?d[f]:[]).concat([S]):d[f]?d[f]+", "+S:S}}),d}},function(H,c,a){var e=a(3);H.exports=e.isStandardBrowserEnv()?function(){var r,o=/(msie|trident)/i.test(navigator.userAgent),f=document.createElement("a");function S(u){var d=u;return o&&(f.setAttribute("href",d),d=f.href),f.setAttribute("href",d),{href:f.href,protocol:f.protocol?f.protocol.replace(/:$/,""):"",host:f.host,search:f.search?f.search.replace(/^\?/,""):"",hash:f.hash?f.hash.replace(/^#/,""):"",hostname:f.hostname,port:f.port,pathname:f.pathname.charAt(0)==="/"?f.pathname:"/"+f.pathname}}return r=S(window.location.href),function(u){var d=e.isString(u)?S(u):u;return d.protocol===r.protocol&&d.host===r.host}}():function(){return!0}},function(H,c,a){var e=a(56),r={};["object","boolean","number","function","string","symbol"].forEach(function(u,d){r[u]=function(v){return typeof v===u||"a"+(d<1?"n ":" ")+u}});var o={},f=e.version.split(".");function S(u,d){for(var v=d?d.split("."):f,t=u.split("."),l=0;l<3;l++){if(v[l]>t[l])return!0;if(v[l]<t[l])return!1}return!1}r.transitional=function(u,d,v){var t=d&&S(d);function l(T,y){return"[Axios v"+e.version+"] Transitional option '"+T+"'"+y+(v?". "+v:"")}return function(T,y,C){if(u===!1)throw new Error(l(y," has been removed in "+d));return t&&!o[y]&&(o[y]=!0,console.warn(l(y," has been deprecated since v"+d+" and will be removed in the near future"))),!u||u(T,y,C)}},H.exports={isOlderVersion:S,assertOptions:function(u,d,v){if(typeof u!="object")throw new TypeError("options must be an object");for(var t=Object.keys(u),l=t.length;l-- >0;){var T=t[l],y=d[T];if(y){var C=u[T],L=C===void 0||y(C,T,u);if(L!==!0)throw new TypeError("option "+T+" must be "+L)}else if(v!==!0)throw Error("Unknown option "+T)}},validators:r}},function(H){H.exports=JSON.parse('{"name":"axios","version":"0.21.4","description":"Promise based HTTP client for the browser and node.js","main":"index.js","scripts":{"test":"grunt test","start":"node ./sandbox/server.js","build":"NODE_ENV=production grunt build","preversion":"npm test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json","postversion":"git push && git push --tags","examples":"node ./examples/server.js","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","fix":"eslint --fix lib/**/*.js"},"repository":{"type":"git","url":"https://github.com/axios/axios.git"},"keywords":["xhr","http","ajax","promise","node"],"author":"Matt Zabriskie","license":"MIT","bugs":{"url":"https://github.com/axios/axios/issues"},"homepage":"https://axios-http.com","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"jsdelivr":"dist/axios.min.js","unpkg":"dist/axios.min.js","typings":"./index.d.ts","dependencies":{"follow-redirects":"^1.14.0"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}]}')},function(H,c,a){var e=a(28);function r(o){if(typeof o!="function")throw new TypeError("executor must be a function.");var f;this.promise=new Promise(function(u){f=u});var S=this;o(function(u){S.reason||(S.reason=new e(u),f(S.reason))})}r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var o;return{token:new r(function(f){o=f}),cancel:o}},H.exports=r},function(H,c,a){H.exports=function(e){return function(r){return e.apply(null,r)}}},function(H,c,a){H.exports=function(e){return typeof e=="object"&&e.isAxiosError===!0}},function(H,c,a){a.r(c);var e=a(2);const r="none",o="online",f=function(){let S=window.location.protocol;return["http:","https:"].indexOf(S)<0&&(S="http:"),S};c.default=class{constructor(){this._networkType="",this.maxWaitTime=3e3}start(){this._networkType=o}_onNetworkStatusChange(S){this._networkType=S.networkType,S.isConnected?e.default.info("NetMonitor networkType:"+S.networkType):e.default.warn("NetMonitor no network, please check!")}probe(){return new Promise(S=>{if(window&&window.fetch)fetch(`${f()}//webim-1252463788.file.myqcloud.com/assets/test/speed.xml?random=${Math.random()}`).then(u=>{u.ok?S([!0,o]):S([!1,r])}).catch(()=>{S([!1,r])});else{const u=new XMLHttpRequest,d=setTimeout(()=>{e.default.warn("NetMonitor fetch timeout. Probably no network, please check!"),u.abort(),this._networkType=r,S([!1,r])},this.maxWaitTime);u.onreadystatechange=function(){u.readyState===4&&(clearTimeout(d),u.status===200||u.status===304?(this._networkType=o,S([!0,o])):(e.default.warn(`NetMonitor fetch status:${u.status}. Probably no network, please check!`),this._networkType=r,S([!1,r])))},u.open("GET",`${f()}//webim-1252463788.file.myqcloud.com/assets/test/speed.xml?random=${Math.random()}`),u.send()}})}getNetworkType(){return this._networkType}reset(){this._networkType=""}}},function(H,c,a){Object.defineProperty(c,"__esModule",{value:!0}),c.apiCallQueue=c.avoidRepeatedCall=c.statusValidate=c.businessValidate=c.paramValidate=c.VALIDATE_PARAMS=void 0;var e=a(62);Object.defineProperty(c,"VALIDATE_PARAMS",{enumerable:!0,get:function(){return e.VALIDATE_PARAMS}});var r=a(63);Object.defineProperty(c,"paramValidate",{enumerable:!0,get:function(){return r.paramValidate}});var o=a(64);Object.defineProperty(c,"businessValidate",{enumerable:!0,get:function(){return o.businessValidate}});var f=a(65);Object.defineProperty(c,"statusValidate",{enumerable:!0,get:function(){return f.statusValidate}});var S=a(66);Object.defineProperty(c,"avoidRepeatedCall",{enumerable:!0,get:function(){return S.avoidRepeatedCall}});var u=a(67);Object.defineProperty(c,"apiCallQueue",{enumerable:!0,get:function(){return u.apiCallQueue}})},function(H,c,a){Object.defineProperty(c,"__esModule",{value:!0}),c.VALIDATE_PARAMS=void 0;var e=a(12),r=a(0);c.VALIDATE_PARAMS={createInstance:{SDKAppID:{required:!0,rules:[r.NAME.NUMBER],allowEmpty:!1},tim:{required:!1,rules:[r.NAME.OBJECT],allowEmpty:!0}},login:{userID:{required:!0,rules:[r.NAME.STRING],allowEmpty:!1},userSig:{required:!0,rules:[r.NAME.STRING],allowEmpty:!1}},call:{userID:{required:!0,rules:[r.NAME.STRING],allowEmpty:!1},type:{required:!0,rules:[r.NAME.NUMBER],range:[1,2],allowEmpty:!1},roomID:{required:!1,rules:[r.NAME.NUMBER],range:"0~"+r.MAX_NUMBER_ROOM_ID,allowEmpty:!1},strRoomID:{required:!1,rules:[r.NAME.STRING],allowEmpty:!0},timeout:{required:!1,rules:[r.NAME.NUMBER],allowEmpty:!1}},groupCall:{userIDList:{required:!0,rules:[r.NAME.ARRAY],allowEmpty:!1},type:{required:!0,rules:[r.NAME.NUMBER],range:[1,2],allowEmpty:!1},groupID:{required:!0,rules:[r.NAME.STRING],allowEmpty:!1},roomID:{required:!1,rules:[r.NAME.NUMBER],range:"0~"+r.MAX_NUMBER_ROOM_ID,allowEmpty:!1},strRoomID:{required:!1,rules:[r.NAME.STRING],allowEmpty:!0},timeout:{required:!1,rules:[r.NAME.NUMBER],allowEmpty:!1}},joinInGroupCall:{type:{required:!0,rules:[r.NAME.NUMBER],range:[1,2],allowEmpty:!1},groupID:{required:!0,rules:[r.NAME.STRING],allowEmpty:!1},roomID:{required:!0,rules:[r.NAME.NUMBER],allowEmpty:!1},strRoomID:{required:!1,rules:[r.NAME.STRING],allowEmpty:!0}},inviteUser:{userIDList:{required:!0,rules:[r.NAME.ARRAY],allowEmpty:!1}},openCamera:[{key:"videoViewDomID",required:!0,rules:[r.NAME.STRING],allowEmpty:!1}],startRemoteView:{userID:{required:!0,rules:[r.NAME.STRING],allowEmpty:!1},videoViewDomID:{required:!0,rules:[r.NAME.STRING],allowEmpty:!1}},stopRemoteView:{userID:{required:!0,rules:[r.NAME.STRING],allowEmpty:!1}},startLocalView:{userID:{required:!0,rules:[r.NAME.STRING],allowEmpty:!1},videoViewDomID:{required:!0,rules:[r.NAME.STRING],allowEmpty:!1}},stopLocalView:{userID:{required:!0,rules:[r.NAME.STRING],allowEmpty:!1}},switchCamera:[{key:"cameraPosition",required:!0,rules:[r.NAME.NUMBER],range:[e.TUICallCameraPosition.FRONT,e.TUICallCameraPosition.BACK],allowEmpty:!1}],switchDevice:{deviceType:{required:!0,rules:[r.NAME.STRING],allowEmpty:!1},deviceId:{required:!0,rules:[r.NAME.STRING],allowEmpty:!1}},setVideoQuality:[{key:"profile",required:!0,rules:[r.NAME.STRING,r.NAME.OBJECT],range:Object.keys(e.TUICommonDefine.VideoEncoderParams),allowEmpty:!1}],switchCallMediaType:[{key:"newMediaType",required:!0,rules:[r.NAME.NUMBER],range:[1,2],allowEmpty:!1}],getDeviceList:[{key:"deviceType",required:!0,rules:[r.NAME.STRING],range:["camera","microphones","speaker","microphone"],allowEmpty:!1}],getCurrentDevice:[{key:"deviceType",required:!0,rules:[r.NAME.STRING],range:["camera","speaker","microphone"],allowEmpty:!1}],setSelfInfo:{nickName:{required:!1,rules:[r.NAME.STRING],allowEmpty:!1},avatar:{required:!1,rules:[r.NAME.STRING],allowEmpty:!1}},setVideoRenderParams:{objectFit:{require:!1,rules:[r.NAME.STRING],range:[r.NAME.CONTAIN,r.NAME.COVER,r.NAME.FILL],allowEmpty:!1},muted:{require:!1,rules:[r.NAME.BOOLEAN],allowEmpty:!1},mirror:{require:!1,rules:[r.NAME.BOOLEAN],allowEmpty:!1}},enableMultiDeviceAbility:[{key:"enable",required:!0,rules:[r.NAME.BOOLEAN],allowEmpty:!1}]}},function(H,c,a){var e=this&&this.__assign||function(){return(e=Object.assign||function(t){for(var l,T=1,y=arguments.length;T<y;T++)for(var C in l=arguments[T])Object.prototype.hasOwnProperty.call(l,C)&&(t[C]=l[C]);return t}).apply(this,arguments)};Object.defineProperty(c,"__esModule",{value:!0}),c.paramValidate=void 0;var r=a(8),o=a(1),f=a(10),S=a(7),u=a(15);function d(t,l,T){var y=r.default();try{if(o.isArray(t))for(var C=0;C<t.length;C++)v.call(this,e(e({},t[C]),{value:l[C],name:T}));else for(var L in t)v.call(this,e(e({},t[L]),{value:l[0][L],name:T,key:L}))}catch(i){throw y.error("paramValidate.fail",{text:{error:i}}),i}}function v(t){var l=t.required,T=t.rules,y=t.range,C=t.value,L=t.allowEmpty,i=t.name,s=t.key;if(o.isUndefined(C)){if(l){var R=u.getErrorMessage({code:S.default.INVALID_PARAMETER_REQUIRED,params:{key:s,value:C,fnName:i}});throw new f.default({code:S.default.ERROR_PARAM_INVALID,message:R})}}else{var I="";if(!T.some(function(E){return E===o.getType(C)})){for(var h=0;h<T.length;h++){var _=T[h];I+=(_=_.replace(_[0],_[0].toUpperCase()))+"/"}throw I=I.substring(0,I.length-1),R=u.getErrorMessage({code:S.default.INVALID_PARAMETER_TYPE,params:{key:s,rule:{type:I},value:C,fnName:i}}),new f.default({code:S.default.ERROR_PARAM_INVALID,message:R})}if(L===!1){if(o.isArray(C)&&C.length===0)throw R=u.getErrorMessage({code:S.default.INVALID_PARAMETER_EMPTY,params:{key:s,fnName:i}}),new f.default({code:S.default.ERROR_PARAM_INVALID,message:R});if(o.isString(C)&&C.trim()==="")throw R=u.getErrorMessage({code:S.default.INVALID_PARAMETER_EMPTY,params:{key:s,value:C}}),new f.default({code:S.default.ERROR_PARAM_INVALID,message:R})}if(o.isArray(y)&&y&&y.indexOf(C)===-1)throw R=u.getErrorMessage({code:S.default.INVALID_PARAMETER_RANGE,params:{key:s,rule:{values:y},value:C,fnName:i}}),new f.default({code:S.default.ERROR_PARAM_INVALID,message:R});if(o.isString(y)&&y.indexOf("~")!==-1){var D=y.split("~");if(C<+D[0]||C>+D[1]||o.isNumber(C)&&Number.isNaN(C))throw R=u.getErrorMessage({code:S.default.INVALID_PARAMETER_RANGE,params:{key:s,rule:{values:y},value:C,fnName:i}}),new f.default({code:S.default.ERROR_PARAM_INVALID,message:R})}}}c.paramValidate=function(t){return function(l,T,y){var C=y.value;return y.value=function(){for(var L=[],i=0;i<arguments.length;i++)L[i]=arguments[i];return d.call(this,t,L,T),C.apply(this,L)},y}}},function(H,c,a){var e=this&&this.__awaiter||function(y,C,L,i){return new(L||(L=Promise))(function(s,R){function I(D){try{_(i.next(D))}catch(E){R(E)}}function h(D){try{_(i.throw(D))}catch(E){R(E)}}function _(D){var E;D.done?s(D.value):(E=D.value,E instanceof L?E:new L(function(b){b(E)})).then(I,h)}_((i=i.apply(y,C||[])).next())})},r=this&&this.__generator||function(y,C){var L,i,s,R,I={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return R={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(R[Symbol.iterator]=function(){return this}),R;function h(_){return function(D){return function(E){if(L)throw new TypeError("Generator is already executing.");for(;I;)try{if(L=1,i&&(s=2&E[0]?i.return:E[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,E[1])).done)return s;switch(i=0,s&&(E=[2&E[0],s.value]),E[0]){case 0:case 1:s=E;break;case 4:return I.label++,{value:E[1],done:!1};case 5:I.label++,i=E[1],E=[0];continue;case 7:E=I.ops.pop(),I.trys.pop();continue;default:if(s=I.trys,!((s=s.length>0&&s[s.length-1])||E[0]!==6&&E[0]!==2)){I=0;continue}if(E[0]===3&&(!s||E[1]>s[0]&&E[1]<s[3])){I.label=E[1];break}if(E[0]===6&&I.label<s[1]){I.label=s[1],s=E;break}if(s&&I.label<s[2]){I.label=s[2],I.ops.push(E);break}s[2]&&I.ops.pop(),I.trys.pop();continue}E=C.call(y,I)}catch(b){E=[6,b],i=0}finally{L=s=0}if(5&E[0])throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}([_,D])}}};Object.defineProperty(c,"__esModule",{value:!0}),c.validateBusiness=c.businessValidate=void 0;var o=a(8),f=a(10),S=a(7),u=a(11),d=a(6),v=a(1);function t(y){var C=v.isDomesticSDKAppID(y)?""+u.ERROR_CN_MESSAGE.ERROR_PACKAGE_NOT_PURCHASED:""+u.ERROR_MESSAGE.ERROR_PACKAGE_NOT_PURCHASED;return C=C.replace("${purchaseAddress}",v.getPurchaseAddress(y))}function l(y,C,L){if(o.default().error("validateBusiness.fail",{text:{error:y}}),y.code===2905)throw new f.default({code:S.default.ERROR_TIM_VERSION_OUTDATED});var i=S.default.ERROR_PACKAGE_NOT_SUPPORTED,s="";throw C===d.CALL_EXPERMENTEL_API_TYPE.PRO?s=function(R){var I=v.isDomesticSDKAppID(R)?""+u.ERROR_CN_MESSAGE.ERROR_PACKAGE_NOT_SUPPORTED:""+u.ERROR_MESSAGE.ERROR_PACKAGE_NOT_SUPPORTED;return I=I.replace("${purchaseAddress}",v.getPurchaseAddress(R))}(L)+" <ERROR_PACKAGE_NOT_SUPPORTED: "+S.default.ERROR_PACKAGE_NOT_SUPPORTED+">":(i=S.default.ERROR_PACKAGE_NOT_PURCHASED,s=t(L)+" <ERROR_PACKAGE_NOT_PURCHASED: "+S.default.ERROR_PACKAGE_NOT_PURCHASED+">"),new f.default({code:i,message:s})}function T(y,C,L){return e(this,void 0,void 0,function(){return r(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.tim.callExperimentalAPI("isCommercialAbilityEnabled",y)];case 1:if(i.sent().data.enabled)return[2,C.apply(this,L)];try{y===d.CALL_EXPERMENTEL_API_TYPE.BASE&&(this._callDataReport.setCodeAndMessage(S.default.ERROR_PACKAGE_NOT_SUPPORTED,u.ERROR_MESSAGE.ERROR_PACKAGE_NOT_SUPPORTED),this._callDataReport.uploadToKibana())}catch(s){console.warn("base ability check failed, userId:"+this.getUserId()+", error: "+s)}throw new f.default({code:S.default.ERROR_PACKAGE_NOT_SUPPORTED});case 2:return l(i.sent(),y,this._sdkAppID),[3,3];case 3:return[2]}})})}c.businessValidate=function(y){return function(C,L,i){var s=i.value;return i.value=function(){for(var R=[],I=0;I<arguments.length;I++)R[I]=arguments[I];return e(this,void 0,void 0,function(){return r(this,function(h){switch(h.label){case 0:return h.trys.push([0,2,,3]),[4,T.call(this,y,s,R)];case 1:return[2,h.sent()];case 2:throw h.sent();case 3:return[2]}})})},i}},c.validateBusiness=function(y,C,L){return e(this,void 0,void 0,function(){var i,s;return r(this,function(R){switch(R.label){case 0:return R.trys.push([0,2,,3]),[4,y.callExperimentalAPI("isCommercialAbilityEnabled",C)];case 1:if((i=R.sent()).data.enabled)return[2,Promise.resolve(i.data.enabled)];throw s=t(L)+" <ERROR_PACKAGE_NOT_PURCHASED: "+S.default.ERROR_PACKAGE_NOT_PURCHASED+">",new f.default({code:S.default.ERROR_PACKAGE_NOT_PURCHASED,message:s});case 2:return l(R.sent(),C,L),[3,3];case 3:return[2]}})})}},function(H,c,a){Object.defineProperty(c,"__esModule",{value:!0}),c.statusValidate=void 0;var e=a(8),r=a(10),o=a(7),f=a(15);function S(u,d,v){var t,l=e.default();if(u!=null&&u.init&&!this._isLogin){var T=f.getErrorMessage({code:o.default.ERROR_INIT_FAIL,params:{fnName:v},languageList:["en"]});throw l.error("statusValidate.fail",{text:{error:""+T}}),new r.default({code:o.default.ERROR_INIT_FAIL,fnName:v})}if(((t=u==null?void 0:u.callStatus)===null||t===void 0?void 0:t.indexOf(this._callStatus))===-1)throw T=f.getErrorMessage({code:o.default.INVALID_PARAMETER_RANGE,params:{key:"callStatus",rule:{values:u.callStatus},value:this._callStatus,fnName:v}}),l.error("statusValidate.fail",{text:{error:T}}),new r.default({code:o.default.ERROR_REQUEST_REFUSED,message:T});if(u!=null&&u.scene&&this._isGroupCall)throw T=f.getErrorMessage({code:o.default.ERROR_SCENE_NOT_SUPPORTED,params:{fnName:v},languageList:["en"]}),l.error("statusValidate.fail",{text:{error:""+T}}),new r.default({code:o.default.ERROR_SCENE_NOT_SUPPORTED,fnName:v})}c.statusValidate=function(u){return function(d,v,t){var l=t.value;return t.value=function(){for(var T=[],y=0;y<arguments.length;y++)T[y]=arguments[y];return S.call(this,u,T,v),l.apply(this,T)},t}}},function(H,c,a){var e=this&&this.__awaiter||function(u,d,v,t){return new(v||(v=Promise))(function(l,T){function y(i){try{L(t.next(i))}catch(s){T(s)}}function C(i){try{L(t.throw(i))}catch(s){T(s)}}function L(i){var s;i.done?l(i.value):(s=i.value,s instanceof v?s:new v(function(R){R(s)})).then(y,C)}L((t=t.apply(u,d||[])).next())})},r=this&&this.__generator||function(u,d){var v,t,l,T,y={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return T={next:C(0),throw:C(1),return:C(2)},typeof Symbol=="function"&&(T[Symbol.iterator]=function(){return this}),T;function C(L){return function(i){return function(s){if(v)throw new TypeError("Generator is already executing.");for(;y;)try{if(v=1,t&&(l=2&s[0]?t.return:s[0]?t.throw||((l=t.return)&&l.call(t),0):t.next)&&!(l=l.call(t,s[1])).done)return l;switch(t=0,l&&(s=[2&s[0],l.value]),s[0]){case 0:case 1:l=s;break;case 4:return y.label++,{value:s[1],done:!1};case 5:y.label++,t=s[1],s=[0];continue;case 7:s=y.ops.pop(),y.trys.pop();continue;default:if(l=y.trys,!((l=l.length>0&&l[l.length-1])||s[0]!==6&&s[0]!==2)){y=0;continue}if(s[0]===3&&(!l||s[1]>l[0]&&s[1]<l[3])){y.label=s[1];break}if(s[0]===6&&y.label<l[1]){y.label=l[1],l=s;break}if(l&&y.label<l[2]){y.label=l[2],y.ops.push(s);break}l[2]&&y.ops.pop(),y.trys.pop();continue}s=d.call(u,y)}catch(R){s=[6,R],t=0}finally{v=l=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([L,i])}}};Object.defineProperty(c,"__esModule",{value:!0}),c.avoidRepeatedCall=void 0;var o=a(8),f=a(10),S=a(7);c.avoidRepeatedCall=function(){var u=o.default();return function(d,v,t){var l=t.value,T=new Set;return t.value=function(){for(var y=[],C=0;C<arguments.length;C++)y[C]=arguments[C];return e(this,void 0,void 0,function(){var L,i;return r(this,function(s){switch(s.label){case 0:if(T.has(this))throw u.error("avoidRepeatedCall.fail",{text:{error:"previous "+v+"() is ongoing, please avoid repeated calls"}}),new f.default({code:S.default.ERROR_REQUEST_REPEATED,fnName:v});s.label=1;case 1:return s.trys.push([1,3,,4]),T.add(this),[4,l.apply(this,y)];case 2:return L=s.sent(),T.delete(this),[2,L];case 3:throw i=s.sent(),u.error("avoidRepeatedCall.fail",{text:{error:i}}),T.delete(this),i;case 4:return[2]}})})},t}}},function(H,c,a){var e=this&&this.__assign||function(){return(e=Object.assign||function(o){for(var f,S=1,u=arguments.length;S<u;S++)for(var d in f=arguments[S])Object.prototype.hasOwnProperty.call(f,d)&&(o[d]=f[d]);return o}).apply(this,arguments)};Object.defineProperty(c,"__esModule",{value:!0}),c.apiCallQueue=void 0;var r=new WeakMap;c.apiCallQueue=function(){return function(o,f,S){var u=S.value,d=function(v){var t=v.fn,l=v.args,T=v.context,y=v.resolve,C=v.reject;t.apply(T,l).then(y,C).finally(function(){var L=r.get(T);L.shift(),L[0]&&d(e({},L[0]))})};return S.value=function(){for(var v=this,t=[],l=0;l<arguments.length;l++)t[l]=arguments[l];return new Promise(function(T,y){if(r.has(v)){var C=r.get(v),L=C.length;C.push({fn:u,args:t,context:v,resolve:T,reject:y}),L===0&&d({fn:u,args:t,context:v,resolve:T,reject:y})}else r.set(v,[{fn:u,args:t,context:v,resolve:T,reject:y}]),d({fn:u,args:t,context:v,resolve:T,reject:y})})},S}}},function(H,c,a){Object.defineProperty(c,"__esModule",{value:!0}),c.TUICallEngineObserver=c.CallDataReport=void 0;var e=a(6),r=a(16),o=a(13),f=a(29),S=a(18),u=a(0),d=a(69),v=a(1),t=a(30),l=function(){function y(C){this._eventStatController=new S.default,o.default.bindController(this._eventStatController),this.initializeCallData(C),this._ssoLog=new o.default(f.default.QUALITY_REPORT)}return y.prototype.setCallData=function(C){this._callData=C},y.prototype.getCallData=function(){return this._callData},y.prototype.setInviteID=function(C){this._callData.inviteID=C},y.prototype.setTotalTime=function(C){this._callData.totalTime=C},y.prototype.setAbilityBit=function(C){this._callData.abilityBit=!!C},y.prototype.setEnterRoomTime=function(C){this._callData.enterRoomTime=d.convertTimeStampToString(C)},y.prototype.setSendSignalingTime=function(C){this._callData.sendSignalingTime=d.convertTimeStampToString(C)},y.prototype.setCallAcceptTime=function(C){this._callData.callAcceptTime=d.convertTimeStampToString(C)},y.prototype.setExitRoomTime=function(C){this._callData.exitRoomTime=d.convertTimeStampToString(C)},y.prototype.setCallEndTime=function(C){this._callData.callEndTime=C},y.prototype.setCodeAndMessage=function(C,L){this._callData.code=C||0,this._callData.message=L||""},y.prototype.setCallScene=function(C){this._callData.callScene=C||""},y.prototype.getResult=function(){return this._callData.result},y.prototype.setResult=function(C){this._callData.result=C||""},y.prototype.setUserID=function(C){this._callData.userID=C||""},y.prototype.packageCallDataToKibana=function(){var C=t.callTypeMapping(this._callData.callType),L=t.callRoleMapping(this._callData.callRole);return"CallData{version='"+this._callData.version+", platform="+this._callData.platform+", framework="+this._callData.framework+", sdk_app_id="+this._callData.sdkAppId+", user_id="+this._callData.userID+", room_id="+this._callData.roomID+", invite_id="+this._callData.inviteID+", invitee_list="+this._callData.inviteeList+", media_type="+C+", role="+L+", call_scene="+this._callData.callScene+", result="+this._callData.result+", total_time="+this._callData.totalTime+", total_score="+this._callData.totalScore+", ability_bit="+this._callData.abilityBit+", enter_room="+this._callData.enterRoomTime+", send_signaling="+this._callData.sendSignalingTime+", call_accept="+this._callData.callAcceptTime+", exit_room="+this._callData.exitRoomTime+", call_end="+this._callData.callEndTime+", code="+this._callData.code+", message="+this._callData.message+", network="+this._callData.network+", audio="+this._callData.audio+", video="+this._callData.video+"}"},y.prototype.initializeCallData=function(C){var L=C||{},i=L.version,s=i===void 0?"":i,R=L.sdkAppId,I=R===void 0?0:R,h=L.userID,_=h===void 0?"":h,D=v.getHostType();this._callData={version:s,platform:D,framework:u.NAME.WEB,sdkAppId:I,userID:_,roomID:0,inviteID:"",callRole:e.CALL_ROLE.UNKNOWN,callScene:"",callType:e.CALL_TYPE.UNKNOWN,inviteeList:[],result:u.NAME.UNKNOWN,totalTime:0,totalScore:0,code:0,message:"",abilityBit:!1,enterRoomTime:"",sendSignalingTime:"",callAcceptTime:"",exitRoomTime:"",callEndTime:"",network:0,audio:0,video:0}},y.prototype.reset=function(){this.initializeCallData(),this._ssoLog=null},y.prototype.clearCallDataAfterUpload=function(){var C=this.getCallData(),L=C.version,i=C.sdkAppId,s=C.userID;this.initializeCallData({version:L,sdkAppId:i,userID:s})},y.prototype.uploadToKibana=function(){try{this._ssoLog.setText(this.packageCallDataToKibana()).setEnd(),this.clearCallDataAfterUpload()}catch{}},y}();c.CallDataReport=l;var T=function(){function y(C,L){this._eventEmitter=C,this._callDataReport=L,this.registerListener()}return y.prototype.registerListener=function(){this._eventEmitter.on(r.TUICallEvent.CALLING_END,this.onCallEnd.bind(this)),this._eventEmitter.on(r.TUICallEvent.CALLING_CANCEL,this.onCallingCancel.bind(this)),this._eventEmitter.on(r.TUICallEvent.NO_RESP,this.onNoResponse.bind(this)),this._eventEmitter.on(r.TUICallEvent.LINE_BUSY,this.onLineBusy.bind(this)),this._eventEmitter.on(r.TUICallEvent.REJECT,this.onReject.bind(this))},y.prototype.removeLister=function(){this._eventEmitter.off(r.TUICallEvent.CALLING_END,this.onCallEnd.bind(this)),this._eventEmitter.off(r.TUICallEvent.CALLING_CANCEL,this.onCallingCancel.bind(this)),this._eventEmitter.off(r.TUICallEvent.NO_RESP,this.onNoResponse.bind(this)),this._eventEmitter.off(r.TUICallEvent.LINE_BUSY,this.onLineBusy.bind(this)),this._eventEmitter.off(r.TUICallEvent.REJECT,this.onReject.bind(this))},y.prototype.onCallEnd=function(C){var L=C.totalTime,i=L===void 0?0:L;this._callDataReport.setTotalTime(i),this._callDataReport.setResult(u.NAME.NORMAL),this._callDataReport.setCodeAndMessage(),this._callDataReport.uploadToKibana()},y.prototype.onCallingCancel=function(){this._callDataReport.getResult()||this._callDataReport.setResult(u.NAME.CANCEL),this._callDataReport.setCodeAndMessage(),this._callDataReport.uploadToKibana()},y.prototype.onNoResponse=function(){this._callDataReport.setResult(u.NAME.TIMEOUT)},y.prototype.onLineBusy=function(){this._callDataReport.setResult(u.NAME.BUSYLINE)},y.prototype.onReject=function(){this._callDataReport.setResult(u.NAME.REJECT)},y}();c.TUICallEngineObserver=T},function(H,c,a){a.r(c),a.d(c,"setBaseTime",function(){return u}),a.d(c,"getCurrentTime",function(){return d}),a.d(c,"getTimestamp",function(){return v}),a.d(c,"convertTimeStampToString",function(){return t});var e=a(2),r=a(32),o=a.n(r);let f=new Date().getTime(),S=0;const u=function(l){f=l,S=f-new Date().getTime();const T=new Date;T.setTime(l),e.default.info("baseTime from server: "+T+" offset: "+S)},d=function(){return new Date().getTime()+S},v=function(){const l=new Date;return l.setTime(d()),l.toLocaleString()},t=l=>l<=0?"":o()(l).format("YYYY-MM-DD HH:mm:ss")},function(H,c,a){var e=this&&this.__assign||function(){return(e=Object.assign||function(i){for(var s,R=1,I=arguments.length;R<I;R++)for(var h in s=arguments[R])Object.prototype.hasOwnProperty.call(s,h)&&(i[h]=s[h]);return i}).apply(this,arguments)},r=this&&this.__awaiter||function(i,s,R,I){return new(R||(R=Promise))(function(h,_){function D(A){try{b(I.next(A))}catch(p){_(p)}}function E(A){try{b(I.throw(A))}catch(p){_(p)}}function b(A){var p;A.done?h(A.value):(p=A.value,p instanceof R?p:new R(function(m){m(p)})).then(D,E)}b((I=I.apply(i,s||[])).next())})},o=this&&this.__generator||function(i,s){var R,I,h,_,D={label:0,sent:function(){if(1&h[0])throw h[1];return h[1]},trys:[],ops:[]};return _={next:E(0),throw:E(1),return:E(2)},typeof Symbol=="function"&&(_[Symbol.iterator]=function(){return this}),_;function E(b){return function(A){return function(p){if(R)throw new TypeError("Generator is already executing.");for(;D;)try{if(R=1,I&&(h=2&p[0]?I.return:p[0]?I.throw||((h=I.return)&&h.call(I),0):I.next)&&!(h=h.call(I,p[1])).done)return h;switch(I=0,h&&(p=[2&p[0],h.value]),p[0]){case 0:case 1:h=p;break;case 4:return D.label++,{value:p[1],done:!1};case 5:D.label++,I=p[1],p=[0];continue;case 7:p=D.ops.pop(),D.trys.pop();continue;default:if(h=D.trys,!((h=h.length>0&&h[h.length-1])||p[0]!==6&&p[0]!==2)){D=0;continue}if(p[0]===3&&(!h||p[1]>h[0]&&p[1]<h[3])){D.label=p[1];break}if(p[0]===6&&D.label<h[1]){D.label=h[1],h=p;break}if(h&&D.label<h[2]){D.label=h[2],D.ops.push(p);break}h[2]&&D.ops.pop(),D.trys.pop();continue}p=s.call(i,D)}catch(m){p=[6,m],I=0}finally{R=h=0}if(5&p[0])throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}([b,A])}}};Object.defineProperty(c,"__esModule",{value:!0}),c.TUICallEngineRecordObserver=c.CallRecordReport=void 0;var f=a(6),S=a(16),u=a(0),d=a(1),v=a(2),t=a(71),l=a(5),T=a(30),y={serviceCommand:u.NAME.CALLKIT_RECORDS_SVR+".*"},C=function(){function i(s){this._tim=s.tim,this._heartbeat=-1,this._lastHeartBeatTime=-1,this._bodyStatus=u.NAME.WAITING,this.initializeCallData(s)}return i.prototype.getCallRecordData=function(){return this._callRecordData},i.prototype.initializeCallData=function(s){var R=s||{},I=R.version,h=I===void 0?"":I,_=R.userID,D=_===void 0?"":_,E=l.getOsInfo().name,b={version:1,command:u.NAME.EVENT_REPORT,sdk_version:h,seq:0,os_name:u.NAME.WEB,os_version:"0.0",device_name:E,framework:u.NAME.WEB,call_type:"",media_type:"",client_ts:0,role:f.CALL_ROLE.UNKNOWN,user_id:D,room_id:"",call_id:"",group_id:"",room_id_type:1};this._callRecordData={head:b,body:{event_type:"",code:0,message:"",invitee_list:[]}}},i.prototype.reset=function(){this.initializeCallData()},i.prototype._setCallType=function(s){s&&(this._callRecordData.head=e(e({},this._callRecordData.head),{call_type:s}))},i.prototype._setMediaType=function(s){s&&(this._callRecordData.head=e(e({},this._callRecordData.head),{media_type:T.callTypeMapping(s)}))},i.prototype._setCallRole=function(s){s&&(this._callRecordData.head=e(e({},this._callRecordData.head),{role:s}))},i.prototype._setUserID=function(s){s&&(this._callRecordData.head=e(e({},this._callRecordData.head),{user_id:s}))},i.prototype._setRoomID=function(s){s&&(this._callRecordData.head=e(e({},this._callRecordData.head),{room_id:""+s}))},i.prototype._setInviteID=function(s){s===void 0&&(s=""),s&&(this._callRecordData.head=e(e({},this._callRecordData.head),{call_id:s}))},i.prototype._setGroupId=function(s){d.isUndefined(s)||(this._callRecordData.head=e(e({},this._callRecordData.head),{group_id:s}))},i.prototype._getGroupId=function(){return this._callRecordData.head.group_id},i.prototype._setRoomIdType=function(s){s&&(this._callRecordData.head=e(e({},this._callRecordData.head),{room_id_type:s}))},i.prototype._setEventType=function(s){s&&(this._callRecordData.body=e(e({},this._callRecordData.body),{event_type:s}))},i.prototype._setInviteeList=function(s){s===void 0&&(s=[]),this._callRecordData.body=e(e({},this._callRecordData.body),{invitee_list:s})},i.prototype._setSeq=function(){var s=this.getCallRecordData().head.seq;this._callRecordData.head=e(e({},this._callRecordData.head),{seq:s+1})},i.prototype.setBodyStatus=function(s){if(s){var R=u.NAME.WAITING;switch(s){case f.CALL_STATUS.CALLING:R=u.NAME.WAITING;break;case f.CALL_STATUS.CONNECTED:R=u.NAME.CALLING}this._bodyStatus=R}},i.prototype.eventUpload=function(s){var R;return r(this,void 0,void 0,function(){var I,h,_,D,E,b,A,p,m,U,P,k,V,x,j,O,n,g;return o(this,function(N){switch(N.label){case 0:return N.trys.push([0,2,,3]),I=s.eventType,h=s.callType,_=s.mediaType,D=s.callRole,E=s.userID,b=s.roomID,A=s.inviteID,p=s.groupId,m=s.strRoomId,U=m===void 0?"":m,P=s.inviteeList,k=P===void 0?[]:P,I?(this._callRecordData.head=e(e({},this._callRecordData.head),{command:u.NAME.EVENT_REPORT,client_ts:Math.floor(Date.now()/1e3)}),this._setCallType(h),this._setMediaType(_),this._setCallRole(D),this._setUserID(E),this._setInviteID(A),this._setGroupId(p),b>0?(this._setRoomID(""+b),this._setRoomIdType(1)):b===0&&d.isString(U)&&U.length>0&&(this._setRoomID(U),this._setRoomIdType(2)),this._setEventType(I),this._setInviteeList(k),this._setSeq(),V=this.getCallRecordData(),x=V.head,j=V.body,O={head:e(e({},x),{role:T.callRoleMapping(x.role)}),body:j},n=e(e({},y),{data:JSON.stringify(O)}),[4,(R=this==null?void 0:this._tim)===null||R===void 0?void 0:R.callExperimentalAPI("sendTRTCCustomData",n)]):[2];case 1:return N.sent(),[3,3];case 2:return g=N.sent(),console.warn("eventUpload failed. error: "+JSON.stringify(g)),[3,3];case 3:return[2]}})})},i.prototype.eventUploadNotSave=function(s){var R;return r(this,void 0,void 0,function(){var I,h,_,D,E,b,A,p,m,U,P,k,V,x,j,O;return o(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),I=s.eventType,h=s.callType,_=s.mediaType,D=s.callRole,E=s.roomID,b=s.groupId,A=s.strRoomId,p=A===void 0?"":A,m=s.inviteID,this._setSeq(),U=this.getCallRecordData(),P=U.head,k=U.body,V=P.room_id_type,E>0&&(V=1),E===0&&p&&(V=2),x={head:e(e({},P),{role:T.callRoleMapping(D),call_id:m,call_type:h,media_type:T.callTypeMapping(_),room_id:V===1?""+E:p,client_ts:Math.floor(Date.now()/1e3),group_id:b||this._getGroupId(),room_id_type:V}),body:e(e({},k),{event_type:I})},j=e(e({},y),{data:JSON.stringify(x)}),[4,(R=this==null?void 0:this._tim)===null||R===void 0?void 0:R.callExperimentalAPI("sendTRTCCustomData",j)];case 1:return n.sent(),[3,3];case 2:return O=n.sent(),console.warn("eventUploadNotSave failed. error: "+JSON.stringify(O)),[3,3];case 3:return[2]}})})},i.prototype.heartBeatUpload=function(){var s;return r(this,void 0,void 0,function(){var R,I,h,_;return o(this,function(D){switch(D.label){case 0:return D.trys.push([0,2,,3]),this._setSeq(),R=this._callRecordData.head,I={head:e(e({},R),{role:T.callRoleMapping(R.role),clientTs:Date.now(),command:u.NAME.HEART_BEAT}),body:{status:this._bodyStatus}},h=e(e({},y),{data:I}),[4,(s=this==null?void 0:this._tim)===null||s===void 0?void 0:s.callExperimentalAPI("sendTRTCCustomData",h)];case 1:return D.sent(),[3,3];case 2:return _=D.sent(),console.warn("heartBeatUpload failed. error: "+JSON.stringify(_)),[3,3];case 3:return[2]}})})},i.prototype.startHeartbeat=function(){this._heartbeat===-1&&(v.default.info("start heart beat..."),this.heartBeatUpload(),this._heartbeat=t.default.run(u.NAME.TIMEOUT,this.doHeartbeat.bind(this),{delay:2e3,count:0,backgroundTask:!0}))},i.prototype.stopHeartbeat=function(){this._heartbeat!==-1&&(v.default.info("stop heart beat"),t.default.clearTask(this._heartbeat),this._heartbeat=-1,this._lastHeartBeatTime=-1,this._bodyStatus=u.NAME.WAITING)},i.prototype.doHeartbeat=function(){return r(this,void 0,void 0,function(){var s;return o(this,function(R){return this.heartBeatUpload(),s=Date.now(),this._lastHeartBeatTime>0&&s-this._lastHeartBeatTime>1e4&&v.default.warn("heartbeat took "+(s-this._lastHeartBeatTime)),this._lastHeartBeatTime=s,[2]})})},i}();c.CallRecordReport=C;var L=function(){function i(s,R){this._eventEmitter=s,this._callRecordDataReport=R,this._isCallAccepted=!1,this.registerListener()}return i.prototype.registerListener=function(){this._eventEmitter.on(S.TUICallEvent.ON_CALL_RECEIVED,this.onCallReceived.bind(this)),this._eventEmitter.on(S.TUICallEvent.USER_ACCEPT,this.onCallAccepted.bind(this)),this._eventEmitter.on(S.TUICallEvent.CALLING_END,this.onCallEnd.bind(this)),this._eventEmitter.on(S.TUICallEvent.CALLING_CANCEL,this.onCallingCancel.bind(this)),this._eventEmitter.on(S.TUICallEvent.NO_RESP,this.onNoResponse.bind(this)),this._eventEmitter.on(S.TUICallEvent.LINE_BUSY,this.onLineBusy.bind(this)),this._eventEmitter.on(S.TUICallEvent.REJECT,this.onReject.bind(this))},i.prototype.removeLister=function(){this._eventEmitter.off(S.TUICallEvent.ON_CALL_RECEIVED,this.onCallReceived),this._eventEmitter.off(S.TUICallEvent.USER_ACCEPT,this.onCallAccepted),this._eventEmitter.off(S.TUICallEvent.CALLING_END,this.onCallEnd),this._eventEmitter.off(S.TUICallEvent.CALLING_CANCEL,this.onCallingCancel),this._eventEmitter.off(S.TUICallEvent.NO_RESP,this.onNoResponse),this._eventEmitter.off(S.TUICallEvent.LINE_BUSY,this.onLineBusy),this._eventEmitter.off(S.TUICallEvent.REJECT,this.onReject)},i.prototype.onCallReceived=function(){this._callRecordDataReport.startHeartbeat()},i.prototype.onCallAccepted=function(){var s=this._callRecordDataReport.getCallRecordData().head;if((s==null?void 0:s.role)===u.NAME.INVITER){if(this._isCallAccepted&&s.call_type===u.NAME.GROUP)return;this._isCallAccepted=!0;var R={eventType:u.NAME.CALL_ACCEPTED};this._callRecordDataReport.eventUpload(R),this._callRecordDataReport.setBodyStatus(f.CALL_STATUS.CONNECTED)}},i.prototype.onCallEnd=function(){var s={eventType:u.NAME.CALL_END};this._isCallAccepted=!1,this._callRecordDataReport.eventUpload(s),this._callRecordDataReport.stopHeartbeat()},i.prototype.onCallingCancel=function(s){var R=this._callRecordDataReport.getCallRecordData().head,I=R.role===u.NAME.INVITER?u.NAME.CANCEL_CALL:u.NAME.CALL_CANCELED;this._isCallAccepted=!1;var h=(s||{}).reason;((h===void 0?"":h)===u.NAME.NORMAL||R.role===u.NAME.INVITER&&R.call_type===u.NAME.GROUP)&&this._callRecordDataReport.eventUpload({eventType:I}),this._callRecordDataReport.stopHeartbeat()},i.prototype.onNoResponse=function(){this._uploadInC2C(u.NAME.TIMEOUT)},i.prototype.onLineBusy=function(){this._uploadInC2C(u.NAME.BUSYLINE)},i.prototype.onReject=function(){this._uploadInC2C(u.NAME.REJECT)},i.prototype._uploadInC2C=function(s){var R=this._callRecordDataReport.getCallRecordData().head;if((R==null?void 0:R.call_type)===u.NAME.SINGLE){var I="";switch(s){case u.NAME.TIMEOUT:I=R.role===u.NAME.INVITER?u.NAME.CALL_MISSED:u.NAME.NOT_ANSWER_CALL;break;case u.NAME.REJECT:I=R.role===u.NAME.INVITER&&u.NAME.CALL_REJECTED;break;case u.NAME.BUSYLINE:I=R.role===u.NAME.INVITER?u.NAME.CALL_BUSY:u.NAME.NOT_ANSWER_CALL;break;default:return}this._callRecordDataReport.eventUpload({eventType:I})}},i}();c.TUICallEngineRecordObserver=L},function(H,c,a){var e=this&&this.__assign||function(){return(e=Object.assign||function(u){for(var d,v=1,t=arguments.length;v<t;v++)for(var l in d=arguments[v])Object.prototype.hasOwnProperty.call(d,l)&&(u[l]=d[l]);return u}).apply(this,arguments)};Object.defineProperty(c,"__esModule",{value:!0});var r=a(1),o=a(0),f=window==null?void 0:window.cancelAnimationFrame,S=function(){function u(){}return u.generateTaskID=function(){return this.currentTaskID++},u.run=function(d,v,t){d===void 0&&(d=o.NAME.TIMEOUT),t=d===o.NAME.INTERVAL?e({delay:2e3,count:0,backgroundTask:!0},t):d===o.NAME.RAF?e({fps:60,delay:16.6,count:0,backgroundTask:!0},t):e({delay:2e3,count:0,backgroundTask:!0},t),r.isObject(v)&&(t=e(e({},t),v)),r.isFunction(d)&&(v=d,d=o.NAME.TIMEOUT);var l=e({taskID:this.generateTaskID(),loopCount:0,intervalID:null,timeoutID:null,rafID:null,taskName:d,callback:v},t);return this.taskMap.set(l.taskID,l),this[d](l),l.taskID},u.interval=function(d){var v=this;return d.intervalID=setInterval(function(){d.callback(),d.loopCount+=1,v.isBreakLoop(d)},d.delay)},u.timeout=function(d){var v=this,t=function(){if(d.callback(),d.loopCount+=1,!v.isBreakLoop(d))return d.timeoutID=setTimeout(t,d.delay)};return d.timeoutID=setTimeout(t,d.delay)},u.raf=function(d){var v=this;d.delay=(1e3/d.fps).toFixed(2);var t,l=r.performanceNow(),T=function(){if(document.hidden&&d.backgroundTask)return t=r.performanceNow()-l,l=r.performanceNow(),d.callback(),d.loopCount+=1,v.isBreakLoop(d)?void 0:d.timeoutID=setTimeout(T,d.delay-Math.floor(t%d.delay));if((t=r.performanceNow()-l)>=d.delay&&(l=r.performanceNow()-Math.floor(t%d.delay),d.callback(),d.loopCount+=1),!v.isBreakLoop(d))return d.rafID=requestAnimationFrame(T)};if(d.rafID=requestAnimationFrame(T),d.backgroundTask){var y=function(){if(document.hidden){var C=r.performanceNow()-l;C>=d.delay?T():d.timeoutID=setTimeout(T,d.delay-C)}};document.addEventListener("visibilitychange",y),d.onVisibilitychange=y,document.hidden&&y()}return d.taskID},u.hasTask=function(d){return this.taskMap.has(d)},u.clearTask=function(d){if(!this.taskMap.has(d))return!0;var v=this.taskMap.get(d),t=v.intervalID,l=v.timeoutID,T=v.rafID,y=v.onVisibilitychange;return t&&clearInterval(t),l&&clearTimeout(l),T&&f(T),y&&document.removeEventListener("visibilitychange",y),this.taskMap.delete(d),!0},u.isBreakLoop=function(d){return!this.taskMap.has(d.taskID)||d.count!==0&&d.loopCount>=d.count&&(this.clearTask(d.taskID),!0)},u.taskMap=new Map,u.currentTaskID=1,u}();c.default=S},function(H,c,a){Object.defineProperty(c,"__esModule",{value:!0}),c.ES_TABLE=c.ES_URL=c.CLS_TOPIC_ID=c.CLS_ENDPOINT=void 0,c.CLS_ENDPOINT="https://ap-nanjing.cls.tencentcs.com",c.CLS_TOPIC_ID="a1310e66-a3f5-4572-a1c3-7a327a27496d",c.ES_URL="https://webim.tim.qq.com/v4/imopenstat/tweb_trtccalling_report",c.ES_TABLE="timweb-trtccalling"}]).default})})(fe);var Re=fe.exports;export{Re as t};
