import{B as V,q as d,o as f,Z as I,i as n,z,_ as M}from"./@tencentcloud-7fc831ec.js";import"./adapter-vue-24f22062.js";import{a as g,i as R}from"./env-a593fd1d.js";import E from"./index-b5b8c0ea.js";import{d as F,r as o,w as H,o as h,x as Z,aR as K,a as c,ae as A,a_ as u,c as k,aB as S,y as W,F as Y,ao as $}from"./@vue-a164be7a.js";import"./tim-upload-plugin-4412696f.js";import"./tim-profanity-filter-plugin-a7e08ee8.js";import"./vue-84471dcb.js";import"./marked-7f3c3653.js";import"./trtc-cloud-js-sdk-6995d964.js";import"./trtc-sdk-v5-5ba82a9e.js";import"./pinia-ec219911.js";import"./mitt-f7ef348c.js";import"./interactjs-0d94d9f4.js";import"./rtc-detect-b2f0fa0a.js";import"./tuicall-engine-webrtc-9ec0a575.js";const j={ref:"dialog",class:"member-list"},J={key:0,class:"member-list-title"},Q={class:"title"},X={class:"member-list-box"},ee=["onClick"],te=["src"],se={class:"member-list-box-body-name"},ae=F({__name:"index",emits:["onAtListOpen","insertAt"],setup(oe,{expose:B,emit:G}){const x=G,s=o(),y=o(),m=o(!1),i=o(),_=o(),a=o(),b=o(!1),p=o({left:0,top:0}),L=o(0),r=o(""),O={userID:V.TYPES.MSG_AT_ALL,nick:"所有人",isAll:!0,avatar:"https://web.sdk.qcloud.com/im/assets/images/at.svg"};d.watch(f.CONV,{currentConversationID:e=>{var l,t;if(e!==r.value)if(r.value=e,i.value=[],_.value=[],a.value=[],b.value=!1,d.update(f.CUSTOM,"memberList",i.value),(l=r==null?void 0:r.value)!=null&&l.startsWith("GROUP")){b.value=!0;const v=(t=r==null?void 0:r.value)==null?void 0:t.substring(5);I.switchGroup(v)}else I.switchGroup("")}}),d.watch(f.GRP,{currentGroupMemberList:e=>{i.value=e,_.value=[O,...i.value],a.value=_.value,d.update(f.CUSTOM,"memberList",i.value)}});const w=e=>{b.value&&(m.value=e,m.value&&x("onAtListOpen"))},P=e=>{p.value=e},T=e=>{var l,t;L.value=e,(t=(l=y.value)==null?void 0:l[L.value])==null||t.scrollIntoView(!1)},U=e=>{a.value=e};n.toggleAtList=w,n.handleAtListPosition=P,n.setCurrentSelectIndex=T,n.setShowMemberList=U,B({toggleAtList:w}),H(()=>[p.value,s==null?void 0:s.value],()=>{var e;R||!(s!=null&&s.value)||!((e=s==null?void 0:s.value)!=null&&e.style)||(s.value.style.left=p.value.left+"px",s.value.style.top=p.value.top-s.value.clientHeight+"px")});const C=()=>{m.value=!1,a.value=_.value,p.value={left:0,top:0}},q=e=>{var l;if(g&&n.selectItem)n.selectItem(e);else if((l=a==null?void 0:a.value)!=null&&l.length){const t=a==null?void 0:a.value[e];x("insertAt",{id:t==null?void 0:t.userID,label:(t==null?void 0:t.nick)||(t==null?void 0:t.userID)})}C()},D=e=>(e==null?void 0:e.avatar)||"https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png",N=e=>e!=null&&e.nick?e==null?void 0:e.nick:e==null?void 0:e.userID;return(e,l)=>(h(),Z(E,{show:u(m),onOnClose:C},{default:K(()=>[c("div",{ref_key:"MessageInputAt",ref:s,class:A([u(g)?"message-input-at":"message-input-at-h5"])},[c("div",j,[u(g)?W("",!0):(h(),k("header",J,[c("span",Q,S(u(z).t("TUIChat.选择提醒的人")),1)])),c("ul",X,[(h(!0),k(Y,null,$(u(a),(t,v)=>(h(),k("li",{key:v,ref_for:!0,ref_key:"memberListItems",ref:y,class:A(["member-list-box-body",[v===u(L)&&"selected"]]),onClick:le=>q(v)},[c("img",{class:"member-list-box-body-avatar",src:D(t)},null,8,te),c("span",se,S(N(t)),1)],10,ee))),128))])],512)],2)]),_:1},8,["show"]))}});const xe=M(ae,[["__scopeId","data-v-f07ce405"]]);export{xe as default};
