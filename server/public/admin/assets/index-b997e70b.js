import{d as H,bg as _,r as C,aZ as W,b as V,b7 as q,o as d,x as z,aR as x,a as P,ae as r,a_ as o,ag as L,aW as v,aB as c,c as f,y as I,M as Y}from"./@vue-a164be7a.js";import"./adapter-vue-24f22062.js";import{q as F,B as U,i as g,z as l,_ as G}from"./@tencentcloud-7fc831ec.js";import{d as s}from"./constant-bad60a54.js";import{c as Q,a as y}from"./env-a593fd1d.js";import Z from"./index-cfa97a9d.js";import j from"./index-1dfefc7d.js";import"./tim-upload-plugin-4412696f.js";import"./tim-profanity-filter-plugin-a7e08ee8.js";import"./vue-84471dcb.js";import"./marked-7f3c3653.js";import"./trtc-cloud-js-sdk-6995d964.js";import"./trtc-sdk-v5-5ba82a9e.js";import"./pinia-ec219911.js";import"./mitt-f7ef348c.js";import"./interactjs-0d94d9f4.js";import"./rtc-detect-b2f0fa0a.js";import"./tuicall-engine-webrtc-9ec0a575.js";const J={class:"delDialog-title"},K=H({__name:"index",props:{actionsMenuPosition:{},selectedConversation:{},selectedConversationDomRect:{}},emits:["closeConversationActionMenu"],setup(h,{emit:S}){var E,M;const k=S,n=h,b=((E=_())==null?void 0:E.proxy)||_(),T=C(),w=C(!0),D=C(!1),O=F.getConversationModel(((M=n.selectedConversation)==null?void 0:M.conversationID)||""),a=C(n.actionsMenuPosition);W(()=>{R()});const B=V(()=>{var i,t;return((i=n.selectedConversation)==null?void 0:i.type)===U.TYPES.CONV_C2C?"TUIConversation.删除后，将清空该聊天的消息记录":((t=n.selectedConversation)==null?void 0:t.type)===U.TYPES.CONV_GROUP?"TUIConversation.删除后，将清空该群聊的消息记录":""});function R(){q(()=>{var i,t;if(Q)((i=g)==null?void 0:i.createSelectorQuery().in(b)).select("#conversation-actions-menu").boundingClientRect(m=>{var p,N;m&&(m.bottom>((N=(p=g)==null?void 0:p.getWindowInfo)==null?void 0:N.call(p).windowHeight)&&(a.value={...n.actionsMenuPosition,top:n.actionsMenuPosition.top-(n.actionsMenuPosition.conversationHeight||0)-m.height}),a.value.left+m.width+5>g.getWindowInfo().windowWidth&&(a.value.left=g.getWindowInfo().windowWidth-m.width-5)),w.value=!1}).exec();else{const e=(t=T.value)==null?void 0:t.getBoundingClientRect();y&&typeof n.actionsMenuPosition.left<"u"&&(a.value.left=n.actionsMenuPosition.left),e&&e.bottom>window.innerHeight&&(a.value.top=n.actionsMenuPosition.top-(n.actionsMenuPosition.conversationHeight||0)-e.height),w.value=!1}})}const u=i=>{const{name:t}=i,e=O;if(!(!t||!e||!e.conversationID)){switch(t){case s.DELETE:e==null||e.deleteConversation();break;case s.ISPINNED:e==null||e.pinConversation();break;case s.DISPINNED:e==null||e.pinConversation();break;case s.MUTE:e==null||e.muteConversation();break;case s.NOTMUTE:e==null||e.muteConversation();break}k("closeConversationActionMenu")}},$=()=>{D.value=!0},A=i=>{i||k("closeConversationActionMenu"),D.value=i};return(i,t)=>(d(),z(Z,{maskColor:"transparent",onOnOverlayClick:t[6]||(t[6]=()=>k("closeConversationActionMenu"))},{default:x(()=>[P("div",{id:"conversation-actions-menu",ref_key:"actionsMenuDomRef",ref:T,class:r([o(y)&&"actions-menu-pc","actions-menu",!o(w)&&"cancel-hidden"]),style:L({top:`${o(a).top}px`,left:`${o(a).left}px`})},[P("div",{class:r(["actions-menu-item"]),onClick:t[0]||(t[0]=v(e=>$(),["stop"]))},c(o(l).t("TUIConversation.删除会话")),1),n.selectedConversation&&n.selectedConversation.isPinned?I("",!0):(d(),f("div",{key:0,class:r(["actions-menu-item"]),onClick:t[1]||(t[1]=v(e=>u({name:o(s).ISPINNED}),["stop"]))},c(o(l).t("TUIConversation.置顶会话")),1)),n.selectedConversation&&n.selectedConversation.isPinned?(d(),f("div",{key:1,class:r(["actions-menu-item"]),onClick:t[2]||(t[2]=v(e=>u({name:o(s).DISPINNED}),["stop"]))},c(o(l).t("TUIConversation.取消置顶")),1)):I("",!0),n.selectedConversation&&n.selectedConversation.isMuted?I("",!0):(d(),f("div",{key:2,class:r(["actions-menu-item"]),onClick:t[3]||(t[3]=v(e=>u({name:o(s).MUTE}),["stop"]))},c(o(l).t("TUIConversation.消息免打扰")),1)),n.selectedConversation&&n.selectedConversation.isMuted?(d(),f("div",{key:3,class:r(["actions-menu-item"]),onClick:t[4]||(t[4]=v(e=>u({name:o(s).NOTMUTE}),["stop"]))},c(o(l).t("TUIConversation.取消免打扰")),1)):I("",!0)],6),Y(j,{show:o(D),center:!0,isHeaderShow:o(y),onSubmit:t[5]||(t[5]=e=>u({name:o(s).DELETE})),"onUpdate:show":A},{default:x(()=>[P("p",J,c(o(l).t(o(B))),1)]),_:1},8,["show","isHeaderShow"])]),_:1}))}});const Ie=G(K,[["__scopeId","data-v-15cfc865"]]);export{Ie as default};
