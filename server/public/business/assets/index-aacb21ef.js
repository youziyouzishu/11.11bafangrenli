import{d as H,b7 as U,r as C,aU as V,b as W,b2 as q,o as d,t as z,aM as _,a as P,a9 as r,aV as o,ab as G,aR as v,aw as c,c as f,u as I,G as L}from"./@vue-25170201.js";import"./adapter-vue-20243c9c.js";import{q as Y,B as b,i as k,z as l,_ as F}from"./@tencentcloud-25a17c42.js";import{d as i}from"./constant-bad60a54.js";import{c as Q,a as T}from"./env-6b0ecdb8.js";import j from"./index-3a577aae.js";import J from"./index-11528969.js";import"./tim-upload-plugin-5e9dfffb.js";import"./tim-profanity-filter-plugin-23d0f338.js";import"./vue-04189d9a.js";import"./marked-7f3c3653.js";import"./trtc-cloud-js-sdk-ca6139e0.js";import"./trtc-sdk-v5-8c3e4b7a.js";import"./pinia-1182f1fa.js";import"./mitt-f7ef348c.js";import"./interactjs-c534f49a.js";import"./rtc-detect-1f468b1b.js";const K={class:"delDialog-title"},X=H({__name:"index",props:{actionsMenuPosition:{},selectedConversation:{},selectedConversationDomRect:{}},emits:["closeConversationActionMenu"],setup(h,{emit:x}){var E,M;const w=x,n=h,S=((E=U())==null?void 0:E.proxy)||U(),y=C(),g=C(!0),D=C(!1),O=Y.getConversationModel(((M=n.selectedConversation)==null?void 0:M.conversationID)||""),a=C(n.actionsMenuPosition);V(()=>{R()});const B=W(()=>{var s,t;return((s=n.selectedConversation)==null?void 0:s.type)===b.TYPES.CONV_C2C?"TUIConversation.删除后，将清空该聊天的消息记录":((t=n.selectedConversation)==null?void 0:t.type)===b.TYPES.CONV_GROUP?"TUIConversation.删除后，将清空该群聊的消息记录":""});function R(){q(()=>{var s,t;if(Q)((s=k)==null?void 0:s.createSelectorQuery().in(S)).select("#conversation-actions-menu").boundingClientRect(m=>{var p,N;m&&(m.bottom>((N=(p=k)==null?void 0:p.getWindowInfo)==null?void 0:N.call(p).windowHeight)&&(a.value={...n.actionsMenuPosition,top:n.actionsMenuPosition.top-(n.actionsMenuPosition.conversationHeight||0)-m.height}),a.value.left+m.width+5>k.getWindowInfo().windowWidth&&(a.value.left=k.getWindowInfo().windowWidth-m.width-5)),g.value=!1}).exec();else{const e=(t=y.value)==null?void 0:t.getBoundingClientRect();T&&typeof n.actionsMenuPosition.left<"u"&&(a.value.left=n.actionsMenuPosition.left),e&&e.bottom>window.innerHeight&&(a.value.top=n.actionsMenuPosition.top-(n.actionsMenuPosition.conversationHeight||0)-e.height),g.value=!1}})}const u=s=>{const{name:t}=s,e=O;if(!(!t||!e||!e.conversationID)){switch(t){case i.DELETE:e==null||e.deleteConversation();break;case i.ISPINNED:e==null||e.pinConversation();break;case i.DISPINNED:e==null||e.pinConversation();break;case i.MUTE:e==null||e.muteConversation();break;case i.NOTMUTE:e==null||e.muteConversation();break}w("closeConversationActionMenu")}},$=()=>{D.value=!0},A=s=>{s||w("closeConversationActionMenu"),D.value=s};return(s,t)=>(d(),z(j,{maskColor:"transparent",onOnOverlayClick:t[6]||(t[6]=()=>w("closeConversationActionMenu"))},{default:_(()=>[P("div",{id:"conversation-actions-menu",ref_key:"actionsMenuDomRef",ref:y,class:r([o(T)&&"actions-menu-pc","actions-menu",!o(g)&&"cancel-hidden"]),style:G({top:`${o(a).top}px`,left:`${o(a).left}px`})},[P("div",{class:r(["actions-menu-item"]),onClick:t[0]||(t[0]=v(e=>$(),["stop"]))},c(o(l).t("TUIConversation.删除会话")),1),n.selectedConversation&&n.selectedConversation.isPinned?I("",!0):(d(),f("div",{key:0,class:r(["actions-menu-item"]),onClick:t[1]||(t[1]=v(e=>u({name:o(i).ISPINNED}),["stop"]))},c(o(l).t("TUIConversation.置顶会话")),1)),n.selectedConversation&&n.selectedConversation.isPinned?(d(),f("div",{key:1,class:r(["actions-menu-item"]),onClick:t[2]||(t[2]=v(e=>u({name:o(i).DISPINNED}),["stop"]))},c(o(l).t("TUIConversation.取消置顶")),1)):I("",!0),n.selectedConversation&&n.selectedConversation.isMuted?I("",!0):(d(),f("div",{key:2,class:r(["actions-menu-item"]),onClick:t[3]||(t[3]=v(e=>u({name:o(i).MUTE}),["stop"]))},c(o(l).t("TUIConversation.消息免打扰")),1)),n.selectedConversation&&n.selectedConversation.isMuted?(d(),f("div",{key:3,class:r(["actions-menu-item"]),onClick:t[4]||(t[4]=v(e=>u({name:o(i).NOTMUTE}),["stop"]))},c(o(l).t("TUIConversation.取消免打扰")),1)):I("",!0)],6),L(J,{show:o(D),center:!0,isHeaderShow:o(T),onSubmit:t[5]||(t[5]=e=>u({name:o(i).DELETE})),"onUpdate:show":A},{default:_(()=>[P("p",K,c(o(l).t(o(B))),1)]),_:1},8,["show","isHeaderShow"])]),_:1}))}});const fe=F(X,[["__scopeId","data-v-15cfc865"]]);export{fe as default};
