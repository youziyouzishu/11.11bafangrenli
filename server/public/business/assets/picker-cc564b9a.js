import{F as K,_ as D,a as A}from"./index-5e14258e.js";import{P as F}from"./index-e34f0d65.js";import{E as O}from"./element-plus-64da2267.js";import{k as Y,n as j}from"./index-7638d9aa.js";import{_ as q}from"./index-c028864d.js";import{D as H}from"./vuedraggable-78471ab3.js";import{d as J,r as s,bl as Q,b as k,b2 as W,w as X,aY as $,al as I,o as S,c as U,G as i,A as Z,aM as p,a as n,aR as V,a9 as B,E as x,u as E,aO as ee,ak as ae,ab as le,aK as te,af as oe,ae as se}from"./@vue-25170201.js";import{d as ie}from"./@vueuse-944ef3f4.js";import{_ as ne}from"./@tencentcloud-25a17c42.js";const re=J({components:{Popup:F,Draggable:H,FileItem:K,Material:D,Preview:A},props:{modelValue:{type:[String,Array],default:()=>[]},type:{type:String,default:"image"},size:{type:String,default:"100px"},fileSize:{type:String,default:"100px"},limit:{type:Number,default:1},disabled:{type:Boolean,default:!1},hiddenUpload:{type:Boolean,default:!1},uploadClass:{type:String,default:""},excludeDomain:{type:Boolean,default:!1}},emits:["change","update:modelValue"],setup(e,{emit:l}){const h=s(),g=s(),y=s(""),_=s(!1),t=s([]),m=s([]),r=s(!0),f=s(-1),{disabled:w,limit:u,modelValue:C}=Q(e),{getImageUrl:b}=Y(),o=k(()=>{switch(e.type){case"image":return"图片";case"video":return"视频";case"file":return"文档";default:return""}}),c=k(()=>e.limit-t.value.length>0),v=k(()=>r.value?u.value==-1?null:u.value-t.value.length:1),L=ie(()=>{const a=m.value.map(d=>e.excludeDomain?d.url:d.uri);r.value?t.value=[...t.value,...a]:t.value.splice(f.value,1,a.shift()),z()},1e3,!1),M=a=>{var d;w.value||(a>=0?(r.value=!1,f.value=a):r.value=!0,(d=h.value)==null||d.open())},N=a=>{m.value=a},z=()=>{const a=u.value!=1?t.value:t.value[0]||"";l("update:modelValue",a),l("change",a),P()},T=a=>{t.value.splice(a,1),z()},G=a=>{y.value=a,_.value=!0},P=()=>{W(()=>{var a;e.hiddenUpload&&(t.value=[]),(a=g.value)==null||a.clearSelect()})};return X(C,a=>{t.value=Array.isArray(a)?a:a==""?[]:[a]},{immediate:!0}),$("limit",e.limit),$("hiddenUpload",e.hiddenUpload),{popupRef:h,materialRef:g,fileList:t,tipsText:o,handleConfirm:L,meterialLimit:v,showUpload:c,showPopup:M,selectChange:N,deleteImg:T,previewUrl:y,showPreview:_,handlePreview:G,handleClose:P,getImageUrl:b}}});const R=e=>(oe("data-v-5f839159"),e=e(),se(),e),ue={class:"material-select"},de=["onClick"],pe={class:"operation-btns text-xs text-center"},me=R(()=>n("span",null,"修改",-1)),fe=["onClick"],ce=["href"],ve=R(()=>n("span",null,"添加",-1)),he={class:"material-wrap"};function ge(e,l,h,g,y,_){const t=I("file-item"),m=q,r=I("draggable"),f=j,w=D,u=O,C=F,b=A;return S(),U("div",ue,[i(C,{ref:"popupRef",width:"830px","custom-class":"body-padding",title:`选择${e.tipsText}`,onConfirm:e.handleConfirm,onClose:e.handleClose},Z({default:p(()=>[i(u,null,{default:p(()=>[n("div",he,[i(w,{ref:"materialRef",type:e.type,"file-size":e.fileSize,limit:e.meterialLimit,onChange:e.selectChange},null,8,["type","file-size","limit","onChange"])])]),_:1})]),_:2},[e.hiddenUpload?void 0:{name:"trigger",fn:p(()=>[n("div",{class:"material-select__trigger clearfix",onClick:l[3]||(l[3]=V(()=>{},["stop"]))},[i(r,{class:"draggable",modelValue:e.fileList,"onUpdate:modelValue":l[1]||(l[1]=o=>e.fileList=o),animation:"300","item-key":"id"},{item:p(({element:o,index:c})=>[n("div",{class:B(["material-preview",{"is-disabled":e.disabled,"is-one":e.limit==1}]),onClick:v=>e.showPopup(c)},[i(m,{onClose:v=>e.deleteImg(c)},{default:p(()=>[i(t,{uri:e.excludeDomain?e.getImageUrl(o):o,"file-size":e.size,type:e.type},null,8,["uri","file-size","type"])]),_:2},1032,["onClose"]),n("div",pe,[me,x(" | "),e.type=="image"||e.type=="video"?(S(),U("span",{key:0,onClick:V(v=>e.handlePreview(o),["stop"])},"查看",8,fe)):E("",!0),e.type=="file"?(S(),U("a",{key:1,href:o,target:"_blank",onClick:l[0]||(l[0]=V(()=>{},["stop"]))},"下载",8,ce)):E("",!0)])],10,de)]),_:1},8,["modelValue"]),ee(n("div",{class:B(["material-upload",{"is-disabled":e.disabled,"is-one":e.limit==1,[e.uploadClass]:!0}]),onClick:l[2]||(l[2]=o=>e.showPopup(-1))},[ae(e.$slots,"upload",{},()=>[n("div",{class:"upload-btn",style:le({width:e.size,height:e.size})},[i(f,{size:25,name:"el-icon-Plus"}),ve],4)],!0)],2),[[te,e.showUpload]])])]),key:"0"}]),1032,["title","onConfirm","onClose"]),i(b,{modelValue:e.showPreview,"onUpdate:modelValue":l[4]||(l[4]=o=>e.showPreview=o),url:e.previewUrl,type:e.type},null,8,["modelValue","url","type"])])}const ze=ne(re,[["render",ge],["__scopeId","data-v-5f839159"]]);export{ze as M};
