import{d as w,r as x,aU as D,aW as G,b as r,aO as E,aK as B,aV as i,o as b,c as k,a as z,aw as V,a9 as Y}from"./@vue-25170201.js";import"./adapter-vue-20243c9c.js";import{B as q,q as o,o as m,z as c,_ as A}from"./@tencentcloud-25a17c42.js";import{T as F}from"./config-58aee8b5.js";import"./tim-upload-plugin-5e9dfffb.js";import"./tim-profanity-filter-plugin-23d0f338.js";import"./vue-04189d9a.js";import"./marked-7f3c3653.js";import"./trtc-cloud-js-sdk-ca6139e0.js";import"./trtc-sdk-v5-8c3e4b7a.js";import"./pinia-1182f1fa.js";import"./mitt-f7ef348c.js";import"./interactjs-c534f49a.js";import"./rtc-detect-1f468b1b.js";const H=w({__name:"index",props:{message:{default:()=>({})}},emits:["openReadUserPanel"],setup(v,{emit:S}){const y=S,t=v,T=F.getFeatureConfig("ReadStatus"),u=q.TYPES,g=x(o.getData(m.USER,"displayMessageReadReceipt"));D(()=>{o.watch(m.USER,{displayMessageReadReceipt:_})}),G(()=>{o.unwatch(m.USER,{displayMessageReadReceipt:_})});const M=r(()=>{if(!T||!g.value)return!1;const{ID:e,type:n,flow:l,status:p,hasRiskContent:d,conversationID:f,conversationType:U,needReadReceipt:O=!1}=t.message;if(d)return!1;const{groupProfile:a}=o.getConversationModel(f)||{};if((a==null?void 0:a.type)===u.GRP_AVCHATROOM||(a==null?void 0:a.type)===u.GRP_COMMUNITY)return!1;if(n===u.MSG_CUSTOM){const R=o.getMessageModel(e);if((R==null?void 0:R.getSignalingInfo())!==null)return!1}return l!=="out"||p!=="success"?!1:U==="GROUP"?O:U==="C2C"}),s=r(()=>{const{conversationType:e,needReadReceipt:n=!1,isPeerRead:l=!1}=t.message,{readCount:p=0,unreadCount:d=0,isPeerRead:f=!1}=t.message.readReceiptInfo;return e==="C2C"?n?f?0:1:l?0:1:e==="GROUP"?n?p===0?1:d===0?2:4:3:1}),h=r(()=>{const{readCount:e=0}=t.message.readReceiptInfo;switch(s.value){case 0:return c.t("TUIChat.已读");case 1:return c.t("TUIChat.未读");case 2:return c.t("TUIChat.全部已读");case 4:return`${e}${c.t("TUIChat.人已读")}`;default:return""}}),I=r(()=>{const{conversationType:e}=t.message;return e==="C2C"?s.value!==0:e==="GROUP"?s.value!==2:!1}),C=r(()=>t.message.needReadReceipt&&t.message.conversationType==="GROUP"&&(s.value===4||s.value===1));function P(){C.value&&y("openReadUserPanel")}function _(e){g.value=e}return(e,n)=>E((b(),k("div",{class:Y({"message-label":!0,unread:i(I),"finger-point":i(C)}),onClick:P},[z("span",null,V(i(h)),1)],2)),[[B,i(M)]])}});const ne=A(H,[["__scopeId","data-v-6f029fb7"]]);export{ne as default};
