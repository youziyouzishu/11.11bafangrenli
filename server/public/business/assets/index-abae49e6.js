import{d as Z,b as C,r as P,aU as j,aW as O,o as r,c as i,a as y,aV as s,aw as k,G as M,u as m,F as R,aj as $,a9 as f,ak as U,aR as H,E as ee,t as ae}from"./@vue-25170201.js";import"./adapter-vue-20243c9c.js";import{q as n,o as l,z as p,_ as se}from"./@tencentcloud-25a17c42.js";import"./dayjs-346d7cd4.js";import{c as re,g as te,s as I}from"./search-type-list-06b12619.js";import x from"./Icon-fec85db6.js";import ie from"./index-c86991f7.js";import{d as oe}from"./down-icon-9d19ec5a.js";import{c as ce}from"./input-close-4e859ba7.js";import{c as ne}from"./close-dark-2378607d.js";import{a as T,c as N}from"./env-6b0ecdb8.js";import"./type-96adc8a0.js";const w=24*60*60,F={all:{key:"all",label:"全部",value:{timePosition:0,timePeriod:0}},oneDay:{key:"today",label:"今天",value:{timePosition:0,timePeriod:w}},threeDay:{key:"threeDays",label:"近三天",value:{timePosition:0,timePeriod:3*w}},sevenDay:{key:"sevenDays",label:"近七天",value:{timePosition:0,timePeriod:7*w}}},S=F.all,le={key:0,class:"tui-search-header"},ue={class:"tui-search-header-title"},he={class:"tui-search-tabs"},de=["onClick"],ye={key:1,class:"tui-search-time"},me=["onClick"],pe={key:0,class:"tui-search-time-item-picker"},Te={key:1},ve=Z({__name:"index",props:{popupPosition:{type:String,default:"bottom"},searchType:{type:String,default:"global",validator(g){return["global","conversation"].includes(g)}}},emits:["searchConfigChange","closeInConversationSearch"],setup(g,{emit:L}){const a=g,V=L,z=C(()=>(a==null?void 0:a.searchType)==="conversation"?re:te),v=P(I[a==null?void 0:a.searchType]),c=P(S),B=C(()=>v.value.key!=="contact"&&v.value.key!=="group"),b=C(()=>T&&a.searchType==="global"&&!N?"two":"one"),o=P(!1);function D(e){(e==null?void 0:e.searchType)===(a==null?void 0:a.searchType)&&(v.value=(e==null?void 0:e.value)||I[a==null?void 0:a.searchType])}function A(e){(e==null?void 0:e.searchType)===(a==null?void 0:a.searchType)&&(c.value=(e==null?void 0:e.value)||S)}j(()=>{n.watch(l.SEARCH,{currentSearchMessageType:D,currentSearchMessageTime:A})}),O(()=>{n.unwatch(l.SEARCH,{currentSearchMessageType:D,currentSearchMessageTime:A})});const q=e=>{n.update(l.SEARCH,"currentSearchMessageType",{value:e,searchType:a.searchType})},W=e=>{o.value&&e.key==="all"?o.value=!1:(o.value=!1,n.update(l.SEARCH,"currentSearchMessageTime",{value:e,searchType:a.searchType}))},G=()=>{var e;((e=c.value)==null?void 0:e.key)!=="all"?n.update(l.SEARCH,"currentSearchMessageTime",{value:S,searchType:a.searchType}):o.value=!0},J=e=>{var h,t,u;if(((h=c.value)==null?void 0:h.key)==="all"){const{startDate:d,endDate:_}=e,E=Number((((t=_==null?void 0:_.toDate())==null?void 0:t.getTime())/1e3).toFixed(0)),X=E-Number((((u=d==null?void 0:d.toDate())==null?void 0:u.getTime())/1e3).toFixed(0)),Y={key:c.value.key,label:c.value.label,value:{timePosition:E,timePeriod:X}};n.update(l.SEARCH,"currentSearchMessageTime",{value:Y,searchType:a.searchType})}},K=()=>{var e;o.value=!1,((e=c.value)==null?void 0:e.key)==="all"&&n.update(l.SEARCH,"currentSearchMessageTime",{value:S,searchType:a.searchType})},Q=()=>{V("closeInConversationSearch")};return(e,h)=>(r(),i("div",{class:f(["tui-search-container",!s(T)&&"tui-search-container-h5",s(T)&&`container-${a.popupPosition}`,`container-${a.searchType}`])},[y("div",{class:f([s(T)&&`tui-search-container-${a.popupPosition}`,!s(T)&&"tui-search-container-h5-main"])},[a.searchType==="conversation"&&!s(N)?(r(),i("div",le,[y("div",ue,k(s(p).t("TUISearch.搜索会话内容")),1),y("div",{class:"tui-search-header-close",onClick:Q},[M(x,{file:s(ne),width:"14px",height:"14px"},null,8,["file"])])])):m("",!0),y("div",he,[(r(!0),i(R,null,$(s(z),(t,u)=>(r(),i("div",{key:u,class:f(["tui-search-tabs-item",s(v).key===t.key&&"tui-search-tabs-item-selected"]),onClick:d=>q(t)},k(s(p).t(`TUISearch.${t.label}`)),11,de))),128))]),U(e.$slots,"input",{},void 0,!0),s(B)?(r(),i("div",ye,[(r(!0),i(R,null,$(s(F),(t,u)=>(r(),i("div",{key:u,class:f(["tui-search-time-item",s(c).key===t.key&&"tui-search-time-item-selected"]),onClick:d=>W(t)},[t.key==="all"?(r(),i("div",pe,[s(o)?m("",!0):(r(),i("div",{key:0,class:"tui-search-time-item-all",onClick:H(G,["stop"])},[ee(k(s(p).t("TUISearch.选择时间")+":  "+s(p).t("TUISearch.全部"))+" ",1),M(x,{file:s(oe),width:"14px",height:"14px"},null,8,["file"])])),y("div",{onClick:h[0]||(h[0]=H(()=>{},["stop"]))},[s(o)?(r(),ae(ie,{key:0,type:"range",rangeTableType:s(b),onPick:J},null,8,["rangeTableType"])):m("",!0)]),s(o)?(r(),i("div",{key:1,class:"tui-search-time-item-close",onClick:K},[M(x,{class:"icon",file:s(ce),width:"14px",height:"14px"},null,8,["file"])])):m("",!0)])):(r(),i("div",Te,k(s(p).t(`TUISearch.${t.label}`)),1))],10,me))),128))])):m("",!0),U(e.$slots,"result",{},void 0,!0)],2)],2))}});const ke=se(ve,[["__scopeId","data-v-fec6713a"]]),Re=Object.freeze(Object.defineProperty({__proto__:null,default:ke},Symbol.toStringTag,{value:"Module"}));export{ke as S,Re as i,S as s};
