import{B as c,Q as T,z as p,J as E,Z as l,i as n,W as C}from"./@tencentcloud-25a17c42.js";import{T as r}from"./index-ebb29dde.js";import{T as t}from"./index-9521edcb.js";const o=a=>{var s;return(a==null?void 0:a.avatar)||((s=a==null?void 0:a.profile)==null?void 0:s.avatar)||(a==null?void 0:a.groupID)&&"https://web.sdk.qcloud.com/im/assets/images/Public.svg"||"https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png"},h=a=>{var s;return(a==null?void 0:a.remark)||(a==null?void 0:a.name)||((s=a==null?void 0:a.profile)==null?void 0:s.nick)||(a==null?void 0:a.nick)||(a==null?void 0:a.groupID)||(a==null?void 0:a.userID)||""},I=a=>{var s;return(a==null?void 0:a.name)||((s=a==null?void 0:a.profile)==null?void 0:s.nick)||(a==null?void 0:a.nick)||(a==null?void 0:a.groupID)||(a==null?void 0:a.userID)||""},P=a=>{var e;const s=[{label:a!=null&&a.groupID?"群ID":"ID",data:(a==null?void 0:a.groupID)||(a==null?void 0:a.userID)||""}];return g(a)||s.push({label:a!=null&&a.groupID?"群类型":"个性签名",data:(a==null?void 0:a.type)||((e=a==null?void 0:a.profile)==null?void 0:e.selfSignature)||""}),s},g=a=>{var s,e,S,d;return(a==null?void 0:a.type)===((e=(s=c)==null?void 0:s.TYPES)==null?void 0:e.SNS_APPLICATION_SENT_TO_ME)||(a==null?void 0:a.type)===((d=(S=c)==null?void 0:S.TYPES)==null?void 0:d.SNS_APPLICATION_SENT_BY_ME)},y=a=>new Promise((s,e)=>{if(a!=null&&a.groupID||!(a!=null&&a.userID)){s(!1);return}if(a!=null&&a.addTime){s(!0);return}T.checkFriend({userIDList:[a==null?void 0:a.userID],type:c.TYPES.SNS_CHECK_TYPE_BOTH}).then(S=>{var d,u;switch((u=(d=S==null?void 0:S.data)==null?void 0:d.successUserIDList[0])==null?void 0:u.relation){case c.TYPES.SNS_TYPE_NO_RELATION:s(!1);break;case c.TYPES.SNS_TYPE_A_WITH_B:s(!1);break;case c.TYPES.SNS_TYPE_B_WITH_A:s(!1);break;case c.TYPES.SNS_TYPE_BOTH_WAY:s(!0);break;default:s(!1);break}}).catch(S=>{console.warn("checkFriend error",S),e(S)})}),D=(a,s)=>{var e;if(((e=s==null?void 0:s.replace(/[^\u0000-\u00ff]/g,"aa"))==null?void 0:e.length)>96){r({message:p.t("TUIContact.修改备注失败: 备注长度不得超过 96 字节"),type:t.ERROR});return}T.updateFriend({userID:a,remark:s}).then(()=>{r({message:p.t("TUIContact.修改备注成功"),type:t.SUCCESS})}).catch(S=>{console.warn("update friend remark failed:",S),r({message:p.t("TUIContact.修改备注失败"),type:t.ERROR})})},O=a=>{T.deleteFriend({userIDList:[a],type:c.TYPES.SNS_DELETE_TYPE_BOTH}).then(s=>{const{successUserIDList:e}=s.data;e[0].userID===a?r({message:p.t("TUIContact.删除好友成功"),type:t.SUCCESS}):r({message:p.t("TUIContact.删除好友失败"),type:t.ERROR})}).catch(s=>{console.warn("delete friend failed:",s),r({message:p.t("TUIContact.删除好友失败"),type:t.ERROR})})},A=a=>{T.addFriend(a).then(()=>{r({message:p.t("TUIContact.申请已发送"),type:t.SUCCESS})}).catch(s=>{console.warn("delete friend failed:",s),r({message:p.t("TUIContact.申请发送失败"),type:t.ERROR})})},N=a=>{const s=a!=null&&a.groupID?`GROUP${a==null?void 0:a.groupID}`:`C2C${a==null?void 0:a.userID}`;E.switchConversation(s).catch(e=>{console.warn("switch conversation failed:",e),r({message:p.t("TUIContact.进入会话失败"),type:t.ERROR})})},Y=a=>{T.acceptFriendApplication({userID:a,type:c.TYPES.SNS_APPLICATION_AGREE_AND_ADD}).then(()=>{r({message:p.t("TUIContact.添加好友成功"),type:t.SUCCESS})}).catch(s=>{console.warn("accept friend application failed:",s),r({message:p.t("TUIContact.同意好友申请失败"),type:t.ERROR})})},k=a=>{T.refuseFriendApplication(a).then(()=>{r({message:p.t("TUIContact.拒绝成功"),type:t.SUCCESS})}).catch(s=>{console.warn("accept friend application failed:",s),r({message:p.t("TUIContact.拒绝好友申请失败"),type:t.ERROR})})},w=a=>{l.dismissGroup(a).then(()=>{var s,e;r({message:p.t("TUIContact.解散群聊成功"),type:t.SUCCESS}),(s=n)!=null&&s.updateContactSearch&&((e=n)==null||e.updateContactSearch())}).catch(s=>{console.warn("dismiss group failed:",s),r({message:p.t("TUIContact.解散群聊失败"),type:t.ERROR})})},b=a=>{l.quitGroup(a).then(()=>{r({message:p.t("TUIContact.退出群组成功"),type:t.SUCCESS})}).catch(s=>{console.warn("quit group failed:",s),r({message:p.t("TUIContact.退出群组失败"),type:t.ERROR})})},F=(a,s)=>{l.joinGroup({groupID:a,applyMessage:s}).then(e=>{var S;switch((S=e==null?void 0:e.data)==null?void 0:S.status){case c.TYPES.JOIN_STATUS_WAIT_APPROVAL:r({message:p.t("TUIContact.等待管理员同意"),type:t.SUCCESS});break;case c.TYPES.JOIN_STATUS_SUCCESS:r({message:p.t("TUIContact.加群成功"),type:t.SUCCESS});break;case c.TYPES.JOIN_STATUS_ALREADY_IN_GROUP:r({message:p.t("TUIContact.您已是群成员"),type:t.SUCCESS});break}}).catch(e=>{console.warn("join group failed:",e),r({message:"申请入群失败",type:t.ERROR})})},L=(a,s)=>{C.addToBlacklist({userIDList:[a]}).then(()=>{s&&s()}).catch(e=>{console.warn("add to blacklist failed:",e),r({message:p.t("TUIContact.加入黑名单失败"),type:t.ERROR})})},B=(a,s)=>{C.removeFromBlacklist({userIDList:[a]}).then(()=>{s&&s()}).catch(e=>{console.warn("remove from blacklist failed:",e),r({message:p.t("TUIContact.移除黑名单失败"),type:t.ERROR})})};export{L as a,A as b,O as c,w as d,N as e,Y as f,k as g,P as h,g as i,F as j,y as k,I as l,o as m,h as n,b as q,B as r,D as u};
