import{A as H,B as J,x as O,C as X,y as Z,H as Q,q as W,r as Y,s as ee,I as te,J as oe}from"./element-plus-64da2267.js";import{_ as ae}from"./index.vue_vue_type_script_setup_true_lang-abbb91f8.js";import{D as ne,w as V,n as le}from"./index-7638d9aa.js";import{d as T,aZ as B,r as re,al as ie,am as se,o as r,c as b,G as e,aM as t,aV as a,aP as S,E as s,aO as m,t as p,a as w,aX as me,u as de}from"./@vue-25170201.js";import{b as pe,c as ce,d as _e,e as ue,s as fe}from"./code-cf8f43d7.js";import{u as ge}from"./usePaging-8178f38d.js";import{_ as ye}from"./data-table.vue_vue_type_script_setup_true_lang-efd3d023.js";import{_ as be}from"./code-preview.vue_vue_type_script_setup_true_lang-5a077b80.js";import"./lodash-es-fbce1780.js";import"./async-validator-dee29e8b.js";import"./@element-plus-9559a6ac.js";import"./dayjs-346d7cd4.js";import"./@tencentcloud-25a17c42.js";import"./tim-upload-plugin-5e9dfffb.js";import"./tim-profanity-filter-plugin-23d0f338.js";import"./vue-04189d9a.js";import"./marked-7f3c3653.js";import"./trtc-cloud-js-sdk-ca6139e0.js";import"./trtc-sdk-v5-8c3e4b7a.js";import"./pinia-1182f1fa.js";import"./mitt-f7ef348c.js";import"./interactjs-c534f49a.js";import"./rtc-detect-1f468b1b.js";import"./@ctrl-f8748455.js";import"./@popperjs-c75af06c.js";import"./normalize-wheel-es-ed76fb12.js";import"./@vueuse-944ef3f4.js";import"./lodash-2cc29f39.js";import"./axios-67477f72.js";import"./vue-router-f7517f62.js";import"./css-color-function-7acc3e97.js";import"./color-9254db0b.js";import"./clone-db6b0f3b.js";import"./color-convert-946e453a.js";import"./color-name-b7949e8c.js";import"./color-string-6fa48439.js";import"./balanced-match-51764fed.js";import"./ms-f6814399.js";import"./nprogress-ccaead9e.js";import"./@tiptap-008a465d.js";import"./prosemirror-state-c544e594.js";import"./prosemirror-model-8b0495eb.js";import"./orderedmap-1b52af60.js";import"./prosemirror-transform-fc1f2a72.js";import"./prosemirror-view-ef3f9f96.js";import"./prosemirror-keymap-776f822d.js";import"./w3c-keyname-a25e4cc1.js";import"./prosemirror-commands-5c2a1a07.js";import"./prosemirror-schema-list-1c96ec4d.js";import"./vue-clipboard3-f5f9feb9.js";import"./clipboard-3d849c41.js";import"./echarts-d6620a89.js";import"./zrender-9797a04d.js";import"./tslib-54e39b60.js";import"./highlight.js-1b502259.js";import"./@highlightjs-7a15facb.js";import"./path-to-regexp-767716ea.js";import"./index-e34f0d65.js";const we={class:"code-generation"},he={class:"flex"},ve={class:"mt-4"},Ce={class:"flex items-center"},ke={class:"flex justify-end mt-4"},Ve=T({name:"codeGenerate"}),Bt=T({...Ve,setup(xe){const c=B({table_name:"",table_comment:""}),_=B({show:!1,loading:!1,code:[]}),{pager:f,getLists:y,resetParams:I,resetPage:h}=ge({fetchFun:ue,params:c}),g=re([]),K=n=>{g.value=n.map(({id:o})=>o)},G=async n=>{await V.confirm("确定要同步表结构？"),await fe({id:n})},x=async n=>{await V.confirm("确定要删除？"),await pe({id:n}),y()},N=async n=>{const o=await ce({id:n});_.code=o,_.show=!0},U=n=>n.some(o=>o.generate_type==1),E=async n=>{if(U(n))return V.msgError("生成方式为生成到模块，请在前端开发模式下使用，详细参考文档");const o=await _e({id:n});o.file&&window.open(o.file,"_blank")},F=(n,o)=>{switch(n){case"generate":E([o.id]);break;case"sync":G(o.id);break;case"delete":x(o.id)}};return y(),(n,o)=>{const D=H,v=J,i=O,M=X,P=Z,C=le,u=Q,q=ie("router-link"),k=W,z=Y,A=ee,L=te,R=ae,d=se("perms"),j=oe;return r(),b("div",we,[e(P,{class:"!border-none",shadow:"never"},{default:t(()=>[e(M,{class:"mb-[-16px]",model:a(c),inline:""},{default:t(()=>[e(v,{label:"表名称"},{default:t(()=>[e(D,{class:"w-[280px]",modelValue:a(c).table_name,"onUpdate:modelValue":o[0]||(o[0]=l=>a(c).table_name=l),clearable:"",onKeyup:S(a(h),["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(v,{label:"表描述"},{default:t(()=>[e(D,{class:"w-[280px]",modelValue:a(c).table_comment,"onUpdate:modelValue":o[1]||(o[1]=l=>a(c).table_comment=l),clearable:"",onKeyup:S(a(h),["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(v,null,{default:t(()=>[e(i,{type:"primary",onClick:a(h)},{default:t(()=>[s("查询")]),_:1},8,["onClick"]),e(i,{onClick:a(I)},{default:t(()=>[s("重置")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1}),m((r(),p(P,{class:"!border-none mt-4",shadow:"never"},{default:t(()=>[w("div",he,[m((r(),p(ye,{class:"inline-block mr-[10px]",onSuccess:a(y)},{default:t(()=>[e(i,{type:"primary"},{icon:t(()=>[e(C,{name:"el-icon-Plus"})]),default:t(()=>[s(" 导入数据表 ")]),_:1})]),_:1},8,["onSuccess"])),[[d,["tools.generator/selectTable"]]]),m((r(),p(i,{disabled:!a(g).length,onClick:o[2]||(o[2]=l=>x(a(g))),type:"danger"},{icon:t(()=>[e(C,{name:"el-icon-Delete"})]),default:t(()=>[s(" 删除 ")]),_:1},8,["disabled"])),[[d,["tools.generator/delete"]]]),m((r(),p(i,{disabled:!a(g).length,onClick:o[3]||(o[3]=l=>E(a(g)))},{default:t(()=>[s(" 生成代码 ")]),_:1},8,["disabled"])),[[d,["tools.generator/generate"]]])]),w("div",ve,[e(L,{data:a(f).lists,size:"large",onSelectionChange:K},{default:t(()=>[e(u,{type:"selection",width:"55"}),e(u,{label:"表名称",prop:"table_name","min-width":"180"}),e(u,{label:"表描述",prop:"table_comment","min-width":"180"}),e(u,{label:"创建时间",prop:"create_time","min-width":"180"}),e(u,{label:"更新时间",prop:"update_time","min-width":"180"}),e(u,{label:"操作",width:"160",fixed:"right"},{default:t(({row:l})=>[w("div",Ce,[m((r(),p(i,{type:"primary",link:"",onClick:$=>N(l.id)},{default:t(()=>[s(" 预览 ")]),_:2},1032,["onClick"])),[[d,["tools.generator/preview"]]]),e(i,{type:"primary",link:""},{default:t(()=>[m((r(),p(q,{to:{path:a(ne)("tools.generator/edit"),query:{id:l.id}}},{default:t(()=>[s(" 编辑 ")]),_:2},1032,["to"])),[[d,["tools.generator/edit"]]])]),_:2},1024),m((r(),p(A,{class:"ml-2",onCommand:$=>F($,l)},{dropdown:t(()=>[e(z,null,{default:t(()=>[m((r(),b("div",null,[e(k,{command:"generate"},{default:t(()=>[e(i,{type:"primary",link:""},{default:t(()=>[s(" 生成代码 ")]),_:1})]),_:1})])),[[d,["tools.generator/generate"]]]),m((r(),b("div",null,[e(k,{command:"sync"},{default:t(()=>[e(i,{type:"primary",link:""},{default:t(()=>[s(" 同步 ")]),_:1})]),_:1})])),[[d,["tools.generator/syncColumn"]]]),m((r(),b("div",null,[e(k,{command:"delete"},{default:t(()=>[e(i,{type:"danger",link:""},{default:t(()=>[s(" 删除 ")]),_:1})]),_:1})])),[[d,["tools.generator/delete"]]])]),_:1})]),default:t(()=>[e(i,{type:"primary",link:""},{default:t(()=>[s(" 更多 "),e(C,{name:"el-icon-ArrowDown",size:14})]),_:1})]),_:2},1032,["onCommand"])),[[d,["tools.generator/generate","tools.generator/syncColumn","tools.generator/delete"]]])])]),_:1})]),_:1},8,["data"])]),w("div",ke,[e(R,{modelValue:a(f),"onUpdate:modelValue":o[4]||(o[4]=l=>me(f)?f.value=l:null),onChange:a(y)},null,8,["modelValue","onChange"])])]),_:1})),[[j,a(f).loading]]),a(_).show?(r(),p(be,{key:0,modelValue:a(_).show,"onUpdate:modelValue":o[5]||(o[5]=l=>a(_).show=l),code:a(_).code},null,8,["modelValue","code"])):de("",!0)])}}});export{Bt as default};
