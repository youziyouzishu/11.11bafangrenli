import{c as mI,a as vx}from"./@tencentcloud-25a17c42.js";var fI={exports:{}},gb;function Kx(){return gb||(gb=1,function(ge,de){(function(u,Z){ge.exports=Z()})(mI,function(){function u(e,t){return t.forEach(function(r){r&&typeof r!="string"&&!Array.isArray(r)&&Object.keys(r).forEach(function(i){if(i!=="default"&&!(i in e)){var n=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(e,i,n.get?n:{enumerable:!0,get:function(){return r[i]}})}})}),Object.freeze(e)}var Z=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof mI<"u"?mI:typeof self<"u"?self:{},we=function(e){try{return!!e()}catch{return!0}},_t=!we(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),It=_t,Ht=Function.prototype,dt=Ht.call,ir=It&&Ht.bind.bind(dt,dt),Oe=It?ir:function(e){return function(){return dt.apply(e,arguments)}},Ur=Oe,nl=Ur({}.toString),Ir=Ur("".slice),ii=function(e){return Ir(nl(e),8,-1)},Fr=we,Gt=ii,vi=Object,xt=Oe("".split),Pe=Fr(function(){return!vi("z").propertyIsEnumerable(0)})?function(e){return Gt(e)=="String"?xt(e,""):vi(e)}:vi,Ge=function(e){return e==null},As=Ge,Dr=TypeError,ni=function(e){if(As(e))throw Dr("Can't call method on "+e);return e},wa=Pe,Hi=ni,nr=function(e){return wa(Hi(e))},Ri=function(e){return e&&e.Math==Math&&e},q=Ri(typeof globalThis=="object"&&globalThis)||Ri(typeof window=="object"&&window)||Ri(typeof self=="object"&&self)||Ri(typeof Z=="object"&&Z)||function(){return this}()||Function("return this")(),Gi={},Yi={get exports(){return Gi},set exports(e){Gi=e}},ur=q,to=Object.defineProperty,Cr=function(e,t){try{to(ur,e,{value:t,configurable:!0,writable:!0})}catch{ur[e]=t}return t},Or=Cr,hs="__core-js_shared__",gs=q[hs]||Or(hs,{}),ro=gs;(Yi.exports=function(e,t){return ro[e]||(ro[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.30.0",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.0/LICENSE",source:"https://github.com/zloirock/core-js"});var Vr,io,ol=ni,no=Object,or=function(e){return no(ol(e))},sl=or,al=Oe({}.hasOwnProperty),Bt=Object.hasOwn||function(e,t){return al(sl(e),t)},En=Oe,ft=0,pt=Math.random(),oi=En(1 .toString),si=function(e){return"Symbol("+(e===void 0?"":e)+")_"+oi(++ft+pt,36)},M=typeof navigator<"u"&&String(navigator.userAgent)||"",ct=q,wt=M,oo=ct.process,so=ct.Deno,Ut=oo&&oo.versions||so&&so.version,jr=Ut&&Ut.v8;jr&&(io=(Vr=jr.split("."))[0]>0&&Vr[0]<4?1:+(Vr[0]+Vr[1])),!io&&wt&&(!(Vr=wt.match(/Edge\/(\d+)/))||Vr[1]>=74)&&(Vr=wt.match(/Chrome\/(\d+)/))&&(io=+Vr[1]);var ce=io,Wi=ce,yr=we,Fe=!!Object.getOwnPropertySymbols&&!yr(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Wi&&Wi<41}),ao=Fe&&!Symbol.sham&&typeof Symbol.iterator=="symbol",_n=Gi,kr=Bt,Da=si,Hr=Fe,Br=ao,Ji=q.Symbol,ps=_n("wks"),ms=Br?Ji.for||Ji:Ji&&Ji.withoutSetter||Da,lt=function(e){return kr(ps,e)||(ps[e]=Hr&&kr(Ji,e)?Ji[e]:ms("Symbol."+e)),ps[e]},co=typeof document=="object"&&document.all,lo={all:co,IS_HTMLDDA:co===void 0&&co!==void 0},Oa=lo.all,Je=lo.IS_HTMLDDA?function(e){return typeof e=="function"||e===Oa}:function(e){return typeof e=="function"},Gr=Je,In=lo.all,Ct=lo.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:Gr(e)||e===In}:function(e){return typeof e=="object"?e!==null:Gr(e)},Ki=Ct,Xi=String,Yr=TypeError,y=function(e){if(Ki(e))return e;throw Yr(Xi(e)+" is not an object")},ka={},At=!we(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),Me=At&&we(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),Ft={},Cn=Ct,yt=q.document,sr=Cn(yt)&&Cn(yt.createElement),yn=function(e){return sr?yt.createElement(e):{}},uo=yn,bi=!At&&!we(function(){return Object.defineProperty(uo("div"),"a",{get:function(){return 7}}).a!=7}),ai=_t,Tn=Function.prototype.call,ht=ai?Tn.bind(Tn):function(){return Tn.apply(Tn,arguments)},fs=q,Es=Je,Wr=function(e,t){return arguments.length<2?(r=fs[e],Es(r)?r:void 0):fs[e]&&fs[e][t];var r},j=Oe({}.isPrototypeOf),_s=Wr,cl=Je,Ba=j,Ao=Object,Is=ao?function(e){return typeof e=="symbol"}:function(e){var t=_s("Symbol");return cl(t)&&Ba(t.prototype,Ao(e))},ho=String,zi=function(e){try{return ho(e)}catch{return"Object"}},Sn=Je,wi=zi,qi=TypeError,Ar=function(e){if(Sn(e))return e;throw qi(wi(e)+" is not a function")},Cs=Ar,ll=Ge,Dt=function(e,t){var r=e[t];return ll(r)?void 0:Cs(r)},go=ht,po=Je,mo=Ct,vn=TypeError,dl=ht,ys=Ct,fo=Is,ul=Dt,Na=function(e,t){var r,i;if(t==="string"&&po(r=e.toString)&&!mo(i=go(r,e))||po(r=e.valueOf)&&!mo(i=go(r,e))||t!=="string"&&po(r=e.toString)&&!mo(i=go(r,e)))return i;throw vn("Can't convert object to primitive value")},Pa=TypeError,rt=lt("toPrimitive"),Ts=function(e,t){if(!ys(e)||fo(e))return e;var r,i=ul(e,rt);if(i){if(t===void 0&&(t="default"),r=dl(i,e,t),!ys(r)||fo(r))return r;throw Pa("Can't convert object to primitive value")}return t===void 0&&(t="number"),Na(e,t)},Nr=Ts,ci=Is,$i=function(e){var t=Nr(e,"string");return ci(t)?t:t+""},Jr=At,Eo=bi,ke=Me,_o=y,Kr=$i,Ma=TypeError,I=Object.defineProperty,at=Object.getOwnPropertyDescriptor,Ss="enumerable",vs="configurable",Rs="writable";Ft.f=Jr?ke?function(e,t,r){if(_o(e),t=Kr(t),_o(r),typeof e=="function"&&t==="prototype"&&"value"in r&&Rs in r&&!r[Rs]){var i=at(e,t);i&&i[Rs]&&(e[t]=r.value,r={configurable:vs in r?r[vs]:i[vs],enumerable:Ss in r?r[Ss]:i[Ss],writable:!1})}return I(e,t,r)}:I:function(e,t,r){if(_o(e),t=Kr(t),_o(r),Eo)try{return I(e,t,r)}catch{}if("get"in r||"set"in r)throw Ma("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var Al=Math.ceil,hl=Math.floor,gl=Math.trunc||function(e){var t=+e;return(t>0?hl:Al)(t)},pl=gl,li=function(e){var t=+e;return t!=t||t===0?0:pl(t)},Rn=li,Io=Math.max,bs=Math.min,Yt=function(e,t){var r=Rn(e);return r<0?Io(r+t,0):bs(r,t)},La=li,ml=Math.min,Di=function(e){return e>0?ml(La(e),9007199254740991):0},Co=Di,ar=function(e){return Co(e.length)},Qa=nr,fl=Yt,xa=ar,Tt=function(e){return function(t,r,i){var n,a=Qa(t),c=xa(a),A=fl(i,c);if(e&&r!=r){for(;c>A;)if((n=a[A++])!=n)return!0}else for(;c>A;A++)if((e||A in a)&&a[A]===r)return e||A||0;return!e&&-1}},Ua={includes:Tt(!0),indexOf:Tt(!1)},bn={},di=Bt,ws=nr,wn=Ua.indexOf,El=bn,yo=Oe([].push),Pr=function(e,t){var r,i=ws(e),n=0,a=[];for(r in i)!di(El,r)&&di(i,r)&&yo(a,r);for(;t.length>n;)di(i,r=t[n++])&&(~wn(a,r)||yo(a,r));return a},ui=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Le=Pr,Ds=ui,Fa=Object.keys||function(e){return Le(e,Ds)},Va=At,Oi=Me,ja=Ft,Os=y,_l=nr,To=Fa;ka.f=Va&&!Oi?Object.defineProperties:function(e,t){Os(e);for(var r,i=_l(t),n=To(t),a=n.length,c=0;a>c;)ja.f(e,r=n[c++],i[r]);return e};var Zt,So=Wr("document","documentElement"),ks=si,Wt=Gi("keys"),vo=function(e){return Wt[e]||(Wt[e]=ks(e))},ki=y,Ro=ka,v=ui,S=bn,B=So,L=yn,J="prototype",ee="script",oe=vo("IE_PROTO"),$=function(){},ue=function(e){return"<"+ee+">"+e+"</"+ee+">"},Ae=function(e){e.write(ue("")),e.close();var t=e.parentWindow.Object;return e=null,t},he=function(){try{Zt=new ActiveXObject("htmlfile")}catch{}var e,t,r;he=typeof document<"u"?document.domain&&Zt?Ae(Zt):(t=L("iframe"),r="java"+ee+":",t.style.display="none",B.appendChild(t),t.src=String(r),(e=t.contentWindow.document).open(),e.write(ue("document.F=Object")),e.close(),e.F):Ae(Zt);for(var i=v.length;i--;)delete he[J][v[i]];return he()};S[oe]=!0;var Ye=Object.create||function(e,t){var r;return e!==null?($[J]=ki(e),r=new $,$[J]=null,r[oe]=e):r=he(),t===void 0?r:Ro.f(r,t)},ot=lt,nt=Ye,Nt=Ft.f,cr=ot("unscopables"),Jt=Array.prototype;Jt[cr]==null&&Nt(Jt,cr,{configurable:!0,value:nt(null)});var Pt,hr,Ot,er=function(e){Jt[cr][e]=!0},tr={},Dn=Je,Bs=q.WeakMap,Zi=Dn(Bs)&&/native code/.test(String(Bs)),Bi=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},_g=Ft,Ig=Bi,Ai=At?function(e,t,r){return _g.f(e,t,Ig(1,r))}:function(e,t,r){return e[t]=r,e},Cg=Zi,mu=q,fu=Ct,yg=Ai,bo=Bt,Il=gs,Tg=vo,Ni=bn,Cl="Object already initialized",yl=mu.TypeError,Sg=mu.WeakMap;if(Cg||Il.state){var hi=Il.state||(Il.state=new Sg);hi.get=hi.get,hi.has=hi.has,hi.set=hi.set,Pt=function(e,t){if(hi.has(e))throw yl(Cl);return t.facade=e,hi.set(e,t),t},hr=function(e){return hi.get(e)||{}},Ot=function(e){return hi.has(e)}}else{var Mt=Tg("state");Ni[Mt]=!0,Pt=function(e,t){if(bo(e,Mt))throw yl(Cl);return t.facade=e,yg(e,Mt,t),t},hr=function(e){return bo(e,Mt)?e[Mt]:{}},Ot=function(e){return bo(e,Mt)}}var rr={set:Pt,get:hr,has:Ot,enforce:function(e){return Ot(e)?hr(e):Pt(e,{})},getterFor:function(e){return function(t){var r;if(!fu(t)||(r=hr(t)).type!==e)throw yl("Incompatible receiver, "+e+" required");return r}}},Xr={},Tl={},Sl={}.propertyIsEnumerable,Ns=Object.getOwnPropertyDescriptor,Ha=Ns&&!Sl.call({1:2},1);Tl.f=Ha?function(e){var t=Ns(this,e);return!!t&&t.enumerable}:Sl;var vg=At,Rg=ht,bg=Tl,Eu=Bi,wg=nr,_u=$i,Dg=Bt,wo=bi,Iu=Object.getOwnPropertyDescriptor;Xr.f=vg?Iu:function(e,t){if(e=wg(e),t=_u(t),wo)try{return Iu(e,t)}catch{}if(Dg(e,t))return Eu(!Rg(bg.f,e,t),e[t])};var Ga={},Og={get exports(){return Ga},set exports(e){Ga=e}},vl=At,kg=Bt,Cu=Function.prototype,Bg=vl&&Object.getOwnPropertyDescriptor,Rl=kg(Cu,"name"),Ps={EXISTS:Rl,PROPER:Rl&&(function(){}).name==="something",CONFIGURABLE:Rl&&(!vl||vl&&Bg(Cu,"name").configurable)},Ng=Je,bl=gs,Pg=Oe(Function.toString);Ng(bl.inspectSource)||(bl.inspectSource=function(e){return Pg(e)});var wl=bl.inspectSource,Ms=Oe,Mg=we,Lg=Je,Ya=Bt,Dl=At,Qg=Ps.CONFIGURABLE,xg=wl,Ug=rr.enforce,Fg=rr.get,yu=String,Wa=Object.defineProperty,Vg=Ms("".slice),Ja=Ms("".replace),jg=Ms([].join),Hg=Dl&&!Mg(function(){return Wa(function(){},"length",{value:8}).length!==8}),Gg=String(String).split("String"),Yg=Og.exports=function(e,t,r){Vg(yu(t),0,7)==="Symbol("&&(t="["+Ja(yu(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!Ya(e,"name")||Qg&&e.name!==t)&&(Dl?Wa(e,"name",{value:t,configurable:!0}):e.name=t),Hg&&r&&Ya(r,"arity")&&e.length!==r.arity&&Wa(e,"length",{value:r.arity});try{r&&Ya(r,"constructor")&&r.constructor?Dl&&Wa(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var i=Ug(e);return Ya(i,"source")||(i.source=jg(Gg,typeof t=="string"?t:"")),e};Function.prototype.toString=Yg(function(){return Lg(this)&&Fg(this).source||xg(this)},"toString");var Wg=Je,Jg=Ft,Kg=Ga,Ka=Cr,Kt=function(e,t,r,i){i||(i={});var n=i.enumerable,a=i.name!==void 0?i.name:t;if(Wg(r)&&Kg(r,a,i),i.global)n?e[t]=r:Ka(t,r);else{try{i.unsafe?e[t]&&(n=!0):delete e[t]}catch{}n?e[t]=r:Jg.f(e,t,{value:r,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}return e},Do={},Xg=Pr,zg=ui.concat("length","prototype");Do.f=Object.getOwnPropertyNames||function(e){return Xg(e,zg)};var Ol={};Ol.f=Object.getOwnPropertySymbols;var On,Tu,Su,qg=Wr,$g=Do,Zg=Ol,Q=y,We=Oe([].concat),vu=qg("Reflect","ownKeys")||function(e){var t=$g.f(Q(e)),r=Zg.f;return r?We(t,r(e)):t},Ru=Bt,ep=vu,kl=Xr,tp=Ft,bu=function(e,t,r){for(var i=ep(t),n=tp.f,a=kl.f,c=0;c<i.length;c++){var A=i[c];Ru(e,A)||r&&Ru(r,A)||n(e,A,a(t,A))}},rp=we,wu=Je,Du=/#|\.prototype\./,Ls=function(e,t){var r=np[ip(e)];return r==op||r!=Bl&&(wu(t)?rp(t):!!t)},ip=Ls.normalize=function(e){return String(e).replace(Du,".").toLowerCase()},np=Ls.data={},Bl=Ls.NATIVE="N",op=Ls.POLYFILL="P",kn=Ls,Nl=q,sp=Xr.f,ap=Ai,cp=Kt,lp=Cr,dp=bu,up=kn,gt=function(e,t){var r,i,n,a,c,A=e.target,d=e.global,g=e.stat;if(r=d?Nl:g?Nl[A]||lp(A,{}):(Nl[A]||{}).prototype)for(i in t){if(a=t[i],n=e.dontCallGetSet?(c=sp(r,i))&&c.value:r[i],!up(d?i:A+(g?".":"#")+i,e.forced)&&n!==void 0){if(typeof a==typeof n)continue;dp(a,n)}(e.sham||n&&n.sham)&&ap(a,"sham",!0),cp(r,i,a,e)}},Ap=!we(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),hp=Bt,gp=Je,pp=or,mp=Ap,Ou=vo("IE_PROTO"),Pl=Object,fp=Pl.prototype,Xa=mp?Pl.getPrototypeOf:function(e){var t=pp(e);if(hp(t,Ou))return t[Ou];var r=t.constructor;return gp(r)&&t instanceof r?r.prototype:t instanceof Pl?fp:null},Ep=we,_p=Je,Ip=Ct,ku=Xa,Cp=Kt,Ml=lt("iterator"),Bu=!1;[].keys&&("next"in(Su=[].keys())?(Tu=ku(ku(Su)))!==Object.prototype&&(On=Tu):Bu=!0);var yp=!Ip(On)||Ep(function(){var e={};return On[Ml].call(e)!==e});yp&&(On={}),_p(On[Ml])||Cp(On,Ml,function(){return this});var Ll={IteratorPrototype:On,BUGGY_SAFARI_ITERATORS:Bu},Tp=Ft.f,Sp=Bt,Nu=lt("toStringTag"),Oo=function(e,t,r){e&&!r&&(e=e.prototype),e&&!Sp(e,Nu)&&Tp(e,Nu,{configurable:!0,value:t})},vp=Ll.IteratorPrototype,Rp=Ye,Pu=Bi,bp=Oo,wp=tr,Dp=function(){return this},Mu=function(e,t,r,i){var n=t+" Iterator";return e.prototype=Rp(vp,{next:Pu(+!i,r)}),bp(e,n,!1),wp[n]=Dp,e},Op=Oe,kp=Ar,Bp=Je,za=String,Np=TypeError,Pp=function(e,t,r){try{return Op(kp(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},Mp=y,Lp=function(e){if(typeof e=="object"||Bp(e))return e;throw Np("Can't set "+za(e)+" as a prototype")},ko=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=Pp(Object.prototype,"__proto__","set"))(r,[]),t=r instanceof Array}catch{}return function(i,n){return Mp(i),Lp(n),t?e(i,n):i.__proto__=n,i}}():void 0),Qp=gt,xp=ht,Up=Je,Fp=Mu,Lu=Xa,Qu=ko,qa=Oo,Vp=Ai,Ql=Kt,jp=tr,xu=Ps.PROPER,Hp=Ps.CONFIGURABLE,Uu=Ll.IteratorPrototype,$a=Ll.BUGGY_SAFARI_ITERATORS,Qs=lt("iterator"),Fu="keys",xs="values",Bo="entries",Us=function(){return this},Za=function(e,t,r,i,n,a,c){Fp(r,t,i);var A,d,g,E=function(G){if(G===n&&x)return x;if(!$a&&G in w)return w[G];switch(G){case Fu:case xs:case Bo:return function(){return new r(this,G)}}return function(){return new r(this)}},f=t+" Iterator",b=!1,w=e.prototype,k=w[Qs]||w["@@iterator"]||n&&w[n],x=!$a&&k||E(n),Y=t=="Array"&&w.entries||k;if(Y&&(A=Lu(Y.call(new e)))!==Object.prototype&&A.next&&(Lu(A)!==Uu&&(Qu?Qu(A,Uu):Up(A[Qs])||Ql(A,Qs,Us)),qa(A,f,!0)),xu&&n==xs&&k&&k.name!==xs&&(Hp?Vp(w,"name",xs):(b=!0,x=function(){return xp(k,this)})),n)if(d={values:E(xs),keys:a?x:E(Fu),entries:E(Bo)},c)for(g in d)($a||b||!(g in w))&&Ql(w,g,d[g]);else Qp({target:t,proto:!0,forced:$a||b},d);return w[Qs]!==x&&Ql(w,Qs,x,{name:n}),jp[t]=x,d},Vu=function(e,t){return{value:e,done:t}},Gp=nr,xl=er,ju=tr,Hu=rr,Yp=Ft.f,Wp=Za,Gu=Vu,Jp=At,zr="Array Iterator",Kp=Hu.set,Xp=Hu.getterFor(zr),ec=Wp(Array,"Array",function(e,t){Kp(this,{type:zr,target:Gp(e),index:0,kind:t})},function(){var e=Xp(this),t=e.target,r=e.kind,i=e.index++;return!t||i>=t.length?(e.target=void 0,Gu(void 0,!0)):Gu(r=="keys"?i:r=="values"?t[i]:[i,t[i]],!1)},"values"),Yu=ju.Arguments=ju.Array;if(xl("keys"),xl("values"),xl("entries"),Jp&&Yu.name!=="values")try{Yp(Yu,"name",{value:"values"})}catch{}var Wu={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},tc=yn("span").classList,Ju=tc&&tc.constructor&&tc.constructor.prototype,Ku=Ju===Object.prototype?void 0:Ju,Xu=q,zu=Wu,zp=Ku,Fs=ec,No=Ai,qu=lt,Po=qu("iterator"),$u=qu("toStringTag"),Ul=Fs.values,Zu=function(e,t){if(e){if(e[Po]!==Ul)try{No(e,Po,Ul)}catch{e[Po]=Ul}if(e[$u]||No(e,$u,t),zu[t]){for(var r in Fs)if(e[r]!==Fs[r])try{No(e,r,Fs[r])}catch{e[r]=Fs[r]}}}};for(var Fl in zu)Zu(Xu[Fl]&&Xu[Fl].prototype,Fl);Zu(zp,"DOMTokenList");var en=typeof process<"u"&&ii(process)=="process",rc=Ga,ic=Ft,gi=function(e,t,r){return r.get&&rc(r.get,t,{getter:!0}),r.set&&rc(r.set,t,{setter:!0}),ic.f(e,t,r)},nc=Wr,eA=gi,qp=At,Vl=lt("species"),Bn=function(e){var t=nc(e);qp&&t&&!t[Vl]&&eA(t,Vl,{configurable:!0,get:function(){return this}})},oc=j,H=TypeError,Xt=function(e,t){if(oc(t,e))return e;throw H("Incorrect invocation")},tA={};tA[lt("toStringTag")]="z";var $p=String(tA)==="[object z]",sc=Je,Vs=ii,pi=lt("toStringTag"),Nn=Object,Zp=Vs(function(){return arguments}())=="Arguments",tn=$p?Vs:function(e){var t,r,i;return e===void 0?"Undefined":e===null?"Null":typeof(r=function(n,a){try{return n[a]}catch{}}(t=Nn(e),pi))=="string"?r:Zp?Vs(t):(i=Vs(t))=="Object"&&sc(t.callee)?"Arguments":i},jl=Oe,js=we,rA=Je,em=tn,ye=wl,Ce=function(){},iA=[],Ie=Wr("Reflect","construct"),ac=/^\s*(?:class|function)\b/,tm=jl(ac.exec),rm=!ac.exec(Ce),Hs=function(e){if(!rA(e))return!1;try{return Ie(Ce,iA,e),!0}catch{return!1}},nA=function(e){if(!rA(e))return!1;switch(em(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return rm||!!tm(ac,ye(e))}catch{return!0}};nA.sham=!0;var Gs,Mo,oA,Hl,Gl=!Ie||js(function(){var e;return Hs(Hs.call)||!Hs(Object)||!Hs(function(){e=!0})||e})?nA:Hs,im=Gl,nm=zi,om=TypeError,sA=function(e){if(im(e))return e;throw om(nm(e)+" is not a constructor")},aA=y,sm=sA,am=Ge,cm=lt("species"),Yl=function(e,t){var r,i=aA(e).constructor;return i===void 0||am(r=aA(i)[cm])?t:sm(r)},lm=_t,cA=Function.prototype,lA=cA.apply,dA=cA.call,uA=typeof Reflect=="object"&&Reflect.apply||(lm?dA.bind(lA):function(){return dA.apply(lA,arguments)}),dm=ii,um=Oe,Ys=function(e){if(dm(e)==="Function")return um(e)},Am=Ar,hm=_t,gm=Ys(Ys.bind),rn=function(e,t){return Am(e),t===void 0?e:hm?gm(e,t):function(){return e.apply(t,arguments)}},pm=Oe([].slice),mm=TypeError,Wl=function(e,t){if(e<t)throw mm("Not enough arguments");return e},AA=/(?:ipad|iphone|ipod).*applewebkit/i.test(M),Tr=q,fm=uA,Em=rn,hA=Je,_m=Bt,gA=we,pA=So,Im=pm,mA=yn,Cm=Wl,ym=AA,Tm=en,Jl=Tr.setImmediate,Kl=Tr.clearImmediate,Sm=Tr.process,Xl=Tr.Dispatch,vm=Tr.Function,fA=Tr.MessageChannel,Rm=Tr.String,zl=0,nn={},cc="onreadystatechange";gA(function(){Gs=Tr.location});var ql=function(e){if(_m(nn,e)){var t=nn[e];delete nn[e],t()}},Ws=function(e){return function(){ql(e)}},EA=function(e){ql(e.data)},_A=function(e){Tr.postMessage(Rm(e),Gs.protocol+"//"+Gs.host)};Jl&&Kl||(Jl=function(e){Cm(arguments.length,1);var t=hA(e)?e:vm(e),r=Im(arguments,1);return nn[++zl]=function(){fm(t,void 0,r)},Mo(zl),zl},Kl=function(e){delete nn[e]},Tm?Mo=function(e){Sm.nextTick(Ws(e))}:Xl&&Xl.now?Mo=function(e){Xl.now(Ws(e))}:fA&&!ym?(Hl=(oA=new fA).port2,oA.port1.onmessage=EA,Mo=Em(Hl.postMessage,Hl)):Tr.addEventListener&&hA(Tr.postMessage)&&!Tr.importScripts&&Gs&&Gs.protocol!=="file:"&&!gA(_A)?(Mo=_A,Tr.addEventListener("message",EA,!1)):Mo=cc in mA("script")?function(e){pA.appendChild(mA("script"))[cc]=function(){pA.removeChild(this),ql(e)}}:function(e){setTimeout(Ws(e),0)});var $l={set:Jl,clear:Kl},o=function(){this.head=null,this.tail=null};o.prototype={add:function(e){var t={item:e,next:null},r=this.tail;r?r.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return(this.head=e.next)===null&&(this.tail=null),e.item}};var s,l,h,p,m,_=o,C=/ipad|iphone|ipod/i.test(M)&&typeof Pebble<"u",R=/web0s(?!.*chrome)/i.test(M),D=q,P=rn,U=Xr.f,V=$l.set,re=_,ie=AA,fe=C,be=R,Se=en,z=D.MutationObserver||D.WebKitMutationObserver,ne=D.document,st=D.process,et=D.Promise,gr=U(D,"queueMicrotask"),Sr=gr&&gr.value;if(!Sr){var Lo=new re,IA=function(){var e,t;for(Se&&(e=st.domain)&&e.exit();t=Lo.get();)try{t()}catch(r){throw Lo.head&&s(),r}e&&e.enter()};ie||Se||be||!z||!ne?!fe&&et&&et.resolve?((p=et.resolve(void 0)).constructor=et,m=P(p.then,p),s=function(){m(IA)}):Se?s=function(){st.nextTick(IA)}:(V=P(V,D),s=function(){V(IA)}):(l=!0,h=ne.createTextNode(""),new z(IA).observe(h,{characterData:!0}),s=function(){h.data=l=!l}),Sr=function(e){Lo.head||s(),Lo.add(e)}}var _b=Sr,bm=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}},Zl=q.Promise,_I=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",Ib=!_I&&!en&&typeof window=="object"&&typeof document=="object",Cb=q,ed=Zl,yb=Je,Tb=kn,Sb=wl,vb=lt,Rb=Ib,bb=_I,wm=ce;ed&&ed.prototype;var wb=vb("species"),II=!1,CI=yb(Cb.PromiseRejectionEvent),Db=Tb("Promise",function(){var e=Sb(ed),t=e!==String(ed);if(!t&&wm===66)return!0;if(!wm||wm<51||!/native code/.test(e)){var r=new ed(function(n){n(1)}),i=function(n){n(function(){},function(){})};if((r.constructor={})[wb]=i,!(II=r.then(function(){})instanceof i))return!0}return!t&&(Rb||bb)&&!CI}),Js={CONSTRUCTOR:Db,REJECTION_EVENT:CI,SUBCLASSING:II},lc={},yI=Ar,Ob=TypeError,kb=function(e){var t,r;this.promise=new e(function(i,n){if(t!==void 0||r!==void 0)throw Ob("Bad Promise constructor");t=i,r=n}),this.resolve=yI(t),this.reject=yI(r)};lc.f=function(e){return new kb(e)};var Dm,TI,SI,Bb=gt,CA=en,Qo=q,dc=ht,vI=Kt,RI=ko,Nb=Oo,Pb=Bn,Mb=Ar,yA=Je,Lb=Ct,Qb=Xt,xb=Yl,bI=$l.set,Om=_b,Ub=function(e,t){try{arguments.length==1?console.error(e):console.error(e,t)}catch{}},Fb=bm,Vb=_,wI=rr,TA=Zl,DI=lc,SA="Promise",OI=Js.CONSTRUCTOR,jb=Js.REJECTION_EVENT,Hb=Js.SUBCLASSING,km=wI.getterFor(SA),Gb=wI.set,uc=TA&&TA.prototype,Ac=TA,vA=uc,kI=Qo.TypeError,Bm=Qo.document,Nm=Qo.process,Pm=DI.f,Yb=Pm,Wb=!!(Bm&&Bm.createEvent&&Qo.dispatchEvent),BI="unhandledrejection",NI=function(e){var t;return!(!Lb(e)||!yA(t=e.then))&&t},PI=function(e,t){var r,i,n,a=t.value,c=t.state==1,A=c?e.ok:e.fail,d=e.resolve,g=e.reject,E=e.domain;try{A?(c||(t.rejection===2&&Kb(t),t.rejection=1),A===!0?r=a:(E&&E.enter(),r=A(a),E&&(E.exit(),n=!0)),r===e.promise?g(kI("Promise-chain cycle")):(i=NI(r))?dc(i,r,d,g):d(r)):g(a)}catch(f){E&&!n&&E.exit(),g(f)}},MI=function(e,t){e.notified||(e.notified=!0,Om(function(){for(var r,i=e.reactions;r=i.get();)PI(r,e);e.notified=!1,t&&!e.rejection&&Jb(e)}))},LI=function(e,t,r){var i,n;Wb?((i=Bm.createEvent("Event")).promise=t,i.reason=r,i.initEvent(e,!1,!0),Qo.dispatchEvent(i)):i={promise:t,reason:r},!jb&&(n=Qo["on"+e])?n(i):e===BI&&Ub("Unhandled promise rejection",r)},Jb=function(e){dc(bI,Qo,function(){var t,r=e.facade,i=e.value;if(QI(e)&&(t=Fb(function(){CA?Nm.emit("unhandledRejection",i,r):LI(BI,r,i)}),e.rejection=CA||QI(e)?2:1,t.error))throw t.value})},QI=function(e){return e.rejection!==1&&!e.parent},Kb=function(e){dc(bI,Qo,function(){var t=e.facade;CA?Nm.emit("rejectionHandled",t):LI("rejectionhandled",t,e.value)})},hc=function(e,t,r){return function(i){e(t,i,r)}},gc=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=2,MI(e,!0))},Mm=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw kI("Promise can't be resolved itself");var i=NI(t);i?Om(function(){var n={done:!1};try{dc(i,t,hc(Mm,n,e),hc(gc,n,e))}catch(a){gc(n,a,e)}}):(e.value=t,e.state=1,MI(e,!1))}catch(n){gc({done:!1},n,e)}}};if(OI&&(vA=(Ac=function(e){Qb(this,vA),Mb(e),dc(Dm,this);var t=km(this);try{e(hc(Mm,t),hc(gc,t))}catch(r){gc(t,r)}}).prototype,(Dm=function(e){Gb(this,{type:SA,done:!1,notified:!1,parent:!1,reactions:new Vb,rejection:!1,state:0,value:void 0})}).prototype=vI(vA,"then",function(e,t){var r=km(this),i=Pm(xb(this,Ac));return r.parent=!0,i.ok=!yA(e)||e,i.fail=yA(t)&&t,i.domain=CA?Nm.domain:void 0,r.state==0?r.reactions.add(i):Om(function(){PI(i,r)}),i.promise}),TI=function(){var e=new Dm,t=km(e);this.promise=e,this.resolve=hc(Mm,t),this.reject=hc(gc,t)},DI.f=Pm=function(e){return e===Ac||e===void 0?new TI(e):Yb(e)},yA(TA)&&uc!==Object.prototype)){SI=uc.then,Hb||vI(uc,"then",function(e,t){var r=this;return new Ac(function(i,n){dc(SI,r,i,n)}).then(e,t)},{unsafe:!0});try{delete uc.constructor}catch{}RI&&RI(uc,vA)}Bb({global:!0,constructor:!0,wrap:!0,forced:OI},{Promise:Ac}),Nb(Ac,SA,!1),Pb(SA);var Xb=tr,zb=lt("iterator"),qb=Array.prototype,Lm=function(e){return e!==void 0&&(Xb.Array===e||qb[zb]===e)},$b=tn,xI=Dt,Zb=Ge,ew=tr,tw=lt("iterator"),td=function(e){if(!Zb(e))return xI(e,tw)||xI(e,"@@iterator")||ew[$b(e)]},rw=ht,iw=Ar,nw=y,ow=zi,sw=td,aw=TypeError,RA=function(e,t){var r=arguments.length<2?sw(e):t;if(iw(r))return nw(rw(r,e));throw aw(ow(e)+" is not iterable")},cw=ht,UI=y,lw=Dt,FI=function(e,t,r){var i,n;UI(e);try{if(!(i=lw(e,"return"))){if(t==="throw")throw r;return r}i=cw(i,e)}catch(a){n=!0,i=a}if(t==="throw")throw r;if(n)throw i;return UI(i),r},dw=rn,uw=ht,Aw=y,hw=zi,gw=Lm,pw=ar,VI=j,mw=RA,fw=td,jI=FI,Ew=TypeError,bA=function(e,t){this.stopped=e,this.result=t},HI=bA.prototype,GI=function(e,t,r){var i,n,a,c,A,d,g,E=r&&r.that,f=!(!r||!r.AS_ENTRIES),b=!(!r||!r.IS_RECORD),w=!(!r||!r.IS_ITERATOR),k=!(!r||!r.INTERRUPTED),x=dw(t,E),Y=function(F){return i&&jI(i,"normal",F),new bA(!0,F)},G=function(F){return f?(Aw(F),k?x(F[0],F[1],Y):x(F[0],F[1])):k?x(F,Y):x(F)};if(b)i=e.iterator;else if(w)i=e;else{if(!(n=fw(e)))throw Ew(hw(e)+" is not iterable");if(gw(n)){for(a=0,c=pw(e);c>a;a++)if((A=G(e[a]))&&VI(HI,A))return A;return new bA(!1)}i=mw(e,n)}for(d=b?e.next:i.next;!(g=uw(d,i)).done;){try{A=G(g.value)}catch(F){jI(i,"throw",F)}if(typeof A=="object"&&A&&VI(HI,A))return A}return new bA(!1)},YI=lt("iterator"),WI=!1;try{var _w=0,JI={next:function(){return{done:!!_w++}},return:function(){WI=!0}};JI[YI]=function(){return this},Array.from(JI,function(){throw 2})}catch{}var KI=function(e,t){if(!t&&!WI)return!1;var r=!1;try{var i={};i[YI]=function(){return{next:function(){return{done:r=!0}}}},e(i)}catch{}return r},Iw=Zl,XI=Js.CONSTRUCTOR||!KI(function(e){Iw.all(e).then(void 0,function(){})}),Cw=ht,yw=Ar,Tw=lc,Sw=bm,vw=GI;gt({target:"Promise",stat:!0,forced:XI},{all:function(e){var t=this,r=Tw.f(t),i=r.resolve,n=r.reject,a=Sw(function(){var c=yw(t.resolve),A=[],d=0,g=1;vw(e,function(E){var f=d++,b=!1;g++,Cw(c,t,E).then(function(w){b||(b=!0,A[f]=w,--g||i(A))},n)}),--g||i(A)});return a.error&&n(a.value),r.promise}});var Rw=gt,bw=Js.CONSTRUCTOR,Qm=Zl,ww=Wr,Dw=Je,Ow=Kt,zI=Qm&&Qm.prototype;if(Rw({target:"Promise",proto:!0,forced:bw,real:!0},{catch:function(e){return this.then(void 0,e)}}),Dw(Qm)){var qI=ww("Promise").prototype.catch;zI.catch!==qI&&Ow(zI,"catch",qI,{unsafe:!0})}var kw=ht,Bw=Ar,Nw=lc,Pw=bm,Mw=GI;gt({target:"Promise",stat:!0,forced:XI},{race:function(e){var t=this,r=Nw.f(t),i=r.reject,n=Pw(function(){var a=Bw(t.resolve);Mw(e,function(c){kw(a,t,c).then(r.resolve,i)})});return n.error&&i(n.value),r.promise}});var Lw=ht,Qw=lc;gt({target:"Promise",stat:!0,forced:Js.CONSTRUCTOR},{reject:function(e){var t=Qw.f(this);return Lw(t.reject,void 0,e),t.promise}});var xw=y,Uw=Ct,Fw=lc,$I=function(e,t){if(xw(e),Uw(t)&&t.constructor===e)return t;var r=Fw.f(e);return(0,r.resolve)(t),r.promise},Vw=gt,jw=Js.CONSTRUCTOR,Hw=$I;Wr("Promise"),Vw({target:"Promise",stat:!0,forced:jw},{resolve:function(e){return Hw(this,e)}});var Gw=Je,Yw=Ct,ZI=ko,eC=function(e,t,r){var i,n;return ZI&&Gw(i=t.constructor)&&i!==r&&Yw(n=i.prototype)&&n!==r.prototype&&ZI(e,n),e},Ww=Ct,Jw=ii,Kw=lt("match"),tC=function(e){var t;return Ww(e)&&((t=e[Kw])!==void 0?!!t:Jw(e)=="RegExp")},Xw=tn,zw=String,qr=function(e){if(Xw(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return zw(e)},qw=y,rC=function(){var e=qw(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},$w=ht,Zw=Bt,eD=j,tD=rC,iC=RegExp.prototype,nC=function(e){var t=e.flags;return t!==void 0||"flags"in iC||Zw(e,"flags")||!eD(iC,e)?t:$w(tD,e)},xm=we,Um=q.RegExp,Fm=xm(function(){var e=Um("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),rD=Fm||xm(function(){return!Um("a","y").sticky}),iD=Fm||xm(function(){var e=Um("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),oC={BROKEN_CARET:iD,MISSED_STICKY:rD,UNSUPPORTED_Y:Fm},nD=Ft.f,oD=we,sD=q.RegExp,sC=oD(function(){var e=sD(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),aD=we,cD=q.RegExp,aC=aD(function(){var e=cD("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),lD=At,Vm=q,rd=Oe,dD=kn,uD=eC,AD=Ai,hD=Do.f,cC=j,gD=tC,lC=qr,pD=nC,dC=oC,mD=function(e,t,r){r in e||nD(e,r,{configurable:!0,get:function(){return t[r]},set:function(i){t[r]=i}})},fD=Kt,ED=we,_D=Bt,ID=rr.enforce,CD=Bn,uC=sC,AC=aC,yD=lt("match"),xo=Vm.RegExp,pc=xo.prototype,TD=Vm.SyntaxError,SD=rd(pc.exec),wA=rd("".charAt),hC=rd("".replace),gC=rd("".indexOf),vD=rd("".slice),RD=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Ks=/a/g,jm=/a/g,bD=new xo(Ks)!==Ks,pC=dC.MISSED_STICKY,wD=dC.UNSUPPORTED_Y,DD=lD&&(!bD||pC||uC||AC||ED(function(){return jm[yD]=!1,xo(Ks)!=Ks||xo(jm)==jm||xo(Ks,"i")!="/a/i"}));if(dD("RegExp",DD)){for(var Xs=function(e,t){var r,i,n,a,c,A,d=cC(pc,this),g=gD(e),E=t===void 0,f=[],b=e;if(!d&&g&&E&&e.constructor===Xs)return e;if((g||cC(pc,e))&&(e=e.source,E&&(t=pD(b))),e=e===void 0?"":lC(e),t=t===void 0?"":lC(t),b=e,uC&&"dotAll"in Ks&&(i=!!t&&gC(t,"s")>-1)&&(t=hC(t,/s/g,"")),r=t,pC&&"sticky"in Ks&&(n=!!t&&gC(t,"y")>-1)&&wD&&(t=hC(t,/y/g,"")),AC&&(a=function(w){for(var k,x=w.length,Y=0,G="",F=[],me={},Te=!1,Ze=!1,qe=0,Ne="";Y<=x;Y++){if((k=wA(w,Y))==="\\")k+=wA(w,++Y);else if(k==="]")Te=!1;else if(!Te)switch(!0){case k==="[":Te=!0;break;case k==="(":SD(RD,vD(w,Y+1))&&(Y+=2,Ze=!0),G+=k,qe++;continue;case(k===">"&&Ze):if(Ne===""||_D(me,Ne))throw new TD("Invalid capture group name");me[Ne]=!0,F[F.length]=[Ne,qe],Ze=!1,Ne="";continue}Ze?Ne+=k:G+=k}return[G,F]}(e),e=a[0],f=a[1]),c=uD(xo(e,t),d?this:pc,Xs),(i||n||f.length)&&(A=ID(c),i&&(A.dotAll=!0,A.raw=Xs(function(w){for(var k,x=w.length,Y=0,G="",F=!1;Y<=x;Y++)(k=wA(w,Y))!=="\\"?F||k!=="."?(k==="["?F=!0:k==="]"&&(F=!1),G+=k):G+="[\\s\\S]":G+=k+wA(w,++Y);return G}(e),r)),n&&(A.sticky=!0),f.length&&(A.groups=f)),e!==b)try{AD(c,"source",b===""?"(?:)":b)}catch{}return c},mC=hD(xo),fC=0;mC.length>fC;)mD(Xs,xo,mC[fC++]);pc.constructor=Xs,Xs.prototype=pc,fD(Vm,"RegExp",Xs,{constructor:!0})}CD("RegExp");var mc=ht,DA=Oe,OD=qr,kD=rC,BD=oC,ND=Ye,PD=rr.get,MD=sC,LD=aC,QD=Gi("native-string-replace",String.prototype.replace),OA=RegExp.prototype.exec,Hm=OA,xD=DA("".charAt),UD=DA("".indexOf),FD=DA("".replace),Gm=DA("".slice),Ym=function(){var e=/a/,t=/b*/g;return mc(OA,e,"a"),mc(OA,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),EC=BD.BROKEN_CARET,Wm=/()??/.exec("")[1]!==void 0;(Ym||Wm||EC||MD||LD)&&(Hm=function(e){var t,r,i,n,a,c,A,d=this,g=PD(d),E=OD(e),f=g.raw;if(f)return f.lastIndex=d.lastIndex,t=mc(Hm,f,E),d.lastIndex=f.lastIndex,t;var b=g.groups,w=EC&&d.sticky,k=mc(kD,d),x=d.source,Y=0,G=E;if(w&&(k=FD(k,"y",""),UD(k,"g")===-1&&(k+="g"),G=Gm(E,d.lastIndex),d.lastIndex>0&&(!d.multiline||d.multiline&&xD(E,d.lastIndex-1)!==`
`)&&(x="(?: "+x+")",G=" "+G,Y++),r=new RegExp("^(?:"+x+")",k)),Wm&&(r=new RegExp("^"+x+"$(?!\\s)",k)),Ym&&(i=d.lastIndex),n=mc(OA,w?r:d,G),w?n?(n.input=Gm(n.input,Y),n[0]=Gm(n[0],Y),n.index=d.lastIndex,d.lastIndex+=n[0].length):d.lastIndex=0:Ym&&n&&(d.lastIndex=d.global?n.index+n[0].length:i),Wm&&n&&n.length>1&&mc(QD,n[0],r,function(){for(a=1;a<arguments.length-2;a++)arguments[a]===void 0&&(n[a]=void 0)}),n&&b)for(n.groups=c=ND(null),a=0;a<b.length;a++)c[(A=b[a])[0]]=n[A[1]];return n});var kA=Hm;gt({target:"RegExp",proto:!0,forced:/./.exec!==kA},{exec:kA});var VD=ii,_C=Array.isArray||function(e){return VD(e)=="Array"},IC=_C,jD=Gl,HD=Ct,GD=lt("species"),CC=Array,YD=function(e){var t;return IC(e)&&(t=e.constructor,(jD(t)&&(t===CC||IC(t.prototype))||HD(t)&&(t=t[GD])===null)&&(t=void 0)),t===void 0?CC:t},WD=rn,JD=Pe,KD=or,XD=ar,zD=function(e,t){return new(YD(e))(t===0?0:t)},yC=Oe([].push),Uo=function(e){var t=e==1,r=e==2,i=e==3,n=e==4,a=e==6,c=e==7,A=e==5||a;return function(d,g,E,f){for(var b,w,k=KD(d),x=JD(k),Y=WD(g,E),G=XD(x),F=0,me=f||zD,Te=t?me(d,G):r||c?me(d,0):void 0;G>F;F++)if((A||F in x)&&(w=Y(b=x[F],F,k),e))if(t)Te[F]=w;else if(w)switch(e){case 3:return!0;case 5:return b;case 6:return F;case 2:yC(Te,b)}else switch(e){case 4:return!1;case 7:yC(Te,b)}return a?-1:i||n?n:Te}},TC={forEach:Uo(0),map:Uo(1),filter:Uo(2),some:Uo(3),every:Uo(4),find:Uo(5),findIndex:Uo(6),filterReject:Uo(7)},qD=we,Jm=function(e,t){var r=[][e];return!!r&&qD(function(){r.call(null,t||function(){return 1},1)})},$D=TC.forEach,ZD=Jm("forEach")?[].forEach:function(e){return $D(this,e,arguments.length>1?arguments[1]:void 0)},SC=q,vC=Wu,eO=Ku,Km=ZD,tO=Ai,RC=function(e){if(e&&e.forEach!==Km)try{tO(e,"forEach",Km)}catch{e.forEach=Km}};for(var Xm in vC)vC[Xm]&&RC(SC[Xm]&&SC[Xm].prototype);RC(eO);var rO=Ar,iO=or,nO=Pe,oO=ar,sO=TypeError,bC=function(e){return function(t,r,i,n){rO(r);var a=iO(t),c=nO(a),A=oO(a),d=e?A-1:0,g=e?-1:1;if(i<2)for(;;){if(d in c){n=c[d],d+=g;break}if(d+=g,e?d<0:A<=d)throw sO("Reduce of empty array with no initial value")}for(;e?d>=0:A>d;d+=g)d in c&&(n=r(n,c[d],d,a));return n}},aO={left:bC(!1),right:bC(!0)}.left;gt({target:"Array",proto:!0,forced:!en&&ce>79&&ce<83||!Jm("reduce")},{reduce:function(e){var t=arguments.length;return aO(this,e,t,t>1?arguments[1]:void 0)}});var wC=Ys,DC=Kt,cO=kA,OC=we,kC=lt,lO=Ai,dO=kC("species"),zm=RegExp.prototype,qm=Oe,uO=li,AO=qr,hO=ni,gO=qm("".charAt),BC=qm("".charCodeAt),pO=qm("".slice),NC=function(e){return function(t,r){var i,n,a=AO(hO(t)),c=uO(r),A=a.length;return c<0||c>=A?e?"":void 0:(i=BC(a,c))<55296||i>56319||c+1===A||(n=BC(a,c+1))<56320||n>57343?e?gO(a,c):i:e?pO(a,c,c+2):n-56320+(i-55296<<10)+65536}},$m={codeAt:NC(!1),charAt:NC(!0)},mO=$m.charAt,Zm=Oe,fO=or,EO=Math.floor,ef=Zm("".charAt),_O=Zm("".replace),tf=Zm("".slice),IO=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,CO=/\$([$&'`]|\d{1,2})/g,PC=function(e,t,r,i,n,a){var c=r+e.length,A=i.length,d=CO;return n!==void 0&&(n=fO(n),d=IO),_O(a,d,function(g,E){var f;switch(ef(E,0)){case"$":return"$";case"&":return e;case"`":return tf(t,0,r);case"'":return tf(t,c);case"<":f=n[tf(E,1,-1)];break;default:var b=+E;if(b===0)return g;if(b>A){var w=EO(b/10);return w===0?g:w<=A?i[w-1]===void 0?ef(E,1):i[w-1]+ef(E,1):g}f=i[b-1]}return f===void 0?"":f})},MC=ht,yO=y,TO=Je,SO=ii,vO=kA,RO=TypeError,bO=uA,LC=ht,BA=Oe,wO=function(e,t,r,i){var n=kC(e),a=!OC(function(){var g={};return g[n]=function(){return 7},""[e](g)!=7}),c=a&&!OC(function(){var g=!1,E=/a/;return e==="split"&&((E={}).constructor={},E.constructor[dO]=function(){return E},E.flags="",E[n]=/./[n]),E.exec=function(){return g=!0,null},E[n](""),!g});if(!a||!c||r){var A=wC(/./[n]),d=t(n,""[e],function(g,E,f,b,w){var k=wC(g),x=E.exec;return x===cO||x===zm.exec?a&&!w?{done:!0,value:A(E,f,b)}:{done:!0,value:k(f,E,b)}:{done:!1}});DC(String.prototype,e,d[0]),DC(zm,n,d[1])}i&&lO(zm[n],"sham",!0)},DO=we,OO=y,kO=Je,BO=Ge,NO=li,PO=Di,fc=qr,MO=ni,LO=function(e,t,r){return t+(r?mO(e,t).length:1)},QO=Dt,xO=PC,UO=function(e,t){var r=e.exec;if(TO(r)){var i=MC(r,e,t);return i!==null&&yO(i),i}if(SO(e)==="RegExp")return MC(vO,e,t);throw RO("RegExp#exec called on incompatible receiver")},rf=lt("replace"),FO=Math.max,VO=Math.min,jO=BA([].concat),nf=BA([].push),QC=BA("".indexOf),xC=BA("".slice),HO=function(e){return e===void 0?e:String(e)},GO="a".replace(/./,"$0")==="$0",UC=!!/./[rf]&&/./[rf]("a","$0")==="",YO=!DO(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});wO("replace",function(e,t,r){var i=UC?"$":"$0";return[function(n,a){var c=MO(this),A=BO(n)?void 0:QO(n,rf);return A?LC(A,n,c,a):LC(t,fc(c),n,a)},function(n,a){var c=OO(this),A=fc(n);if(typeof a=="string"&&QC(a,i)===-1&&QC(a,"$<")===-1){var d=r(t,c,A,a);if(d.done)return d.value}var g=kO(a);g||(a=fc(a));var E=c.global;if(E){var f=c.unicode;c.lastIndex=0}for(var b=[];;){var w=UO(c,A);if(w===null||(nf(b,w),!E))break;fc(w[0])===""&&(c.lastIndex=LO(A,PO(c.lastIndex),f))}for(var k="",x=0,Y=0;Y<b.length;Y++){for(var G=fc((w=b[Y])[0]),F=FO(VO(NO(w.index),A.length),0),me=[],Te=1;Te<w.length;Te++)nf(me,HO(w[Te]));var Ze=w.groups;if(g){var qe=jO([G],me,F,A);Ze!==void 0&&nf(qe,Ze);var Ne=fc(bO(a,void 0,qe))}else Ne=xO(G,A,F,me,Ze,a);F>=x&&(k+=xC(A,x,F)+Ne,x=F+G.length)}return k+xC(A,x)}]},!YO||!GO||UC);var WO=Ua.includes,JO=er;gt({target:"Array",proto:!0,forced:we(function(){return!Array(1).includes()})},{includes:function(e){return WO(this,e,arguments.length>1?arguments[1]:void 0)}}),JO("includes");var KO=li,XO=qr,zO=ni,qO=RangeError,FC=Oe,$O=Di,VC=qr,ZO=function(e){var t=XO(zO(this)),r="",i=KO(e);if(i<0||i==1/0)throw qO("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(t+=t))1&i&&(r+=t);return r},ek=ni,tk=FC(ZO),rk=FC("".slice),ik=Math.ceil,jC=function(e){return function(t,r,i){var n,a,c=VC(ek(t)),A=$O(r),d=c.length,g=i===void 0?" ":VC(i);return A<=d||g==""?c:((a=tk(g,ik((n=A-d)/g.length))).length>n&&(a=rk(a,0,n)),e?c+a:a+c)}},nk={start:jC(!1),end:jC(!0)},ok=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(M),sk=nk.start;gt({target:"String",proto:!0,forced:ok},{padStart:function(e){return sk(this,e,arguments.length>1?arguments[1]:void 0)}});var ak=we,ck=At,lk=lt("iterator"),HC=!ak(function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach(function(i,n){t.delete("b"),r+=n+i}),!t.size&&!ck||!t.sort||e.href!=="http://a/c%20d?a=1&c=3"||t.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!t[lk]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://ÑÐµÑÑ").host!=="xn--e1aybc"||new URL("http://a#Ð±").hash!=="#%D0%B1"||r!=="a1c3"||new URL("http://x",void 0).host!=="x"}),dk=Kt,GC=function(e,t,r){for(var i in t)dk(e,i,t[i],r);return e},uk=$i,Ak=Ft,hk=Bi,YC=function(e,t,r){var i=uk(t);i in e?Ak.f(e,i,hk(0,r)):e[i]=r},WC=Yt,gk=ar,pk=YC,mk=Array,fk=Math.max,of=function(e,t,r){for(var i=gk(e),n=WC(t,i),a=WC(r===void 0?i:r,i),c=mk(fk(a-n,0)),A=0;n<a;n++,A++)pk(c,A,e[n]);return c.length=A,c},JC=of,Ek=Math.floor,sf=function(e,t){var r=e.length,i=Ek(r/2);return r<8?_k(e,t):Ik(e,sf(JC(e,0,i),t),sf(JC(e,i),t),t)},_k=function(e,t){for(var r,i,n=e.length,a=1;a<n;){for(i=a,r=e[a];i&&t(e[i-1],r)>0;)e[i]=e[--i];i!==a++&&(e[i]=r)}return e},Ik=function(e,t,r,i){for(var n=t.length,a=r.length,c=0,A=0;c<n||A<a;)e[c+A]=c<n&&A<a?i(t[c],r[A])<=0?t[c++]:r[A++]:c<n?t[c++]:r[A++];return e},af=sf,cf=gt,Ec=q,NA=ht,on=Oe,_c=At,KC=HC,XC=Kt,Ck=gi,yk=GC,Tk=Oo,Sk=Mu,lf=rr,zC=Xt,df=Je,vk=Bt,Rk=rn,bk=tn,wk=y,qC=Ct,$r=qr,Dk=Ye,$C=Bi,uf=RA,Ok=td,Ic=Wl,kk=af,Bk=lt("iterator"),id="URLSearchParams",ZC=id+"Iterator",ey=lf.set,mi=lf.getterFor(id),Nk=lf.getterFor(ZC),Pk=Object.getOwnPropertyDescriptor,Af=function(e){if(!_c)return Ec[e];var t=Pk(Ec,e);return t&&t.value},ty=Af("fetch"),PA=Af("Request"),nd=Af("Headers"),hf=PA&&PA.prototype,ry=nd&&nd.prototype,Mk=Ec.RegExp,Lk=Ec.TypeError,iy=Ec.decodeURIComponent,Qk=Ec.encodeURIComponent,xk=on("".charAt),ny=on([].join),zs=on([].push),gf=on("".replace),Uk=on([].shift),oy=on([].splice),sy=on("".split),Fk=on("".slice),Vk=/\+/g,ay=Array(4),jk=function(e){return ay[e-1]||(ay[e-1]=Mk("((?:%[\\da-f]{2}){"+e+"})","gi"))},Hk=function(e){try{return iy(e)}catch{return e}},cy=function(e){var t=gf(e,Vk," "),r=4;try{return iy(t)}catch{for(;r;)t=gf(t,jk(r--),Hk);return t}},Gk=/[!'()~]|%20/g,Yk={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},Wk=function(e){return Yk[e]},ly=function(e){return gf(Qk(e),Gk,Wk)},pf=Sk(function(e,t){ey(this,{type:ZC,iterator:uf(mi(e).entries),kind:t})},"Iterator",function(){var e=Nk(this),t=e.kind,r=e.iterator.next(),i=r.value;return r.done||(r.value=t==="keys"?i.key:t==="values"?i.value:[i.key,i.value]),r},!0),dy=function(e){this.entries=[],this.url=null,e!==void 0&&(qC(e)?this.parseObject(e):this.parseQuery(typeof e=="string"?xk(e,0)==="?"?Fk(e,1):e:$r(e)))};dy.prototype={type:id,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,r,i,n,a,c,A,d=Ok(e);if(d)for(r=(t=uf(e,d)).next;!(i=NA(r,t)).done;){if(a=(n=uf(wk(i.value))).next,(c=NA(a,n)).done||(A=NA(a,n)).done||!NA(a,n).done)throw Lk("Expected sequence with length 2");zs(this.entries,{key:$r(c.value),value:$r(A.value)})}else for(var g in e)vk(e,g)&&zs(this.entries,{key:g,value:$r(e[g])})},parseQuery:function(e){if(e)for(var t,r,i=sy(e,"&"),n=0;n<i.length;)(t=i[n++]).length&&(r=sy(t,"="),zs(this.entries,{key:cy(Uk(r)),value:cy(ny(r,"="))}))},serialize:function(){for(var e,t=this.entries,r=[],i=0;i<t.length;)e=t[i++],zs(r,ly(e.key)+"="+ly(e.value));return ny(r,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var MA=function(){zC(this,Cc);var e=ey(this,new dy(arguments.length>0?arguments[0]:void 0));_c||(this.length=e.entries.length)},Cc=MA.prototype;if(yk(Cc,{append:function(e,t){Ic(arguments.length,2);var r=mi(this);zs(r.entries,{key:$r(e),value:$r(t)}),_c||this.length++,r.updateURL()},delete:function(e){Ic(arguments.length,1);for(var t=mi(this),r=t.entries,i=$r(e),n=0;n<r.length;)r[n].key===i?oy(r,n,1):n++;_c||(this.length=r.length),t.updateURL()},get:function(e){Ic(arguments.length,1);for(var t=mi(this).entries,r=$r(e),i=0;i<t.length;i++)if(t[i].key===r)return t[i].value;return null},getAll:function(e){Ic(arguments.length,1);for(var t=mi(this).entries,r=$r(e),i=[],n=0;n<t.length;n++)t[n].key===r&&zs(i,t[n].value);return i},has:function(e){Ic(arguments.length,1);for(var t=mi(this).entries,r=$r(e),i=0;i<t.length;)if(t[i++].key===r)return!0;return!1},set:function(e,t){Ic(arguments.length,1);for(var r,i=mi(this),n=i.entries,a=!1,c=$r(e),A=$r(t),d=0;d<n.length;d++)(r=n[d]).key===c&&(a?oy(n,d--,1):(a=!0,r.value=A));a||zs(n,{key:c,value:A}),_c||(this.length=n.length),i.updateURL()},sort:function(){var e=mi(this);kk(e.entries,function(t,r){return t.key>r.key?1:-1}),e.updateURL()},forEach:function(e){for(var t,r=mi(this).entries,i=Rk(e,arguments.length>1?arguments[1]:void 0),n=0;n<r.length;)i((t=r[n++]).value,t.key,this)},keys:function(){return new pf(this,"keys")},values:function(){return new pf(this,"values")},entries:function(){return new pf(this,"entries")}},{enumerable:!0}),XC(Cc,Bk,Cc.entries,{name:"entries"}),XC(Cc,"toString",function(){return mi(this).serialize()},{enumerable:!0}),_c&&Ck(Cc,"size",{get:function(){return mi(this).entries.length},configurable:!0,enumerable:!0}),Tk(MA,id),cf({global:!0,constructor:!0,forced:!KC},{URLSearchParams:MA}),!KC&&df(nd)){var Jk=on(ry.has),Kk=on(ry.set),uy=function(e){if(qC(e)){var t,r=e.body;if(bk(r)===id)return t=e.headers?new nd(e.headers):new nd,Jk(t,"content-type")||Kk(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),Dk(e,{body:$C(0,$r(r)),headers:$C(0,t)})}return e};if(df(ty)&&cf({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return ty(e,arguments.length>1?uy(arguments[1]):{})}}),df(PA)){var mf=function(e){return zC(this,hf),new PA(e,arguments.length>1?uy(arguments[1]):{})};hf.constructor=mf,mf.prototype=hf,cf({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:mf})}}var Xk={URLSearchParams:MA,getState:mi},Ay=`	
\v\f\r Â áââââââââââââ¯âã\u2028\u2029\uFEFF`,zk=ni,qk=qr,ff=Ay,hy=Oe("".replace),$k=RegExp("^["+ff+"]+"),Zk=RegExp("(^|[^"+ff+"])["+ff+"]+$"),Ef=function(e){return function(t){var r=qk(zk(t));return 1&e&&(r=hy(r,$k,"")),2&e&&(r=hy(r,Zk,"$1")),r}},eB={start:Ef(1),end:Ef(2),trim:Ef(3)},tB=Ps.PROPER,rB=we,gy=Ay,iB=eB.trim;gt({target:"String",proto:!0,forced:function(e){return rB(function(){return!!gy[e]()||"âÂá "[e]()!=="âÂá "||tB&&gy[e].name!==e})}("trim")},{trim:function(){return iB(this)}});var nB=gt,oB=At,LA=Oe,sB=Bt,aB=Je,cB=j,lB=qr,dB=gi,uB=bu,Pn=q.Symbol,qs=Pn&&Pn.prototype;if(oB&&aB(Pn)&&(!("description"in qs)||Pn().description!==void 0)){var py={},QA=function(){var e=arguments.length<1||arguments[0]===void 0?void 0:lB(arguments[0]),t=cB(qs,this)?new Pn(e):e===void 0?Pn():Pn(e);return e===""&&(py[t]=!0),t};uB(QA,Pn),QA.prototype=qs,qs.constructor=QA;var AB=String(Pn("test"))=="Symbol(test)",hB=LA(qs.valueOf),gB=LA(qs.toString),pB=/^Symbol\((.*)\)[^)]+$/,mB=LA("".replace),fB=LA("".slice);dB(qs,"description",{configurable:!0,get:function(){var e=hB(this);if(sB(py,e))return"";var t=gB(e),r=AB?fB(t,7,-1):mB(t,pB,"$1");return r===""?void 0:r}}),nB({global:!0,constructor:!0,forced:!0},{Symbol:QA})}var EB=$m.charAt,_B=qr,my=rr,IB=Za,fy=Vu,Ey="String Iterator",CB=my.set,yB=my.getterFor(Ey);IB(String,"String",function(e){CB(this,{type:Ey,string:_B(e),index:0})},function(){var e,t=yB(this),r=t.string,i=t.index;return i>=r.length?fy(void 0,!0):(e=EB(r,i),t.index+=e.length,fy(e,!1))});var fi,_y=At,TB=Oe,SB=ht,vB=we,_f=Fa,RB=Ol,bB=Tl,wB=or,DB=Pe,yc=Object.assign,Iy=Object.defineProperty,OB=TB([].concat),kB=!yc||vB(function(){if(_y&&yc({b:1},yc(Iy({},"a",{enumerable:!0,get:function(){Iy(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),i="abcdefghijklmnopqrst";return e[r]=7,i.split("").forEach(function(n){t[n]=n}),yc({},e)[r]!=7||_f(yc({},t)).join("")!=i})?function(e,t){for(var r=wB(e),i=arguments.length,n=1,a=RB.f,c=bB.f;i>n;)for(var A,d=DB(arguments[n++]),g=a?OB(_f(d),a(d)):_f(d),E=g.length,f=0;E>f;)A=g[f++],_y&&!SB(c,d,A)||(r[A]=d[A]);return r}:yc,BB=y,NB=FI,PB=rn,MB=ht,LB=or,QB=function(e,t,r,i){try{return i?t(BB(r)[0],r[1]):t(r)}catch(n){NB(e,"throw",n)}},xB=Lm,UB=Gl,FB=ar,Cy=YC,VB=RA,jB=td,yy=Array,$s=Oe,If=2147483647,HB=/[^\0-\u007E]/,Ty=/[.\u3002\uFF0E\uFF61]/g,Sy="Overflow: input needs wider integers to process",vy=RangeError,GB=$s(Ty.exec),Tc=Math.floor,Cf=String.fromCharCode,Ry=$s("".charCodeAt),by=$s([].join),Fo=$s([].push),YB=$s("".replace),WB=$s("".split),JB=$s("".toLowerCase),wy=function(e){return e+22+75*(e<26)},KB=function(e,t,r){var i=0;for(e=r?Tc(e/700):e>>1,e+=Tc(e/t);e>455;)e=Tc(e/35),i+=36;return Tc(i+36*e/(e+38))},XB=function(e){var t=[];e=function(G){for(var F=[],me=0,Te=G.length;me<Te;){var Ze=Ry(G,me++);if(Ze>=55296&&Ze<=56319&&me<Te){var qe=Ry(G,me++);(64512&qe)==56320?Fo(F,((1023&Ze)<<10)+(1023&qe)+65536):(Fo(F,Ze),me--)}else Fo(F,Ze)}return F}(e);var r,i,n=e.length,a=128,c=0,A=72;for(r=0;r<e.length;r++)(i=e[r])<128&&Fo(t,Cf(i));var d=t.length,g=d;for(d&&Fo(t,"-");g<n;){var E=If;for(r=0;r<e.length;r++)(i=e[r])>=a&&i<E&&(E=i);var f=g+1;if(E-a>Tc((If-c)/f))throw vy(Sy);for(c+=(E-a)*f,a=E,r=0;r<e.length;r++){if((i=e[r])<a&&++c>If)throw vy(Sy);if(i==a){for(var b=c,w=36;;){var k=w<=A?1:w>=A+26?26:w-A;if(b<k)break;var x=b-k,Y=36-k;Fo(t,Cf(wy(k+x%Y))),b=Tc(x/Y),w+=36}Fo(t,Cf(wy(b))),A=KB(c,f,g==d),c=0,g++}}c++,a++}return by(t,"")},zB=gt,yf=At,qB=HC,Tf=q,Dy=rn,Ei=Oe,xA=Kt,_i=gi,$B=Xt,Sf=Bt,vf=kB,Sc=function(e){var t=LB(e),r=UB(this),i=arguments.length,n=i>1?arguments[1]:void 0,a=n!==void 0;a&&(n=PB(n,i>2?arguments[2]:void 0));var c,A,d,g,E,f,b=jB(t),w=0;if(!b||this===yy&&xB(b))for(c=FB(t),A=r?new this(c):yy(c);c>w;w++)f=a?n(t[w],w):t[w],Cy(A,w,f);else for(E=(g=VB(t,b)).next,A=r?new this:[];!(d=MB(E,g)).done;w++)f=a?QB(g,n,[d.value,w],!0):d.value,Cy(A,w,f);return A.length=w,A},Pi=of,ZB=$m.codeAt,eN=function(e){var t,r,i=[],n=WB(YB(JB(e),Ty,"."),".");for(t=0;t<n.length;t++)r=n[t],Fo(i,GB(HB,r)?"xn--"+XB(r):r);return by(i,".")},Mn=qr,tN=Oo,rN=Wl,Oy=Xk,ky=rr,iN=ky.set,UA=ky.getterFor("URL"),nN=Oy.URLSearchParams,oN=Oy.getState,od=Tf.URL,Rf=Tf.TypeError,FA=Tf.parseInt,sN=Math.floor,By=Math.pow,Ii=Ei("".charAt),Mi=Ei(/./.exec),sd=Ei([].join),aN=Ei(1 .toString),cN=Ei([].pop),vc=Ei([].push),bf=Ei("".replace),lN=Ei([].shift),dN=Ei("".split),ad=Ei("".slice),VA=Ei("".toLowerCase),uN=Ei([].unshift),wf="Invalid scheme",Zs="Invalid host",Ny="Invalid port",Py=/[a-z]/i,AN=/[\d+-.a-z]/i,Df=/\d/,hN=/^0x/i,gN=/^[0-7]+$/,pN=/^\d+$/,My=/^[\da-f]+$/i,mN=/[\0\t\n\r #%/:<>?@[\\\]^|]/,fN=/[\0\t\n\r #/:<>?@[\\\]^|]/,EN=/^[\u0000-\u0020]+/,_N=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,IN=/[\t\n\r]/g,cd=function(e){var t,r,i,n;if(typeof e=="number"){for(t=[],r=0;r<4;r++)uN(t,e%256),e=sN(e/256);return sd(t,".")}if(typeof e=="object"){for(t="",i=function(a){for(var c=null,A=1,d=null,g=0,E=0;E<8;E++)a[E]!==0?(g>A&&(c=d,A=g),d=null,g=0):(d===null&&(d=E),++g);return g>A&&(c=d,A=g),c}(e),r=0;r<8;r++)n&&e[r]===0||(n&&(n=!1),i===r?(t+=r?":":"::",n=!0):(t+=aN(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},jA={},Ly=vf({},jA,{" ":1,'"':1,"<":1,">":1,"`":1}),Qy=vf({},Ly,{"#":1,"?":1,"{":1,"}":1}),Of=vf({},Qy,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Vo=function(e,t){var r=ZB(e,0);return r>32&&r<127&&!Sf(t,e)?e:encodeURIComponent(e)},HA={ftp:21,file:null,http:80,https:443,ws:80,wss:443},ld=function(e,t){var r;return e.length==2&&Mi(Py,Ii(e,0))&&((r=Ii(e,1))==":"||!t&&r=="|")},xy=function(e){var t;return e.length>1&&ld(ad(e,0,2))&&(e.length==2||(t=Ii(e,2))==="/"||t==="\\"||t==="?"||t==="#")},CN=function(e){return e==="."||VA(e)==="%2e"},kf={},Uy={},Bf={},Fy={},Vy={},Nf={},jy={},Hy={},GA={},YA={},Pf={},Mf={},Lf={},Qf={},Gy={},xf={},Rc={},sn={},Yy={},ea={},Ln={},Uf=function(e,t,r){var i,n,a,c=Mn(e);if(t){if(n=this.parse(c))throw Rf(n);this.searchParams=null}else{if(r!==void 0&&(i=new Uf(r,!0)),n=this.parse(c,null,i))throw Rf(n);(a=oN(new nN)).bindURL(this),this.searchParams=a}};Uf.prototype={type:"URL",parse:function(e,t,r){var i,n,a,c,A,d=this,g=t||kf,E=0,f="",b=!1,w=!1,k=!1;for(e=Mn(e),t||(d.scheme="",d.username="",d.password="",d.host=null,d.port=null,d.path=[],d.query=null,d.fragment=null,d.cannotBeABaseURL=!1,e=bf(e,EN,""),e=bf(e,_N,"$1")),e=bf(e,IN,""),i=Sc(e);E<=i.length;){switch(n=i[E],g){case kf:if(!n||!Mi(Py,n)){if(t)return wf;g=Bf;continue}f+=VA(n),g=Uy;break;case Uy:if(n&&(Mi(AN,n)||n=="+"||n=="-"||n=="."))f+=VA(n);else{if(n!=":"){if(t)return wf;f="",g=Bf,E=0;continue}if(t&&(d.isSpecial()!=Sf(HA,f)||f=="file"&&(d.includesCredentials()||d.port!==null)||d.scheme=="file"&&!d.host))return;if(d.scheme=f,t)return void(d.isSpecial()&&HA[d.scheme]==d.port&&(d.port=null));f="",d.scheme=="file"?g=Qf:d.isSpecial()&&r&&r.scheme==d.scheme?g=Fy:d.isSpecial()?g=Hy:i[E+1]=="/"?(g=Vy,E++):(d.cannotBeABaseURL=!0,vc(d.path,""),g=Yy)}break;case Bf:if(!r||r.cannotBeABaseURL&&n!="#")return wf;if(r.cannotBeABaseURL&&n=="#"){d.scheme=r.scheme,d.path=Pi(r.path),d.query=r.query,d.fragment="",d.cannotBeABaseURL=!0,g=Ln;break}g=r.scheme=="file"?Qf:Nf;continue;case Fy:if(n!="/"||i[E+1]!="/"){g=Nf;continue}g=GA,E++;break;case Vy:if(n=="/"){g=YA;break}g=sn;continue;case Nf:if(d.scheme=r.scheme,n==fi)d.username=r.username,d.password=r.password,d.host=r.host,d.port=r.port,d.path=Pi(r.path),d.query=r.query;else if(n=="/"||n=="\\"&&d.isSpecial())g=jy;else if(n=="?")d.username=r.username,d.password=r.password,d.host=r.host,d.port=r.port,d.path=Pi(r.path),d.query="",g=ea;else{if(n!="#"){d.username=r.username,d.password=r.password,d.host=r.host,d.port=r.port,d.path=Pi(r.path),d.path.length--,g=sn;continue}d.username=r.username,d.password=r.password,d.host=r.host,d.port=r.port,d.path=Pi(r.path),d.query=r.query,d.fragment="",g=Ln}break;case jy:if(!d.isSpecial()||n!="/"&&n!="\\"){if(n!="/"){d.username=r.username,d.password=r.password,d.host=r.host,d.port=r.port,g=sn;continue}g=YA}else g=GA;break;case Hy:if(g=GA,n!="/"||Ii(f,E+1)!="/")continue;E++;break;case GA:if(n!="/"&&n!="\\"){g=YA;continue}break;case YA:if(n=="@"){b&&(f="%40"+f),b=!0,a=Sc(f);for(var x=0;x<a.length;x++){var Y=a[x];if(Y!=":"||k){var G=Vo(Y,Of);k?d.password+=G:d.username+=G}else k=!0}f=""}else if(n==fi||n=="/"||n=="?"||n=="#"||n=="\\"&&d.isSpecial()){if(b&&f=="")return"Invalid authority";E-=Sc(f).length+1,f="",g=Pf}else f+=n;break;case Pf:case Mf:if(t&&d.scheme=="file"){g=xf;continue}if(n!=":"||w){if(n==fi||n=="/"||n=="?"||n=="#"||n=="\\"&&d.isSpecial()){if(d.isSpecial()&&f=="")return Zs;if(t&&f==""&&(d.includesCredentials()||d.port!==null))return;if(c=d.parseHost(f))return c;if(f="",g=Rc,t)return;continue}n=="["?w=!0:n=="]"&&(w=!1),f+=n}else{if(f=="")return Zs;if(c=d.parseHost(f))return c;if(f="",g=Lf,t==Mf)return}break;case Lf:if(!Mi(Df,n)){if(n==fi||n=="/"||n=="?"||n=="#"||n=="\\"&&d.isSpecial()||t){if(f!=""){var F=FA(f,10);if(F>65535)return Ny;d.port=d.isSpecial()&&F===HA[d.scheme]?null:F,f=""}if(t)return;g=Rc;continue}return Ny}f+=n;break;case Qf:if(d.scheme="file",n=="/"||n=="\\")g=Gy;else{if(!r||r.scheme!="file"){g=sn;continue}if(n==fi)d.host=r.host,d.path=Pi(r.path),d.query=r.query;else if(n=="?")d.host=r.host,d.path=Pi(r.path),d.query="",g=ea;else{if(n!="#"){xy(sd(Pi(i,E),""))||(d.host=r.host,d.path=Pi(r.path),d.shortenPath()),g=sn;continue}d.host=r.host,d.path=Pi(r.path),d.query=r.query,d.fragment="",g=Ln}}break;case Gy:if(n=="/"||n=="\\"){g=xf;break}r&&r.scheme=="file"&&!xy(sd(Pi(i,E),""))&&(ld(r.path[0],!0)?vc(d.path,r.path[0]):d.host=r.host),g=sn;continue;case xf:if(n==fi||n=="/"||n=="\\"||n=="?"||n=="#"){if(!t&&ld(f))g=sn;else if(f==""){if(d.host="",t)return;g=Rc}else{if(c=d.parseHost(f))return c;if(d.host=="localhost"&&(d.host=""),t)return;f="",g=Rc}continue}f+=n;break;case Rc:if(d.isSpecial()){if(g=sn,n!="/"&&n!="\\")continue}else if(t||n!="?")if(t||n!="#"){if(n!=fi&&(g=sn,n!="/"))continue}else d.fragment="",g=Ln;else d.query="",g=ea;break;case sn:if(n==fi||n=="/"||n=="\\"&&d.isSpecial()||!t&&(n=="?"||n=="#")){if((A=VA(A=f))===".."||A==="%2e."||A===".%2e"||A==="%2e%2e"?(d.shortenPath(),n=="/"||n=="\\"&&d.isSpecial()||vc(d.path,"")):CN(f)?n=="/"||n=="\\"&&d.isSpecial()||vc(d.path,""):(d.scheme=="file"&&!d.path.length&&ld(f)&&(d.host&&(d.host=""),f=Ii(f,0)+":"),vc(d.path,f)),f="",d.scheme=="file"&&(n==fi||n=="?"||n=="#"))for(;d.path.length>1&&d.path[0]==="";)lN(d.path);n=="?"?(d.query="",g=ea):n=="#"&&(d.fragment="",g=Ln)}else f+=Vo(n,Qy);break;case Yy:n=="?"?(d.query="",g=ea):n=="#"?(d.fragment="",g=Ln):n!=fi&&(d.path[0]+=Vo(n,jA));break;case ea:t||n!="#"?n!=fi&&(n=="'"&&d.isSpecial()?d.query+="%27":d.query+=n=="#"?"%23":Vo(n,jA)):(d.fragment="",g=Ln);break;case Ln:n!=fi&&(d.fragment+=Vo(n,Ly))}E++}},parseHost:function(e){var t,r,i;if(Ii(e,0)=="["){if(Ii(e,e.length-1)!="]"||(t=function(n){var a,c,A,d,g,E,f,b=[0,0,0,0,0,0,0,0],w=0,k=null,x=0,Y=function(){return Ii(n,x)};if(Y()==":"){if(Ii(n,1)!=":")return;x+=2,k=++w}for(;Y();){if(w==8)return;if(Y()!=":"){for(a=c=0;c<4&&Mi(My,Y());)a=16*a+FA(Y(),16),x++,c++;if(Y()=="."){if(c==0||(x-=c,w>6))return;for(A=0;Y();){if(d=null,A>0){if(!(Y()=="."&&A<4))return;x++}if(!Mi(Df,Y()))return;for(;Mi(Df,Y());){if(g=FA(Y(),10),d===null)d=g;else{if(d==0)return;d=10*d+g}if(d>255)return;x++}b[w]=256*b[w]+d,++A!=2&&A!=4||w++}if(A!=4)return;break}if(Y()==":"){if(x++,!Y())return}else if(Y())return;b[w++]=a}else{if(k!==null)return;x++,k=++w}}if(k!==null)for(E=w-k,w=7;w!=0&&E>0;)f=b[w],b[w--]=b[k+E-1],b[k+--E]=f;else if(w!=8)return;return b}(ad(e,1,-1)),!t))return Zs;this.host=t}else if(this.isSpecial()){if(e=eN(e),Mi(mN,e)||(t=function(n){var a,c,A,d,g,E,f,b=dN(n,".");if(b.length&&b[b.length-1]==""&&b.length--,(a=b.length)>4)return n;for(c=[],A=0;A<a;A++){if((d=b[A])=="")return n;if(g=10,d.length>1&&Ii(d,0)=="0"&&(g=Mi(hN,d)?16:8,d=ad(d,g==8?1:2)),d==="")E=0;else{if(!Mi(g==10?pN:g==8?gN:My,d))return n;E=FA(d,g)}vc(c,E)}for(A=0;A<a;A++)if(E=c[A],A==a-1){if(E>=By(256,5-a))return null}else if(E>255)return null;for(f=cN(c),A=0;A<c.length;A++)f+=c[A]*By(256,3-A);return f}(e),t===null))return Zs;this.host=t}else{if(Mi(fN,e))return Zs;for(t="",r=Sc(e),i=0;i<r.length;i++)t+=Vo(r[i],jA);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return Sf(HA,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||this.scheme=="file"&&t==1&&ld(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,r=e.username,i=e.password,n=e.host,a=e.port,c=e.path,A=e.query,d=e.fragment,g=t+":";return n!==null?(g+="//",e.includesCredentials()&&(g+=r+(i?":"+i:"")+"@"),g+=cd(n),a!==null&&(g+=":"+a)):t=="file"&&(g+="//"),g+=e.cannotBeABaseURL?c[0]:c.length?"/"+sd(c,"/"):"",A!==null&&(g+="?"+A),d!==null&&(g+="#"+d),g},setHref:function(e){var t=this.parse(e);if(t)throw Rf(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if(e=="blob")try{return new bc(e.path[0]).origin}catch{return"null"}return e!="file"&&this.isSpecial()?e+"://"+cd(this.host)+(t!==null?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(Mn(e)+":",kf)},getUsername:function(){return this.username},setUsername:function(e){var t=Sc(Mn(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=Vo(t[r],Of)}},getPassword:function(){return this.password},setPassword:function(e){var t=Sc(Mn(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=Vo(t[r],Of)}},getHost:function(){var e=this.host,t=this.port;return e===null?"":t===null?cd(e):cd(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,Pf)},getHostname:function(){var e=this.host;return e===null?"":cd(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,Mf)},getPort:function(){var e=this.port;return e===null?"":Mn(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||((e=Mn(e))==""?this.port=null:this.parse(e,Lf))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+sd(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Rc))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){(e=Mn(e))==""?this.query=null:(Ii(e,0)=="?"&&(e=ad(e,1)),this.query="",this.parse(e,ea)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){(e=Mn(e))!=""?(Ii(e,0)=="#"&&(e=ad(e,1)),this.fragment="",this.parse(e,Ln)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var bc=function(e){var t=$B(this,vr),r=rN(arguments.length,1)>1?arguments[1]:void 0,i=iN(t,new Uf(e,!1,r));yf||(t.href=i.serialize(),t.origin=i.getOrigin(),t.protocol=i.getProtocol(),t.username=i.getUsername(),t.password=i.getPassword(),t.host=i.getHost(),t.hostname=i.getHostname(),t.port=i.getPort(),t.pathname=i.getPathname(),t.search=i.getSearch(),t.searchParams=i.getSearchParams(),t.hash=i.getHash())},vr=bc.prototype,Ci=function(e,t){return{get:function(){return UA(this)[e]()},set:t&&function(r){return UA(this)[t](r)},configurable:!0,enumerable:!0}};if(yf&&(_i(vr,"href",Ci("serialize","setHref")),_i(vr,"origin",Ci("getOrigin")),_i(vr,"protocol",Ci("getProtocol","setProtocol")),_i(vr,"username",Ci("getUsername","setUsername")),_i(vr,"password",Ci("getPassword","setPassword")),_i(vr,"host",Ci("getHost","setHost")),_i(vr,"hostname",Ci("getHostname","setHostname")),_i(vr,"port",Ci("getPort","setPort")),_i(vr,"pathname",Ci("getPathname","setPathname")),_i(vr,"search",Ci("getSearch","setSearch")),_i(vr,"searchParams",Ci("getSearchParams")),_i(vr,"hash",Ci("getHash","setHash"))),xA(vr,"toJSON",function(){return UA(this).serialize()},{enumerable:!0}),xA(vr,"toString",function(){return UA(this).serialize()},{enumerable:!0}),od){var Wy=od.createObjectURL,Jy=od.revokeObjectURL;Wy&&xA(bc,"createObjectURL",Dy(Wy,od)),Jy&&xA(bc,"revokeObjectURL",Dy(Jy,od))}tN(bc,"URL"),zB({global:!0,constructor:!0,forced:!qB,sham:!yf},{URL:bc});var yN=gt,WA=Zl,TN=we,Ky=Wr,Xy=Je,SN=Yl,zy=$I,vN=Kt,Ff=WA&&WA.prototype;if(yN({target:"Promise",proto:!0,real:!0,forced:!!WA&&TN(function(){Ff.finally.call({then:function(){}},function(){})})},{finally:function(e){var t=SN(this,Ky("Promise")),r=Xy(e);return this.then(r?function(i){return zy(t,e()).then(function(){return i})}:e,r?function(i){return zy(t,e()).then(function(){throw i})}:e)}}),Xy(WA)){var qy=Ky("Promise").prototype.finally;Ff.finally!==qy&&vN(Ff,"finally",qy,{unsafe:!0})}var $y=typeof ArrayBuffer<"u"&&typeof DataView<"u",RN=li,bN=Di,wN=RangeError,Zy=function(e){if(e===void 0)return 0;var t=RN(e),r=bN(t);if(t!==r)throw wN("Wrong length or index");return r},DN=Array,ON=Math.abs,Qn=Math.pow,kN=Math.floor,BN=Math.log,NN=Math.LN2,PN={pack:function(e,t,r){var i,n,a,c=DN(r),A=8*r-t-1,d=(1<<A)-1,g=d>>1,E=t===23?Qn(2,-24)-Qn(2,-77):0,f=e<0||e===0&&1/e<0?1:0,b=0;for((e=ON(e))!=e||e===1/0?(n=e!=e?1:0,i=d):(i=kN(BN(e)/NN),e*(a=Qn(2,-i))<1&&(i--,a*=2),(e+=i+g>=1?E/a:E*Qn(2,1-g))*a>=2&&(i++,a/=2),i+g>=d?(n=0,i=d):i+g>=1?(n=(e*a-1)*Qn(2,t),i+=g):(n=e*Qn(2,g-1)*Qn(2,t),i=0));t>=8;)c[b++]=255&n,n/=256,t-=8;for(i=i<<t|n,A+=t;A>0;)c[b++]=255&i,i/=256,A-=8;return c[--b]|=128*f,c},unpack:function(e,t){var r,i=e.length,n=8*i-t-1,a=(1<<n)-1,c=a>>1,A=n-7,d=i-1,g=e[d--],E=127&g;for(g>>=7;A>0;)E=256*E+e[d--],A-=8;for(r=E&(1<<-A)-1,E>>=-A,A+=t;A>0;)r=256*r+e[d--],A-=8;if(E===0)E=1-c;else{if(E===a)return r?NaN:g?-1/0:1/0;r+=Qn(2,t),E-=c}return(g?-1:1)*r*Qn(2,E-t)}},MN=or,eT=Yt,LN=ar,tT=function(e){for(var t=MN(this),r=LN(t),i=arguments.length,n=eT(i>1?arguments[1]:void 0,r),a=i>2?arguments[2]:void 0,c=a===void 0?r:eT(a,r);c>n;)t[n++]=e;return t},JA=q,Vf=Oe,jf=At,QN=$y,rT=Ps,iT=Ai,xN=gi,nT=GC,Hf=we,KA=Xt,UN=li,FN=Di,XA=Zy,oT=PN,VN=Xa,sT=ko,jN=Do.f,HN=tT,GN=of,aT=Oo,Gf=rr,YN=rT.PROPER,cT=rT.CONFIGURABLE,wc="ArrayBuffer",zA="DataView",Dc="prototype",lT="Wrong index",dT=Gf.getterFor(wc),dd=Gf.getterFor(zA),uT=Gf.set,yi=JA[wc],Li=yi,Oc=Li&&Li[Dc],xn=JA[zA],ta=xn&&xn[Dc],AT=Object.prototype,WN=JA.Array,qA=JA.RangeError,JN=Vf(HN),KN=Vf([].reverse),hT=oT.pack,gT=oT.unpack,pT=function(e){return[255&e]},mT=function(e){return[255&e,e>>8&255]},fT=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},ET=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},XN=function(e){return hT(e,23,4)},zN=function(e){return hT(e,52,8)},$A=function(e,t,r){xN(e[Dc],t,{configurable:!0,get:function(){return r(this)[t]}})},jo=function(e,t,r,i){var n=XA(r),a=dd(e);if(n+t>a.byteLength)throw qA(lT);var c=a.bytes,A=n+a.byteOffset,d=GN(c,A,A+t);return i?d:KN(d)},Ho=function(e,t,r,i,n,a){var c=XA(r),A=dd(e);if(c+t>A.byteLength)throw qA(lT);for(var d=A.bytes,g=c+A.byteOffset,E=i(+n),f=0;f<t;f++)d[g+f]=E[a?f:t-f-1]};if(QN){var _T=YN&&yi.name!==wc;if(Hf(function(){yi(1)})&&Hf(function(){new yi(-1)})&&!Hf(function(){return new yi,new yi(1.5),new yi(NaN),yi.length!=1||_T&&!cT}))_T&&cT&&iT(yi,"name",wc);else{(Li=function(e){return KA(this,Oc),new yi(XA(e))})[Dc]=Oc;for(var Yf,IT=jN(yi),CT=0;IT.length>CT;)(Yf=IT[CT++])in Li||iT(Li,Yf,yi[Yf]);Oc.constructor=Li}sT&&VN(ta)!==AT&&sT(ta,AT);var ZA=new xn(new Li(2)),yT=Vf(ta.setInt8);ZA.setInt8(0,2147483648),ZA.setInt8(1,2147483649),!ZA.getInt8(0)&&ZA.getInt8(1)||nT(ta,{setInt8:function(e,t){yT(this,e,t<<24>>24)},setUint8:function(e,t){yT(this,e,t<<24>>24)}},{unsafe:!0})}else Oc=(Li=function(e){KA(this,Oc);var t=XA(e);uT(this,{type:wc,bytes:JN(WN(t),0),byteLength:t}),jf||(this.byteLength=t,this.detached=!1)})[Dc],ta=(xn=function(e,t,r){KA(this,ta),KA(e,Oc);var i=dT(e),n=i.byteLength,a=UN(t);if(a<0||a>n)throw qA("Wrong offset");if(a+(r=r===void 0?n-a:FN(r))>n)throw qA("Wrong length");uT(this,{type:zA,buffer:e,byteLength:r,byteOffset:a,bytes:i.bytes}),jf||(this.buffer=e,this.byteLength=r,this.byteOffset=a)})[Dc],jf&&($A(Li,"byteLength",dT),$A(xn,"buffer",dd),$A(xn,"byteLength",dd),$A(xn,"byteOffset",dd)),nT(ta,{getInt8:function(e){return jo(this,1,e)[0]<<24>>24},getUint8:function(e){return jo(this,1,e)[0]},getInt16:function(e){var t=jo(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=jo(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return ET(jo(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return ET(jo(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return gT(jo(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return gT(jo(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){Ho(this,1,e,pT,t)},setUint8:function(e,t){Ho(this,1,e,pT,t)},setInt16:function(e,t){Ho(this,2,e,mT,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){Ho(this,2,e,mT,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){Ho(this,4,e,fT,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){Ho(this,4,e,fT,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){Ho(this,4,e,XN,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){Ho(this,8,e,zN,t,arguments.length>2?arguments[2]:void 0)}});aT(Li,wc),aT(xn,zA);var eh={ArrayBuffer:Li,DataView:xn},qN=gt,Wf=Ys,$N=we,TT=y,ST=Yt,ZN=Di,eP=Yl,Jf=eh.ArrayBuffer,Kf=eh.DataView,vT=Kf.prototype,RT=Wf(Jf.prototype.slice),tP=Wf(vT.getUint8),rP=Wf(vT.setUint8);qN({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:$N(function(){return!new Jf(2).slice(1,void 0).byteLength})},{slice:function(e,t){if(RT&&t===void 0)return RT(TT(this),e);for(var r=TT(this).byteLength,i=ST(e,r),n=ST(t===void 0?r:t,r),a=new(eP(this,Jf))(ZN(n-i)),c=new Kf(this),A=new Kf(a),d=0;i<n;)rP(A,d++,tP(c,i++));return a}});var Mr,kc,th,rh={},bT={get exports(){return rh},set exports(e){rh=e}},iP=$y,Xf=At,Rr=q,wT=Je,ih=Ct,Go=Bt,zf=tn,nP=zi,oP=Ai,qf=Kt,sP=gi,aP=j,nh=Xa,Bc=ko,cP=lt,lP=si,DT=rr.enforce,dP=rr.get,oh=Rr.Int8Array,$f=oh&&oh.prototype,OT=Rr.Uint8ClampedArray,kT=OT&&OT.prototype,an=oh&&nh(oh),Qi=$f&&nh($f),uP=Object.prototype,Zf=Rr.TypeError,BT=cP("toStringTag"),eE=lP("TYPED_ARRAY_TAG"),sh="TypedArrayConstructor",Un=iP&&!!Bc&&zf(Rr.opera)!=="Opera",NT=!1,Fn={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},tE={BigInt64Array:8,BigUint64Array:8},PT=function(e){var t=nh(e);if(ih(t)){var r=dP(t);return r&&Go(r,sh)?r[sh]:PT(t)}},MT=function(e){if(!ih(e))return!1;var t=zf(e);return Go(Fn,t)||Go(tE,t)};for(Mr in Fn)(th=(kc=Rr[Mr])&&kc.prototype)?DT(th)[sh]=kc:Un=!1;for(Mr in tE)(th=(kc=Rr[Mr])&&kc.prototype)&&(DT(th)[sh]=kc);if((!Un||!wT(an)||an===Function.prototype)&&(an=function(){throw Zf("Incorrect invocation")},Un))for(Mr in Fn)Rr[Mr]&&Bc(Rr[Mr],an);if((!Un||!Qi||Qi===uP)&&(Qi=an.prototype,Un))for(Mr in Fn)Rr[Mr]&&Bc(Rr[Mr].prototype,Qi);if(Un&&nh(kT)!==Qi&&Bc(kT,Qi),Xf&&!Go(Qi,BT))for(Mr in NT=!0,sP(Qi,BT,{configurable:!0,get:function(){return ih(this)?this[eE]:void 0}}),Fn)Rr[Mr]&&oP(Rr[Mr],eE,Mr);var Vn={NATIVE_ARRAY_BUFFER_VIEWS:Un,TYPED_ARRAY_TAG:NT&&eE,aTypedArray:function(e){if(MT(e))return e;throw Zf("Target is not a typed array")},aTypedArrayConstructor:function(e){if(wT(e)&&(!Bc||aP(an,e)))return e;throw Zf(nP(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,r,i){if(Xf){if(r)for(var n in Fn){var a=Rr[n];if(a&&Go(a.prototype,e))try{delete a.prototype[e]}catch{try{a.prototype[e]=t}catch{}}}Qi[e]&&!r||qf(Qi,e,r?t:Un&&$f[e]||t,i)}},exportTypedArrayStaticMethod:function(e,t,r){var i,n;if(Xf){if(Bc){if(r){for(i in Fn)if((n=Rr[i])&&Go(n,e))try{delete n[e]}catch{}}if(an[e]&&!r)return;try{return qf(an,e,r?t:Un&&an[e]||t)}catch{}}for(i in Fn)!(n=Rr[i])||n[e]&&!r||qf(n,e,t)}},getTypedArrayConstructor:PT,isView:function(e){if(!ih(e))return!1;var t=zf(e);return t==="DataView"||Go(Fn,t)||Go(tE,t)},isTypedArray:MT,TypedArray:an,TypedArrayPrototype:Qi},LT=q,rE=we,AP=KI,hP=Vn.NATIVE_ARRAY_BUFFER_VIEWS,gP=LT.ArrayBuffer,ra=LT.Int8Array,QT=!hP||!rE(function(){ra(1)})||!rE(function(){new ra(-1)})||!AP(function(e){new ra,new ra(null),new ra(1.5),new ra(e)},!0)||rE(function(){return new ra(new gP(2),1,void 0).length!==1}),pP=Ct,mP=Math.floor,fP=Number.isInteger||function(e){return!pP(e)&&isFinite(e)&&mP(e)===e},EP=li,_P=RangeError,IP=function(e){var t=EP(e);if(t<0)throw _P("The argument can't be less than 0");return t},CP=RangeError,xT=function(e,t){var r=IP(e);if(r%t)throw CP("Wrong offset");return r},yP=tn,TP=Ts,SP=TypeError,UT=function(e){var t=TP(e,"number");if(typeof t=="number")throw SP("Can't convert number to bigint");return BigInt(t)},vP=rn,RP=ht,bP=sA,wP=or,DP=ar,OP=RA,kP=td,BP=Lm,NP=function(e){var t=yP(e);return t=="BigInt64Array"||t=="BigUint64Array"},PP=Vn.aTypedArrayConstructor,MP=UT,FT=function(e){var t,r,i,n,a,c,A,d,g=bP(this),E=wP(e),f=arguments.length,b=f>1?arguments[1]:void 0,w=b!==void 0,k=kP(E);if(k&&!BP(k))for(d=(A=OP(E,k)).next,E=[];!(c=RP(d,A)).done;)E.push(c.value);for(w&&f>2&&(b=vP(b,arguments[2])),r=DP(E),i=new(PP(g))(r),n=NP(i),t=0;r>t;t++)a=w?b(E[t],t):E[t],i[t]=n?MP(a):+a;return i},VT=gt,jT=q,HT=ht,LP=At,QP=QT,Nc=Vn,GT=eh,YT=Xt,xP=Bi,ud=Ai,UP=fP,FP=Di,WT=Zy,iE=xT,JT=$i,Ad=Bt,VP=tn,nE=Ct,jP=Is,HP=Ye,GP=j,ah=ko,YP=Do.f,KT=FT,WP=TC.forEach,JP=Bn,KP=gi,XT=Ft,zT=Xr,XP=eC,oE=rr.get,zP=rr.set,qP=rr.enforce,qT=XT.f,$P=zT.f,ZP=Math.round,sE=jT.RangeError,$T=GT.ArrayBuffer,eM=$T.prototype,tM=GT.DataView,ch=Nc.NATIVE_ARRAY_BUFFER_VIEWS,ZT=Nc.TYPED_ARRAY_TAG,eS=Nc.TypedArray,hd=Nc.TypedArrayPrototype,rM=Nc.aTypedArrayConstructor,aE=Nc.isTypedArray,lh="BYTES_PER_ELEMENT",cE="Wrong length",tS=function(e,t){rM(e);for(var r=0,i=t.length,n=new e(i);i>r;)n[r]=t[r++];return n},dh=function(e,t){KP(e,t,{configurable:!0,get:function(){return oE(this)[t]}})},rS=function(e){var t;return GP(eM,e)||(t=VP(e))=="ArrayBuffer"||t=="SharedArrayBuffer"},iS=function(e,t){return aE(e)&&!jP(t)&&t in e&&UP(+t)&&t>=0},nS=function(e,t){return t=JT(t),iS(e,t)?xP(2,e[t]):$P(e,t)},oS=function(e,t,r){return t=JT(t),!(iS(e,t)&&nE(r)&&Ad(r,"value"))||Ad(r,"get")||Ad(r,"set")||r.configurable||Ad(r,"writable")&&!r.writable||Ad(r,"enumerable")&&!r.enumerable?qT(e,t,r):(e[t]=r.value,e)};LP?(ch||(zT.f=nS,XT.f=oS,dh(hd,"buffer"),dh(hd,"byteOffset"),dh(hd,"byteLength"),dh(hd,"length")),VT({target:"Object",stat:!0,forced:!ch},{getOwnPropertyDescriptor:nS,defineProperty:oS}),bT.exports=function(e,t,r){var i=e.match(/\d+/)[0]/8,n=e+(r?"Clamped":"")+"Array",a="get"+e,c="set"+e,A=jT[n],d=A,g=d&&d.prototype,E={},f=function(w,k){qT(w,k,{get:function(){return function(x,Y){var G=oE(x);return G.view[a](Y*i+G.byteOffset,!0)}(this,k)},set:function(x){return function(Y,G,F){var me=oE(Y);r&&(F=(F=ZP(F))<0?0:F>255?255:255&F),me.view[c](G*i+me.byteOffset,F,!0)}(this,k,x)},enumerable:!0})};ch?QP&&(d=t(function(w,k,x,Y){return YT(w,g),XP(nE(k)?rS(k)?Y!==void 0?new A(k,iE(x,i),Y):x!==void 0?new A(k,iE(x,i)):new A(k):aE(k)?tS(d,k):HT(KT,d,k):new A(WT(k)),w,d)}),ah&&ah(d,eS),WP(YP(A),function(w){w in d||ud(d,w,A[w])}),d.prototype=g):(d=t(function(w,k,x,Y){YT(w,g);var G,F,me,Te=0,Ze=0;if(nE(k)){if(!rS(k))return aE(k)?tS(d,k):HT(KT,d,k);G=k,Ze=iE(x,i);var qe=k.byteLength;if(Y===void 0){if(qe%i||(F=qe-Ze)<0)throw sE(cE)}else if((F=FP(Y)*i)+Ze>qe)throw sE(cE);me=F/i}else me=WT(k),G=new $T(F=me*i);for(zP(w,{buffer:G,byteOffset:Ze,byteLength:F,length:me,view:new tM(G)});Te<me;)f(w,Te++)}),ah&&ah(d,eS),g=d.prototype=HP(hd)),g.constructor!==d&&ud(g,"constructor",d),qP(g).TypedArrayConstructor=d,ZT&&ud(g,ZT,n);var b=d!=A;E[n]=d,VT({global:!0,constructor:!0,forced:b,sham:!ch},E),lh in d||ud(d,lh,i),lh in g||ud(g,lh,i),JP(n)}):bT.exports=function(){},rh("Uint8",function(e){return function(t,r,i){return e(this,t,r,i)}});var iM=tT,nM=UT,oM=tn,sM=ht,aM=we,cM=Vn.aTypedArray,lM=Vn.exportTypedArrayMethod,dM=Oe("".slice);lM("fill",function(e){var t=arguments.length;cM(this);var r=dM(oM(this),0,3)==="Big"?nM(e):+e;return sM(iM,this,r,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)},aM(function(){var e=0;return new Int8Array(2).fill({valueOf:function(){return e++}}),e!==1}));var sS=q,aS=ht,lE=Vn,uM=ar,AM=xT,hM=or,cS=we,gM=sS.RangeError,dE=sS.Int8Array,lS=dE&&dE.prototype,dS=lS&&lS.set,pM=lE.aTypedArray,mM=lE.exportTypedArrayMethod,uE=!cS(function(){var e=new Uint8ClampedArray(2);return aS(dS,e,{length:1,0:3},1),e[1]!==3}),fM=uE&&lE.NATIVE_ARRAY_BUFFER_VIEWS&&cS(function(){var e=new dE(2);return e.set(1),e.set("2",1),e[0]!==0||e[1]!==2});mM("set",function(e){pM(this);var t=AM(arguments.length>1?arguments[1]:void 0,1),r=hM(e);if(uE)return aS(dS,this,r,t);var i=this.length,n=uM(r),a=0;if(n+t>i)throw gM("Wrong length");for(;a<n;)this[t+a]=r[a++]},!uE||fM);var uS=M.match(/firefox\/(\d+)/i),AS=!!uS&&+uS[1],hS=/MSIE|Trident/.test(M),gS=M.match(/AppleWebKit\/(\d+)\./),pS=!!gS&&+gS[1],EM=Ys,AE=we,_M=Ar,IM=af,mS=AS,CM=hS,fS=ce,ES=pS,yM=Vn.aTypedArray,TM=Vn.exportTypedArrayMethod,gd=q.Uint16Array,Pc=gd&&EM(gd.prototype.sort),SM=!(!Pc||AE(function(){Pc(new gd(2),null)})&&AE(function(){Pc(new gd(2),{})})),_S=!!Pc&&!AE(function(){if(fS)return fS<74;if(mS)return mS<67;if(CM)return!0;if(ES)return ES<602;var e,t,r=new gd(516),i=Array(516);for(e=0;e<516;e++)t=e%4,r[e]=515-e,i[e]=e-2*t+3;for(Pc(r,function(n,a){return(n/4|0)-(a/4|0)}),e=0;e<516;e++)if(r[e]!==i[e])return!0});TM("sort",function(e){return e!==void 0&&_M(e),_S?Pc(this,e):IM(yM(this),function(t){return function(r,i){return t!==void 0?+t(r,i)||0:i!=i?-1:r!=r?1:r===0&&i===0?1/r>0&&1/i<0?1:-1:r>i}}(e))},!_S||SM),rh("Float32",function(e){return function(t,r,i){return e(this,t,r,i)}});var vM=Bn,hE="ArrayBuffer",IS=eh[hE];gt({global:!0,constructor:!0,forced:q[hE]!==IS},{ArrayBuffer:IS}),vM(hE);var RM=gt,bM=_C,wM=Oe([].reverse),CS=[1,2];RM({target:"Array",proto:!0,forced:String(CS)===String(CS.reverse())},{reverse:function(){return bM(this)&&(this.length=this.length),wM(this)}});var yS=zi,DM=TypeError,OM=gt,TS=Oe,kM=Ar,BM=or,SS=ar,NM=function(e,t){if(!delete e[t])throw DM("Cannot delete property "+yS(t)+" of "+yS(e))},vS=qr,gE=we,PM=af,MM=Jm,RS=AS,LM=hS,bS=ce,wS=pS,Yo=[],DS=TS(Yo.sort),QM=TS(Yo.push),xM=gE(function(){Yo.sort(void 0)}),UM=gE(function(){Yo.sort(null)}),FM=MM("sort"),OS=!gE(function(){if(bS)return bS<70;if(!(RS&&RS>3)){if(LM)return!0;if(wS)return wS<603;var e,t,r,i,n="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(i=0;i<47;i++)Yo.push({k:t+i,v:r})}for(Yo.sort(function(a,c){return c.v-a.v}),i=0;i<Yo.length;i++)t=Yo[i].k.charAt(0),n.charAt(n.length-1)!==t&&(n+=t);return n!=="DGBEFHACIJK"}});OM({target:"Array",proto:!0,forced:xM||!UM||!FM||!OS},{sort:function(e){e!==void 0&&kM(e);var t=BM(this);if(OS)return e===void 0?DS(t):DS(t,e);var r,i,n=[],a=SS(t);for(i=0;i<a;i++)i in t&&QM(n,t[i]);for(PM(n,function(c){return function(A,d){return d===void 0?-1:A===void 0?1:c!==void 0?+c(A,d)||0:vS(A)>vS(d)?1:-1}}(e)),r=SS(n),i=0;i<r;)t[i]=n[i++];for(;i<a;)NM(t,i++);return t}});var VM=gt,jM=ht,pE=Oe,kS=ni,HM=Je,GM=Ge,YM=tC,pd=qr,WM=Dt,JM=nC,KM=PC,XM=lt("replace"),zM=TypeError,BS=pE("".indexOf);pE("".replace);var NS=pE("".slice),qM=Math.max,PS=function(e,t,r){return r>e.length?-1:t===""?r:BS(e,t,r)};VM({target:"String",proto:!0},{replaceAll:function(e,t){var r,i,n,a,c,A,d,g,E=kS(this),f=0,b=0,w="";if(!GM(e)){if(YM(e)&&(r=pd(kS(JM(e))),!~BS(r,"g")))throw zM("`.replaceAll` does not allow non-global regexes");if(i=WM(e,XM))return jM(i,e,E,t)}for(n=pd(E),a=pd(e),(c=HM(t))||(t=pd(t)),A=a.length,d=qM(1,A),f=PS(n,a,0);f!==-1;)g=c?pd(t(a,f,n)):KM(a,n,f,[],void 0,t),w+=NS(n,b,f)+g,b=f+A,f=PS(n,a,f+d);return b<n.length&&(w+=NS(n,b)),w}}),(0,Vn.exportTypedArrayStaticMethod)("from",FT,QT);let MS=!0,LS=!0;function uh(e,t,r){const i=e.match(t);return i&&i.length>=r&&parseInt(i[r],10)}function ia(e,t,r){if(!e.RTCPeerConnection)return;const i=e.RTCPeerConnection.prototype,n=i.addEventListener;i.addEventListener=function(c,A){if(c!==t)return n.apply(this,arguments);const d=g=>{const E=r(g);E&&(A.handleEvent?A.handleEvent(E):A(E))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(A,d),n.apply(this,[c,d])};const a=i.removeEventListener;i.removeEventListener=function(c,A){if(c!==t||!this._eventMap||!this._eventMap[t])return a.apply(this,arguments);if(!this._eventMap[t].has(A))return a.apply(this,arguments);const d=this._eventMap[t].get(A);return this._eventMap[t].delete(A),this._eventMap[t].size===0&&delete this._eventMap[t],Object.keys(this._eventMap).length===0&&delete this._eventMap,a.apply(this,[c,d])},Object.defineProperty(i,"on"+t,{get(){return this["_on"+t]},set(c){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),c&&this.addEventListener(t,this["_on"+t]=c)},enumerable:!0,configurable:!0})}function $M(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(MS=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function ZM(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(LS=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function QS(){if(typeof window=="object"){if(MS)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function mE(e,t){LS&&console.warn(e+" is deprecated, please use "+t+" instead.")}function xS(e){return Object.prototype.toString.call(e)==="[object Object]"}function US(e){return xS(e)?Object.keys(e).reduce(function(t,r){const i=xS(e[r]),n=i?US(e[r]):e[r],a=i&&!Object.keys(n).length;return n===void 0||a?t:Object.assign(t,{[r]:n})},{}):e}function fE(e,t,r){t&&!r.has(t.id)&&(r.set(t.id,t),Object.keys(t).forEach(i=>{i.endsWith("Id")?fE(e,e.get(t[i]),r):i.endsWith("Ids")&&t[i].forEach(n=>{fE(e,e.get(n),r)})}))}function FS(e,t,r){const i=r?"outbound-rtp":"inbound-rtp",n=new Map;if(t===null)return n;const a=[];return e.forEach(c=>{c.type==="track"&&c.trackIdentifier===t.id&&a.push(c)}),a.forEach(c=>{e.forEach(A=>{A.type===i&&A.trackId===c.id&&fE(e,A,n)})}),n}const VS=QS;function jS(e,t){const r=e&&e.navigator;if(!r.mediaDevices)return;const i=function(c){if(typeof c!="object"||c.mandatory||c.optional)return c;const A={};return Object.keys(c).forEach(d=>{if(d==="require"||d==="advanced"||d==="mediaSource")return;const g=typeof c[d]=="object"?c[d]:{ideal:c[d]};g.exact!==void 0&&typeof g.exact=="number"&&(g.min=g.max=g.exact);const E=function(f,b){return f?f+b.charAt(0).toUpperCase()+b.slice(1):b==="deviceId"?"sourceId":b};if(g.ideal!==void 0){A.optional=A.optional||[];let f={};typeof g.ideal=="number"?(f[E("min",d)]=g.ideal,A.optional.push(f),f={},f[E("max",d)]=g.ideal,A.optional.push(f)):(f[E("",d)]=g.ideal,A.optional.push(f))}g.exact!==void 0&&typeof g.exact!="number"?(A.mandatory=A.mandatory||{},A.mandatory[E("",d)]=g.exact):["min","max"].forEach(f=>{g[f]!==void 0&&(A.mandatory=A.mandatory||{},A.mandatory[E(f,d)]=g[f])})}),c.advanced&&(A.optional=(A.optional||[]).concat(c.advanced)),A},n=function(c,A){if(t.version>=61)return A(c);if((c=JSON.parse(JSON.stringify(c)))&&typeof c.audio=="object"){const d=function(g,E,f){E in g&&!(f in g)&&(g[f]=g[E],delete g[E])};d((c=JSON.parse(JSON.stringify(c))).audio,"autoGainControl","googAutoGainControl"),d(c.audio,"noiseSuppression","googNoiseSuppression"),c.audio=i(c.audio)}if(c&&typeof c.video=="object"){let d=c.video.facingMode;d=d&&(typeof d=="object"?d:{ideal:d});const g=t.version<66;if(d&&(d.exact==="user"||d.exact==="environment"||d.ideal==="user"||d.ideal==="environment")&&(!r.mediaDevices.getSupportedConstraints||!r.mediaDevices.getSupportedConstraints().facingMode||g)){let E;if(delete c.video.facingMode,d.exact==="environment"||d.ideal==="environment"?E=["back","rear"]:d.exact!=="user"&&d.ideal!=="user"||(E=["front"]),E)return r.mediaDevices.enumerateDevices().then(f=>{let b=(f=f.filter(w=>w.kind==="videoinput")).find(w=>E.some(k=>w.label.toLowerCase().includes(k)));return!b&&f.length&&E.includes("back")&&(b=f[f.length-1]),b&&(c.video.deviceId=d.exact?{exact:b.deviceId}:{ideal:b.deviceId}),c.video=i(c.video),VS("chrome: "+JSON.stringify(c)),A(c)})}c.video=i(c.video)}return VS("chrome: "+JSON.stringify(c)),A(c)},a=function(c){return t.version>=64?c:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[c.name]||c.name,message:c.message,constraint:c.constraint||c.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(r.getUserMedia=(function(c,A,d){n(c,g=>{r.webkitGetUserMedia(g,A,E=>{d&&d(a(E))})})}).bind(r),r.mediaDevices.getUserMedia){const c=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(A){return n(A,d=>c(d).then(g=>{if(d.audio&&!g.getAudioTracks().length||d.video&&!g.getVideoTracks().length)throw g.getTracks().forEach(E=>{E.stop()}),new DOMException("","NotFoundError");return g},g=>Promise.reject(a(g))))}}}function HS(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function GS(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(r){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=r)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let n;n=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(c=>c.track&&c.track.id===i.track.id):{track:i.track};const a=new Event("track");a.track=i.track,a.receiver=n,a.transceiver={receiver:n},a.streams=[r.stream],this.dispatchEvent(a)}),r.stream.getTracks().forEach(i=>{let n;n=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(c=>c.track&&c.track.id===i.id):{track:i};const a=new Event("track");a.track=i,a.receiver=n,a.transceiver={receiver:n},a.streams=[r.stream],this.dispatchEvent(a)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else ia(e,"track",t=>(t.transceiver||Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}}),t))}function YS(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(n,a){return{track:a,get dtmf(){return this._dtmf===void 0&&(a.kind==="audio"?this._dtmf=n.createDTMFSender(a):this._dtmf=null),this._dtmf},_pc:n}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(c,A){let d=n.apply(this,arguments);return d||(d=t(this,c),this._senders.push(d)),d};const a=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(c){a.apply(this,arguments);const A=this._senders.indexOf(c);A!==-1&&this._senders.splice(A,1)}}const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(n){this._senders=this._senders||[],r.apply(this,[n]),n.getTracks().forEach(a=>{this._senders.push(t(this,a))})};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(n){this._senders=this._senders||[],i.apply(this,[n]),n.getTracks().forEach(a=>{const c=this._senders.find(A=>A.track===a);c&&this._senders.splice(this._senders.indexOf(c),1)})}}else if(typeof e=="object"&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const r=t.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function WS(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[r,i,n]=arguments;if(arguments.length>0&&typeof r=="function")return t.apply(this,arguments);if(t.length===0&&(arguments.length===0||typeof r!="function"))return t.apply(this,[]);const a=function(A){const d={};return A.result().forEach(g=>{const E={id:g.id,timestamp:g.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[g.type]||g.type};g.names().forEach(f=>{E[f]=g.stat(f)}),d[E.id]=E}),d},c=function(A){return new Map(Object.keys(A).map(d=>[d,A[d]]))};if(arguments.length>=2){const A=function(d){i(c(a(d)))};return t.apply(this,[A,r])}return new Promise((A,d)=>{t.apply(this,[function(g){A(c(a(g)))},d])}).then(i,n)}}function JS(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const r=e.RTCPeerConnection.prototype.getSenders;r&&(e.RTCPeerConnection.prototype.getSenders=function(){const n=r.apply(this,[]);return n.forEach(a=>a._pc=this),n});const i=e.RTCPeerConnection.prototype.addTrack;i&&(e.RTCPeerConnection.prototype.addTrack=function(){const n=i.apply(this,arguments);return n._pc=this,n}),e.RTCRtpSender.prototype.getStats=function(){const n=this;return this._pc.getStats().then(a=>FS(a,n.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){const i=r.apply(this,[]);return i.forEach(n=>n._pc=this),i}),ia(e,"track",i=>(i.receiver._pc=i.srcElement,i)),e.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(n=>FS(n,i.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const r=arguments[0];let i,n,a;return this.getSenders().forEach(c=>{c.track===r&&(i?a=!0:i=c)}),this.getReceivers().forEach(c=>(c.track===r&&(n?a=!0:n=c),c.track===r)),a||i&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function KS(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(a=>this._shimmedLocalStreams[a][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(a,c){if(!c)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const A=t.apply(this,arguments);return this._shimmedLocalStreams[c.id]?this._shimmedLocalStreams[c.id].indexOf(A)===-1&&this._shimmedLocalStreams[c.id].push(A):this._shimmedLocalStreams[c.id]=[c,A],A};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{},a.getTracks().forEach(d=>{if(this.getSenders().find(g=>g.track===d))throw new DOMException("Track already exists.","InvalidAccessError")});const c=this.getSenders();r.apply(this,arguments);const A=this.getSenders().filter(d=>c.indexOf(d)===-1);this._shimmedLocalStreams[a.id]=[a].concat(A)};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[a.id],i.apply(this,arguments)};const n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},a&&Object.keys(this._shimmedLocalStreams).forEach(c=>{const A=this._shimmedLocalStreams[c].indexOf(a);A!==-1&&this._shimmedLocalStreams[c].splice(A,1),this._shimmedLocalStreams[c].length===1&&delete this._shimmedLocalStreams[c]}),n.apply(this,arguments)}}function XS(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return KS(e);const r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const d=r.apply(this);return this._reverseStreams=this._reverseStreams||{},d.map(g=>this._reverseStreams[g.id])};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(d){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},d.getTracks().forEach(g=>{if(this.getSenders().find(E=>E.track===g))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[d.id]){const g=new e.MediaStream(d.getTracks());this._streams[d.id]=g,this._reverseStreams[g.id]=d,d=g}i.apply(this,[d])};const n=e.RTCPeerConnection.prototype.removeStream;function a(d,g){let E=g.sdp;return Object.keys(d._reverseStreams||[]).forEach(f=>{const b=d._reverseStreams[f],w=d._streams[b.id];E=E.replace(new RegExp(w.id,"g"),b.id)}),new RTCSessionDescription({type:g.type,sdp:E})}e.RTCPeerConnection.prototype.removeStream=function(d){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},n.apply(this,[this._streams[d.id]||d]),delete this._reverseStreams[this._streams[d.id]?this._streams[d.id].id:d.id],delete this._streams[d.id]},e.RTCPeerConnection.prototype.addTrack=function(d,g){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const E=[].slice.call(arguments,1);if(E.length!==1||!E[0].getTracks().find(b=>b===d))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(b=>b.track===d))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const f=this._streams[g.id];if(f)f.addTrack(d),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const b=new e.MediaStream([d]);this._streams[g.id]=b,this._reverseStreams[b.id]=g,this.addStream(b)}return this.getSenders().find(b=>b.track===d)},["createOffer","createAnswer"].forEach(function(d){const g=e.RTCPeerConnection.prototype[d],E={[d](){const f=arguments;return arguments.length&&typeof arguments[0]=="function"?g.apply(this,[b=>{const w=a(this,b);f[0].apply(null,[w])},b=>{f[1]&&f[1].apply(null,b)},arguments[2]]):g.apply(this,arguments).then(b=>a(this,b))}};e.RTCPeerConnection.prototype[d]=E[d]});const c=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(d,g){let E=g.sdp;return Object.keys(d._reverseStreams||[]).forEach(f=>{const b=d._reverseStreams[f],w=d._streams[b.id];E=E.replace(new RegExp(b.id,"g"),w.id)}),new RTCSessionDescription({type:g.type,sdp:E})}(this,arguments[0]),c.apply(this,arguments)):c.apply(this,arguments)};const A=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const d=A.get.apply(this);return d.type===""?d:a(this,d)}}),e.RTCPeerConnection.prototype.removeTrack=function(d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!d._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(d._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let g;this._streams=this._streams||{},Object.keys(this._streams).forEach(E=>{this._streams[E].getTracks().find(f=>d.track===f)&&(g=this._streams[E])}),g&&(g.getTracks().length===1?this.removeStream(this._reverseStreams[g.id]):g.removeTrack(d.track),this.dispatchEvent(new Event("negotiationneeded")))}}function EE(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(r){const i=e.RTCPeerConnection.prototype[r],n={[r](){return arguments[0]=new(r==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};e.RTCPeerConnection.prototype[r]=n[r]})}function zS(e,t){ia(e,"negotiationneeded",r=>{const i=r.target;if(!(t.version<72||i.getConfiguration&&i.getConfiguration().sdpSemantics==="plan-b")||i.signalingState==="stable")return r})}var qS=Object.freeze({__proto__:null,shimMediaStream:HS,shimOnTrack:GS,shimGetSendersWithDtmf:YS,shimGetStats:WS,shimSenderReceiverGetStats:JS,shimAddTrackRemoveTrackWithNative:KS,shimAddTrackRemoveTrack:XS,shimPeerConnection:EE,fixNegotiationNeeded:zS,shimGetUserMedia:jS,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(typeof t=="function"?e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then(i=>{const n=r.video&&r.video.width,a=r.video&&r.video.height,c=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:c||3}},n&&(r.video.mandatory.maxWidth=n),a&&(r.video.mandatory.maxHeight=a),e.navigator.mediaDevices.getUserMedia(r)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}});function $S(e,t){const r=e&&e.navigator,i=e&&e.MediaStreamTrack;if(r.getUserMedia=function(n,a,c){mE("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(n).then(a,c)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){const n=function(c,A,d){A in c&&!(d in c)&&(c[d]=c[A],delete c[A])},a=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(c){return typeof c=="object"&&typeof c.audio=="object"&&(c=JSON.parse(JSON.stringify(c)),n(c.audio,"autoGainControl","mozAutoGainControl"),n(c.audio,"noiseSuppression","mozNoiseSuppression")),a(c)},i&&i.prototype.getSettings){const c=i.prototype.getSettings;i.prototype.getSettings=function(){const A=c.apply(this,arguments);return n(A,"mozAutoGainControl","autoGainControl"),n(A,"mozNoiseSuppression","noiseSuppression"),A}}if(i&&i.prototype.applyConstraints){const c=i.prototype.applyConstraints;i.prototype.applyConstraints=function(A){return this.kind==="audio"&&typeof A=="object"&&(A=JSON.parse(JSON.stringify(A)),n(A,"autoGainControl","mozAutoGainControl"),n(A,"noiseSuppression","mozNoiseSuppression")),c.apply(this,[A])}}}}function ZS(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function _E(e,t){if(typeof e!="object"||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const a=e.RTCPeerConnection.prototype[n],c={[n](){return arguments[0]=new(n==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),a.apply(this,arguments)}};e.RTCPeerConnection.prototype[n]=c[n]});const r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[n,a,c]=arguments;return i.apply(this,[n||null]).then(A=>{if(t.version<53&&!a)try{A.forEach(d=>{d.type=r[d.type]||d.type})}catch(d){if(d.name!=="TypeError")throw d;A.forEach((g,E)=>{A.set(E,Object.assign({},g,{type:r[g.type]||g.type}))})}return A}).then(a,c)}}function ev(e){if(typeof e!="object"||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const i=t.apply(this,[]);return i.forEach(n=>n._pc=this),i});const r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){const i=r.apply(this,arguments);return i._pc=this,i}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function tv(e){if(typeof e!="object"||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const r=t.apply(this,[]);return r.forEach(i=>i._pc=this),r}),ia(e,"track",r=>(r.receiver._pc=r.srcElement,r)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function rv(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(t){mE("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&t.getTracks().includes(r.track)&&this.removeTrack(r)})})}function iv(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function nv(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(a=>{if("rid"in a&&!/^[a-z0-9]{0,16}$/i.test(a.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in a&&!(parseFloat(a.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in a&&!(parseFloat(a.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const n=t.apply(this,arguments);if(i){const{sender:a}=n,c=a.getParameters();(!("encodings"in c)||c.encodings.length===1&&Object.keys(c.encodings[0]).length===0)&&(c.encodings=r,a.sendEncodings=r,this.setParametersPromises.push(a.setParameters(c).then(()=>{delete a.sendEncodings}).catch(()=>{delete a.sendEncodings})))}return n})}function ov(e){if(typeof e!="object"||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const r=t.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function sv(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function av(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}var cv=Object.freeze({__proto__:null,shimOnTrack:ZS,shimPeerConnection:_E,shimSenderGetStats:ev,shimReceiverGetStats:tv,shimRemoveStream:rv,shimRTCDataChannel:iv,shimAddTransceiver:nv,shimGetParameters:ov,shimCreateOffer:sv,shimCreateAnswer:av,shimGetUserMedia:$S,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return r.video===!0?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)})}});function lv(e){if(typeof e=="object"&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>t.call(this,i,r)),r.getVideoTracks().forEach(i=>t.call(this,i,r))},e.RTCPeerConnection.prototype.addTrack=function(r,...i){return i&&i.forEach(n=>{this._localStreams?this._localStreams.includes(n)||this._localStreams.push(n):this._localStreams=[n]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(t);if(r===-1)return;this._localStreams.splice(r,1);const i=t.getTracks();this.getSenders().forEach(n=>{i.includes(n.track)&&this.removeTrack(n)})})}}function dv(e){if(typeof e=="object"&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(r){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=r),this.addEventListener("track",this._onaddstreampoly=i=>{i.streams.forEach(n=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(n))return;this._remoteStreams.push(n);const a=new Event("addstream");a.stream=n,this.dispatchEvent(a)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(n=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(n)>=0)return;r._remoteStreams.push(n);const a=new Event("addstream");a.stream=n,r.dispatchEvent(a)})}),t.apply(r,arguments)}}}function uv(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,r=t.createOffer,i=t.createAnswer,n=t.setLocalDescription,a=t.setRemoteDescription,c=t.addIceCandidate;t.createOffer=function(d,g){const E=arguments.length>=2?arguments[2]:arguments[0],f=r.apply(this,[E]);return g?(f.then(d,g),Promise.resolve()):f},t.createAnswer=function(d,g){const E=arguments.length>=2?arguments[2]:arguments[0],f=i.apply(this,[E]);return g?(f.then(d,g),Promise.resolve()):f};let A=function(d,g,E){const f=n.apply(this,[d]);return E?(f.then(g,E),Promise.resolve()):f};t.setLocalDescription=A,A=function(d,g,E){const f=a.apply(this,[d]);return E?(f.then(g,E),Promise.resolve()):f},t.setRemoteDescription=A,A=function(d,g,E){const f=c.apply(this,[d]);return E?(f.then(g,E),Promise.resolve()):f},t.addIceCandidate=A}function Av(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const r=t.mediaDevices,i=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=n=>i(hv(n))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=(function(r,i,n){t.mediaDevices.getUserMedia(r).then(i,n)}).bind(t))}function hv(e){return e&&e.video!==void 0?Object.assign({},e,{video:US(e.video)}):e}function gv(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const n=[];for(let a=0;a<r.iceServers.length;a++){let c=r.iceServers[a];c.urls===void 0&&c.url?(mE("RTCIceServer.url","RTCIceServer.urls"),c=JSON.parse(JSON.stringify(c)),c.urls=c.url,delete c.url,n.push(c)):n.push(r.iceServers[a])}r.iceServers=n}return new t(r,i)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function pv(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function mv(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(r){if(r){r.offerToReceiveAudio!==void 0&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(a=>a.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio!==!0||i||this.addTransceiver("audio",{direction:"recvonly"}),r.offerToReceiveVideo!==void 0&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const n=this.getTransceivers().find(a=>a.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&n?n.direction==="sendrecv"?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":n.direction==="recvonly"&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):r.offerToReceiveVideo!==!0||n||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function fv(e){typeof e!="object"||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var Ev=Object.freeze({__proto__:null,shimLocalStreamsAPI:lv,shimRemoteStreamsAPI:dv,shimCallbacksAPI:uv,shimGetUserMedia:Av,shimConstraints:hv,shimRTCIceServerUrls:gv,shimTrackEventTransceiver:pv,shimCreateOfferLegacy:mv,shimAudioContext:fv}),Ah={};(function(e){const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(r){return r.trim().split(`
`).map(i=>i.trim())},t.splitSections=function(r){return r.split(`
m=`).map((i,n)=>(n>0?"m="+i:i).trim()+`\r
`)},t.getDescription=function(r){const i=t.splitSections(r);return i&&i[0]},t.getMediaSections=function(r){const i=t.splitSections(r);return i.shift(),i},t.matchPrefix=function(r,i){return t.splitLines(r).filter(n=>n.indexOf(i)===0)},t.parseCandidate=function(r){let i;i=r.indexOf("a=candidate:")===0?r.substring(12).split(" "):r.substring(10).split(" ");const n={foundation:i[0],component:{1:"rtp",2:"rtcp"}[i[1]]||i[1],protocol:i[2].toLowerCase(),priority:parseInt(i[3],10),ip:i[4],address:i[4],port:parseInt(i[5],10),type:i[7]};for(let a=8;a<i.length;a+=2)switch(i[a]){case"raddr":n.relatedAddress=i[a+1];break;case"rport":n.relatedPort=parseInt(i[a+1],10);break;case"tcptype":n.tcpType=i[a+1];break;case"ufrag":n.ufrag=i[a+1],n.usernameFragment=i[a+1];break;default:n[i[a]]===void 0&&(n[i[a]]=i[a+1])}return n},t.writeCandidate=function(r){const i=[];i.push(r.foundation);const n=r.component;n==="rtp"?i.push(1):n==="rtcp"?i.push(2):i.push(n),i.push(r.protocol.toUpperCase()),i.push(r.priority),i.push(r.address||r.ip),i.push(r.port);const a=r.type;return i.push("typ"),i.push(a),a!=="host"&&r.relatedAddress&&r.relatedPort&&(i.push("raddr"),i.push(r.relatedAddress),i.push("rport"),i.push(r.relatedPort)),r.tcpType&&r.protocol.toLowerCase()==="tcp"&&(i.push("tcptype"),i.push(r.tcpType)),(r.usernameFragment||r.ufrag)&&(i.push("ufrag"),i.push(r.usernameFragment||r.ufrag)),"candidate:"+i.join(" ")},t.parseIceOptions=function(r){return r.substring(14).split(" ")},t.parseRtpMap=function(r){let i=r.substring(9).split(" ");const n={payloadType:parseInt(i.shift(),10)};return i=i[0].split("/"),n.name=i[0],n.clockRate=parseInt(i[1],10),n.channels=i.length===3?parseInt(i[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(r){let i=r.payloadType;r.preferredPayloadType!==void 0&&(i=r.preferredPayloadType);const n=r.channels||r.numChannels||1;return"a=rtpmap:"+i+" "+r.name+"/"+r.clockRate+(n!==1?"/"+n:"")+`\r
`},t.parseExtmap=function(r){const i=r.substring(9).split(" ");return{id:parseInt(i[0],10),direction:i[0].indexOf("/")>0?i[0].split("/")[1]:"sendrecv",uri:i[1],attributes:i.slice(2).join(" ")}},t.writeExtmap=function(r){return"a=extmap:"+(r.id||r.preferredId)+(r.direction&&r.direction!=="sendrecv"?"/"+r.direction:"")+" "+r.uri+(r.attributes?" "+r.attributes:"")+`\r
`},t.parseFmtp=function(r){const i={};let n;const a=r.substring(r.indexOf(" ")+1).split(";");for(let c=0;c<a.length;c++)n=a[c].trim().split("="),i[n[0].trim()]=n[1];return i},t.writeFmtp=function(r){let i="",n=r.payloadType;if(r.preferredPayloadType!==void 0&&(n=r.preferredPayloadType),r.parameters&&Object.keys(r.parameters).length){const a=[];Object.keys(r.parameters).forEach(c=>{r.parameters[c]!==void 0?a.push(c+"="+r.parameters[c]):a.push(c)}),i+="a=fmtp:"+n+" "+a.join(";")+`\r
`}return i},t.parseRtcpFb=function(r){const i=r.substring(r.indexOf(" ")+1).split(" ");return{type:i.shift(),parameter:i.join(" ")}},t.writeRtcpFb=function(r){let i="",n=r.payloadType;return r.preferredPayloadType!==void 0&&(n=r.preferredPayloadType),r.rtcpFeedback&&r.rtcpFeedback.length&&r.rtcpFeedback.forEach(a=>{i+="a=rtcp-fb:"+n+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+`\r
`}),i},t.parseSsrcMedia=function(r){const i=r.indexOf(" "),n={ssrc:parseInt(r.substring(7,i),10)},a=r.indexOf(":",i);return a>-1?(n.attribute=r.substring(i+1,a),n.value=r.substring(a+1)):n.attribute=r.substring(i+1),n},t.parseSsrcGroup=function(r){const i=r.substring(13).split(" ");return{semantics:i.shift(),ssrcs:i.map(n=>parseInt(n,10))}},t.getMid=function(r){const i=t.matchPrefix(r,"a=mid:")[0];if(i)return i.substring(6)},t.parseFingerprint=function(r){const i=r.substring(14).split(" ");return{algorithm:i[0].toLowerCase(),value:i[1].toUpperCase()}},t.getDtlsParameters=function(r,i){return{role:"auto",fingerprints:t.matchPrefix(r+i,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(r,i){let n="a=setup:"+i+`\r
`;return r.fingerprints.forEach(a=>{n+="a=fingerprint:"+a.algorithm+" "+a.value+`\r
`}),n},t.parseCryptoLine=function(r){const i=r.substring(9).split(" ");return{tag:parseInt(i[0],10),cryptoSuite:i[1],keyParams:i[2],sessionParams:i.slice(3)}},t.writeCryptoLine=function(r){return"a=crypto:"+r.tag+" "+r.cryptoSuite+" "+(typeof r.keyParams=="object"?t.writeCryptoKeyParams(r.keyParams):r.keyParams)+(r.sessionParams?" "+r.sessionParams.join(" "):"")+`\r
`},t.parseCryptoKeyParams=function(r){if(r.indexOf("inline:")!==0)return null;const i=r.substring(7).split("|");return{keyMethod:"inline",keySalt:i[0],lifeTime:i[1],mkiValue:i[2]?i[2].split(":")[0]:void 0,mkiLength:i[2]?i[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(r){return r.keyMethod+":"+r.keySalt+(r.lifeTime?"|"+r.lifeTime:"")+(r.mkiValue&&r.mkiLength?"|"+r.mkiValue+":"+r.mkiLength:"")},t.getCryptoParameters=function(r,i){return t.matchPrefix(r+i,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(r,i){const n=t.matchPrefix(r+i,"a=ice-ufrag:")[0],a=t.matchPrefix(r+i,"a=ice-pwd:")[0];return n&&a?{usernameFragment:n.substring(12),password:a.substring(10)}:null},t.writeIceParameters=function(r){let i="a=ice-ufrag:"+r.usernameFragment+`\r
a=ice-pwd:`+r.password+`\r
`;return r.iceLite&&(i+=`a=ice-lite\r
`),i},t.parseRtpParameters=function(r){const i={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=t.splitLines(r)[0].split(" ");i.profile=n[2];for(let c=3;c<n.length;c++){const A=n[c],d=t.matchPrefix(r,"a=rtpmap:"+A+" ")[0];if(d){const g=t.parseRtpMap(d),E=t.matchPrefix(r,"a=fmtp:"+A+" ");switch(g.parameters=E.length?t.parseFmtp(E[0]):{},g.rtcpFeedback=t.matchPrefix(r,"a=rtcp-fb:"+A+" ").map(t.parseRtcpFb),i.codecs.push(g),g.name.toUpperCase()){case"RED":case"ULPFEC":i.fecMechanisms.push(g.name.toUpperCase())}}}t.matchPrefix(r,"a=extmap:").forEach(c=>{i.headerExtensions.push(t.parseExtmap(c))});const a=t.matchPrefix(r,"a=rtcp-fb:* ").map(t.parseRtcpFb);return i.codecs.forEach(c=>{a.forEach(A=>{c.rtcpFeedback.find(d=>d.type===A.type&&d.parameter===A.parameter)||c.rtcpFeedback.push(A)})}),i},t.writeRtpDescription=function(r,i){let n="";n+="m="+r+" ",n+=i.codecs.length>0?"9":"0",n+=" "+(i.profile||"UDP/TLS/RTP/SAVPF")+" ",n+=i.codecs.map(c=>c.preferredPayloadType!==void 0?c.preferredPayloadType:c.payloadType).join(" ")+`\r
`,n+=`c=IN IP4 0.0.0.0\r
`,n+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,i.codecs.forEach(c=>{n+=t.writeRtpMap(c),n+=t.writeFmtp(c),n+=t.writeRtcpFb(c)});let a=0;return i.codecs.forEach(c=>{c.maxptime>a&&(a=c.maxptime)}),a>0&&(n+="a=maxptime:"+a+`\r
`),i.headerExtensions&&i.headerExtensions.forEach(c=>{n+=t.writeExtmap(c)}),n},t.parseRtpEncodingParameters=function(r){const i=[],n=t.parseRtpParameters(r),a=n.fecMechanisms.indexOf("RED")!==-1,c=n.fecMechanisms.indexOf("ULPFEC")!==-1,A=t.matchPrefix(r,"a=ssrc:").map(b=>t.parseSsrcMedia(b)).filter(b=>b.attribute==="cname"),d=A.length>0&&A[0].ssrc;let g;const E=t.matchPrefix(r,"a=ssrc-group:FID").map(b=>b.substring(17).split(" ").map(w=>parseInt(w,10)));E.length>0&&E[0].length>1&&E[0][0]===d&&(g=E[0][1]),n.codecs.forEach(b=>{if(b.name.toUpperCase()==="RTX"&&b.parameters.apt){let w={ssrc:d,codecPayloadType:parseInt(b.parameters.apt,10)};d&&g&&(w.rtx={ssrc:g}),i.push(w),a&&(w=JSON.parse(JSON.stringify(w)),w.fec={ssrc:d,mechanism:c?"red+ulpfec":"red"},i.push(w))}}),i.length===0&&d&&i.push({ssrc:d});let f=t.matchPrefix(r,"b=");return f.length&&(f=f[0].indexOf("b=TIAS:")===0?parseInt(f[0].substring(7),10):f[0].indexOf("b=AS:")===0?1e3*parseInt(f[0].substring(5),10)*.95-16e3:void 0,i.forEach(b=>{b.maxBitrate=f})),i},t.parseRtcpParameters=function(r){const i={},n=t.matchPrefix(r,"a=ssrc:").map(A=>t.parseSsrcMedia(A)).filter(A=>A.attribute==="cname")[0];n&&(i.cname=n.value,i.ssrc=n.ssrc);const a=t.matchPrefix(r,"a=rtcp-rsize");i.reducedSize=a.length>0,i.compound=a.length===0;const c=t.matchPrefix(r,"a=rtcp-mux");return i.mux=c.length>0,i},t.writeRtcpParameters=function(r){let i="";return r.reducedSize&&(i+=`a=rtcp-rsize\r
`),r.mux&&(i+=`a=rtcp-mux\r
`),r.ssrc!==void 0&&r.cname&&(i+="a=ssrc:"+r.ssrc+" cname:"+r.cname+`\r
`),i},t.parseMsid=function(r){let i;const n=t.matchPrefix(r,"a=msid:");if(n.length===1)return i=n[0].substring(7).split(" "),{stream:i[0],track:i[1]};const a=t.matchPrefix(r,"a=ssrc:").map(c=>t.parseSsrcMedia(c)).filter(c=>c.attribute==="msid");return a.length>0?(i=a[0].value.split(" "),{stream:i[0],track:i[1]}):void 0},t.parseSctpDescription=function(r){const i=t.parseMLine(r),n=t.matchPrefix(r,"a=max-message-size:");let a;n.length>0&&(a=parseInt(n[0].substring(19),10)),isNaN(a)&&(a=65536);const c=t.matchPrefix(r,"a=sctp-port:");if(c.length>0)return{port:parseInt(c[0].substring(12),10),protocol:i.fmt,maxMessageSize:a};const A=t.matchPrefix(r,"a=sctpmap:");if(A.length>0){const d=A[0].substring(10).split(" ");return{port:parseInt(d[0],10),protocol:d[1],maxMessageSize:a}}},t.writeSctpDescription=function(r,i){let n=[];return n=r.protocol!=="DTLS/SCTP"?["m="+r.kind+" 9 "+r.protocol+" "+i.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+i.port+`\r
`]:["m="+r.kind+" 9 "+r.protocol+" "+i.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+i.port+" "+i.protocol+` 65535\r
`],i.maxMessageSize!==void 0&&n.push("a=max-message-size:"+i.maxMessageSize+`\r
`),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(r,i,n){let a;const c=i!==void 0?i:2;return a=r||t.generateSessionId(),`v=0\r
o=`+(n||"thisisadapterortc")+" "+a+" "+c+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},t.getDirection=function(r,i){const n=t.splitLines(r);for(let a=0;a<n.length;a++)switch(n[a]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[a].substring(2)}return i?t.getDirection(i):"sendrecv"},t.getKind=function(r){return t.splitLines(r)[0].split(" ")[0].substring(2)},t.isRejected=function(r){return r.split(" ",2)[1]==="0"},t.parseMLine=function(r){const i=t.splitLines(r)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},t.parseOLine=function(r){const i=t.matchPrefix(r,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},t.isValidSDP=function(r){if(typeof r!="string"||r.length===0)return!1;const i=t.splitLines(r);for(let n=0;n<i.length;n++)if(i[n].length<2||i[n].charAt(1)!=="=")return!1;return!0},e.exports=t})({get exports(){return Ah},set exports(e){Ah=e}});var Mc=Ah,eL=u({__proto__:null,default:Mc},[Ah]);function hh(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&((r=JSON.parse(JSON.stringify(r))).candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new t(r),n=Mc.parseCandidate(r.candidate);for(const a in n)a in i||Object.defineProperty(i,a,{value:n[a]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(r)},e.RTCIceCandidate.prototype=t.prototype,ia(e,"icecandidate",r=>(r.candidate&&Object.defineProperty(r,"candidate",{value:new e.RTCIceCandidate(r.candidate),writable:"false"}),r))}function IE(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||ia(e,"icecandidate",t=>{if(t.candidate){const r=Mc.parseCandidate(t.candidate.candidate);r.type==="relay"&&(t.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[r.priority>>24])}return t})}function gh(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,t.browser==="chrome"&&t.version>=76){const{sdpSemantics:i}=this.getConfiguration();i==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(function(i){if(!i||!i.sdp)return!1;const n=Mc.splitSections(i.sdp);return n.shift(),n.some(a=>{const c=Mc.parseMLine(a);return c&&c.kind==="application"&&c.protocol.indexOf("SCTP")!==-1})}(arguments[0])){const i=function(d){const g=d.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(g===null||g.length<2)return-1;const E=parseInt(g[1],10);return E!=E?-1:E}(arguments[0]),n=function(d){let g=65536;return t.browser==="firefox"&&(g=t.version<57?d===-1?16384:2147483637:t.version<60?t.version===57?65535:65536:2147483637),g}(i),a=function(d,g){let E=65536;t.browser==="firefox"&&t.version===57&&(E=65535);const f=Mc.matchPrefix(d.sdp,"a=max-message-size:");return f.length>0?E=parseInt(f[0].substring(19),10):t.browser==="firefox"&&g!==-1&&(E=2147483637),E}(arguments[0],i);let c;c=n===0&&a===0?Number.POSITIVE_INFINITY:n===0||a===0?Math.max(n,a):Math.min(n,a);const A={};Object.defineProperty(A,"maxMessageSize",{get:()=>c}),this._sctp=A}return r.apply(this,arguments)}}function ph(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(i,n){const a=i.send;i.send=function(){const c=arguments[0],A=c.length||c.size||c.byteLength;if(i.readyState==="open"&&n.sctp&&A>n.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+n.sctp.maxMessageSize+" bytes)");return a.apply(i,arguments)}}const r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const i=r.apply(this,arguments);return t(i,this),i},ia(e,"datachannel",i=>(t(i.channel,i.target),i))}function CE(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(r){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),r&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=r)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(r=>{const i=t[r];t[r]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=n=>{const a=n.target;if(a._lastConnectionState!==a.connectionState){a._lastConnectionState=a.connectionState;const c=new Event("connectionstatechange",n);a.dispatchEvent(c)}return n},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}})}function yE(e,t){if(!e.RTCPeerConnection||t.browser==="chrome"&&t.version>=71||t.browser==="safari"&&t.version>=605)return;const r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const n=i.sdp.split(`
`).filter(a=>a.trim()!=="a=extmap-allow-mixed").join(`
`);e.RTCSessionDescription&&i instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:i.type,sdp:n}):i.sdp=n}return r.apply(this,arguments)}}function mh(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const r=e.RTCPeerConnection.prototype.addIceCandidate;r&&r.length!==0&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(t.browser==="chrome"&&t.version<78||t.browser==="firefox"&&t.version<68||t.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function fh(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const r=e.RTCPeerConnection.prototype.setLocalDescription;r&&r.length!==0&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return r.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer"}return i.sdp||i.type!=="offer"&&i.type!=="answer"?r.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(n=>r.apply(this,[n]))})}var tL=Object.freeze({__proto__:null,shimRTCIceCandidate:hh,shimRTCIceCandidateRelayProtocol:IE,shimMaxMessageSize:gh,shimSendThrowTypeError:ph,shimConnectionState:CE,removeExtmapAllowMixed:yE,shimAddIceCandidateNullOrEmpty:mh,shimParameterlessSetLocalDescription:fh});(function({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const r=QS,i=function(a){const c={browser:null,version:null};if(a===void 0||!a.navigator||!a.navigator.userAgent)return c.browser="Not a browser.",c;const{navigator:A}=a;if(A.mozGetUserMedia)c.browser="firefox",c.version=uh(A.userAgent,/Firefox\/(\d+)\./,1);else if(A.webkitGetUserMedia||a.isSecureContext===!1&&a.webkitRTCPeerConnection)c.browser="chrome",c.version=uh(A.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!a.RTCPeerConnection||!A.userAgent.match(/AppleWebKit\/(\d+)\./))return c.browser="Not a supported browser.",c;c.browser="safari",c.version=uh(A.userAgent,/AppleWebKit\/(\d+)\./,1),c.supportsUnifiedPlan=a.RTCRtpTransceiver&&"currentDirection"in a.RTCRtpTransceiver.prototype}return c}(e),n={browserDetails:i,commonShim:tL,extractVersion:uh,disableLog:$M,disableWarnings:ZM,sdp:eL};switch(i.browser){case"chrome":if(!qS||!EE||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),n;if(i.version===null)return r("Chrome shim can not determine version, not shimming."),n;r("adapter.js shimming chrome."),n.browserShim=qS,mh(e,i),fh(e),jS(e,i),HS(e),EE(e,i),GS(e),XS(e,i),YS(e),WS(e),JS(e),zS(e,i),hh(e),IE(e),CE(e),gh(e,i),ph(e),yE(e,i);break;case"firefox":if(!cv||!_E||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),n;r("adapter.js shimming firefox."),n.browserShim=cv,mh(e,i),fh(e),$S(e,i),_E(e,i),ZS(e),rv(e),ev(e),tv(e),iv(e),nv(e),ov(e),sv(e),av(e),hh(e),CE(e),gh(e,i),ph(e);break;case"safari":if(!Ev||!t.shimSafari)return r("Safari shim is not included in this adapter release."),n;r("adapter.js shimming safari."),n.browserShim=Ev,mh(e,i),fh(e),gv(e),mv(e),uv(e),lv(e),dv(e),pv(e),Av(e),fv(e),hh(e),IE(e),gh(e,i),ph(e),yE(e,i);break;default:r("Unsupported browser!")}})({window:typeof window>"u"?void 0:window});var Ee,rL=Object.create,md=Object.defineProperty,iL=Object.defineProperties,_v=Object.getOwnPropertyDescriptor,nL=Object.getOwnPropertyDescriptors,oL=Object.getOwnPropertyNames,Eh=Object.getOwnPropertySymbols,Iv=Object.getPrototypeOf,TE=Object.prototype.hasOwnProperty,Cv=Object.prototype.propertyIsEnumerable,sL=Reflect.get,SE=Math.pow,vE=(e,t,r)=>t in e?md(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,_e=(e,t)=>{for(var r in t||(t={}))TE.call(t,r)&&vE(e,r,t[r]);if(Eh)for(var r of Eh(t))Cv.call(t,r)&&vE(e,r,t[r]);return e},Ke=(e,t)=>iL(e,nL(t)),jn=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),fd=(e,t)=>{for(var r in t)md(e,r,{get:t[r],enumerable:!0})},lr=(e,t,r)=>(r=e!=null?rL(Iv(e)):{},((i,n,a,c)=>{if(n&&typeof n=="object"||typeof n=="function")for(let A of oL(n))!TE.call(i,A)&&A!==a&&md(i,A,{get:()=>n[A],enumerable:!(c=_v(n,A))||c.enumerable});return i})(!t&&e&&e.__esModule?r:md(r,"default",{value:e,enumerable:!0}),e)),le=(e,t,r,i)=>{for(var n,a=i>1?void 0:i?_v(t,r):t,c=e.length-1;c>=0;c--)(n=e[c])&&(a=(i?n(t,r,a):n(a))||a);return i&&a&&md(t,r,a),a},T=(e,t,r)=>(vE(e,typeof t!="symbol"?t+"":t,r),r),Ti=(e,t,r)=>sL(Iv(e),r,t),N=(e,t,r)=>new Promise((i,n)=>{var a=d=>{try{A(r.next(d))}catch(g){n(g)}},c=d=>{try{A(r.throw(d))}catch(g){n(g)}},A=d=>d.done?i(d.value):Promise.resolve(d.value).then(a,c);A((r=r.apply(e,t)).next())}),Lr=jn((e,t)=>{var r=Object.prototype.hasOwnProperty,i="~";function n(){}function a(g,E,f){this.fn=g,this.context=E,this.once=f||!1}function c(g,E,f,b,w){if(typeof f!="function")throw new TypeError("The listener must be a function");var k=new a(f,b||g,w),x=i?i+E:E;return g._events[x]?g._events[x].fn?g._events[x]=[g._events[x],k]:g._events[x].push(k):(g._events[x]=k,g._eventsCount++),g}function A(g,E){--g._eventsCount==0?g._events=new n:delete g._events[E]}function d(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(i=!1)),d.prototype.eventNames=function(){var g,E,f=[];if(this._eventsCount===0)return f;for(E in g=this._events)r.call(g,E)&&f.push(i?E.slice(1):E);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(g)):f},d.prototype.listeners=function(g){var E=i?i+g:g,f=this._events[E];if(!f)return[];if(f.fn)return[f.fn];for(var b=0,w=f.length,k=new Array(w);b<w;b++)k[b]=f[b].fn;return k},d.prototype.listenerCount=function(g){var E=i?i+g:g,f=this._events[E];return f?f.fn?1:f.length:0},d.prototype.emit=function(g,E,f,b,w,k){var x=i?i+g:g;if(!this._events[x])return!1;var Y,G,F=this._events[x],me=arguments.length;if(F.fn){switch(F.once&&this.removeListener(g,F.fn,void 0,!0),me){case 1:return F.fn.call(F.context),!0;case 2:return F.fn.call(F.context,E),!0;case 3:return F.fn.call(F.context,E,f),!0;case 4:return F.fn.call(F.context,E,f,b),!0;case 5:return F.fn.call(F.context,E,f,b,w),!0;case 6:return F.fn.call(F.context,E,f,b,w,k),!0}for(G=1,Y=new Array(me-1);G<me;G++)Y[G-1]=arguments[G];F.fn.apply(F.context,Y)}else{var Te,Ze=F.length;for(G=0;G<Ze;G++)switch(F[G].once&&this.removeListener(g,F[G].fn,void 0,!0),me){case 1:F[G].fn.call(F[G].context);break;case 2:F[G].fn.call(F[G].context,E);break;case 3:F[G].fn.call(F[G].context,E,f);break;case 4:F[G].fn.call(F[G].context,E,f,b);break;default:if(!Y)for(Te=1,Y=new Array(me-1);Te<me;Te++)Y[Te-1]=arguments[Te];F[G].fn.apply(F[G].context,Y)}}return!0},d.prototype.on=function(g,E,f){return c(this,g,E,f,!1)},d.prototype.once=function(g,E,f){return c(this,g,E,f,!0)},d.prototype.removeListener=function(g,E,f,b){var w=i?i+g:g;if(!this._events[w])return this;if(!E)return A(this,w),this;var k=this._events[w];if(k.fn)k.fn===E&&(!b||k.once)&&(!f||k.context===f)&&A(this,w);else{for(var x=0,Y=[],G=k.length;x<G;x++)(k[x].fn!==E||b&&!k[x].once||f&&k[x].context!==f)&&Y.push(k[x]);Y.length?this._events[w]=Y.length===1?Y[0]:Y:A(this,w)}return this},d.prototype.removeAllListeners=function(g){var E;return g?(E=i?i+g:g,this._events[E]&&A(this,E)):(this._events=new n,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=i,d.EventEmitter=d,t!==void 0&&(t.exports=d)}),yv=jn((e,t)=>{var r=t.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(i){return i.encoding?"rtpmap:%d %s/%s/%s":i.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(i){return i.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(i){return i.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(i){return"extmap:%d"+(i.direction?"/%s":"%v")+(i["encrypt-uri"]?" %s":"%v")+" %s"+(i.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(i){return i.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(i){var n="candidate:%s %d %s %d %s %d typ %s";return n+=i.raddr!=null?" raddr %s rport %d":"%v%v",n+=i.tcptype!=null?" tcptype %s":"%v",i.generation!=null&&(n+=" generation %d"),n+=i["network-id"]!=null?" network-id %d":"%v",n+=i["network-cost"]!=null?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(i){var n="ssrc:%d";return i.attribute!=null&&(n+=" %s",i.value!=null&&(n+=":%s")),n}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(i){return i.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(i){return i.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(i){return"imageattr:%s %s %s"+(i.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(i){return"simulcast:%s %s"+(i.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(i){return"ts-refclk:%s"+(i.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(i){var n="mediaclk:";return n+=i.id!=null?"id=%s %s":"%v%s",n+=i.mediaClockValue!=null?"=%s":"",n+=i.rateNumerator!=null?" rate=%s":"",n+=i.rateDenominator!=null?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(r).forEach(function(i){r[i].forEach(function(n){n.reg||(n.reg=/(.*)/),n.format||(n.format="%s")})})}),aL=jn(e=>{var t=function(c){return String(Number(c))===c?Number(c):c},r=function(c,A,d){var g=c.name&&c.names;c.push&&!A[c.push]?A[c.push]=[]:g&&!A[c.name]&&(A[c.name]={});var E=c.push?{}:g?A[c.name]:A;(function(f,b,w,k){if(k&&!w)b[k]=t(f[1]);else for(var x=0;x<w.length;x+=1)f[x+1]!=null&&(b[w[x]]=t(f[x+1]))})(d.match(c.reg),E,c.names,c.name),c.push&&A[c.push].push(E)},i=yv(),n=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(c){var A={},d=[],g=A;return c.split(/(\r\n|\r|\n)/).filter(n).forEach(function(E){var f=E[0],b=E.slice(2);f==="m"&&(d.push({rtp:[],fmtp:[]}),g=d[d.length-1]);for(var w=0;w<(i[f]||[]).length;w+=1){var k=i[f][w];if(k.reg.test(b))return r(k,g,b)}}),A.media=d,A};var a=function(c,A){var d=A.split(/=(.+)/,2);return d.length===2?c[d[0]]=t(d[1]):d.length===1&&A.length>1&&(c[d[0]]=void 0),c};e.parseParams=function(c){return c.split(/;\s?/).reduce(a,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(c){return c.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(c){for(var A=[],d=c.split(" ").map(t),g=0;g<d.length;g+=3)A.push({component:d[g],ip:d[g+1],port:d[g+2]});return A},e.parseImageAttributes=function(c){return c.split(" ").map(function(A){return A.substring(1,A.length-1).split(",").reduce(a,{})})},e.parseSimulcastStreamList=function(c){return c.split(";").map(function(A){return A.split(",").map(function(d){var g,E=!1;return d[0]!=="~"?g=t(d):(g=t(d.substring(1,d.length)),E=!0),{scid:g,paused:E}})})}}),cL=jn((e,t)=>{var r=yv(),i=/%[sdv%]/g,n=function(d){var g=1,E=arguments,f=E.length;return d.replace(i,function(b){if(g>=f)return b;var w=E[g];switch(g+=1,b){case"%%":return"%";case"%s":return String(w);case"%d":return Number(w);case"%v":return""}})},a=function(d,g,E){var f=[d+"="+(g.format instanceof Function?g.format(g.push?E:E[g.name]):g.format)];if(g.names)for(var b=0;b<g.names.length;b+=1){var w=g.names[b];g.name?f.push(E[g.name][w]):f.push(E[g.names[b]])}else f.push(E[g.name]);return n.apply(null,f)},c=["v","o","s","i","u","e","p","c","b","t","r","z","a"],A=["i","c","b","a"];t.exports=function(d,g){g=g||{},d.version==null&&(d.version=0),d.name==null&&(d.name=" "),d.media.forEach(function(w){w.payloads==null&&(w.payloads="")});var E=g.outerOrder||c,f=g.innerOrder||A,b=[];return E.forEach(function(w){r[w].forEach(function(k){k.name in d&&d[k.name]!=null?b.push(a(w,k,d)):k.push in d&&d[k.push]!=null&&d[k.push].forEach(function(x){b.push(a(w,k,x))})})}),d.media.forEach(function(w){b.push(a("m",r.m[0],w)),f.forEach(function(k){r[k].forEach(function(x){x.name in w&&w[x.name]!=null?b.push(a(k,x,w)):x.push in w&&w[x.push]!=null&&w[x.push].forEach(function(Y){b.push(a(k,x,Y))})})})}),b.join(`\r
`)+`\r
`}}),lL=jn(e=>{var t=aL(),r=cL();e.write=r,e.parse=t.parse,e.parseParams=t.parseParams,e.parseFmtpConfig=t.parseFmtpConfig,e.parsePayloads=t.parsePayloads,e.parseRemoteCandidates=t.parseRemoteCandidates,e.parseImageAttributes=t.parseImageAttributes,e.parseSimulcastStreamList=t.parseSimulcastStreamList}),Tv=jn((e,t)=>{var r=t.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(i){return i.encoding?"rtpmap:%d %s/%s/%s":i.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(i){return i.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(i){return i.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(i){return"extmap:%d"+(i.direction?"/%s":"%v")+(i["encrypt-uri"]?" %s":"%v")+" %s"+(i.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(i){return i.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(i){var n="candidate:%s %d %s %d %s %d typ %s";return n+=i.raddr!=null?" raddr %s rport %d":"%v%v",n+=i.tcptype!=null?" tcptype %s":"%v",i.generation!=null&&(n+=" generation %d"),n+=i["network-id"]!=null?" network-id %d":"%v",n+=i["network-cost"]!=null?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(i){var n="ssrc:%d";return i.attribute!=null&&(n+=" %s",i.value!=null&&(n+=":%s")),n}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(i){return i.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(i){return i.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(i){return"imageattr:%s %s %s"+(i.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(i){return"simulcast:%s %s"+(i.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(i){return"ts-refclk:%s"+(i.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(i){var n="mediaclk:";return n+=i.id!=null?"id=%s %s":"%v%s",n+=i.mediaClockValue!=null?"=%s":"",n+=i.rateNumerator!=null?" rate=%s":"",n+=i.rateDenominator!=null?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(r).forEach(function(i){r[i].forEach(function(n){n.reg||(n.reg=/(.*)/),n.format||(n.format="%s")})})}),dL=jn(e=>{var t=function(c){return String(Number(c))===c?Number(c):c},r=function(c,A,d){var g=c.name&&c.names;c.push&&!A[c.push]?A[c.push]=[]:g&&!A[c.name]&&(A[c.name]={});var E=c.push?{}:g?A[c.name]:A;(function(f,b,w,k){if(k&&!w)b[k]=t(f[1]);else for(var x=0;x<w.length;x+=1)f[x+1]!=null&&(b[w[x]]=t(f[x+1]))})(d.match(c.reg),E,c.names,c.name),c.push&&A[c.push].push(E)},i=Tv(),n=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(c){var A={},d=[],g=A;return c.split(/(\r\n|\r|\n)/).filter(n).forEach(function(E){var f=E[0],b=E.slice(2);f==="m"&&(d.push({rtp:[],fmtp:[]}),g=d[d.length-1]);for(var w=0;w<(i[f]||[]).length;w+=1){var k=i[f][w];if(k.reg.test(b))return r(k,g,b)}}),A.media=d,A};var a=function(c,A){var d=A.split(/=(.+)/,2);return d.length===2?c[d[0]]=t(d[1]):d.length===1&&A.length>1&&(c[d[0]]=void 0),c};e.parseParams=function(c){return c.split(/;\s?/).reduce(a,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(c){return c.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(c){for(var A=[],d=c.split(" ").map(t),g=0;g<d.length;g+=3)A.push({component:d[g],ip:d[g+1],port:d[g+2]});return A},e.parseImageAttributes=function(c){return c.split(" ").map(function(A){return A.substring(1,A.length-1).split(",").reduce(a,{})})},e.parseSimulcastStreamList=function(c){return c.split(";").map(function(A){return A.split(",").map(function(d){var g,E=!1;return d[0]!=="~"?g=t(d):(g=t(d.substring(1,d.length)),E=!0),{scid:g,paused:E}})})}}),uL=jn((e,t)=>{var r=Tv(),i=/%[sdv%]/g,n=function(d){var g=1,E=arguments,f=E.length;return d.replace(i,function(b){if(g>=f)return b;var w=E[g];switch(g+=1,b){case"%%":return"%";case"%s":return String(w);case"%d":return Number(w);case"%v":return""}})},a=function(d,g,E){var f=[d+"="+(g.format instanceof Function?g.format(g.push?E:E[g.name]):g.format)];if(g.names)for(var b=0;b<g.names.length;b+=1){var w=g.names[b];g.name?f.push(E[g.name][w]):f.push(E[g.names[b]])}else f.push(E[g.name]);return n.apply(null,f)},c=["v","o","s","i","u","e","p","c","b","t","r","z","a"],A=["i","c","b","a"];t.exports=function(d,g){g=g||{},d.version==null&&(d.version=0),d.name==null&&(d.name=" "),d.media.forEach(function(w){w.payloads==null&&(w.payloads="")});var E=g.outerOrder||c,f=g.innerOrder||A,b=[];return E.forEach(function(w){r[w].forEach(function(k){k.name in d&&d[k.name]!=null?b.push(a(w,k,d)):k.push in d&&d[k.push]!=null&&d[k.push].forEach(function(x){b.push(a(w,k,x))})})}),d.media.forEach(function(w){b.push(a("m",r.m[0],w)),f.forEach(function(k){r[k].forEach(function(x){x.name in w&&w[x.name]!=null?b.push(a(k,x,w)):x.push in w&&w[x.push]!=null&&w[x.push].forEach(function(Y){b.push(a(k,x,Y))})})})}),b.join(`\r
`)+`\r
`}}),Sv=jn(e=>{var t=dL(),r=uL();e.write=r,e.parse=t.parse,e.parseParams=t.parseParams,e.parseFmtpConfig=t.parseFmtpConfig,e.parsePayloads=t.parsePayloads,e.parseRemoteCandidates=t.parseRemoteCandidates,e.parseImageAttributes=t.parseImageAttributes,e.parseSimulcastStreamList=t.parseSimulcastStreamList}),AL=lr(Lr()),vv=((Ee=vv||{})[Ee.INVALID_PARAMETER=4096]="INVALID_PARAMETER",Ee[Ee.INVALID_OPERATION=4097]="INVALID_OPERATION",Ee[Ee.NOT_SUPPORTED=4098]="NOT_SUPPORTED",Ee[Ee.DEVICE_NOT_FOUND=4099]="DEVICE_NOT_FOUND",Ee[Ee.INITIALIZE_FAILED=4100]="INITIALIZE_FAILED",Ee[Ee.SIGNAL_CHANNEL_SETUP_FAILED=16385]="SIGNAL_CHANNEL_SETUP_FAILED",Ee[Ee.SIGNAL_CHANNEL_ERROR=16386]="SIGNAL_CHANNEL_ERROR",Ee[Ee.ICE_TRANSPORT_ERROR=16387]="ICE_TRANSPORT_ERROR",Ee[Ee.JOIN_ROOM_FAILED=16388]="JOIN_ROOM_FAILED",Ee[Ee.CREATE_OFFER_FAILED=16389]="CREATE_OFFER_FAILED",Ee[Ee.SIGNAL_CHANNEL_RECONNECTION_FAILED=16390]="SIGNAL_CHANNEL_RECONNECTION_FAILED",Ee[Ee.UPLINK_RECONNECTION_FAILED=16391]="UPLINK_RECONNECTION_FAILED",Ee[Ee.DOWNLINK_RECONNECTION_FAILED=16392]="DOWNLINK_RECONNECTION_FAILED",Ee[Ee.REMOTE_STREAM_NOT_EXIST=16400]="REMOTE_STREAM_NOT_EXIST",Ee[Ee.CLIENT_BANNED=16448]="CLIENT_BANNED",Ee[Ee.SERVER_TIMEOUT=16449]="SERVER_TIMEOUT",Ee[Ee.SUBSCRIPTION_TIMEOUT=16450]="SUBSCRIPTION_TIMEOUT",Ee[Ee.PLAY_NOT_ALLOWED=16451]="PLAY_NOT_ALLOWED",Ee[Ee.DEVICE_AUTO_RECOVER_FAILED=16452]="DEVICE_AUTO_RECOVER_FAILED",Ee[Ee.START_PUBLISH_CDN_FAILED=16453]="START_PUBLISH_CDN_FAILED",Ee[Ee.STOP_PUBLISH_CDN_FAILED=16454]="STOP_PUBLISH_CDN_FAILED",Ee[Ee.START_MIX_TRANSCODE_FAILED=16455]="START_MIX_TRANSCODE_FAILED",Ee[Ee.STOP_MIX_TRANSCODE_FAILED=16456]="STOP_MIX_TRANSCODE_FAILED",Ee[Ee.NOT_SUPPORTED_H264=16457]="NOT_SUPPORTED_H264",Ee[Ee.SWITCH_ROLE_FAILED=16458]="SWITCH_ROLE_FAILED",Ee[Ee.API_CALL_TIMEOUT=16459]="API_CALL_TIMEOUT",Ee[Ee.SCHEDULE_FAILED=16460]="SCHEDULE_FAILED",Ee[Ee.API_CALL_ABORTED=16461]="API_CALL_ABORTED",Ee[Ee.SPC_INITIALIZED_FAILED=16462]="SPC_INITIALIZED_FAILED",Ee[Ee.UNKNOWN=65535]="UNKNOWN",Ee),se=vv,hL=class extends Error{constructor(e){let{name:t="RtcError",message:r,code:i=se.UNKNOWN,extraCode:n=0,constraint:a}=e,c="<".concat(function(d){for(let g in se)if(se[g]===d)return g;return"UNKNOWN"}(i)," 0x").concat(i.toString(16),">"),A="".concat(r).concat(a?" constraint: ".concat(a):"").concat(r!=null&&r.includes(c)?"":" ".concat(c));super(A),T(this,"code"),T(this,"extraCode"),T(this,"message"),T(this,"originMessage"),T(this,"name"),T(this,"constraint"),this.code=i,this.extraCode=n,this.name=t,this.message=A,this.constraint=a,this.originMessage=r}getCode(){return this.code}getExtraCode(){return this.extraCode}toString(){return this.originMessage}},pe=hL,RE=(new Date().getTime(),0),bE=function(){return new Date().getTime()+RE},Rv=function(){let e=new Date;return e.setTime(bE()),e.toLocaleString()},cn={};fd(cn,{bytes2ms:()=>eQ,convertObjectNumberToInt:()=>__,copyProperties:()=>ZL,deepClone:()=>Gd,deepMerge:()=>ha,delay:()=>I_,fibonacci:()=>jd,formatedTime:()=>dQ,getAbilityConfigUrl:()=>zL,getConstructorName:()=>E0,getContainerFromElement:()=>cQ,getEnv:()=>$L,getInternalVersion:()=>oQ,getLoggerUrl:()=>Fd,getMuteStateFromFlag:()=>Hd,getNetworkType:()=>h0,getNumNetworkType:()=>Fh,getReconnectionTimeout:()=>jc,getStringByteLength:()=>E_,getTurnServer:()=>aQ,getUint32Version:()=>T0,getValueType:()=>xr,getViewListFromView:()=>jh,glog:()=>rQ,ipv4ToUint32:()=>Vh,isArray:()=>pr,isAudioWorkletSupported:()=>nQ,isBoolean:()=>ei,isConstructor:()=>m_,isEmpty:()=>I0,isFunction:()=>mt,isLangChinese:()=>qo,isMediaStreamTrack:()=>iQ,isNumber:()=>qt,isObject:()=>$o,isOverseaSdkAppId:()=>Uh,isPlainObject:()=>Wn,isPortrait:()=>y0,isPromise:()=>p_,isRemoteTrack:()=>Zo,isString:()=>ut,isUndefined:()=>K,loadImage:()=>Hh,ms2bytes:()=>tQ,ms2samples:()=>f0,performanceNow:()=>He,promiseAny:()=>f_,samples2ms:()=>m0,setNetworkType:()=>p0,stringify:()=>Jn,stringifyIncludeValue:()=>C0,throttlePromise:()=>S0});var bv={};fd(bv,{AUDIO_MUTE_BIT:()=>QE,AUDIO_STAT_BIT:()=>yd,AUX_STAT_BIT:()=>Ih,AUX_STREAM_MSID:()=>Lv,BACKEND_ENV:()=>ME,BASE_DOC_URL:()=>na,BASE_HOST:()=>Dv,CAPABILITIES_KEYS:()=>jE,CLASS_NAME:()=>PL,CLOUD_CONSOLE_URL:()=>fL,DATA_FREEZE_TIMING:()=>UE,DOC_URL:()=>EL,DTLS_STATE_UNKNOWN:()=>Jo,ENV_NAME:()=>oa,EXCHANGE_SDP_TIMEOUT:()=>jv,INTERVAL:()=>vh,IS_WORKER:()=>_h,IS_WORKLET:()=>OE,KIBANA_EVENT:()=>Hn,LOCAL_STREAM_PUBLISH_STATE:()=>Hv,LOGGER_CMD_TYPE:()=>Id,LOGGER_DOMAIN:()=>Ov,LOGGER_DOMAIN_OVERSEA:()=>kv,LOG_LEVEL:()=>Wo,LOG_LEVEL_NAME:()=>LL,MAIN_STREAM_MSID:()=>Ch,MICROPHONE_COMMUNICATIONS:()=>ML,MICROPHONE_DEFAULT:()=>Sd,NAME:()=>O,NETWORK_TYPE:()=>BE,NOT_SUPPORTED_H264:()=>Th,PAUSED_RETRY_COUNT:()=>Gv,PEERCONNECTION_CONNECTING_TIMEOUT:()=>FE,PEER_CONNECTION_STATE:()=>Vt,PEER_LEAVE_REASON:()=>Yv,RAF:()=>VE,RECOVER_CAPTURE_INTERVAL:()=>Rd,REMOTE_STREAM_TYPE_AUX:()=>xv,REMOTE_STREAM_TYPE_MAIN:()=>Qv,RENDER_FREEZE_TIMING:()=>OL,RIC:()=>bd,SCHEDULE_DOMAIN:()=>un,SCHEDULE_TIMEOUT:()=>NL,SDP_SEMANTICS_PLAN_B:()=>yh,SDP_SEMANTICS_UNIFIED_PLAN:()=>Td,SECOND_HOST:()=>pL,SIGNAL_PING_PONG_INTERVAL:()=>IL,SIGNAL_PING_TIMEOUT:()=>_L,SIGNAL_RECONNECTION_COUNT:()=>wL,SMALL_STAT_BIT:()=>LE,SPEAKER_DEFAULT:()=>Sh,STORAGE_EXPIRES_TIME:()=>Nv,STREAM_TYPE_BIG:()=>kL,STREAM_TYPE_SMALL:()=>BL,SUBSCRIBE_SMALL_RETRY_COUNT:()=>vd,SYNC_USER_LIST_INTERVAL:()=>DL,Scene:()=>Mv,Switch:()=>Pv,THIRD_HOST:()=>mL,TIMEOUT:()=>wd,TRANSPORT_DIRECTION:()=>$e,TRTC_ERROR_ASSISTANCE:()=>Bv,TRTC_QUALITY_BAD:()=>vL,TRTC_QUALITY_DISCONNECTED:()=>bL,TRTC_QUALITY_EXCELLENT:()=>yL,TRTC_QUALITY_GOOD:()=>TL,TRTC_QUALITY_POOR:()=>SL,TRTC_QUALITY_UNKNOWN:()=>CL,TRTC_QUALITY_VERY_BAD:()=>RL,UPDATE_OFFER_TIMEOUT:()=>Vv,VIDEO_MUTE_BIT:()=>xE,VIDEO_STAT_BIT:()=>Cd,audioProfileMap:()=>NE,getRetryCount:()=>Lc,getScriptDir:()=>gL,innerVersion:()=>wE,loggerProxy:()=>kE,screenProfileMap:()=>PE,setLoggerProxy:()=>_d,setRetryCount:()=>Fv,setVersion:()=>wv,version:()=>ln,videoProfileMap:()=>dn});var wE="4.15.00.1600",ln="5.0.0";function wv(e){ln=e;let[t,r,i]=e.split(".").map(n=>parseInt(n,10));wE="".concat(t,".").concat(Math.min(15,r),".").concat(Math.min(15,i),".").concat(r.toString().padStart(2,"0")).concat(i.toString().padStart(2,"0"))}var DE,Ed,Zr,_h=typeof importScripts<"u",OE=typeof registerProcessor<"u",gL=()=>{let e=_h?self.location.href:document.currentScript.src;return e.substring(0,e.lastIndexOf("/")+1)},kE="",_d=e=>kE=e,Dv="web.sdk.qcloud.com",pL="web.sdk.tencent.cn",mL="web.sdk.cloud.tencent.cn",fL="https://console.cloud.tencent.com/trtc",na="https://".concat(Dv,"/trtc/webrtc/v5/doc"),EL="".concat(na,"/zh-cn/"),Ov="https://yun.tim.qq.com",kv="https://apisgp.my-imcloud.com",Bv="trtc_error_assistance",Id={LOG:"jssdk_log",EVENT:"jssdk_event",KEY_POINT:"jssdk_new_endreport",KV_STAT:"jssdk_key_metrics_report"},oa={QCLOUD:"qcloud",OLD_CLOUD_LADDER:"trtc",WEBRTC:"webrtc"},Wo=((Zr=Wo||{})[Zr.TRACE=0]="TRACE",Zr[Zr.DEBUG=1]="DEBUG",Zr[Zr.INFO=2]="INFO",Zr[Zr.WARN=3]="WARN",Zr[Zr.ERROR=4]="ERROR",Zr[Zr.NONE=5]="NONE",Zr),_L=18e3,IL=2e3,BE={unknown:0,wifi:1,"3g":2,"2g":3,"4g":4,wired:5,"5g":6},Nv=6048e5,Pv=((Ed=Pv||{}).USEAINS="useAINS",Ed.ENABLEDEBUG="enableDebug",Ed.USEV2="useV2",Ed.USEWT="useWt",Ed),NE={standard:{sampleRate:48e3,channelCount:1,bitrate:40},"standard-stereo":{sampleRate:48e3,channelCount:2,bitrate:64},high:{sampleRate:48e3,channelCount:1,bitrate:128},"high-stereo":{sampleRate:48e3,channelCount:2,bitrate:192}},dn={"120p":{width:160,height:120,frameRate:15,bitrate:200},"120p_2":{width:160,height:120,frameRate:15,bitrate:100},"180p":{width:320,height:180,frameRate:15,bitrate:350},"180p_2":{width:320,height:180,frameRate:15,bitrate:150},"240p":{width:320,height:240,frameRate:15,bitrate:400},"240p_2":{width:320,height:240,frameRate:15,bitrate:200},"360p":{width:640,height:360,frameRate:15,bitrate:800},"360p_2":{width:640,height:360,frameRate:15,bitrate:400},"480p":{width:640,height:480,frameRate:15,bitrate:900},"480p_2":{width:640,height:480,frameRate:15,bitrate:500},"720p":{width:1280,height:720,frameRate:15,bitrate:1500},"1080p":{width:1920,height:1080,frameRate:15,bitrate:2e3},"1440p":{width:2560,height:1440,frameRate:30,bitrate:4860},"4K":{width:3840,height:2160,frameRate:30,bitrate:9e3}},PE={"480p":{width:640,height:480,frameRate:5,bitrate:900},"480p_2":{width:640,height:480,frameRate:30,bitrate:1e3},"720p":{width:1280,height:720,frameRate:5,bitrate:1200},"720p_2":{width:1280,height:720,frameRate:30,bitrate:3e3},"1080p":{width:1920,height:1080,frameRate:5,bitrate:1600},"1080p_2":{width:1920,height:1080,frameRate:30,bitrate:4e3}},O={CANVAS:"canvas",AUDIO:"audio",VIDEO:"video",SCREEN:"screen",SMALL:"small",BIG:"big",AUXILIARY:"auxiliary",SMALL_VIDEO:"smallVideo",FACING_MODE_USER:"user",FACING_MODE_ENVIRONMENT:"environment",MUTE:"mute",UNMUTE:"unmute",ENDED:"ended",PLAYING:"playing",PAUSE:"pause",ERROR:"error",LOADEDDATA:"loadeddata",AUDIO_INPUT:"audioinput",VIDEO_INPUT:"videoinput",DETAIL:"detail",TEXT:"text",MAIN:"main",BACKUP:"backup",BANNED:"banned",KICK:"kick",USER_TIME_OUT:"user_time_out",ROOM_DISBAND:"room_disband",SEI_MESSAGE:"sei-message",ADD:"add",REMOVE:"remove",REPLACE:"replace",TRACK:"track",SUBSCRIBE:"subscribe",UNSUBSCRIBE:"unsubscribe",TRANSCEIVER_DIRECTION_SENDONLY:"sendonly",TRANSCEIVER_DIRECTION_RECVONLY:"recvonly",ENTER_PICTURE_IN_PICTURE:"enterpictureinpicture",LEAVE_PICTURE_IN_PICTURE:"leavepictureinpicture"},$e={INACTIVE:"inactive",SENDONLY:"sendonly",RECVONLY:"recvonly"},ME={OLD_CLOUD_LADDER:"wss://trtc.rtc.qq.com",WEBRTC:"wss://webrtc.qq.com"},Mv=((DE=Mv||{}).LIVE="live",DE.RTC="rtc",DE),Cd=1,LE=2,Ih=4,yd=8,QE=64,xE=16,Ch="5Y2wZK8nANNAoVw6dSAHVjNxrD1ObBM2kBPV",Lv="224d130c-7b5c-415b-aaa2-79c2eb5a6df2",Qv=O.MAIN,xv=O.AUXILIARY,CL=0,yL=1,TL=2,SL=3,vL=4,RL=5,bL=6,Jo="unknown",Vt={NEW:"new",CONNECTING:"connecting",FAILED:"failed",CLOSED:"closed",DISCONNECTED:"disconnected",CONNECTED:"connected",COMPLETED:"completed"},Uv=1/0;function Fv(e){Uv=e}function Lc(){return Uv}var sa,wL=30,Hn={JOIN:"join",DELTA_JOIN:"delta-join",REJOIN:"rejoin",LEAVE:"leave",DELTA_LEAVE:"delta-leave",PUBLISH:"publish",DELTA_PUBLISH:"delta-publish",UNPUBLISH:"unpublish",SUBSCRIBE:"subscribe",UNSUBSCRIBE:"unsubscribe",UPLINK_CONNECTION:"uplink-connection",UPLINK_RECONNECTION:"uplink-reconnection",DOWNLINK_CONNECTION:"downlink-connection",DOWNLINK_RECONNECTION:"downlink-reconnection",ON_TRACK:"ontrack",ICE_CONNECTION_STATE:"iceConnectionState",LOCAL_STREAM_INITIALIZE:"stream-initialize",SIGNAL_CONNECTION:"websocketConnectionState",SIGNAL_RECONNECTION:"websocketReconnectionState",UPDATE_STREAM:"update-stream",RECOVER_LOCAL_AUDIO_TRACK:"recover-local-audio-track",RECOVER_LOCAL_VIDEO_TRACK:"recover-local-video-track",RECOVER_SUBSCRIPTION:"recover-subscription",START_MIX_TRANSCODE:"start-mix-transcode",STOP_MIX_TRANSCODE:"stop-mix-transcode",PLAYER_ERROR:"player-error",SCHEDULE:"schedule",LOAD_WORKLET:"load-worklet",VIDEO_FROZEN_COUNT:"videoFrozenCount",GET_USER_MEDIA_RETRY:"getUserMedia-retry"},DL=1e4,Vv=1e4,jv=1e4,Td="unified-plan",yh="plan-b",Th=1028,Hv=((sa=Hv||{})[sa.UNPUBLISH=-1]="UNPUBLISH",sa[sa.PUBLISHING=0]="PUBLISHING",sa[sa.PUBLISHED=1]="PUBLISHED",sa),UE=500,OL=1e3,kL=O.BIG,BL=O.SMALL,FE=1e4,un={MAIN:"schedule.cloud-rtc.com",BACKUP:"schedule.rtc.qcloud.com",MAIN_OVERSEA:"schedule.rtc-web.com",BACKUP_OVERSEA:"schedule.rtc-web.io",MAIN_OVERSEA_OLD:"schedule.rtc.tencentcloud.com",BACKUP_OVERSEA_OLD:"schedule-ecdn.rtc.tencentcloud.com"},NL=2e3,PL={TRTC:"TRTC",CLIENT:"Client",LOCAL_STREAM:"LocalStream",REMOTE_STREAM:"RemoteStream",STREAM:"Stream"},Gv=5,Sd="default",Sh=Sd,ML="communications",LL=Object.keys(Wo),Yv=["normal leave","timeout leave","kick","role change"],vd=10,Rd=2e3,bd="ric",VE="raf",vh="interval",wd="timeout",jE=["width","height","frameRate","facingMode","sampleRate","sampleSize","channelCount","deviceId","min","max"];function Dd(e){let{url:t,body:r,method:i,timeout:n}=e,a=new XMLHttpRequest;return new Promise((c,A)=>{a.onreadystatechange=()=>{if(a.readyState===4)if(a.status>=200&&a.status<300)try{let d=JSON.parse(a.response);c({data:d})}catch{c({data:a.response})}else A({status:a.status,statusText:a.statusText||"request failed!"})},a.timeout=n||5e3,a.open(i||"POST",t,!0),a.send(r)})}function Wv(e){return N(this,null,function*(){let t=He(),r=JSON.stringify(e);try{if(!CompressionStream||r.length<=2800)return r;let i=new Blob([r],{type:"application/json"}).stream().pipeThrough(new CompressionStream("gzip")),n=yield(yield(yield new Response(i)).blob()).arrayBuffer();return ae.debug("compressJSON ".concat(r.length," -> ").concat(n.byteLength," ").concat(He()-t,"ms")),n}catch{return r}})}var Ko=1e8,xe={AVOID_REPEATED_CALL:"AVOID_REPEATED_CALL",INVALID_PARAMETER_REQUIRED:"INVALID_PARAMETER_REQUIRED",INVALID_PARAMETER_TYPE:"INVALID_PARAMETER_TYPE",INVALID_PARAMETER_EMPTY:"INVALID_PARAMETER_EMPTY",INVALID_PARAMETER_INSTANCE:"INVALID_PARAMETER_INSTANCE",INVALID_PARAMETER_RANGE:"INVALID_PARAMETER_RANGE",INVALID_PARAMETER_MIN:"INVALID_PARAMETER_MIN",INVALID_PARAMETER_MAX:"INVALID_PARAMETER_MAX",INVALID_PARAMETER_STREAMTYPE:"INVALID_PARAMETER_STREAMTYPE",API_CALL_TIMEOUT:"API_CALL_TIMEOUT",SIGNAL_CHANNEL_RECONNECTION_FAILED:"SIGNAL_CHANNEL_RECONNECTION_FAILED",SIGNAL_CHANNEL_SETUP_FAILED:"SIGNAL_CHANNEL_SETUP_FAILED",ERROR_MESSAGE:"ERROR_MESSAGE",EXCHANGE_SDP_TIMEOUT:"EXCHANGE_SDP_TIMEOUT",DOWNLINK_RECONNECTION_FAILED:"DOWNLINK_RECONNECTION_FAILED",EXCHANGE_SDP_FAILED:"EXCHANGE_SDP_FAILED",UPDATE_OFFER_TIMEOUT:"UPDATE_OFFER_TIMEOUT",UPLINK_RECONNECTION_FAILED:"UPLINK_RECONNECTION_FAILED",INVALID_RECORDID:"INVALID_RECORDID",INVALID_PURE_AUDIO:"INVALID_PURE_AUDIO",INVALID_STREAMID:"INVALID_STREAMID",INVALID_USER_DEFINE_RECORDID:"INVALID_USER_DEFINE_RECORDID",INVALID_USER_DEFINE_PUSH_ARGS:"INVALID_USER_DEFINE_PUSH_ARGS",INVALID_PROXY:"INVALID_PROXY",INVALID_JOIN:"INVALID_JOIN",INVALID_ROOMID_STRING:"INVALID_ROOMID_STRING",INVALID_ROOMID_INTEGER:"INVALID_ROOMID_INTEGER",INVALID_SIGNAL_CHANNEL:"INVALID_SIGNAL_CHANNEL",JOIN_ROOM_TIMEOUT:"JOIN_ROOM_TIMEOUT",JOIN_ROOM_FAILED:"JOIN_ROOM_FAILED",REJOIN_ROOM_FAILED:"REJOIN_ROOM_FAILED",INVALID_DESTROY:"INVALID_DESTROY",INVALID_PUBLISH:"INVALID_PUBLISH",INVALID_UNPUBLISH:"INVALID_UNPUBLISH",INVALID_AUDIENCE:"INVALID_AUDIENCE",INVALID_INITIALIZE:"INVALID_INITIALIZE",INVALID_DUPLICATE_PUBLISHING:"INVALID_DUPLICATE_PUBLISHING",INVALID_SUBSCRIBE_UNDEFINED:"INVALID_SUBSCRIBE_UNDEFINED",INVALID_SUBSCRIBE_LOCAL:"INVALID_SUBSCRIBE_LOCAL",INVALID_REMOTE_STREAM:"INVALID_REMOTE_STREAM",SUBSCRIBE_FAILED:"SUBSCRIBE_FAILED",INVALID_ROLE:"INVALID_ROLE",INVALID_PARAMETER_SWITCH_ROLE:"INVALID_PARAMETER_SWITCH_ROLE",INVALID_OPERATION_SWITCH_ROLE:"INVALID_OPERATION_SWITCH_ROLE",SWITCH_ROLE_TIMEOUT:"SWITCH_ROLE_TIMEOUT",SWITCH_ROLE_FAILED:"SWITCH_ROLE_FAILED",CLIENT_BANNED:"CLIENT_BANNED",INVALID_OPERATION_START_PUBLISH_CDN:"INVALID_OPERATION_START_PUBLISH_CDN",INVALID_OPERATION_STOP_PUBLISH_CDN:"INVALID_OPERATION_STOP_PUBLISH_CDN",INVALID_STREAM_ID:"INVALID_STREAM_ID",START_PUBLISH_CDN_FAILED:"START_PUBLISH_CDN_FAILED",STOP_PUBLISH_CDN_FAILED:"STOP_PUBLISH_CDN_FAILED",START_MIX_TRANSCODE:"START_MIX_TRANSCODE",STOP_MIX_TRANSCODE:"STOP_MIX_TRANSCODE",INVALID_AUDIO_VOLUME:"INVALID_AUDIO_VOLUME",ENABLE_SMALL_STREAM_PUBLISHED:"ENABLE_SMALL_STREAM_PUBLISHED",DISABLE_SMALL_STREAM_PUBLISHED:"DISABLE_SMALL_STREAM_PUBLISHED",NOT_SUPPORTED_SMALL_STREAM:"NOT_SUPPORTED_SMALL_STREAM",INVALID_SMALL_STREAM_PROFILE:"INVALID_SMALL_STREAM_PROFILE",INVALID_PARAMETER_REMOTE_STREAM:"INVALID_PARAMETER_REMOTE_STREAM",INVALID_OPERATION_CHANGE_SMALL:"INVALID_OPERATION_CHANGE_SMALL",REMOTE_NOT_PUBLISH_SMALL_STREAM:"REMOTE_NOT_PUBLISH_SMALL_STREAM",INVALID_SWITCH_DEVICE:"INVALID_SWITCH_DEVICE",INVALID_SWITCH_DEVICE_PUBLISHING:"INVALID_SWITCH_DEVICE_PUBLISHING",INVALID_REPLACE_TRACK:"INVALID_REPLACE_TRACK",INVALID_INITIALIZE_LOCAL_STREAM:"INVALID_INITIALIZE_LOCAL_STREAM",INVALID_ADD_TRACK_REPETITIVE:"INVALID_ADD_TRACK_REPETITIVE",INVALID_ADD_TRACK_REMOVING:"INVALID_ADD_TRACK_REMOVING",INVALID_ADD_TRACK_PUBLISHING:"INVALID_ADD_TRACK_PUBLISHING",INVALID_STREAM_INITIALIZED:"INVALID_STREAM_INITIALIZED",INVALID_ADD_TRACK_NUMBER:"INVALID_ADD_TRACK_NUMBER",INVALID_REMOVE_AUDIO_TRACK:"INVALID_REMOVE_AUDIO_TRACK",INVALID_REMOVE_AUDIO_ADDING:"INVALID_REMOVE_AUDIO_ADDING",INVALID_REMOVE_AUDIO_ON:"INVALID_REMOVE_AUDIO_ON",INVALID_REMOVE_TRACK_PUBLISHING:"INVALID_REMOVE_TRACK_PUBLISHING",INVALID_REMOVE_TRACK_NOT_TRACK:"INVALID_REMOVE_TRACK_NOT_TRACK",INVALID_REMOVE_TRACK_NUMBER:"INVALID_REMOVE_TRACK_NUMBER",INVALID_REPLACE_TRACK_NO_TRACK:"INVALID_REPLACE_TRACK_NO_TRACK",REPEAT_JOIN:"REPEAT_JOIN",CLIENT_DESTROYED:"CLIENT_DESTROYED",NOT_BUG_PACKAGE:"NOT_BUG_PACKAGE",START_MIX_TRANSCODE_FAILED:"START_MIX_TRANSCODE_FAILED",STOP_MIX_TRANSCODE_FAILED:"STOP_MIX_TRANSCODE_FAILED",MIX_TRANSCODE_NOT_STARTED:"MIX_TRANSCODE_NOT_STARTED",CANNOT_LESS_THAN_ZERO:"CANNOT_LESS_THAN_ZERO",MIX_PARAMS_VIDEO_FRAMERATE:"MIX_PARAMS_VIDEO_FRAMERATE",MIX_PARAMS_VIDEO_GOP:"MIX_PARAMS_VIDEO_GOP",MIX_PARAMS_AUDIO_BITRATE:"MIX_PARAMS_AUDIO_BITRATE",MIX_PARAMS_USER_Z_ORDER:"MIX_PARAMS_USER_Z_ORDER",MIX_PARAMS_NOT_SELF:"MIX_PARAMS_NOT_SELF",MIX_PARAMS_USER_STREAM:"MIX_PARAMS_USER_STREAM",INVALID_PLAY:"INVALID_PLAY",INVALID_ELEMENT_ID:"INVALID_ELEMENT_ID",INVALID_ELEMENT_ID_TYPE:"INVALID_ELEMENT_ID_TYPE",PLAY_FAILED:"PLAY_FAILED",INVALID_USERID:"INVALID_USERID",INVALID_CREATE_STREAM_SOURCE:"INVALID_CREATE_STREAM_SOURCE",INVALID_CREATE_STREAM_SCREEN:"INVALID_CREATE_STREAM_SCREEN",INVALID_CREATE_STREAM_AUDIO:"INVALID_CREATE_STREAM_AUDIO",INVALID_CREATE_STREAM_SCREEN_AUDIO:"INVALID_CREATE_STREAM_SCREEN_AUDIO",NOT_SUPPORTED_HTTP:"NOT_SUPPORTED_HTTP",NOT_SUPPORTED_WEBRTC:"NOT_SUPPORTED_WEBRTC",NOT_SUPPORTED_PROFILE:"NOT_SUPPORTED_PROFILE",NOT_SUPPORTED_MEDIA:"NOT_SUPPORTED_MEDIA",NOT_SUPPORTED_H264ENCODE:"NOT_SUPPORTED_H264ENCODE",NOT_SUPPORTED_H264DECODE:"NOT_SUPPORTED_H264DECODE",NOT_SUPPORTED_TRACK:"NOT_SUPPORTED_TRACK",NOT_SUPPORTED_SWITCH_DEVICE:"NOT_SUPPORTED_SWITCH_DEVICE",NOT_SUPPORTED_CAPTURE:"NOT_SUPPORTED_CAPTURE",NOT_SUPPORTED_AUX:"NOT_SUPPORTED_AUX",MICROPHONE_NOT_FOUND:"MICROPHONE_NOT_FOUND",CAMERA_NOT_FOUND:"CAMERA_NOT_FOUND",SIGNAL_RESPONSE_FAILED:"SIGNAL_RESPONSE_FAILED",CATCH_HANDLER_ERROR:"CATCH_HANDLER_ERROR",API_NOT_EXIST:"API_NOT_EXIST",CONNECTION_CLOSED:"CONNECTION_CLOSED",SUBSCRIBE_ALL_FALSE:"SUBSCRIBE_ALL_FALSE",SEI_NOT_SUPPORT:"SEI_NOT_SUPPORT",SEI_DISABLED:"SEI_DISABLED",SEI_BEFORE_PUBLISH:"SEI_BEFORE_PUBLISH",SEI_NOT_VIDEO:"SEI_NOT_VIDEO",CALL_FREQUENCY_LIMIT:"CALL_FREQUENCY_LIMIT",CONNECTION_ABORTED:"CONNECTION_ABORTED",API_CALL_ABORTED:"API_CALL_ABORTED",DUPLICATE_AUX:"DUPLICATE_AUX"},xi={AVOID_REPEATED_CALL:e=>"previous ".concat(e.name,"() is ongoing, please avoid repeated calls."),INVALID_PARAMETER_REQUIRED(e){let{key:t,rule:r,fnName:i,value:n}=e;return"'".concat(t||r.name,"' is a required param when calling ").concat(i,"(), received: ").concat(n,".")},INVALID_PARAMETER_TYPE(e){let{key:t,rule:r,fnName:i,value:n}=e,a="".concat(t||r.name),c="";return c=Array.isArray(r.type)?r.type.join("|"):r.type,"'".concat(a,"' must be type of ").concat(c," when calling ").concat(i,"(), received type: ").concat(xr(n),".")},INVALID_PARAMETER_EMPTY(e){let{key:t,rule:r,fnName:i,value:n}=e;return"'".concat(t||r.name,"' cannot be '").concat(n,"' when calling ").concat(i,"().")},INVALID_PARAMETER_INSTANCE(e){let{key:t,rule:r,fnName:i,value:n}=e,a="".concat(t||r.name),c="".concat(r.instanceOf.name||r.instanceOf);return"'".concat(a,"' must be instanceof ").concat(c," when calling ").concat(i,"(), received type: ").concat(xr(n),".")},INVALID_PARAMETER_RANGE(e){let{key:t,rule:r,fnName:i,value:n}=e;return"'".concat(t||r.name,"' must be one of ").concat(r.values.join("|")," when calling ").concat(i,"(), received: ").concat(n,".")},INVALID_PARAMETER_MIN(e){let{key:t,rule:r,fnName:i,value:n}=e;return"the min value of ".concat(t||r.name," is ").concat(r.min,", received: ").concat(n,".")},INVALID_PARAMETER_MAX(e){let{key:t,rule:r,fnName:i,value:n}=e;return"the max value of ".concat(t||r.name," is ").concat(r.max,", received: ").concat(n,".")},API_CALL_TIMEOUT:e=>"".concat(e.commandDesc||e.command," timeout observed."),SIGNAL_CHANNEL_RECONNECTION_FAILED:"signal channel reconnection failed, please check your network.",SIGNAL_CHANNEL_SETUP_FAILED:e=>"SignalChannel setup failure: (errorCode: ".concat(e.errorCode,", errorMsg: ").concat(e.errorMsg," })."),ERROR_MESSAGE(e){let t="".concat(e.type," failed");return e.message&&(t="".concat(t,": ").concat(e.message,".")),t},EXCHANGE_SDP_TIMEOUT:"exchange sdp timeout.",DOWNLINK_RECONNECTION_FAILED:"downlink reconnection failed, please check your network and re-join room.",EXCHANGE_SDP_FAILED:e=>"exchange sdp failed ".concat(e.errMsg,"."),UPDATE_OFFER_TIMEOUT:"update offer timeout observed.",UPLINK_RECONNECTION_FAILED:"uplink reconnection failed, please check your network and publish again.",INVALID_RECORDID:"recordId must be an integer number.",INVALID_PURE_AUDIO:"pureAudioPushMode must be 1 or 2.",INVALID_STREAMID:"streamId must be a sting literal within 64 bytes, and not be empty.",INVALID_USER_DEFINE_RECORDID:"userDefineRecordId must be a sting literal contains (a-zA-Z),(0-9), underline and hyphen, within 64 bytes, and not be empty.",INVALID_USER_DEFINE_PUSH_ARGS:"userDefinePushArgs must be a sting literal within 256 bytes, and not be empty.",INVALID_PROXY:'proxy server url must start with "wss://".',INVALID_JOIN:"duplicate join() called.",INVALID_ROOMID_STRING:e=>"'".concat(e,"' must be validate string when useStringRoomId is true."),INVALID_ROOMID_INTEGER:e=>"'".concat(e,"' must be an integer between [1, 4294967294] when useStringRoomId is false."),INVALID_SIGNAL_CHANNEL:"SignalChannel is not ready yet.",JOIN_ROOM_TIMEOUT:"join room timeout.",JOIN_ROOM_FAILED(e){let{error:t,code:r}=e;return"Failed to join room - ".concat(t," code: ").concat(r)},REJOIN_ROOM_FAILED:e=>"reJoin room: ".concat(e.roomId," failed, please check your network."),INVALID_DESTROY:"please call leave() before destroy().",INVALID_PUBLISH:"please call join() before publish().",INVALID_UNPUBLISH:"stream has not been published yet.",INVALID_AUDIENCE:"no permission to publish() under live/".concat("audience",', please call switchRole("',"anchor",'") firstly before publish().'),INVALID_INITIALIZE:"cannot publish stream because stream is not initialized, is switching device, or has been closed.",INVALID_DUPLICATE_PUBLISHING:e=>"duplicate ".concat(e," stream publishing, please unpublish your prev ").concat(e," stream and then re-publish."),INVALID_SUBSCRIBE_UNDEFINED:"stream is undefined or null.",INVALID_SUBSCRIBE_LOCAL:"stream cannot be LocalStream.",INVALID_REMOTE_STREAM:"remoteStream does not exist because it has been unpublished by remote peer.",SUBSCRIBE_FAILED(e){let{message:t,userId:r,streamType:i}=e;return"failed to subscribe ".concat(r," ").concat(i," stream, reason: ").concat(t,".")},INVALID_ROLE:"switchRole can only be called in live mode.",INVALID_PARAMETER_SWITCH_ROLE:"role could only be set to a value as ".concat("anchor"," or ","audience","."),INVALID_OPERATION_SWITCH_ROLE:"please call join() before switchRole().",SWITCH_ROLE_TIMEOUT:"switchRole timeout.",SWITCH_ROLE_FAILED:e=>"switchRole failed, errCode: ".concat(e.code," errMsg: ").concat(e.message,"."),CLIENT_BANNED:e=>"client was banned because of ".concat(e.message,"."),INVALID_OPERATION_START_PUBLISH_CDN:"please call startPublishCDNStream() after join room and publish the local stream.",INVALID_OPERATION_STOP_PUBLISH_CDN:"please call startPublishCDNStream() before stopPublishCDNStream().",START_PUBLISH_CDN_FAILED:e=>"startPublishCDNStream failed, errMsg: ".concat(e.message,"."),STOP_PUBLISH_CDN_FAILED:e=>"stopPublishCDNStream failed, errMsg: ".concat(e.message,"."),INVALID_STREAM_ID:e=>"'".concat(e,"' can only consist of uppercase and lowercase english letters (a-zA-Z), numbers (0-9), hyphens and underscores."),START_MIX_TRANSCODE:"please call startMixTranscode() after join().",STOP_MIX_TRANSCODE:"please call stopMixTranscode() after startMixTranscode().",INVALID_AUDIO_VOLUME:"interval must be a number.",ENABLE_SMALL_STREAM_PUBLISHED:"Cannot enable small stream after localStream published.",DISABLE_SMALL_STREAM_PUBLISHED:"Cannot disable small stream after localStream published.",NOT_SUPPORTED_SMALL_STREAM:"your browser does not support opening small stream.",INVALID_SMALL_STREAM_PROFILE:"small stream profile is invalid.",INVALID_PARAMETER_REMOTE_STREAM:"remoteStream is invalid.",INVALID_OPERATION_CHANGE_SMALL:"cannot switch to the small stream without subscribing to the video of remoteStream.",REMOTE_NOT_PUBLISH_SMALL_STREAM:"remote peer does not publish small stream.",INVALID_SWITCH_DEVICE:"cannot switch device on current stream.",INVALID_SWITCH_DEVICE_PUBLISHING:"cannot switch device when publishing localStream.",INVALID_REPLACE_TRACK:"cannot replace track when publishing localStream.",INVALID_INITIALIZE_LOCAL_STREAM:"local stream has not initialized yet.",INVALID_ADD_TRACK_REPETITIVE:"previous addTrack is ongoing, please avoid repetitive execution.",INVALID_ADD_TRACK_REMOVING:"cannot add track when a track is removing.",INVALID_ADD_TRACK_PUBLISHING:"cannot add track when publishing localStream.",INVALID_STREAM_INITIALIZED:"your local stream haven't been initialized yet.",INVALID_ADD_TRACK_NUMBER:"a Stream has at most one audio track and one video track.",INVALID_REMOVE_AUDIO_TRACK:"remove audio track is not supported on your browser.",INVALID_REMOVE_AUDIO_ADDING:"cannot remove track when a track is adding.",INVALID_REMOVE_AUDIO_ON:"previous removeTrack is ongoing, please avoid repetitive execution.",INVALID_REMOVE_TRACK_PUBLISHING:"cannot remove track when publishing localStream.",INVALID_REMOVE_TRACK_NOT_TRACK:"localStream has not this track.",INVALID_REMOVE_TRACK_NUMBER:"remove the only video track is not supported, please use replaceTrack or muteVideo.",INVALID_REPLACE_TRACK_NO_TRACK:e=>"cannot replace ".concat(e.kind," track because stream has not ").concat(e.kind," track"),NOT_BUG_PACKAGE:"You need to buy packages, refer to tencent console.",START_MIX_TRANSCODE_FAILED:e=>"startMixTranscode failed, errMsg: ".concat(e.message,"."),STOP_MIX_TRANSCODE_FAILED:e=>"stopMixTranscode failed, errMsg: ".concat(e.message,"."),MIX_TRANSCODE_NOT_STARTED:"mixTranscode has not been started.",CANNOT_LESS_THAN_ZERO(e){let{key:t,rule:r,fnName:i,value:n}=e;return"'".concat(t||r.name,"' cannot be less than 0 when calling ").concat(i,"().")},MIX_PARAMS_VIDEO_FRAMERATE:"'config.videoFramerate' should be an integer between 0 and 30, excluding 0.",MIX_PARAMS_VIDEO_GOP:"'config.videoGOP' should be an integer between 1 and 8.",MIX_PARAMS_AUDIO_BITRATE:"'config.audioBitrate' should be an integer between 32 and 192.",MIX_PARAMS_USER_Z_ORDER:e=>"'".concat(e,"' is required and must be between 1 and 15."),MIX_PARAMS_NOT_SELF:"'config.mixUsers' must contain self.",MIX_PARAMS_USER_STREAM:"'config.videoWidth' and 'config.videoHeight' of output stream should be contain all mix stream.",INVALID_PLAY:"duplicate play() call observed, please stop() firstly.",INVALID_ELEMENT_ID:e=>{let{key:t,fnName:r}=e;return"'".concat(t,"' is not found in the document object when calling ").concat(r,"().")},INVALID_ELEMENT_ID_TYPE:e=>{let{key:t,fnName:r,type:i}=e;return"the element corresponding to '".concat(t,"' must be instanceof HTMLElement when calling ").concat(r,"(), received: ").concat(i,".")},PLAY_FAILED:e=>"".concat(e.media," play failedï¼browser exception: ").concat(e.error.toString()),INVALID_USERID:"userId cannot be all spaces.",INVALID_CREATE_STREAM_SOURCE:"LocalStream must be created by createStream() with either audio/video or audioSource/videoSource, but can not be mixed with audio/video and audioSource/videoSource.",INVALID_CREATE_STREAM_SCREEN:"screen/video cannot be both true.",INVALID_CREATE_STREAM_AUDIO:"audio/screenAudio cannot be both true.",INVALID_CREATE_STREAM_SCREEN_AUDIO:"when screen is true, screenAudio can be configured.",NOT_SUPPORTED_HTTP:"http protocol does not support the ability to capture microphone, camera and screen. please use https to deploy your page.",NOT_SUPPORTED_WEBRTC:"your browser or environment does not support full WebRTC capabilities.",NOT_SUPPORTED_PROFILE:"your browser does not support setVideoProfile.",NOT_SUPPORTED_MEDIA:"your browser or environment does not support navigator.mediaDevices.",NOT_SUPPORTED_H264ENCODE:"your device does not support H.264 encoding.",NOT_SUPPORTED_H264DECODE:"your device does not support H.264 decoding.",NOT_SUPPORTED_TRACK:e=>"".concat(e,"Track is not supported on your browser."),NOT_SUPPORTED_SWITCH_DEVICE:"switchDevice is not supported on your browser.",NOT_SUPPORTED_CAPTURE:"Your browser or environment does not support screen sharing, please check whether the browser version.",MICROPHONE_NOT_FOUND:"no microphone detected, please check your microphone.",CAMERA_NOT_FOUND:"no camera detected, please check your camera.",SIGNAL_RESPONSE_FAILED:e=>"".concat(e.signalResponse," failed, response code is ").concat(e.code," , errMsg: ").concat(e.message,"."),CATCH_HANDLER_ERROR(e){let{name:t,event:r}=e;return"an error was caught in ".concat(t,".on('").concat(r,"', handler), please check your code in 'handler'.")},API_NOT_EXIST(e){let{name:t}=e;return"experimental api ".concat(t," does not exist.")},REPEAT_JOIN:e=>"[".concat(e,"] is calling client.join api or has already joined room, please avoid repeated join."),CONNECTION_CLOSED:"remoteStream has been unsubscribed or unpublished by remote user.",SUBSCRIBE_ALL_FALSE:"cannot subscribe when both audio & video are false, use client.unsubscribe() instead",CLIENT_DESTROYED(e){let{funName:t}=e;return"failed to call ".concat(t,"() because client was destroyed.")},SEI_NOT_SUPPORT:e=>"not support to sendSEIMessage".concat(e===!1?" without using h264 codec":""),SEI_DISABLED:"SEI is disabled",SEI_BEFORE_PUBLISH:"please call sendSEIMessage() after publish() success",SEI_NOT_VIDEO:"cannot send sei when localStream has not video.",CALL_FREQUENCY_LIMIT:e=>{let{isSize:t,name:r,timesInSecond:i,maxSizeInSecond:n}=e;return"api ".concat(r," call ").concat(t?"size":"times"," is over ").concat(t?"".concat(n," bytes"):i," in a second.")},CONNECTION_ABORTED:e=>"connection aborted due to: ".concat(e),API_CALL_ABORTED(e){let t;return t=e.message.includes("REMOTE_STREAM_NOT_EXIST")?"Subscribe ".concat(e.userId," ").concat(e.streamType," stream aborted, reason: remote user ").concat(e.userId," unpublished stream."):"API aborted, reason: ".concat(e.message),t},DUPLICATE_AUX:"only one auxiliary stream can be published in a room.",NOT_SUPPORTED_AUX:"publish auxiliary stream is not supported on your browser.",INVALID_PARAMETER_STREAMTYPE:e=>"'streamType' is required when 'userId' is not '*', calling ".concat(e,"()")},Jv={};fd(Jv,{ANDROID_VERSION:()=>YE,CHROME_MAJOR_VERSION:()=>la,CHROME_VERSION:()=>c_,EDGE_VERSION:()=>JE,EDG_MAJOR_VERSION:()=>qv,EDG_VERSION:()=>KE,FIREFOX_MAJOR_VERSION:()=>zv,FIREFOX_VERSION:()=>WE,HUAWEI_VERSION:()=>n_,IE_VERSION:()=>VL,IOS_MAIN_VERSION:()=>l_,IOS_VERSION:()=>da,IPADQQB_VERSION:()=>r_,IS_ANDROID:()=>Qr,IS_ANDROID_WEBVIEW:()=>YL,IS_ANY_SAFARI:()=>Uc,IS_CHROME:()=>xh,IS_CHROME_OS:()=>Zv,IS_CHROMIUM_BASE:()=>ca,IS_EDG:()=>Bd,IS_EDGE:()=>kd,IS_ELECTRON:()=>HL,IS_FIREFOX:()=>Rt,IS_HEADLESS_CHROME:()=>t0,IS_HUAWEI:()=>GL,IS_HUAWEIBROWSER:()=>Ph,IS_IE:()=>$v,IS_IE8:()=>FL,IS_IOS:()=>Gn,IS_IOS_13_OR_14:()=>i0,IS_IOS_15_1:()=>r0,IS_IPAD:()=>Od,IS_IPADQQB:()=>kh,IS_IPAD_PRO:()=>GE,IS_IPHONE:()=>Qc,IS_IPOD:()=>Xv,IS_LINUX:()=>Bh,IS_LOCAL:()=>Fc,IS_MAC:()=>aa,IS_MACQQB:()=>Oh,IS_MIBROWSER:()=>Nh,IS_MQQB:()=>Md,IS_NATIVE_ANDROID:()=>UL,IS_OLD_ANDROID:()=>xL,IS_OPPOBROWSER:()=>Lh,IS_SAFARI:()=>hn,IS_SAFARI_15_1:()=>WL,IS_SAMSUNGBROWSER:()=>Mh,IS_SOGOU:()=>bh,IS_SOGOUM:()=>Rh,IS_TBS:()=>An,IS_UCBROWSER:()=>e0,IS_VIVOBROWSER:()=>Qh,IS_WECHAT:()=>wh,IS_WIN:()=>xc,IS_WQQB:()=>Dh,IS_WX:()=>jL,IS_X5MQQB:()=>Pd,IS_XWEB:()=>Nd,MACQQB_VERSION:()=>t_,MI_VERSION:()=>i_,MQQB_VERSION:()=>Ld,OPPO_VERSION:()=>s_,SAFARI_VERSION:()=>xd,SAMSUNG_VERSION:()=>o_,SOGOUM_VERSION:()=>XE,SOGOU_VERSION:()=>zE,TBS_VERSION:()=>qE,UA_DATA_STRING:()=>Yn,USER_AGENT:()=>Ui,VIVO_VERSION:()=>a_,WECHAT_VERSION:()=>ZE,WQQB_VERSION:()=>e_,XWEB_VERSION:()=>$E,browserInfo:()=>Xo,getBrowserInfo:()=>n0,getChromeMajorVersion:()=>Qd,getDeviceModel:()=>o0,getOSName:()=>u_,getOSString:()=>A_,getOSType:()=>JL,getTerminalType:()=>a0,getUserAgentData:()=>d_,isLocalStorageEnabled:()=>ua});var Ui=typeof navigator>"u"?"":navigator.userAgent,je=e=>new RegExp(e,"i").test(Ui),zt=e=>{if(je(e)){let t=new RegExp("".concat(e,"\\/([\\d.]+)")),r=Ui.match(t);if(r&&r[1])return r[1]}return""},HE=e=>{if(je(e)){let t=new RegExp("".concat(e,"\\/(\\d+)")),r=Ui.match(t);if(r&&r[1])return parseFloat(r[1])}return NaN},Kv=/AppleWebKit\/([\d.]+)/i.exec(Ui),QL=Kv?parseFloat(Kv[1]):NaN,Od=je("iPad"),GE=typeof navigator<"u"&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&je("Macintosh"),Qc=je("iPhone")&&!Od,Xv=je("iPod"),Gn=Qc||Od||Xv||GE,Qr=je("Android"),YE=function(){if(Qr){let e=Ui.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(e){let t=e[1]&&parseFloat(e[1]),r=e[2]&&parseFloat(e[2]);if(t&&r)return parseFloat("".concat(e[1],".").concat(e[2]));if(t)return t}}return NaN}(),xL=Qr&&je("webkit")&&YE<2.3,UL=Qr&&YE<5&&QL<537,Rt=je("Firefox"),WE=zt("Firefox"),zv=HE("Firefox"),kd=je("Edge"),JE=zt("Edge"),Bd=je("Edg"),KE=zt("Edg"),qv=HE("Edg"),Rh=je("SogouMobileBrowser"),XE=zt("SogouMobileBrowser"),bh=je("MetaSr\\s"),zE=zt("MetaSr\\s"),An=je("TBS"),qE=zt("TBS"),Nd=je("XWEB"),$E=zt("XWEB"),FL=je("MSIE\\s8\\.0"),$v=je("MSIE\\/\\d+"),VL=function(){if($v){let e=/MSIE\s(\d+)\.\d/.exec(Ui),t=e&&parseFloat(e[1]);return!t&&/Trident\/7.0/i.test(Ui)&&/rv:11.0/.test(Ui)&&(t=11),t}return NaN}(),wh=je("(micromessenger|webbrowser)"),ZE=zt("MicroMessenger"),Pd=!An&&je("MQQBrowser")&&je("COVC"),Md=!An&&je("MQQBrowser")&&!je("COVC"),Ld=Md||Pd?zt("MQQBrowser"):"",Dh=!An&&je(" QQBrowser"),e_=zt(" QQBrowser"),Oh=!An&&je("QQBrowserLite"),t_=zt("QQBrowserLite"),kh=!An&&je("MQBHD"),r_=zt("MQBHD"),xc=je("Windows"),aa=!Gn&&je("MAC OS X"),Bh=!Qr&&je("Linux"),Zv=je("CrOS"),jL=je("MicroMessenger"),e0=je("UCBrowser"),HL=je("Electron"),Nh=je("MiuiBrowser"),i_=zt("MiuiBrowser"),Ph=je("HuaweiBrowser"),GL=je("Huawei"),n_=zt("HuaweiBrowser"),Mh=je("SamsungBrowser"),o_=zt("SamsungBrowser"),Lh=je("HeyTapBrowser"),s_=zt("HeyTapBrowser"),Qh=je("VivoBrowser"),a_=zt("VivoBrowser"),Qd=()=>HE("Chrome"),ca=je("Chrome"),xh=!kd&&!bh&&!Rh&&!An&&!Nd&&!Bd&&!Dh&&!Nh&&!Ph&&!Mh&&!Lh&&!Qh&&ca,t0=je("HeadlessChrome"),la=Qd(),c_=zt("Chrome"),hn=!ca&&!Md&&!Pd&&!Oh&&!kh&&je("Safari"),Uc=hn||Gn,xd=zt("Version"),YL=/Android.*(wv|.0.0.0)/.test(Ui),da=(()=>{if(GE)return xd;if(Gn){let e=Ui.match(/OS (\d+)_(\d+)/i);if(e&&e[1]){let t=e[1];return e[2]&&(t+=".".concat(e[2])),t}}return""})(),l_=Number(da.split(".")[0]),WL=xd==="15.1",r0=da==="15.1",i0=(()=>{let e=Number(da.split(".")[0]);return e===14||e===13})(),Fc=typeof location<"u"&&(location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"),ua=(()=>{let e;return()=>{if(K(e))try{e=!!window.localStorage}catch{e=!1}return e}})(),Xo=n0();function n0(){let e=new Map([[Rt,["Firefox",WE]],[Bd,["Edg",KE]],[xh,["Chrome",c_]],[hn,["Safari",xd]],[An,["TBS",qE]],[Nd,["XWEB",$E]],[wh&&Qc,["WeChat",ZE]],[Dh,["QQ(Win)",e_]],[Md,["QQ(Mobile)",Ld]],[Pd,["QQ(Mobile X5)",Ld]],[Oh,["QQ(Mac)",t_]],[kh,["QQ(iPad)",r_]],[Nh,["MI",i_]],[Ph,["HW",n_]],[Mh,["Samsung",o_]],[Lh,["OPPO",s_]],[Qh,["VIVO",a_]],[kd,["EDGE",JE]],[Rh,["SogouMobile",XE]],[bh,["Sogou",zE]]]),t="unknown",r="unknown";return e.has(!0)&&([t,r]=e.get(!0)),{name:t,version:r}}var Et=null,Yn="";function d_(){return N(this,null,function*(){if(Et)return Et;if(!navigator.userAgentData||!mt(navigator.userAgentData.getHighEntropyValues))return null;try{return(Et=yield navigator.userAgentData.getHighEntropyValues(["architecture","bitness","model","platformVersion","fullVersionList"]))&&!Yn&&(Yn="UAData: ".concat(Et.platform,"/").concat(Et.platformVersion),Et.architecture&&Et.bitness&&(Yn+=" ".concat(Et.architecture,"/").concat(Et.bitness)),Et.mobile&&(Yn+=" mobile"),Et.model&&(Yn+=" model: ".concat(Et.model)),Et.fullVersionList&&(Yn+=" ".concat(Et.fullVersionList.filter(e=>e.brand!=="Not/A)Brand").map(e=>"".concat(e.brand,"/").concat(e.version)).join(",")))),Et}catch{return null}})}function o0(){return(Et==null?void 0:Et.model)||""}var s0=new Map([[Qr,"Android"],[Gn,"iOS"],[xc,"Windows"],[aa,"MacOS"],[Bh,"Linux"],[Zv,"ChromeOS"]]),u_=function(){return s0.get(!0)?s0.get(!0):Et?Et.platform:"unknown"},A_=()=>{let e=u_();return e+="/".concat(Xo.name,"/").concat(hn?Xo.version:Xo.version.split(".")[0]),Et!=null&&Et.platformVersion&&(e+="/".concat(Et.platformVersion)),Et!=null&&Et.architecture&&(e+="/".concat(Et.architecture)),e};function a0(){return Qr?4:Qc?2:Od?3:aa?12:xc?5:Bh?13:1}function JL(){return Qr?"Android":Qc?"iPhone":Od?"iPad":aa?"Mac":xc?"Windows":Bh?"Linux":"unknown"}var c0=(e,t)=>t?"".concat(na,"/").concat(e,"/").concat(t):"".concat(na,"/").concat(e,"/index.html"),KL=()=>{if(window.TRTC_ERROR_INFO&&window.TRTC_ERROR_LINK)return{TRTC_ERROR_INFO:window.TRTC_ERROR_INFO,TRTC_ERROR_LINK:window.TRTC_ERROR_LINK};let e=localStorage==null?void 0:localStorage.getItem(Bv);if(e){e=JSON.parse(e);let t=document.createElement("script");t.type="text/javascript",t.text=e.message,document.body.appendChild(t);let r=window.TRTC_ERROR_INFO,i=window.TRTC_ERROR_LINK;return document.body.removeChild(t),{TRTC_ERROR_INFO:r,TRTC_ERROR_LINK:i}}return{}};function Ve(e){let{key:t,data:r,link:i,addDocLink:n=!0}=e,a="",c="",A="";mt(xi[t])?a=xi[t](r):ut(xi[t])&&(a=xi[t]);let{TRTC_ERROR_INFO:d,TRTC_ERROR_LINK:g}=KL();i?A="".concat(i.className,".html#").concat(i.fnName):g&&g[t]&&(mt(g[t])?A=g[t](r):ut(g[t])&&(A=g[t]));let E=a;return qo()&&(d&&d[t]&&(mt(d[t])?c=d[t](r):ut(d[t])&&(c=d[t])),c&&(E=n?"".concat(c,`
è¯·æ¥çææ¡£: `).concat(c0("zh-cn",A),`

`):"".concat(c,`

`),E+=a)),n&&(E+=` 
Refer to: `.concat(c0("en",A),`
`)),E}var De,Ud=function(e){let{retryFunction:t,settings:r,onError:i,onRetrying:n,onRetryFailed:a,onRetrySuccess:c,context:A}=e;return function(){for(var d=arguments.length,g=new Array(d),E=0;E<d;E++)g[E]=arguments[E];let{retries:f=5,timeout:b=1e3}=r,w=0,k=-1,x=0,Y=(G,F)=>N(this,null,function*(){let me=A||this;try{let Te=yield t.apply(me,g);w>0&&c&&c.call(this,w),w=0,G(Te)}catch(Te){let Ze=()=>{clearTimeout(k),w=0,x=2,F(Te)},qe=()=>{x!==2&&w<(mt(f)?f():f)?(w++,x=1,mt(n)&&n.call(this,w,Ze),k=window.setTimeout(()=>{k=-1,Y(G,F)},mt(b)?b(w):b)):(Ze(),mt(a)&&a.call(this,Te))};mt(i)?i.call(this,{error:Te,retry:qe,reject:F,retryFuncArgs:g,retriedCount:w}):qe()}});return new Promise(Y)}},te=new(lr(Lr(),1)).default,l0=((De=l0||{}).ROOM_DESTROY="1",De.JOIN_START="21",De.JOIN_SCHEDULE_SUCCESS="22",De.JOIN_SIGNAL_CONNECTION_START="23",De.JOIN_SIGNAL_CONNECTION_END="24",De.JOIN_SEND_CMD="25",De.JOIN_RECEIVED_CMD_RES="26",De.JOIN_SUCCESS="27",De.JOIN_FAILED="28",De.LEAVE_START="51",De.LEAVE_SEND_CMD="52",De.LEAVE_SUCCESS="53",De.PUBLISH_START="61",De.SEND_FIRST_VIDEO_FRAME="62",De.PUBLISH_FAILED="63",De.SUBSCRIBE_START="81",De.SUBSCRIBE_SUCCESS="82",De.SUBSCRIBE_FAILED="84",De.UNSUBSCRIBE_SUCCESS="83",De.LOCAL_TRACK_CAPTURE_START="101",De.LOCAL_TRACK_CAPTURE_SUCCESS="102",De.LOCAL_TRACK_CAPTURE_FAILED="103",De.LOCAL_TRACK_PUBLISHED="104",De.LOCAL_TRACK_UNPUBLISHED="105",De.LOCAL_TRACK_REPLACED="106",De.SWITCH_DEVICE_SUCCESS="107",De.TRACK_MUTED="108",De.TRACK_UNMUTED="109",De.REMOTE_TRACK_SUBSCRIBED="110",De.REMOTE_TRACK_UNSUBSCRIBED="111",De.LOCAL_TRACK_RECAPTURE="112",De.PLAY_TRACK_START="151",De.PLAYER_STATE_CHANGED="152",De.VIDEO_LOADED_DATA="153",De.AUTOPLAY_DIALOG_CLICK_CONFIRM="154",De.SIGNAL_CONNECTION_STATE_CHANGED="201",De.PEER_CONNECTION_STATE_CHANGED="202",De.SINGLE_CONNECTION_STAT="203",De.SPC_RECONNECTED="204",De.HEARTBEAT_REPORT="251",De.RECEIVED_PUBLISHED_USER_LIST="252",De.REMOTE_PUBLISH_STATE_CHANGED="253",De.AUDIO_LEVEL_INTERVAL="260",De.NETWORK_QUALITY="261",De.VIDEO_CODEC_IMPLEMENTATION_CHANGED="262",De.QUALITY_LIMITATION_CHANGED="263",De),Lt=new class{constructor(){this._roomIdMap=new Map,typeof registerProcessor>"u"&&(this._configs={sdkAppId:"",userId:"",version:ln,env:oa.QCLOUD,browserVersion:Xo.name+Xo.version,ua:navigator.userAgent})}setConfig(e){let{sdkAppId:t,env:r,userId:i,roomId:n}=e;t!==this._configs.sdkAppId&&(this._configs.sdkAppId=String(t)),this._configs.env=r,this._configs.userId=i,this._roomIdMap.set(i,String(n))}logSuccessEvent(e){Fc||!ae.isAbleToUpload||this._configs.env===oa.QCLOUD&&this.uploadEventToKibana(Ke(_e({},e),{result:"success"}))}logFailedEvent(e){if(Fc||!ae.isAbleToUpload)return;let{eventType:t,code:r,error:i,userId:n}=e,a={roomId:this._roomIdMap.get(n||this._configs.userId),userId:n,eventType:t,result:"failed",code:r||(i==null?void 0:i.extraCode)||(i==null?void 0:i.code)||se.UNKNOWN};this._configs.env===oa.QCLOUD&&this.uploadEventToKibana(Ke(_e({},a),{error:i}))}uploadEventToKibana(e){let t="stat-".concat(e.eventType,"-").concat(e.result);(e.eventType==="delta-join"||e.eventType==="delta-leave"||e.eventType==="delta-publish")&&(t="".concat(e.eventType,":").concat(e.delta)),this.uploadEvent({log:t,userId:e.userId}),e.result==="failed"&&(t="stat-".concat(e.eventType,"-").concat(e.result,"-").concat(e.code),this.uploadEvent({log:t,userId:e.userId,error:e.error}))}uploadEvent(e){let{log:t,userId:r,error:i}=e,n={timestamp:Rv(),sdkAppId:this._configs.sdkAppId,userId:r||this._configs.userId,version:ln,log:t};i&&(n.errorInfo=i.message),this.sendRequest(Fd(this._configs.sdkAppId,Id.LOG),n)}sendRequest(e,t){ae.isAbleToUpload?Dd({url:e,body:JSON.stringify(t)}).catch(()=>{}):setTimeout(()=>{this.sendRequest(e,t)},1e3)}},h_=null,g_=!0;function zo(e){ei(e)&&e!==g_&&(g_=e,ae.info("setIsNeedToSchedule ".concat(e)))}function XL(e){return N(this,arguments,function(t){let{userId:r,sdkAppId:i,useStringRoomId:n,roomId:a,userSig:c,version:A,frameWorkType:d,role:g,latencyLevel:E}=t;return function*(){if(!g_&&h_)return{isCached:!0,result:h_};let f={delta:0,count:[1,1],msg:[],detail:[]};try{let b=new FormData;b.append("userId",String(r)),b.append("sdkAppId",String(i)),b.append("isStrGroupId",String(n)),b.append("groupId",String(a)),b.append("sdkVersion",A),b.append("userSig",String(c)),g&&b.append("role",String(g)),E&&b.append("latencyLevel",String(E)),d&&b.append("frameWorkType",String(d));let w=He(),k=yield function(Y,G,F){return new Promise((me,Te)=>{let Ze=null;f_([A0(qe=>G.count[0]=qe+1,qe=>{let{error:Ne,retry:eo,retriedCount:jt,retryFuncArgs:us}=qe;G.msg[0]=Ne.message,Ze||(jt>=2&&(us[0]=Vc(F,O.MAIN,!0)),eo())})(Vc(F,O.MAIN),Y,{get timeout(){return 1e3*jd(2+G.count[0])}}),A0(qe=>G.count[1]=qe+1,qe=>{let{error:Ne,retry:eo,retriedCount:jt,retryFuncArgs:us}=qe;G.msg[1]=Ne.message,Ze||(jt>=2&&(us[0]=Vc(F,O.BACKUP,!0)),eo())})(Vc(F,O.BACKUP),Y,{get timeout(){return 1e3*jd(2+G.count[1])}})]).then(qe=>{Ze=qe,me(Ze)}).catch(Te)})}(b,f,i);k.config&&(k.config.loggerDomain&&_d(k.config.loggerDomain),ei(k.config.scheduleCache)&&zo(!k.config.scheduleCache)),f.delta=He()-w;let x=function(Y,G,F){let me=performance.getEntriesByType("resource"),Te=Vc(Y,O.MAIN),Ze=Vc(Y,O.BACKUP),qe={totalCost:0,local:0,dns:0,tcp:0,tls:0,request:0,response:0};for(let Ne of me)if(Ne.startTime>=F&&(Ne.name===Te||Ne.name===Ze)&&Ne.transferSize>0){let eo=Ne.name===Te?O.MAIN:O.BACKUP,jt=Math.round(Ne.duration),us=Math.round(Ne.domainLookupStart-Ne.startTime),fn=Math.round(Ne.domainLookupEnd-Ne.domainLookupStart),db=Math.round(Ne.requestStart-Ne.secureConnectionStart),ub=Math.round(Ne.secureConnectionStart-Ne.connectStart),Ab=Math.round(Ne.responseStart-Ne.requestStart),hb=Math.round(Ne.responseEnd-Ne.responseStart),Sx=[us,fn,db,ub,Ab,hb];Lt.uploadEvent({log:"stat-schedule-net:".concat(jt,"(").concat(Sx.join("->"),") ").concat(eo),userId:G}),qe=Ke(_e({},qe),{totalCost:jt,local:us,dns:fn,tcp:ub,tls:db,request:Ab,response:hb});break}return qe}(Number(i),r,w);return h_=k,{isCached:!1,result:k,detailCost:x}}catch(b){let w=pr(b)?b[0]:b,k=qt(w.code)?w.code:0,x="schedule failed".concat(w.message?": ".concat(w.message):""),Y=new pe({code:se.SCHEDULE_FAILED,extraCode:k,message:Ve({key:xe.JOIN_ROOM_FAILED,data:{error:x,code:k}})});throw ae.error(x,k),Y}}()})}document&&document.head.insertAdjacentHTML("beforeend",Object.values(un).map(e=>'<link rel="dns-prefetch" href="https://'.concat(e,'">')).join(`\r
`)),te.on("28",()=>zo(!0)),te.on("63",()=>zo(!0)),te.on("84",()=>zo(!0)),te.on("201",e=>{e.state==="RECONNECTING"&&zo(!0)}),te.on("202",e=>{e.state==="RECONNECTING"&&zo(!0)});var Aa={main:"",backup:""};function d0(e){pr(e)?(Aa.main=e[0],Aa.backup=e[1]):Aa.main=e}function Vc(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:O.MAIN,r=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return"https://".concat(Aa[t]||u0(e,t,r),"/api/v1/config")}function zL(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:O.MAIN;return"https://".concat(Aa[t]||u0(e,t),"/api/v1/trtcAutoConf")}function u0(e){let t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:O.MAIN,i=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return Uh(e)?r===O.MAIN?un.MAIN_OVERSEA:un.BACKUP_OVERSEA:(t=Uh(e)?i?r===O.MAIN?un.MAIN_OVERSEA_OLD:un.BACKUP_OVERSEA_OLD:r===O.MAIN?un.MAIN_OVERSEA:un.BACKUP_OVERSEA:r===O.MAIN?un.MAIN:un.BACKUP,t)}function qL(e,t,r){return new Promise((i,n)=>{Dd({url:e,body:t,timeout:r.timeout}).then(a=>{a.data.code===0?i(a.data.data):n({code:a.data.code,message:a.data.msg})}).catch(n)})}var A0=(e,t)=>Ud({retryFunction:qL,settings:{retries:3,timeout:0},onError:t,onRetrying:e}),$L=function(){return new URLSearchParams(location.search).get("trtc_env")||""},Uh=e=>Number(e)<14e8,Fd=function(e,t){let r;r=kE||(Uh(e)?kv:Ov);let i=Math.floor(Math.random()*SE(2,31));return"".concat(r,"/v5/AVQualityReportSvc/C2S?random=").concat(i,"&sdkappid=").concat(e,"&cmdtype=").concat(t)},Vd="unknown";function h0(){if(Vd!=="unknown")return Vd;let{userAgent:e,connection:t}=navigator,r=(e.match(/NetType\/\S+/)||[])[0]||"";r=r.toLowerCase().replace("nettype/",""),r==="3gnet"&&(r="3g");let i=t&&t.type&&t.type.toLowerCase(),n=t&&t.effectiveType&&t.effectiveType.toLowerCase();return n==="slow-2"&&(n="2g"),i&&(Vd=g0(i,n)),Vd}function g0(e,t){if(BE[e])return e;switch(e){case"cellular":case"wimax":return t||"unknown";case"ethernet":return"wired";default:return"unknown"}}function p0(e){Vd=g0(e)}function Fh(){return BE[h0()]}function ZL(e,t){for(let r of Reflect.ownKeys(t))if(r!=="constructor"&&r!=="prototype"&&r!=="name"){let i=Object.getOwnPropertyDescriptor(t,r)||"";Object.defineProperty(e,r,i)}return e}function eQ(e){return m0(e/4,arguments.length>1&&arguments[1]!==void 0?arguments[1]:48e3)}function m0(e){return 1e3*e/(arguments.length>1&&arguments[1]!==void 0?arguments[1]:48e3)}function tQ(e){return 4*f0(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:48e3)}function f0(e){return e*(arguments.length>1&&arguments[1]!==void 0?arguments[1]:48e3)/1e3}var rQ=typeof window<"u"&&typeof window.glog=="function"?window.glog:()=>{},qo=()=>{let e=navigator.language;return e=e.substring(0,2),e==="zh"},Wn=function(e){if(!e||typeof e!="object"||Object.prototype.toString.call(e)!="[object Object]")return!1;let t=Object.getPrototypeOf(e);if(t===null)return!0;let r=Object.prototype.hasOwnProperty.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&Function.prototype.toString.call(r)===Function.prototype.toString.call(Object)};function jd(e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return e<=1?t:jd(e-1,t,(arguments.length>1&&arguments[1]!==void 0?arguments[1]:1)+t)}function jc(e){return e>8?3e4:1e3*jd(e)}function xr(e){return Reflect.apply(Object.prototype.toString,e,[]).replace(/^\[object\s(\w+)\]$/,"$1").toLowerCase()}var mt=e=>typeof e=="function",K=e=>e===void 0,ut=e=>typeof e=="string",qt=e=>typeof e=="number",ei=e=>typeof e=="boolean",$o=e=>xr(e)==="object",pr=e=>xr(e)==="array",iQ=e=>xr(e)==="MediaStreamTrack".toLowerCase(),Zo=e=>e.isRemote,p_=e=>xr(e)==="promise",m_=e=>mt(e)&&e.prototype.constructor===e,E0=e=>m_(e)?e.prototype.constructor.name:"",nQ=typeof AudioWorkletNode<"u";function f_(e){return new Promise((t,r)=>{let i=[];e.forEach(n=>{n.then(t).catch(a=>{i.push(a),i.length===e.length&&r(i)})})})}function He(){return performance&&performance.now?Math.floor(performance.now()):Date.now()}var _0=e=>+e<10?"0".concat(e):e,oQ=e=>{let t=e.match(/^\d+\.\d+\.\d+/)[0];if(!t)return e;let r=t.split("."),i=_0(r[1])+_0(r[2]);return r[1]-15>0&&(r[1]="15"),r[2]-15>0&&(r[2]="15"),"".concat(r.join("."),".").concat(i)},sQ=Object.prototype.hasOwnProperty;function I0(e){if(e==null)return!0;if(typeof e=="boolean")return!1;if(typeof e=="number")return e===0;if(typeof e=="string"||typeof e=="function"||Array.isArray(e))return e.length===0;if(e instanceof Error)return e.message==="";if(Wn(e))switch(Object.prototype.toString.call(e)){case"[object File]":case"[object Map]":case"[object Set]":return e.size===0;case"[object Object]":for(let t in e)if(sQ.call(e,t))return!1;return!0}return!1}function Hd(e,t){return{userId:t,hasAudio:!!(e&yd),hasVideo:!!(e&Cd),hasAuxiliary:!!(e&Ih),hasSmall:!!(e&LE),audioMuted:!!(e&QE),videoMuted:!!(e&xE),audioAvailable:!(!(e&yd)||e&QE),videoAvailable:!(!(e&Cd)||e&xE)}}function aQ(e){let t={urls:"turn:".concat(e.url)};return!K(e.username)&&!K(e.credential)&&(t.username=e.username,t.credential=e.credential,t.credentialType="password",K(e.credentialType)||(t.credentialType=e.credentialType)),t}function Vh(e){let t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!ut(e))return 0;let r=e.split(".");return t?(Number(r[0])<<24|Number(r[1])<<16|Number(r[2])<<8|Number(r[3]))>>>0:(Number(r[3])<<24|Number(r[2])<<16|Number(r[1])<<8|Number(r[0]))>>>0}var ha=function(e,t,r,i){if(!$o(e)||!$o(t))return 0;let n,a=0,c=Object.keys(t);for(let A=0,d=c.length;A<d;A++)if(n=c[A],!(K(t[n])||r&&r.includes(n)))if($o(e[n])&&$o(t[n]))a+=ha(e[n],t[n],r,i);else{if(i&&i.includes(t[n]))continue;e[n]!==t[n]&&(e[n]=Gd(t[n]),a+=1)}return a};function Gd(e){if(pr(e)){let t=[];return e.forEach((r,i)=>{t[i]=Gd(r)}),t}if($o(e)){let t={};return Object.keys(e).forEach(r=>{t[r]=Gd(e[r])}),t}return e}var jh=e=>{let t=[];if(pr(e))t=[...e];else if(ut(e)){let r=document.getElementById(e);r&&t.push(r)}else e&&t.push(e);return t},cQ=e=>ut(e)?document.getElementById(e):e,lQ=new Intl.DateTimeFormat("zh-CN",{dateStyle:"short",timeStyle:"medium"}),dQ=()=>lQ.format(new Date);function Jn(e,t){let{keysToInclude:r,keysToExclude:i}=t;try{if(pr(e))return"[".concat(e.map(A=>Jn(A,{keysToInclude:r,keysToExclude:i})).join(","),"]");if(!Wn(e)||!pr(r)&&!pr(i))return JSON.stringify(e);let n={},a=new Set(r),c=new Set(i);return Object.keys(e).forEach(A=>{(c.size===0&&a.has(A)||a.size===0&&!c.has(A))&&(n[A]=Wn(e[A])||pr(e[A])?JSON.parse(Jn(e[A],{keysToExclude:i,keysToInclude:r})):e[A])}),JSON.stringify(n)}catch{return"{}"}}function C0(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1],r=[];return Object.keys(e).forEach(i=>{t===e[i]&&r.push(i)}),Jn(e,{keysToInclude:r})}function E_(e){return e.replace(/[\u4e00-\u9fa5]/g,"aa").length}var y0=()=>{var e,t,r,i;return(e=window.screen)!=null&&e.orientation?!((i=(r=(t=window.screen)==null?void 0:t.orientation)==null?void 0:r.type)==null||!i.includes("portrait")):window.orientation===0||window.orientation===180},Hh=e=>N(void 0,null,function*(){return new Promise((t,r)=>{let i;if(ut(e))i=new Image,i.crossOrigin="anonymous",i.src=e;else if(i=e,i.complete)return void t(i);i.onload=()=>t(i),i.onerror=r})}),T0=e=>{let t=e.split(".");return+t[0]<<24|+t[1]<<16|+t[2]<<8|+t[3]},__=e=>(Object.keys(e).forEach(t=>{qt(e[t])&&(t.startsWith("uint")||t.startsWith("int"))?e[t]=Math.floor(e[t]):(Wn(e[t])||pr(e[t]))&&__(e[t])}),e);function I_(e){return new Promise(t=>setTimeout(t,e))}var S0=(e,t)=>{let r=null;return function(){for(var i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return r||(r=e.apply(t||this,n),r.then(c=>(r=null,c)).catch(c=>{throw r=null,c}),r)}},uQ=Object.prototype.hasOwnProperty,ga=e=>e===void 0;function AQ(e){if(e==null)return!0;if(typeof e=="boolean")return!1;if(typeof e=="number")return e===0;if(typeof e=="string"||typeof e=="function"||Array.isArray(e))return e.length===0;if(e instanceof Error)return e.message==="";if(function(t){if(!t||typeof t!="object"||Object.prototype.toString.call(t)!="[object Object]")return!1;let r=Object.getPrototypeOf(t);if(r===null)return!0;let i=Object.prototype.hasOwnProperty.call(r,"constructor")&&r.constructor;return typeof i=="function"&&i instanceof i&&Function.prototype.toString.call(i)===Function.prototype.toString.call(Object)}(e))switch(Object.prototype.toString.call(e)){case"[object File]":case"[object Map]":case"[object Set]":return e.size===0;case"[object Object]":for(let t in e)if(uQ.call(e,t))return!1;return!0}return!1}var hQ=class{constructor(e){T(this,"userId"),T(this,"remoteUserId"),T(this,"id"),T(this,"sdkAppId"),T(this,"type"),T(this,"isLocal"),this.id=e.id,this.userId=e.userId,this.sdkAppId=e.sdkAppId,this.remoteUserId=e.remoteUserId,this.isLocal=typeof e.isLocal!="boolean"||e.isLocal,this.type=this.isLocal?"":e.type}createChild(e){return Object.setPrototypeOf(e,this)}setUserId(e){this.userId=e}setSdkAppId(e){this.sdkAppId=e}log(e,t){let r=this.isLocal?this.userId:this.remoteUserId;t.unshift("[".concat(this.isLocal?"â":"â").concat(this.type&&this.type!=="main"?"*":"").concat(this.id).concat(r?"|".concat(r):"","]")),ae.log(e,t,ga(this.userId)||AQ(this.userId),this.userId,this.sdkAppId)}info(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log(2,t)}debug(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log(1,t)}warn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log(3,t)}error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log(4,t)}},X=l0,gQ=!(Gn||Qr||t0),ae=new class{constructor(){T(this,"_isEnableUploadLog",!0),T(this,"_localJoinedUser",new Map),T(this,"_queue",[]),T(this,"_timeoutId",-1),T(this,"_logLevel",1),T(this,"_logLevelToUpload",2),!_h&&!OE&&(this.checkURLParam(),this.installEvents())}get isAbleToUpload(){return this._isEnableUploadLog&&this._timeoutId!==-1}installEvents(){te.on(X.JOIN_SCHEDULE_SUCCESS,e=>{let{schedule:t}=e;var r;(r=t==null?void 0:t.config)!=null&&r.logLevelToUpload&&Wo[t.config.logLevelToUpload]&&(this._logLevelToUpload=t.config.logLevelToUpload)}),te.on(X.JOIN_SUCCESS,e=>{let{room:t}=e;this.addJoinedUser({userId:t.userId,sdkAppId:t.sdkAppId}),this.startUpload()}),te.once(X.JOIN_FAILED,()=>{this.startUpload()}),te.on(X.LEAVE_SUCCESS,e=>{let{room:t}=e;this.deleteJoinedUser(t.userId)})}startUpload(){this._timeoutId===-1&&this.uploadInterval()}addJoinedUser(e){this._localJoinedUser.set(e.userId,e),this.startUpload()}deleteJoinedUser(e){this._localJoinedUser.delete(e)}uploadInterval(){this.upload().catch(()=>{}),this._timeoutId=window.setTimeout(()=>this.uploadInterval(),2e3)}getLogsToUpload(){let e={map:new Map,splicedQueue:[]};if(this._queue[0].forAllJoinedClients&&this._localJoinedUser.size===0)return e;let t=0;for(;t<this._queue.length&&t!==50;t++){let r=this._queue[t];if(r.forAllJoinedClients)this._localJoinedUser.forEach(i=>{let{userId:n,sdkAppId:a}=i;e.map.has(n)?e.map.get(n).logs.push(r):e.map.set(n,{userId:n,sdkAppId:a,logs:[r]})});else if(ut(r.userId)&&qt(r.sdkAppId)){let{userId:i,sdkAppId:n}=r;e.map.has(i)?e.map.get(i).logs.push(r):e.map.set(i,{userId:i,sdkAppId:n,logs:[r]})}}return e.map.size>0&&(e.splicedQueue=this._queue.splice(0,t)),e}upload(){return N(this,null,function*(){if(this._queue.length===0||!this._isEnableUploadLog)return;let{map:e,splicedQueue:t}=this.getLogsToUpload();if(e.size===0)return;try{let i=[...e.values()];for(let n=0;n<i.length;n++){let{userId:a,sdkAppId:c,logs:A}=i[n];yield this.uploadLogWithRetry(JSON.stringify({timestamp:Rv(),sdkAppId:String(c),userId:a,version:ln,log:A.map(d=>d.log).join(`
`)}),c),A.forEach(d=>d.uploaded=!0)}}catch{}let r=t.filter(i=>!i.uploaded);r.length>0&&(this._queue=r.concat(this._queue))})}uploadLogWithRetry(e,t){return Ud({retryFunction:()=>Dd({url:Fd(t,Id.LOG),body:e,timeout:5e3}),settings:{retries:3,timeout:1e3},onError:r=>{let{retry:i}=r;i()}})()}getPrefix(e){let t=new Date;t.setTime(bE());let r=String(t.getMilliseconds());return"padStart"in String.prototype&&(r=r.toString().padStart(3,"0")),"[".concat(t.toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1"),":").concat(r,"] <").concat(Wo[e],">")}getLogLevel(){return this._logLevel}setLogLevel(e){K(Wo[e])||(this._logLevel!==e&&this.info("setLogLevel",e),this._logLevel=e)}enableUploadLog(){this._isEnableUploadLog=!0}disableUploadLog(){this.warn("disableUploadLog"),this._isEnableUploadLog=!1}logChunkToString(e){if(ut(e))return e;try{return e instanceof Error?e.toString():JSON.stringify(e)}catch{return""}}log(e,t){let r=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],i=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0;var a;if(t.unshift(this.getPrefix(e)),this._isEnableUploadLog&&e>=this._logLevelToUpload&&this._queue.push({log:t.reduce((A,d)=>"".concat(A," ").concat(this.logChunkToString(d)).trim(),""),level:e,userId:i,sdkAppId:n,forAllJoinedClients:r}),e<this._logLevel)return;let c=((a=Wo[e])==null?void 0:a.toLowerCase())||"info";gQ?console[c]("%cTRTC%c%s","padding: 1px 4px;border-radius: 3px;color: #fff;background: #1E88E5;","display: inline",...t):console[c](...t)}debug(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log(1,t)}info(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log(2,t)}warn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log(3,t)}error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log(4,t)}createLogger(e){return new hQ(e)}checkURLParam(){let e=new URLSearchParams(location.search).get("logLevelToUpload"),t=e?Number(e):-1;Wo[t]&&(this._logLevelToUpload=t)}},v0=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let t=16*Math.random()|0;return(e=="x"?t:3&t|8).toString(16)})},R0=new class{constructor(){T(this,"_prefix","TRTC"),T(this,"_queue",new Map),this.checkStorage()}getRealKey(e){return"".concat(this._prefix,"_").concat(e)}checkStorage(){ua()&&(setInterval(this.doFlush.bind(this),2e4),Object.keys(localStorage).filter(e=>{if(e.startsWith(this._prefix)){let t=localStorage.getItem(e);if(!t)return!1;let r=JSON.parse(t);if(r&&r.expiresIn<Date.now())return!0}return!1}).forEach(e=>localStorage.removeItem(e)))}doFlush(){if(ua())try{for(let[e,t]of this._queue)localStorage.setItem(e,JSON.stringify(t))}catch(e){ae.warn(e)}}getItem(e){if(!ua())return null;try{let t=localStorage.getItem(this.getRealKey(e));if(!t)return null;let r=JSON.parse(t);return r&&r.expiresIn>=Date.now()?r.value:null}catch(t){ae.warn(t)}}setItem(e,t){if(ua())try{let r={expiresIn:Date.now()+Nv,value:t};this._queue.set(this.getRealKey(e),r)}catch(r){ae.warn(r)}}deleteItem(e){if(!ua())return!1;try{return e=this.getRealKey(e),this._queue.delete(e),localStorage.removeItem(e),!0}catch(t){return ae.warn(t),!1}}clear(){if(ua())try{localStorage.clear()}catch(e){ae.warn(e)}}},Yd={};fd(Yd,{HTTPS_API:()=>_Q,IS_GET_CAPABILITIES_SUPPORTED:()=>M0,IS_GET_SETTINGS_SUPPORTED:()=>Hc,IS_SEI_SUPPORTED:()=>ma,IS_SPC_SUPPORTED:()=>Kd,basis:()=>yQ,checkSystemRequirementsInternal:()=>v_,decodeSupportStatus:()=>S_,encodeSupportStatus:()=>T_,getBrowserInfo:()=>mQ,getDisplayResolution:()=>O0,isAddTransceiverSupported:()=>Kn,isBrowserSupported:()=>C_,isGetReceiversSupported:()=>Wh,isGetSendersSupported:()=>Jd,isGetTransceiversSupported:()=>es,isGetUserMediaSupported:()=>k0,isMediaDevicesSupported:()=>y_,isMediaSessionSupported:()=>L0,isMediaStreamTrackProcessorSupported:()=>fQ,isReplaceTrackSupported:()=>P0,isScreenCaptureApiAvailable:()=>Gh,isSelectedCandidatePair:()=>Wd,isSetParametersSupported:()=>b_,isSmallStreamAPISupported:()=>N0,isSmallStreamSupported:()=>Yh,isStopTransceiverSupported:()=>CQ,isTRTCSupported:()=>EQ,isUnifiedPlanDefault:()=>IQ,isUsedInHttpProtocol:()=>pa,isWebAudioSupported:()=>B0,isWebCodecSupported:()=>D_,isWebCodecsSupported:()=>w0,isWebRTCSupported:()=>w_,isWebTransportSupported:()=>Q0});var b0=lr(lL(),1),it={result:!1,detail:{isBrowserSupported:!1,isWebRTCSupported:!1,isWebCodecsSupported:!1,isMediaDevicesSupported:!1,isScreenShareSupported:!1,isSmallStreamSupported:!1,isH264EncodeSupported:!1,isVp8EncodeSupported:!1,isH264DecodeSupported:!1,isVp8DecodeSupported:!1}},pQ=new Map([[Rt,["Firefox",WE]],[Bd,["Edg",KE]],[xh,["Chrome",c_]],[hn,["Safari",xd]],[An,["TBS",qE]],[Nd,["XWEB",$E]],[wh&&Qc,["WeChat",ZE]],[Dh,["QQ(Win)",e_]],[Md,["QQ(Mobile)",Ld]],[Pd,["QQ(Mobile X5)",Ld]],[Oh,["QQ(Mac)",t_]],[kh,["QQ(iPad)",r_]],[Nh,["MI",i_]],[Ph,["HW",n_]],[Mh,["Samsung",o_]],[Lh,["OPPO",s_]],[Qh,["VIVO",a_]],[kd,["EDGE",JE]],[Rh,["SogouMobile",XE]],[bh,["Sogou",zE]]]);function mQ(){let e=pQ.get(!0);return{browserName:e?e[0]:"unknown",browserVersion:e?e[1]:"unknown"}}var C_=function(){return!(e0||kd||Bd&&qv<80||Rt&&zv<56)},w0=function(){return["VideoDecoder","VideoEncoder","AudioEncoder","AudioDecoder","MediaStreamTrackGenerator"].every(e=>e in window)},y_=function(){if(!navigator.mediaDevices)return pa()||ae.error(xi.NOT_SUPPORTED_MEDIA),!1;let e=["getUserMedia","enumerateDevices"];return e.filter(t=>t in navigator.mediaDevices).length===e.length},D0=!1;function pa(){return location.protocol==="http:"&&!Fc&&(D0||ae.error(Ve({key:xe.NOT_SUPPORTED_HTTP})),D0=!0,!0)}var fQ=function(){return(window==null?void 0:window.OffscreenCanvas)&&(window==null?void 0:window.MediaStreamTrackProcessor)&&(window==null?void 0:window.MediaStreamTrackGenerator)},T_=function(){return N(this,null,function*(){if(it.detail.isH264EncodeSupported&&it.detail.isVp8EncodeSupported)return{isH264EncodeSupported:it.detail.isH264EncodeSupported,isVp8EncodeSupported:it.detail.isVp8EncodeSupported};let e,t=!1,r=!1;try{let i=new RTCPeerConnection,n=document.createElement(O.CANVAS);n.getContext("2d");let a=n.captureStream(0);return i.addTrack(a.getVideoTracks()[0],a),e=yield i.createOffer(),e.sdp.toLowerCase().indexOf("h264")!==-1&&(t=!0),e.sdp.toLowerCase().indexOf("vp8")!==-1&&(r=!0),i.close(),it.detail.isH264EncodeSupported=t,it.detail.isVp8EncodeSupported=r,{isH264EncodeSupported:it.detail.isH264EncodeSupported,isVp8EncodeSupported:it.detail.isVp8EncodeSupported}}catch{return{isH264EncodeSupported:!1,isVp8EncodeSupported:!1}}})},S_=function(){return N(this,null,function*(){if(it.detail.isH264DecodeSupported&&it.detail.isVp8DecodeSupported)return{isH264DecodeSupported:it.detail.isH264DecodeSupported,isVp8DecodeSupported:it.detail.isVp8DecodeSupported};let e,t=!1,r=!1;try{let i=new RTCPeerConnection;return e=yield i.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}),e.sdp.toLowerCase().indexOf("h264")!==-1&&(t=!0),e.sdp.toLowerCase().indexOf("vp8")!==-1&&(r=!0),i.close(),{isH264DecodeSupported:t,isVp8DecodeSupported:r}}catch{return{isH264DecodeSupported:!1,isVp8DecodeSupported:!1}}})},v_=S0(()=>N(void 0,null,function*(){if(it.result&&it.detail.isH264EncodeSupported&&it.detail.isVp8EncodeSupported&&it.detail.isH264DecodeSupported&&it.detail.isVp8DecodeSupported)return it;let e=C_(),t=w_(),r=w0(),i=y_(),{isH264EncodeSupported:n,isVp8EncodeSupported:a}=yield T_(),{isH264DecodeSupported:c,isVp8DecodeSupported:A}=yield S_();if(!n||!a){let d=yield T_();ae.warn("detect encode again h264:".concat(n," vp8:").concat(a," result: ").concat(JSON.stringify(d))),n=d.isH264EncodeSupported,a=d.isVp8EncodeSupported}if(n&&c&&Qr&&ca&&!Nd&&!An){let{encode:d,decode:g}=yield function(){return N(this,null,function*(){return R_||(R_=new Promise(E=>N(this,null,function*(){let f={encode:!1,decode:!1},b=()=>{};try{ae.warn("detectH264Supported start");let w=document.createElement("canvas"),k=w.getContext("2d");w.width=320,w.height=240;let x=setInterval(()=>{k.fillText("test",Math.floor(320*Math.random()),Math.floor(240*Math.random()))},66),Y=-1,G=-1;b=()=>{clearInterval(Y),clearInterval(x),clearTimeout(G),me.close(),Te.close(),F.getTracks().forEach(jt=>jt.stop())},G=setTimeout(()=>{b(),E(f)},2e3);let F=w.captureStream(),me=new RTCPeerConnection({}),Te=new RTCPeerConnection({offerToReceiveAudio:!0,offerToReceiveVideo:!0});me.addEventListener("icecandidate",jt=>Te.addIceCandidate(jt.candidate)),Te.addEventListener("icecandidate",jt=>me.addIceCandidate(jt.candidate)),me.addTrack(F.getVideoTracks()[0],F);let Ze=yield me.createOffer();yield me.setLocalDescription(Ze),yield Te.setRemoteDescription(Ze);let qe=yield Te.createAnswer(),Ne=b0.default.parse(qe.sdp),eo=Ne.media[0].rtp.findIndex(jt=>jt.codec==="H264");Ne.media[0].rtp=[Ne.media[0].rtp[eo]],Ne.media[0].fmtp=Ne.media[0].fmtp.filter(jt=>jt.payload===Ne.media[0].rtp[0].payload),Ne.media[0].rtcpFb&&(Ne.media[0].rtcpFb=Ne.media[0].rtcpFb.filter(jt=>jt.payload===Ne.media[0].rtp[0].payload)),qe.sdp=b0.default.write(Ne),yield Te.setLocalDescription(qe),yield me.setRemoteDescription(qe),Y=setInterval(()=>N(this,null,function*(){f.encode&&f.decode&&(b(),E(f));let jt=yield me.getSenders()[0].getStats(),us=yield Te.getReceivers()[0].getStats();f.encode||jt.forEach(fn=>{fn.type==="outbound-rtp"&&fn.mediaType===O.VIDEO&&fn.bytesSent>0&&(f.encode=!0)}),f.decode||us.forEach(fn=>{fn.type==="inbound-rtp"&&fn.mediaType===O.VIDEO&&fn.bytesReceived>0&&(f.decode=!0)})}),100)}catch(w){b(),ae.warn(w),E(f)}})).then(E=>((!E.encode||!E.decode)&&ae.warn("detectH264Supported encode: ".concat(E.encode," decode: ").concat(E.decode," ").concat(Yn)),E)),R_)})}();n=d,d&&(c=g)}return it.result=e&&t&&i&&(n||a)&&(c||A),it.detail.isBrowserSupported=e,it.detail.isWebRTCSupported=t,it.detail.isWebCodecsSupported=r,it.detail.isMediaDevicesSupported=i,it.detail.isScreenShareSupported=Gh(),it.detail.isSmallStreamSupported=Yh(),it.detail.isH264EncodeSupported=n,it.detail.isVp8EncodeSupported=a,it.detail.isH264DecodeSupported=c,it.detail.isVp8DecodeSupported=A,it.result||ae.error("".concat(navigator.userAgent," ").concat(C0(it.detail,!1))),R0.setItem(x0,{ua:navigator.userAgent,checkResult:it}),it})),EQ=function(){return it.result},Gh=function(){return!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia)},R_=null,_Q=(e,t,r)=>{location.protocol==="http:"&&!Fc&&(e[t]=()=>{throw new pe({code:se.INVALID_OPERATION,message:xi.NOT_SUPPORTED_HTTP})})},Wd=function(e){return!(e.type!=="candidate-pair"||!e.nominated||e.state!=="in-progress"&&e.state!=="succeeded")&&!(ei(e.selected)&&!e.selected)};function O0(){let e="";if(screen.width){let t=screen.width?screen.width*window.devicePixelRatio:"",r=screen.height?screen.height*window.devicePixelRatio:"";e+="".concat(t," * ").concat(r)}return e}function k0(){return navigator.getUserMedia||navigator.mediaDevices&&navigator.mediaDevices.getUserMedia}function B0(){let e={isSupported:!1},t=["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"];for(let r=0;r<t.length;r++)if(t[r]in window){e.isSupported=!0;break}return e.isSupported}function N0(){return"captureStream"in HTMLCanvasElement.prototype}function Yh(){return!(wh||Gn||la&&la<63)&&!(!C_()||!N0())}var IQ=function(){if(K(window.RTCRtpTransceiver)||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let e=null,t=!1;try{e=new RTCPeerConnection({sdpSemantics:Td}),e.addTransceiver(O.AUDIO),t=!0}catch{}return e==null||e.close(),t};function Wh(){return"RTCPeerConnection"in window&&"getReceivers"in window.RTCPeerConnection.prototype}function Jd(){return"RTCPeerConnection"in window&&"getSenders"in window.RTCPeerConnection.prototype}function es(){return"RTCPeerConnection"in window&&"getTransceivers"in window.RTCPeerConnection.prototype}function Kn(){return l_!==11&&"RTCPeerConnection"in window&&"addTransceiver"in window.RTCPeerConnection.prototype}var Kd=!(!Kn()||ca&&la<86);function CQ(){return"RTCRtpTransceiver"in window&&"stop"in window.RTCRtpTransceiver.prototype}function P0(){return"RTCRtpSender"in window&&"replaceTrack"in window.RTCRtpSender.prototype}function b_(){return"RTCRtpSender"in window&&"setParameters"in window.RTCRtpSender.prototype&&Jd()}var Hc=window.MediaStreamTrack&&"getSettings"in MediaStreamTrack.prototype,M0=window.MediaStreamTrack&&"getCapabilities"in MediaStreamTrack.prototype,ma="RTCRtpSender"in window&&"createEncodedStreams"in window.RTCRtpSender.prototype&&Qd()>=86,w_=function(){return["RTCPeerConnection","webkitRTCPeerConnection","RTCIceGatherer"].filter(e=>e in window).length>0};function D_(){let e={AudioDecoder:!1,AudioEncoder:!1,VideoDecoder:!1,VideoEncoder:!1,ImageDecoder:!1};return K(window.AudioDecoder)||(e.AudioDecoder=!0),K(window.AudioEncoder)||(e.AudioEncoder=!0),K(window.VideoDecoder)||(e.VideoDecoder=!0),K(window.VideoEncoder)||(e.VideoEncoder=!0),K(window.ImageDecoder)||(e.ImageDecoder=!0),e}function L0(){return"mediaSession"in navigator&&!K(navigator.mediaSession.setActionHandler)}function Q0(){return!K(window.WebTransport)}function yQ(){let e={browser:"".concat(Xo.name,"/").concat(Xo.version),os:u_(),displayResolution:O0(),isScreenShareSupported:Gh(),isWebRTCSupported:w_(),isGetUserMediaSupported:k0(),isWebAudioSupported:B0(),isWebSocketsSupported:"WebSocket"in window&&window.WebSocket.CLOSING===2,isWebCodecSupported:D_(),isMediaSessionSupported:L0(),isWebTransportSupported:Q0()};return navigator.userAgent.includes("miniProgram")&&(e.browser="mini/".concat(e.browser)),e}var x0="checkResult";(function(){pa();let e=R0.getItem(x0);e&&e.ua===navigator.userAgent&&(it=e.checkResult),v_()})();var TQ=lr(Lr(),1),U0=Symbol("instance"),Jh=Symbol("cacheResult"),O_=class{constructor(e,t,r){this.oldState=e,this.newState=t,this.action=r,this.aborted=!1}abort(e){this.aborted=!0,zd.call(e,this.oldState,new Error("action '".concat(this.action,"' aborted")))}toString(){return"".concat(this.action,"ing")}},k_=class extends Error{constructor(e,t,r){super(t),this.state=e,this.message=t,this.cause=r}},Xd=new Map;function mr(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return(i,n,a)=>{let c=r.action||n;if(!r.context){let d=Xd.get(i)||[];Xd.has(i)||Xd.set(i,d),d.push({from:e,to:t,action:c})}let A=a.value;a.value=function(){let d=this;for(var g=arguments.length,E=new Array(g),f=0;f<g;f++)E[f]=arguments[f];if(r.context&&(d=tt.get(typeof r.context=="function"?r.context.call(this,...E):r.context)),d.state===t)return r.sync?d[Jh]:Promise.resolve(d[Jh]);d.state instanceof O_&&d.state.action==r.abortAction&&d.state.abort(d);let b=null;Array.isArray(e)?e.length==0?d.state instanceof O_&&d.state.abort(d):(typeof d.state!="string"||!e.includes(d.state))&&(b=new k_(d._state,"".concat(d.name," ").concat(c," to ").concat(t," failed: current state ").concat(d._state," not from ").concat(e.join("|")))):e!==d.state&&(b=new k_(d._state,"".concat(d.name," ").concat(c," to ").concat(t," failed: current state ").concat(d._state," not from ").concat(e)));let w=F=>{if(r.fail&&r.fail.call(this,F),r.sync){if(r.ignoreError)return F;throw F}return r.ignoreError?Promise.resolve(F):Promise.reject(F)};if(b)return w(b);let k=d.state,x=new O_(k,t,c);zd.call(d,x);let Y=F=>{var me;return d[Jh]=F,x.aborted||(zd.call(d,t),(me=r.success)===null||me===void 0||me.call(this,d[Jh])),F},G=F=>{let me=F instanceof Error?F.message:String(F);return zd.call(d,k,F),w(new k_(d._state,"action '".concat(c,"' failed :").concat(me),F instanceof Error?F:new Error(me)))};try{let F=A.apply(this,E);return function(me){return typeof me=="object"&&me&&"then"in me}(F)?F.then(Y).catch(G):r.sync?Y(F):Promise.resolve(Y(F))}catch(F){return G(F)}}}}var SQ=typeof window<"u"&&window.__AFSM__?(e,t)=>{window.dispatchEvent(new CustomEvent(e,{detail:t}))}:typeof importScripts<"u"?(e,t)=>{postMessage({type:e,payload:t})}:()=>{};function zd(e,t){let r=this._state;this._state=e;let i=e.toString();e&&this.emit(i,r),this.emit(tt.STATECHANGED,e,r,t),this.updateDevTools({value:e,old:r,err:t instanceof Error?t.message:String(t)})}var tt=class extends TQ.default{constructor(e,t,r){super(),this.name=e,this.groupName=t,this._state=tt.INIT,e||(e=Date.now().toString(36)),r?Object.setPrototypeOf(this,r):r=Object.getPrototypeOf(this),t||(this.groupName=this.constructor.name);let i=r[U0];i?this.name=i.name+"-"+i.count++:r[U0]={name:this.name,count:0},this.updateDevTools({diagram:this.stateDiagram})}get stateDiagram(){let e=Object.getPrototypeOf(this),t=Xd.get(e)||[],r=new Set,i=[],n=[],a=new Set,c=Object.getPrototypeOf(e);Xd.has(c)&&(c.stateDiagram.forEach(d=>r.add(d)),c.allStates.forEach(d=>a.add(d))),t.forEach(d=>{let{from:g,to:E,action:f}=d;typeof g=="string"?i.push({from:g,to:E,action:f}):g.length?g.forEach(b=>{i.push({from:b,to:E,action:f})}):n.push({to:E,action:f})}),i.forEach(d=>{let{from:g,to:E,action:f}=d;a.add(g),a.add(E),a.add(f+"ing"),r.add("".concat(g," --> ").concat(f,"ing : ").concat(f)),r.add("".concat(f,"ing --> ").concat(E," : ").concat(f," ð¢")),r.add("".concat(f,"ing --> ").concat(g," : ").concat(f," ð´"))}),n.forEach(d=>{let{to:g,action:E}=d;r.add("".concat(E,"ing --> ").concat(g," : ").concat(E," ð¢")),a.forEach(f=>{f!==g&&r.add("".concat(f," --> ").concat(E,"ing : ").concat(E))})});let A=[...r];return Object.defineProperties(e,{stateDiagram:{value:A},allStates:{value:a}}),A}static get(e){let t;return typeof e=="string"?(t=tt.instances.get(e),t||tt.instances.set(e,t=new tt(e,void 0,Object.create(tt.prototype)))):(t=tt.instances2.get(e),t||tt.instances2.set(e,t=new tt(e.constructor.name,void 0,Object.create(tt.prototype)))),t}static getState(e){var t;return(t=tt.get(e))===null||t===void 0?void 0:t.state}updateDevTools(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};SQ(tt.UPDATEAFSM,Object.assign({name:this.name,group:this.groupName},e))}get state(){return this._state}set state(e){zd.call(this,e)}};tt.STATECHANGED="stateChanged",tt.UPDATEAFSM="updateAFSM",tt.INIT="[*]",tt.ON="on",tt.OFF="off",tt.instances=new Map,tt.instances2=new WeakMap;var F0=(window==null?void 0:window.requestIdleCallback)||function(e){let t=Date.now();return setTimeout(()=>{e({didTimeout:!1,timeRemaining:()=>Math.max(0,50-(Date.now()-t))})},1e3)},vQ=(window==null?void 0:window.cancelIdleCallback)||function(e){clearTimeout(e)},RQ=(window==null?void 0:window.cancelAnimationFrame)||(window==null?void 0:window.mozCancelAnimationFrame),B_=class{static generateTaskID(){return this.currentTaskID++}static run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:wd,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;r=_e(e===vh?{delay:2e3,count:0,backgroundTask:!0}:e===bd?{delay:1e4,count:0}:e===VE?{fps:60,delay:16.6,count:0,backgroundTask:!0}:{delay:2e3,count:0,backgroundTask:!0},r),$o(t)&&(r=_e(_e({},r),t)),mt(e)&&(t=e,e=wd);let i=_e({taskID:this.generateTaskID(),loopCount:0,intervalID:null,timeoutID:null,rafID:null,ricID:null,taskName:e,callback:t},r);return this.taskMap.set(i.taskID,i),this[e](i),i.taskID}static interval(e){return e.intervalID=setInterval(()=>{e.callback(),e.loopCount+=1,this.isBreakLoop(e)},e.delay)}static intervalInWorker(e){e.delay=(1e3/e.fps).toFixed(2);let t=new Worker(URL.createObjectURL(new Blob([`
        let timerID = null;
        self.onmessage = function (e) {
          if (e.data === 'start') {
            timerID = setInterval(() => {
              self.postMessage('tick');
            }, `.concat(e.delay,`);
          } else if (e.data === 'stop') {
            clearInterval(timerID);
          }
        };
      `)],{type:"application/javascript"})));t.onmessage=r=>{r.data==="tick"&&(e.callback(),e.loopCount+=1,this.isBreakLoop(e)&&t.postMessage("stop"))},e.worker=t,t.postMessage("start")}static timeout(e){let t=()=>{if(e.callback(),e.loopCount+=1,!this.isBreakLoop(e))return e.timeoutID=setTimeout(t,e.delay)};return e.timeoutID=setTimeout(t,e.delay)}static ric(e){let t,r=He(),i=()=>{if(t=He()-r,t>=e.delay&&(r=He()-Math.floor(t%e.delay),e.callback(),e.loopCount+=1),!this.isBreakLoop(e))return e.ricID=F0(i,{timeout:e.delay})};return e.ricID=F0(i,{timeout:e.delay})}static raf(e){e.delay=(1e3/e.fps).toFixed(2);let t,r=He(),i=()=>document.hidden&&e.backgroundTask?(t=He()-r,r=He(),e.callback(),e.loopCount+=1,this.isBreakLoop(e)?void 0:e.timeoutID=setTimeout(i,e.delay-Math.floor(t%e.delay))):(t=He()-r,t>=e.delay&&(r=He()-Math.floor(t%e.delay),e.callback(),e.loopCount+=1),this.isBreakLoop(e)?void 0:e.rafID=requestAnimationFrame(i));if(e.rafID=requestAnimationFrame(i),e.backgroundTask){let n=()=>{if(document.hidden){let a=He()-r;a>=e.delay?i():e.timeoutID=setTimeout(i,e.delay-a)}};document.addEventListener("visibilitychange",n),e.onVisibilitychange=n,document.hidden&&n()}return e.taskID}static hasTask(e){return this.taskMap.has(e)}static clearTask(e){if(!this.taskMap.has(e))return!0;let{intervalID:t,timeoutID:r,rafID:i,ricID:n,onVisibilitychange:a,worker:c}=this.taskMap.get(e);return c&&c.terminate(),t&&clearInterval(t),r&&clearTimeout(r),i&&RQ(i),n&&vQ(n),a&&document.removeEventListener("visibilitychange",a),this.taskMap.delete(e),!0}static isBreakLoop(e){return!this.taskMap.has(e.taskID)||e.count!==0&&e.loopCount>=e.count&&(this.clearTask(e.taskID),!0)}};B_.taskMap=new Map,B_.currentTaskID=1;var Qt=B_,Si={LOADED_DATA:O.LOADEDDATA,MEDIA_TRACK_CHANGED:"media-track-changed",PLAYER_STATE_CHANGED:"player-state-changed",ERROR:"error"},N_={};fd(N_,{create:()=>Fi,remove:()=>br});var qd=new WeakMap;function Fi(e,t){qd.has(e)||qd.set(e,[]);let r=qd.get(e),i={add:(n,a)=>("addEventListener"in t?(r.push(t.removeEventListener.bind(t,n,a)),t.addEventListener(n,a)):(r.push(t.off.bind(t,n,a)),t.on(n,a)),i)};return i}function br(e){let t=qd.get(e);t&&(t.forEach(r=>r()),qd.delete(e))}var gn=new WeakMap;function fa(e){let{settings:t={retries:5,timeout:2e3},onError:r,onRetrying:i,onRetryFailed:n}=e;return function(a,c,A){let d=Ud({retryFunction:A.value,settings:t,onError(g){let{error:E,retry:f,reject:b,retryFuncArgs:w}=g;var k;r?r.call(this,E,()=>{var x;(x=gn.get(a))!=null&&x.has(c)?f():b(E)},b,w):(k=gn.get(a))!=null&&k.has(c)?f():b(E)},onRetrying(g,E){var f;mt(i)&&i.call(this,g,E),(f=gn.get(a))!=null&&f.has(c)&&(gn.get(a).get(c).stopRetry=E)},onRetryFailed:n});return A.value=function(){let g=gn.get(a);for(var E=arguments.length,f=new Array(E),b=0;b<E;b++)f[b]=arguments[b];return g?g.set(c,{args:f}):gn.set(a,new Map([[c,{args:f}]])),d.apply(this,f).finally(()=>{var w;return(w=gn.get(a))==null?void 0:w.delete(c)})},A}}function Kh(e){let{fnName:t,callback:r,validateArgs:i=!0}=e;return function(n,a,c){let A=c.value;return c.value=function(){for(var d,g,E=arguments.length,f=new Array(E),b=0;b<E;b++)f[b]=arguments[b];if((d=gn.get(n))!=null&&d.has(t)){let{stopRetry:w,args:k}=gn.get(n).get(t),x=!0;if(i){for(let Y of k)if(!f.find(G=>G===Y)){x=!1;break}}x&&(r&&r.apply(this,f),w&&w(),(g=gn.get(n))==null||g.delete(t))}return A.apply(this,f)},c}}var Vi,Ue,P_,V0=class{constructor(){let e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];this.countMap=new Map,this.distributionMap=new Map,this.log=ae.createLogger({id:"kv"}),e&&(te.on("102",t=>{let{track:r,cost:i}=t;this.addSuccessEvent({key:r.kind===O.AUDIO?M_.START_MICROPHONE:L_.START_CAMERA,cost:i})}),te.on("103",t=>{let{track:r,error:i}=t;this.addFailedEvent({key:r.kind===O.AUDIO?M_.START_MICROPHONE:L_.START_CAMERA,error:i})}))}getReportData(){let e={msg_sdk_basic_info:{uint32_sdk_version:T0(this.version||ln),uint32_terminal_type:15,bytes_device_name:"",bytes_os_version:"",uint32_framework:30,uint32_network_type:0},stats_count:[...this.countMap.entries()].map(t=>{let[r,i]=t;return{uint32_key:r,uint32_count:i}}),stats_distribution:[...this.distributionMap.entries()].map(t=>{let[r,i]=t;return{uint32_key:r,distribution_items:[...i.entries()].map(n=>{let[a,c]=n;return{uint32_item_key:a,uint32_item_value:c}})}})};return this.countMap.clear(),this.distributionMap.clear(),e}clear(){this.countMap.clear(),this.distributionMap.clear()}isEnumKey(e){let t=+String(e).slice(-3);return t>=700&&t<799}isErrorCodeKey(e){let t=+String(e).slice(-3);return t>=600&&t<699}isCountKey(e){let t=+String(e).slice(-3);return t>=0&&t<599}isNumberKey(e){let t=+String(e).slice(-3);return t>=800&&t<899}addCount(e){let{key:t,useUV:r=!1}=e;this.isCountKey(t)?r&&this.countMap.has(t)||this.countMap.set(t,(this.countMap.get(t)||0)+1):this.log.debug("".concat(t," is not count key, last 3 number should be 0~599"))}addEnum(e){let{key:t,value:r,useUV:i=!0}=e;var n;if(!this.isEnumKey(t))return this.log.debug("".concat(t," is not enum key, last 3 number should be 700~799"));if(i&&this.countMap.has(t))return;this.countMap.set(t,(this.countMap.get(t)||0)+1);let a=((n=this.distributionMap)==null?void 0:n.get(t))||new Map;a.set(r,(a.get(r)||0)+1),this.distributionMap.set(t,a)}addNumber(e){let{key:t,value:r,split:i=100,useUV:n=!1}=e;var a;if(!this.isNumberKey(t))return this.log.debug("".concat(t," is not number key, last 3 number should be 800~899"));if(n&&this.countMap.has(t))return;this.countMap.set(t,(this.countMap.get(t)||0)+1);let c=((a=this.distributionMap)==null?void 0:a.get(t))||new Map,A=0;if(qt(i))A=Math.floor(r/i);else for(let d=i.length-1;d>0;d--)if(r>i[d]){A=d;break}c.set(A,(c.get(A)||0)+1),this.distributionMap.set(t,c)}addSuccessEvent(e){let{key:t,cost:r,timeKey:i,split:n}=e;if(t&&(this.addEnum({key:t,value:1,useUV:!1}),r)){let a=+String(t).slice(-3);a<800&&a>=700?this.addNumber({key:i||t+100,value:r,split:n}):i||this.log.debug("time stat ignored, ".concat(t))}}addFailedEvent(e){let{key:t,error:r}=e;if(!t)return;let i=se.UNKNOWN;r&&(qt(r)?i=r:(!K(r.extraCode)||!K(r.code))&&(i=r.extraCode||r.code)),this.addEnum({key:t,value:0,useUV:!1}),this.addEnum({key:t,value:i,useUV:!1})}},j0=((Ue=j0||{})[Ue.enterRoom=500700]="enterRoom",Ue[Ue.exitRoom=500701]="exitRoom",Ue[Ue.switchRole=500702]="switchRole",Ue[Ue.destroy=500703]="destroy",Ue[Ue.startLocalAudio=500704]="startLocalAudio",Ue[Ue.updateLocalAudio=500705]="updateLocalAudio",Ue[Ue.stopLocalAudio=500706]="stopLocalAudio",Ue[Ue.startLocalVideo=500707]="startLocalVideo",Ue[Ue.updateLocalVideo=500708]="updateLocalVideo",Ue[Ue.stopLocalVideo=500709]="stopLocalVideo",Ue[Ue.startScreenShare=500710]="startScreenShare",Ue[Ue.updateScreenShare=500711]="updateScreenShare",Ue[Ue.stopScreenShare=500712]="stopScreenShare",Ue[Ue.startRemoteVideo=500713]="startRemoteVideo",Ue[Ue.updateRemoteVideo=500714]="updateRemoteVideo",Ue[Ue.stopRemoteVideo=500715]="stopRemoteVideo",Ue[Ue.muteRemoteAudio=500716]="muteRemoteAudio",Ue[Ue.setRemoteAudioVolume=500717]="setRemoteAudioVolume",Ue[Ue.use=500718]="use",Ue[Ue.sendSEIMessage=5e5]="sendSEIMessage",Ue[Ue.sendCustomMessage=500001]="sendCustomMessage",Ue),H0=((Vi=H0||{})[Vi.AudioMixer=550700]="AudioMixer",Vi[Vi.AIDenoiser=551700]="AIDenoiser",Vi[Vi.VirtualBackground=570700]="VirtualBackground",Vi[Vi.Beauty=571700]="Beauty",Vi[Vi.Watermark=572700]="Watermark",Vi),G0=(e=>(e[e.AudioMixer=550701]="AudioMixer",e[e.AIDenoiser=551701]="AIDenoiser",e[e.VirtualBackground=570701]="VirtualBackground",e[e.Beauty=571701]="Beauty",e[e.Watermark=572701]="Watermark",e))(G0||{}),Y0=(e=>(e[e.AudioMixer=550702]="AudioMixer",e[e.AIDenoiser=551702]="AIDenoiser",e[e.VirtualBackground=570702]="VirtualBackground",e[e.Beauty=571702]="Beauty",e[e.Watermark=572702]="Watermark",e))(Y0||{}),M_=(e=>(e[e.START_MICROPHONE=501700]="START_MICROPHONE",e[e.MICROPHONE_CAHNNELS=501701]="MICROPHONE_CAHNNELS",e[e.MICROPHONE_SAMPLERATE=501702]="MICROPHONE_SAMPLERATE",e))(M_||{}),L_=((P_=L_||{})[P_.START_CAMERA=511700]="START_CAMERA",P_),bQ=new V0(!0),$d=new V0(!1),ve=bQ,Gc=class extends tt{constructor(e,t){super(e.id,"".concat(t,"-player")),this.kind=t,T(this,"id"),T(this,"element",null),T(this,"track"),T(this,"url"),T(this,"attr"),T(this,"muted"),T(this,"_log"),T(this,"_pausedRetryCount"),T(this,"_isElementPlayingFired",!1),T(this,"_interval"),T(this,"_delayDestroyTimeoutId",0),T(this,"_isReplayByRecreateMediaStreamIng",!1),this.id=e.id,this._log=e.log,this.track=e.track,this.muted=e.muted,this._pausedRetryCount=Gv,this._state="STOPPED",this.bindTrackEvents(),this._log.info("create ".concat(t,"-player ").concat(this.id))}get isPlaying(){var e;return this._state==="PLAYING"&&((e=this.element)==null?void 0:e.paused)===!1}get isStopped(){return this._state==="STOPPED"}setAttr(e){this.attr=e}setUrl(e){this.track&&(this.unbindTrackEvents(),this.element&&(this.element.srcObject=null),this.track=null),e!==this.url&&(this.url=e,e!==null&&this.element&&(this.element.crossOrigin="anonymous",this.element.src=e))}play(){return N(this,null,function*(){if(!this.isPlaying)try{this._delayDestroyTimeoutId&&(clearTimeout(this._delayDestroyTimeoutId),this._delayDestroyTimeoutId=0,this.bindTrackEvents(),this.bindElementEvents()),this.bindAutoPlayEvent(),yield this.element.play()}catch(e){let t=Ve({key:xe.PLAY_FAILED,data:{media:this.kind,error:e}});if(this.track&&!this.track.muted&&this._log.warn(e),t.includes("NotAllowedError"))throw new pe({code:se.PLAY_NOT_ALLOWED,message:t})}})}stop(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this._isElementPlayingFired=!1,this.unbindEvents(),e>0?this._delayDestroyTimeoutId||(this._log.info("destroy element after 3 * ".concat(e)),this._delayDestroyTimeoutId=setTimeout(()=>this.destroyElement(),3*e)):this.destroyElement(),this.handleStopped(O.ENDED),this._interval>0&&Qt.clearTask(this._interval)}destroyElement(){this.element&&(this._log.debug("destroy element"),this.element.remove(),this.element.srcObject=null,this.element=null),clearTimeout(this._delayDestroyTimeoutId),this._delayDestroyTimeoutId=0}pause(){var e;this.isPlaying&&((e=this.element)==null||e.pause())}resume(){return this._log.info("resume"),this.isPlaying?Promise.resolve():r0?this.replay():this.play().catch(()=>{})}setMuted(e){this.element&&(this.element.muted=e),this.muted=e}replay(){return this.stop(),this.play().catch(()=>{})}bindElementEvents(){if(this.element){let e=this.handleElementEvent.bind(this);return Fi(this.element,this.element).add(O.PLAYING,e).add(O.ENDED,e).add(O.PAUSE,e).add(O.ERROR,e).add(O.LOADEDDATA,e)}}bindTrackEvents(){if(this.track){let e=this.handleTrackEvent.bind(this);N_==null||N_.create(this.track,this.track).add(O.ENDED,e).add(O.MUTE,e).add(O.UNMUTE,e),this.track.readyState===O.ENDED&&this.handleTrackEvent({type:O.ENDED}),this.track.muted&&this.handleTrackEvent({type:O.MUTE})}}bindAutoPlayEvent(){te.on(X.AUTOPLAY_DIALOG_CLICK_CONFIRM,this.resume,this)}unbindTrackEvents(){this.track&&br(this.track)}unbindEvents(){this.element&&br(this.element),this.unbindTrackEvents(),te.off(X.AUTOPLAY_DIALOG_CLICK_CONFIRM,this.resume,this)}handleElementEvent(e){switch(e.type){case O.PLAYING:this._isElementPlayingFired=!0,this._log.info("".concat(this.kind," player is playing")),this.handlePlaying(O.PLAYING),this._interval&&(Qt.clearTask(this._interval),this._interval=-1);break;case O.ENDED:this._log.info("".concat(this.kind," player is ended")),this.handleStopped(O.ENDED);break;case O.PAUSE:this._log.info("".concat(this.kind," player is paused")),this.handlePaused(O.PAUSE),Gn&&(this._interval=Qt.run(wd,()=>{this.element&&this._state==="PAUSED"&&this.resume()},{delay:3e3}));break;case O.ERROR:if(this.element&&this.element.error){this.handlePaused(O.ERROR);let{code:t,message:r}=this.element.error;this._log.error("".concat(this.kind," ").concat(this._log.isLocal?"local":"remote"," MediaError code: ").concat(t," message: ").concat(r," userAgent: ").concat(navigator.userAgent)),Lt.uploadEvent({log:"stat-".concat(this.kind,"-").concat(Hn.PLAYER_ERROR,"-").concat(t,"-").concat(navigator.userAgent),error:this.element.error}),this.replayByRecreateMediaStream()}break;case O.LOADEDDATA:this.kind===O.VIDEO&&this.emit(Si.LOADED_DATA)}}replayByRecreateMediaStream(){if(!this._isReplayByRecreateMediaStreamIng)return this._isReplayByRecreateMediaStreamIng=!0,this.doReplayByRecreateMediaStream(1e3).then(()=>{this._log.warn("replayByRecreateMediaStream success"),Lt.uploadEvent({log:"stat-replayByRecreateMediaStream-success"}),ve.addSuccessEvent({key:this.kind===O.AUDIO?506700:516700})}).catch(()=>{var e,t;this._log.error("replayByRecreateMediaStream failed"),Lt.uploadEvent({log:"stat-replayByRecreateMediaStream-failed"}),ve.addFailedEvent({key:this.kind===O.AUDIO?506700:516700,error:(e=this.element)==null?void 0:e.error}),(t=this.element)!=null&&t.error&&this.emit(Si.ERROR,this.element.error)}).finally(()=>{this._isReplayByRecreateMediaStreamIng=!1})}doReplayByRecreateMediaStream(e){return this._log.warn("delay ".concat(e,"ms to recreate mediaStream")),new Promise((t,r)=>{I_(e).then(()=>{this.element&&(this.element.srcObject=null,this.element.srcObject=new MediaStream([this.track]),this._log.warn("recreated mediaStream"),this.element.onerror=()=>{var i,n,a;this._log.warn("element onerror ".concat((n=(i=this.element)==null?void 0:i.error)==null?void 0:n.code," fired after recreated mediaStream")),r((a=this.element)==null?void 0:a.error)}),I_(5e3).then(()=>{var i,n;(!this.isPlaying||(i=this.element)!=null&&i.error)&&r((n=this.element)==null?void 0:n.error),t()})})}).finally(()=>{this.element&&(this.element.onerror=null)})}handleTrackEvent(e){switch(e.type){case O.ENDED:this.handleStopped(O.ENDED);break;case O.MUTE:this.handlePaused(O.MUTE);break;case O.UNMUTE:this._isElementPlayingFired&&this.handlePlaying(O.UNMUTE)}}handlePlaying(e){this.emit(Si.PLAYER_STATE_CHANGED,{type:this.kind,state:"PLAYING",reason:e})}handlePaused(e){this.emit(Si.PLAYER_STATE_CHANGED,{type:this.kind,state:"PAUSED",reason:e})}handleStopped(e){this.emit(Si.PLAYER_STATE_CHANGED,{type:this.kind,state:"STOPPED",reason:e})}getElement(){return this.element}};le([fa({settings:{retries:2,timeout:0},onError(e,t,r,i){i[0]=(i[0]||1e3)+1e3,t()}})],Gc.prototype,"doReplayByRecreateMediaStream",1),le([mr([],"PLAYING",{sync:!0})],Gc.prototype,"handlePlaying",1),le([mr("PLAYING","PAUSED",{ignoreError:!0,sync:!0})],Gc.prototype,"handlePaused",1),le([mr([],"STOPPED",{sync:!0})],Gc.prototype,"handleStopped",1);var Xn="trtc_autoplay",Q_="".concat(Xn,"_mask"),Yc="".concat(Xn,"_wrapper"),W0="".concat(Xn,"_header"),x_="".concat(Xn,"_content"),Xh="".concat(Xn,"_action_wrapper"),U_="".concat(Xn,"_question"),F_="".concat(Xn,"_collapse"),zh="".concat(Xn,"_action_confirm"),J0="".concat(Xn,"_detail"),K0="#2473E8",V_="dialog",wQ="".concat(V_,"-show"),DQ="".concat(V_,"-1"),OQ="".concat(V_,"-2"),X0=!1,z0=()=>!!document.querySelector(".".concat(Yc)),q0="".concat(na,"/").concat(qo()?"zh-cn":"en","/tutorial-21-advanced-auto-play-policy.html"),$0="<br><a href='".concat(q0,"' target='_blank'>").concat(qo()?"å¶ä»æ¹æ¡ï¼":"Any other solution?","</a>"),kQ="".concat(qo()?"æµè§å¨èªå¨æ­æ¾ç­ç¥ï¼å¨ç¨æ·ä¸é¡µé¢äº§çäº¤äºï¼ç¹å»ãè§¦æ¸ï¼ä¹åï¼æµè§å¨ç¦æ­¢æ­æ¾æå£°åªä½ãè¯¥å¼¹çªç¨äºå¸®å©ç¨æ·æ¢å¤é³è§é¢æ­æ¾ã".concat($0):"Autoplay Policy: Before user interacts with the web page (clicking, touching), page will not be allowed to play media with sound. This Dialog is used to help users resume playback. ".concat($0)),BQ=class{constructor(){if(T(this,"content","é³è§é¢æ­æ¾è¢«æµè§å¨æ¦æªï¼è¯·ç¹å»âæ¢å¤æ­æ¾âã"),T(this,"_dialogNode",null),T(this,"_bodyPosition",""),T(this,"_showDetail",!1),T(this,"_isCollapseClicked",!1),T(this,"_isQuestionClicked",!1),qo()||(this.content='Media playback failed. Click the "Resume" to resume playback.'),!X0){let e=document.createElement("style");e.innerHTML=".".concat(Q_,"{position:fixed;top:0;left:0;right:0;bottom:0;width:100vw;height:100vh;display:flex;justify-content:center;align-items:center;background:rgba(0,0,0,0.5);z-index:1500;}.").concat(Q_," div:not(.").concat(Xh,"){display:block !important;}.").concat(Yc,"{padding:14px;background:#fff;border-radius:3px;box-shadow:0px 3px 15px #434343;border:1px solid #d1cfcf;max-width:500px;}.").concat(Yc," a{color:").concat(K0,";}.").concat(W0,"{overflow:hidden;text-overflow:ellipsis;font-size:16px;font-weight:600;}.").concat(x_,"{margin:8px 0;}.").concat(Xh,"{width:100%;display:flex !important;align-items:center;justify-content:right;float:right;}.").concat(F_,"{margin-right:auto;cursor:pointer}.").concat(U_,"{height:100%;line-height:16px;cursor:pointer;}.").concat(zh,"{margin-left:8px;color:#fff;background:").concat(K0,";padding:4px 12px;outline:none;border:1px solid;border-radius:3px;font-weight:bold;}.").concat(zh,":hover{opacity:0.9;}.").concat(F_,",.").concat(zh,",.").concat(x_,",.").concat(U_,"{font-size:14px;}@media screen and (max-width:750px){.").concat(Yc,"{width:80vw;}}"),document.head.appendChild(e),X0=!0}this.addDiaLog()}createDiaLog(){let e=document.createElement("template");e.innerHTML='<div class="'.concat(Q_,`"><div class='`).concat(Yc,"'><div class='").concat(W0,"'>").concat(location.host,"</div><div class='").concat(x_,"'>").concat(this.content,"</div><div class='").concat(J0,`' style="visibility:hidden;width:100%;height:0;font-size:12px;color:gray;">`).concat(kQ,"</div><div class='").concat(Xh,"'></div></div></div>").trim();let t=document.createElement("button");t.className=zh,t.innerText=qo()?"æ¢å¤æ­æ¾":"Resume",t.onclick=this.onConfirm.bind(this);let r=document.createElement("div");r.className=U_,r.innerHTML=`<?xml version="1.0" encoding="UTF-8"?>
    <svg class="icon" width="18" height="18" p-id="2030" t="1639646523624" version="1.1" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
    <path d="m464 784.35c0 26.51 21.49 48 48 48s48-21.49 48-48-21.49-48-48-48-48 21.49-48 48z" p-id="2031"/>
    <path d="m512 960c-247.04 0-448-200.96-448-448s200.96-448 448-448 448 200.96 448 448-200.96 448-448 448zm0-831.71c-211.58 0-383.71 172.13-383.71 383.71 0 211.55 172.13 383.71 383.71 383.71 211.55 0 383.71-172.16 383.71-383.71 0-211.58-172.16-383.71-383.71-383.71z" p-id="2032"/>
    <path d="m512 673.7c-17.665 0-32.001-14.336-32.001-31.999v-54.112c0-52.353 40-92.352 75.328-127.65 25.887-25.92 52.672-52.672 52.672-74.017 0-53.343-43.072-96.735-95.999-96.735-53.823 0-95.999 41.536-95.999 94.559 0 17.665-14.336 31.999-32.001 31.999s-32.001-14.336-32.001-31.999c0-87.424 71.775-158.56 160-158.56s160 72.095 160 160.74c0 47.904-36.32 84.192-71.424 119.3-27.84 27.776-56.576 56.512-56.576 82.336v54.112c0 17.665-14.336 32.032-32.001 32.032z" p-id="2033"/>
    </svg>
    `,r.onclick=this.onQuestionClick.bind(this);let i=document.createElement("div");i.className=F_,i.innerText="".concat(qo()?"è¯¦æ >":"Detail >"),i.onclick=this.onCollapseClick.bind(this);let n=e.content.firstChild,a=n.querySelector(".".concat(Xh));return a.appendChild(i),a.appendChild(r),a.appendChild(t),n}addDiaLog(){z0()||(this._dialogNode=this.createDiaLog(),document.body.appendChild(this._dialogNode),this._dialogNode.onclick=this.onConfirm.bind(this),this._dialogNode.querySelector(".".concat(Yc)).onclick=e=>e.stopPropagation(),this._bodyPosition=document.body.style.position,document.body.style.position="fixed",ae.info("show autoplay dialog"),Lt.uploadEvent({log:wQ}))}deleteDiaLog(){this._dialogNode&&(document.body.removeChild(this._dialogNode),document.body.style.position=this._bodyPosition,this._dialogNode=null)}onConfirm(){ae.warn("confirm clicked, try resume stream"),te.emit(X.AUTOPLAY_DIALOG_CLICK_CONFIRM),this.deleteDiaLog()}onCollapseClick(){let e=this._dialogNode.querySelector(".".concat(J0));e.style.visibility="".concat(this._showDetail?"hidden":"visible"),e.style.height="".concat(this._showDetail?0:"fit-content"),this._showDetail=!this._showDetail,this._isCollapseClicked||Lt.uploadEvent({log:DQ}),this._isCollapseClicked=!0}onQuestionClick(){window.open(q0,"_blank"),this._isQuestionClicked||Lt.uploadEvent({log:OQ}),this._isQuestionClicked=!0}},ts=class extends Gc{constructor(e){super(e,O.VIDEO),T(this,"viewMirror",!1),T(this,"objectFit"),T(this,"container"),T(this,"canvas"),this.container=e.container,this.canvas=e.canvas,K(e.viewMirror)||(this.viewMirror=e.viewMirror),K(e.objectFit)||(this.objectFit=e.objectFit),this.initializeElement()}initializeElement(){var e;let t=document.createElement(O.VIDEO);this.track&&(t.srcObject=new MediaStream([this.track])),t.muted=!0,t.setAttribute("id","video_".concat(this.id)),t.setAttribute("style",this.styleAttribute),this.canvas&&this.canvas.setAttribute("style",this.styleAttribute),t.setAttribute("autoplay","autoplay"),t.setAttribute("playsinline","playsinline"),this.element=t,(e=this.container)==null||e.appendChild(this.elementToRender),this.bindElementEvents()}get styleAttribute(){let e="width: 100%; height: 100%; object-fit: ".concat(this.objectFit,";background-color: black;");return this.viewMirror&&(e+="transform: scaleX(-1);"),e}setContainer(e){var t;this.container=e,this.track&&this.elementToRender&&((t=this.container)==null||t.appendChild(this.elementToRender))}bindElementEvents(){let e=super.bindElementEvents();this.handleElementEvent=this.handleElementEvent.bind(this),e&&e.add(O.ENTER_PICTURE_IN_PICTURE,this.handleElementEvent).add(O.LEAVE_PICTURE_IN_PICTURE,this.handleElementEvent)}handleElementEvent(e){var t;super.handleElementEvent(e);let r=e.type;if(r===O.PAUSE&&(this.container&&document.getElementById(this.container.id)||this._log.warn("".concat(this.kind," player has been remove, element ID: ").concat((t=this.container)==null?void 0:t.id)),this._pausedRetryCount>0&&!z0()&&(this._log.info("".concat(this.kind," player auto resume when paused")),this.resume(),this._pausedRetryCount--)),this.viewMirror&&this.element){let i=this.element.style.transform;r===O.ENTER_PICTURE_IN_PICTURE?this.element.style.transform=i.replace("scaleX(-1)",""):r===O.LEAVE_PICTURE_IN_PICTURE&&!i.includes("scaleX")&&(this.element.style.transform="".concat(i," scaleX(-1)"))}}setCanvas(e){var t,r;this.canvas!==e&&((t=this.canvas)==null||t.remove(),e==null||e.setAttribute("style",this.styleAttribute),this.canvas=e,e&&((r=this.container)==null||r.appendChild(e)))}setAttr(e){let t=Object.assign({autoplay:"autoplay",playsinline:"playsinline",muted:!0},e);t.style=Object.assign({width:"100%",height:"100%"},t.style),super.setAttr(t)}get mirror(){return this.viewMirror}setRect(e,t){this.elementToRender&&(this.elementToRender.style.width="".concat(e,"px"),this.elementToRender.style.height="".concat(t,"px"))}setViewMirror(e){this.elementToRender&&(this.elementToRender.style.transform=e?"scaleX(-1)":""),this.viewMirror=e}setObjectFit(e){this.elementToRender&&(this.elementToRender.style.objectFit="".concat(e)),this.objectFit=e}stop(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;var t;super.stop(e),(t=this.canvas)==null||t.remove()}play(){return this.element?this.elementToRender&&this.elementToRender.parentElement!==this.container&&this.container&&this.container.append(this.elementToRender):this.initializeElement(),super.play()}get elementToRender(){return this.canvas||this.element}setTrack(e){e!==this.track&&(this.unbindTrackEvents(),this.track=e,this.emit(Si.MEDIA_TRACK_CHANGED,e),e!==null&&(this.bindTrackEvents(),this.element&&(this.element.srcObject=new MediaStream([e]),this.element.remove()),this.elementToRender&&this.elementToRender.parentElement!==this.container&&this.container&&this.container.append(this.elementToRender)))}getVideoFrame(){if(this.canvas)return this.canvas.toDataURL("image/png");if(!this.element)return"";let e=document.createElement("canvas");return e.width=this.element.videoWidth,e.height=this.element.videoHeight,e.getContext("2d").drawImage(this.element,0,0),e.toDataURL("image/png")}getElement(){return this.element}};function j_(e,t){return N(this,null,function*(){if(!e.audioWorklet)return Promise.reject("audioWorklet is not supported");try{yield e.audioWorklet.addModule(t),ae.info("worklet addModule success")}catch(r){throw ae.info("worklet addModule catch error. ".concat(r.message)),r}})}typeof window<"u"&&(window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext);var Ea=new window.AudioContext({sampleRate:48e3}),qh=()=>{Ea.state==="suspended"?(Ea.resume(),document.addEventListener("click",qh)):Ea.state==="interrupted"?Ea.resume():document.removeEventListener("click",qh)};document.addEventListener("click",qh),Ea.onstatechange=()=>{ae.info("context state: ".concat(Ea.state)),qh()};var rs=e=>Ea,_a=class{constructor(){this.pre=new Set,this.next=new Set,this.connectedNodes=new Set,this._channelCount=1}get channelCount(){return this._channelCount}set channelCount(e){this._channelCount=e,this.node&&(this.node.channelCount=e),this.next.forEach(t=>t.channelCount=e)}setContext(e){this.context=e,this.node&&e.addMixWeight()}removeContext(){var e;this.node&&((e=this.context)==null||e.reduceMixWeight()),delete this.context}setNode(e){var t;if(!this.node)try{(t=this.context)==null||t.addMixWeight(),this.node=e,this.node.channelCountMode="explicit",this.node.channelCount=this._channelCount,this.preNodeReconnect(),this.reconnect(),ve.addSuccessEvent({key:502701})}catch(r){ae.error(r),ve.addFailedEvent({key:502701,error:r})}}deleteNode(){var e;if(this.node)try{this._disconnect(),delete this.node,(e=this.context)==null||e.reduceMixWeight(),this.preNodeReconnect(),ve.addSuccessEvent({key:502702})}catch(t){ae.error(t),ve.addFailedEvent({key:502702,error:t})}}preNodeReconnect(){this.pre.forEach(e=>{e.node?e.reconnect():e.preNodeReconnect()})}connectNext(e){this.next.forEach(t=>e._connect(t.node)||t.connectNext(e))}_connect(e){return!(!this.node||!e)&&(this.node.connect(e),this.connectedNodes.add(e),!0)}_disconnect(){this.connectedNodes.forEach(e=>{var t;return(t=this.node)==null?void 0:t.disconnect(e)}),this.connectedNodes.clear()}reconnect(){this._disconnect(),this.connectNext(this)}pipeTo(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.forEach(i=>{this.next.add(i),i.pre.add(this)}),this}},NQ=class extends _a{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:256;super(),this.fftSize=e,this.dataArray=new Uint8Array(0)}setNode(e){e.fftSize=this.fftSize,this.dataArray=new Uint8Array(e.frequencyBinCount),super.setNode(e)}getByteTimeDomainData(){var e;return(e=this.node)==null||e.getByteTimeDomainData(this.dataArray),this.dataArray}get level(){var e;return(e=this.node)==null||e.getByteTimeDomainData(this.dataArray),Math.max(...this.dataArray)/128-1}get timeDomainPathData(){let e=this.getByteTimeDomainData(),t=0,r=0,i="M".concat(t,",").concat(r);for(let n=0;n<e.length;n++)r=e[n]/128*100/2,i+="L".concat(t,",").concat(r),t+=1;return i}},Z0=class{constructor(){this.source=new _a,this.gain=new _a,this.destination=new _a}get volume(){var e;return((e=this.gain.node)==null?void 0:e.gain.value)||1}setVolume(e){e!==1?(this.gain.node||this.gain.setNode(this.source.node.context.createGain()),this.gain.node.gain.value=e):this.gain.node&&this.gain.deleteNode()}replaceSource(e){this.source.deleteNode(),this.source.setNode(function(t){let r=tR.get(t);if(r)return r;let i=rs();if(t instanceof HTMLAudioElement)r=i.createMediaElementSource(t);else{if(!(t instanceof MediaStreamTrack))return t;r=i.createMediaStreamSource(new MediaStream([t]))}return tR.set(t,r),r}(e))}get track(){var e;return(e=this.stream)==null?void 0:e.getAudioTracks()[0]}get stream(){var e;return(e=this.destination.node)==null?void 0:e.stream}},eR=class extends Z0{constructor(e){super(),this.context=e,this.denoiser=new _a,this.source.pipeTo(this.denoiser.pipeTo(this.gain.pipeTo(this.destination)))}connect(){this.context.inputs.has(this)||(this.destination.setNode(this.context.destination),this.source.setContext(this.context),this.denoiser.setContext(this.context),this.gain.setContext(this.context),this.context.inputs.add(this))}disconnect(){!this.context.inputs.has(this)||(this.destination.deleteNode(),this.source.removeContext(),this.denoiser.removeContext(),this.gain.removeContext(),this.context.inputs.delete(this))}remove(){this.gain.deleteNode(),this.denoiser.deleteNode(),this.source.deleteNode(),this.disconnect()}setVolume(e){e!==1?(this.gain.node||this.gain.setNode(this.context.audioContext.createGain()),this.gain.node.gain.value=e):this.gain.node&&this.gain.deleteNode()}},PQ=class{constructor(){this.audioContext=rs(),this.destination=this.audioContext.createMediaStreamDestination(),this.inputs=new Set,this.mixWeight=0}addMixWeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;this.mixWeight+=e,this.mixWeight-1==e+1>>1&&this.mixOnChange()}reduceMixWeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;this.addMixWeight(-e)}close(){this.inputs.forEach(e=>e.remove())}get mixTrack(){return this.destination.stream.getAudioTracks()[0]}},tR=new WeakMap,Wc=class{constructor(e){T(this,"_volume",0),T(this,"_log"),T(this,"_scriptProcessorNode",null),T(this,"_audioWorkletNode",null),T(this,"_interval",200),T(this,"ready",this.preload());let{log:t}=e;this._log=t,te.on(X.AUDIO_LEVEL_INTERVAL,this.handleAudioLevelInterval,this)}get node(){return this._audioWorkletNode||this._scriptProcessorNode}preload(){return Wc.workletReady||(Wc.workletReady=j_(Wc.audioContext,URL.createObjectURL(new Blob([`
class VolumeMeter extends AudioWorkletProcessor{constructor(){super();this.volume=0;this.intervalTime=200;this.tick=this.intervalTime;this.isStop=false;this.cache=[];this.sentFirstInfo1=false;this.unmute=false;this.port.onmessage=(event)=>{const{data}=event;switch(data.name){case"chunk":this.cache.push.apply(this.cache,data.data);if(!this.sentFirstInfo1){this.port.postMessage({cl:data.data.length});this.sentFirstInfo1=true;}
break;case"setIntervalTime":this.intervalTime=data.intervalTime;break;case"unmute":this.unmute=true;break;case"stop":this.isStop=true;break;}};}
process(inputs,outputs){const input=inputs[0];const output=outputs[0];if(!input&&!output){return true;}
if(this.isStop){return false;}
const l=output?output[0].length:0;const cl=this.cache.length;if(cl>l){output[0].set(this.cache.slice(0,l));this.cache=this.cache.slice(l);}else if(this.unmute){output[0].set(input[0]);}
const firstChannel=cl>l?output[0]:input[0];if(!firstChannel){return true;}
let sum=0;let rms;for(let i=0;i<firstChannel.length;++i){sum+=firstChannel[i]*firstChannel[i];}
rms=Math.sqrt(sum/firstChannel.length);this.volume=Math.max(rms,this.volume*0.95);this.tick-=firstChannel.length;if(this.tick<0){this.tick+=(this.intervalTime/1000)*sampleRate;this.port.postMessage({volume:this.volume,cacheLen:cl,outputLen:l});}
return true;}}
registerProcessor("volume-meter",VolumeMeter);
`],{type:"application/javascript"})))),Wc.workletReady.then(()=>this.initAudioWorklet()).catch(()=>this.initScriptProcessor())}initAudioWorklet(){if(!this._audioWorkletNode)try{this._audioWorkletNode=new AudioWorkletNode(Wc.audioContext,"volume-meter");let e=!1;this._audioWorkletNode.port.onmessage=t=>{this._volume=t.data.volume||0,!e&&t.data.cacheLen&&t.data.outputLen&&(this._log.warn("worklet play success"),e=!0)},this.handleAudioLevelInterval({interval:this._interval})}catch(e){Lt.logFailedEvent({userId:this._log.userId,eventType:Hn.LOAD_WORKLET,error:e}),this.initScriptProcessor()}}initScriptProcessor(){if(!this._scriptProcessorNode)try{this._scriptProcessorNode=rs().createScriptProcessor(2048,1,1),this._scriptProcessorNode.onaudioprocess=e=>{let t=e.inputBuffer.getChannelData(0),r=0;for(let i=0;i<t.length;++i)r+=t[i]*t[i];this._volume=Math.sqrt(r/t.length)||0}}catch(e){this._log.error("volumeMeter init script processor error: ".concat(e))}}destroy(){this._scriptProcessorNode&&(this._scriptProcessorNode.onaudioprocess=null),this._audioWorkletNode&&(this._audioWorkletNode.port.postMessage({name:"stop"}),this._audioWorkletNode.port.onmessage=null),this._audioWorkletNode=null,this._scriptProcessorNode=null,te.off(X.AUDIO_LEVEL_INTERVAL,this.handleAudioLevelInterval,this)}getInternalAudioLevel(){return this._volume}getCalculatedVolume(){return parseFloat(this._volume.toFixed(2))}handleAudioLevelInterval(e){var t;let{interval:r}=e;this._interval=r,(t=this._audioWorkletNode)==null||t.port.postMessage({name:"setIntervalTime",intervalTime:r})}},H_=Wc;T(H_,"audioContext",rs()),T(H_,"workletReady");var MQ=class extends _a{constructor(e){super(),T(this,"_volumeMeter"),this._volumeMeter=new H_(e)}deleteNode(){super.deleteNode(),this._volumeMeter.destroy()}init(){return N(this,null,function*(){yield this._volumeMeter.preload(),this.setNode(this._volumeMeter.node)})}getCalculatedVolume(){return this._volumeMeter.getCalculatedVolume()}getInternalAudioLevel(){return this._volumeMeter.getInternalAudioLevel()}write(e){if(this.node){let t=e.allocationSize({planeIndex:0}),r=new Float32Array(t>>2);e.copyTo(r,{planeIndex:0}),this.node.port.postMessage({name:"chunk",data:r},[r.buffer]),e.close()}}},LQ=lr(Lr(),1),rR=e=>t=>t.deviceId===e,G_=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Input";T(this,"kind"),T(this,"type"),T(this,"devices",[]),this.kind=e,this.type=t}update(e,t){let r=e.filter(i=>i.kind==="".concat(this.kind).concat(this.type.toLocaleLowerCase()));this.devices.length===1&&Zd(this.devices[0])||t&&(r.forEach(i=>{if(i.deviceId&&!this.devices.find(rR(i.deviceId))){let n="".concat(this.kind).concat(this.type,"Added");ae.warn("".concat(n,": ").concat(JSON.stringify(i))),t.emit(n,i)}}),this.devices.forEach(i=>{if(i.deviceId&&!r.find(rR(i.deviceId))){let n="".concat(this.kind).concat(this.type,"Removed");ae.warn("".concat(n,": ").concat(JSON.stringify(i))),t.emit(n,i)}})),this.devices=r}hasDevice(e){return!!this.devices.find(t=>t.deviceId===e)}},QQ=class extends LQ.EventEmitter{constructor(){super(),T(this,"audioInputs",new G_(O.AUDIO)),T(this,"videoInputs",new G_(O.VIDEO)),T(this,"audioOutputs",new G_(O.AUDIO,"Output")),this.init(),navigator.mediaDevices&&(navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",()=>this.update()),"ondevicechange"in navigator.mediaDevices||Qt.run(vh,()=>{this.update()},{delay:1e4}))}init(){Y_().then(e=>{this.audioInputs.update(e),this.videoInputs.update(e),this.audioOutputs.update(e)})}update(){return N(this,arguments,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function*(){let r=yield Y_(t);return e.audioInputs.update(r,e),e.videoInputs.update(r,e),e.audioOutputs.update(r,e),e}()})}},fr=OE||_h?null:new QQ;function Zd(e){return e.deviceId===e.groupId&&e.groupId===""}function Y_(){return N(this,arguments,function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function*(){if(pa()||!y_())return[];let t=yield navigator.mediaDevices.enumerateDevices();if(e!==0){let r={audio:!1,video:!1};if(t.forEach(i=>{Zd(i)&&(i.kind===O.AUDIO_INPUT?r.audio=!0:i.kind===O.VIDEO_INPUT&&(r.video=!0))}),e===2&&(r.audio=!1),e===1&&(r.video=!1),r.audio||r.video){let i;try{i=yield navigator.mediaDevices.getUserMedia(r)}catch(n){ae.debug("capture before getDevices failed: ",n)}t=yield navigator.mediaDevices.enumerateDevices(),i==null||i.getTracks().forEach(n=>n.stop())}}return t.map((r,i)=>{let n={kind:r.kind,deviceId:r.deviceId,groupId:r.groupId,label:r.label||"".concat(r.kind,"_").concat(i)};return r.deviceId.length>0&&W_.add("".concat(r.deviceId,"_").concat(r.kind)),r.getCapabilities&&(n.getCapabilities=()=>r.getCapabilities()),n})}()})}function zn(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return fr.update(e?1:0).then(t=>t.audioInputs.devices)}function is(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return fr.update(e?2:0).then(t=>t.videoInputs.devices)}var iR=!1;function Jc(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return N(this,null,function*(){return fr.update(e?1:0).then(t=>t.audioOutputs.devices)})}var W_=new Set;function nR(e,t){return N(this,null,function*(){let r=(yield zn()).find(i=>i.deviceId===Sd);return(r==null?void 0:r.groupId)===e&&r.label===t})}var $h,xQ=class extends Z0{constructor(e){super(),this.log=e,T(this,"volumeMeter"),T(this,"volumeDestination"),T(this,"analyser",new NQ),this.volumeMeter=new MQ({log:this.log}),this.volumeDestination=new _a,this.volumeMeter.pipeTo(this.volumeDestination)}destory(){this.gain.deleteNode(),this.volumeMeter.deleteNode(),this.analyser.deleteNode(),this.source.deleteNode(),this.destination.deleteNode(),this.volumeDestination.deleteNode()}},J_=class extends Gc{constructor(e){super(e,O.AUDIO),T(this,"_outputDeviceId"),T(this,"_volume",1),T(this,"_destination",rs().createMediaStreamDestination()),T(this,"pipeline"),T(this,"volumeMeterMode","worklet"),this.pipeline=new xQ(this._log)}getMediaStream(){return this.pipeline.stream||(this.track?new MediaStream([this.track]):null)}initializeElement(){if((da==="15.2"||da==="15.3"||da==="15.4")&&this.muted)return void this._log.info("audioElement is muted.");let e=$h||new Audio;e.setAttribute("autoplay","autoplay"),e.srcObject=this.getMediaStream(),e.muted=this.muted,this.element=e,e===$h&&($h=void 0),this.bindElementEvents()}play(){return N(this,null,function*(){if(this.track)return this.pipeline.source.node||this.pipeline.replaceSource(this.track),this.element||this.initializeElement(),this._outputDeviceId&&(yield this.setSinkId(this._outputDeviceId)),this.volumeMeterMode==="worklet"?this.pipeline.volumeMeter.init():this.volumeMeterMode==="analyser"&&this.pipeline.analyser.setNode(rs().createAnalyser()),this.setVolume(this._volume),function(){N(this,null,function*(){try{iR||(iR=!0,ae.info("speakers:".concat((yield Jc()).map(e=>" ".concat(e.deviceId.slice(0,8),": ").concat(e.label)))))}catch{}})}(),Ti(J_.prototype,this,"play").call(this)})}stop(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.pipeline.destory(),super.stop(e)}setSinkId(e){return N(this,null,function*(){var t,r;this._outputDeviceId!==e&&(this._outputDeviceId=e),this.element&&this.element.sinkId!==e&&(yield(r=(t=this.element).setSinkId)==null?void 0:r.call(t,e))})}get useDestination(){return!!this.pipeline.stream}setLoop(e){!this.element||(this.element.loop=e)}getAudioLevel(){return this.pipeline.volumeMeter.getCalculatedVolume()}getInternalAudioLevel(){return this.pipeline.volumeMeter.getInternalAudioLevel()}},UQ=class extends J_{constructor(e){super(e),this.pipeline.source.pipeTo(this.pipeline.volumeMeter,this.pipeline.destination)}setTrack(e){var t;this.track!==e&&(this.unbindTrackEvents(),this.track=e,this.emit(Si.MEDIA_TRACK_CHANGED,e),e?(this.bindTrackEvents(),this.pipeline.source.channelCount=((t=e.getSettings())==null?void 0:t.channelCount)||1,this.pipeline.replaceSource(e),!this.useDestination&&this.element&&(this.element.srcObject=new MediaStream([e]))):this.pipeline.source.deleteNode())}setSourceNode(e){!e||this.pipeline.source.node===e||(this.pipeline.replaceSource(e),e instanceof MediaStreamAudioSourceNode?this.pipeline.destination.setNode(this._destination):this.pipeline.destination.deleteNode(),this.element&&(this.element.srcObject=this.getMediaStream(),this.element.play().catch(()=>{}),this.setVolume(this._volume)))}setVolume(e){this._volume=e,this.element&&(this.element.volume=e)}},FQ=class extends J_{constructor(e){super(e),T(this,"_sourceElement"),this.pipeline.source.pipeTo(this.pipeline.gain.pipeTo(this.pipeline.volumeMeter,this.pipeline.destination))}write(e){this.pipeline.volumeMeter.write(e)}setTrack(e){var t,r,i;((r=(t=this.element)==null?void 0:t.error)==null?void 0:r.code)!==MediaError.MEDIA_ERR_DECODE&&this.track!==e&&(this.unbindTrackEvents(),this.track=e,this.emit(Si.MEDIA_TRACK_CHANGED,e),e?(this.bindTrackEvents(),this._sourceElement?this._sourceElement.srcObject=new MediaStream([e]):!this.useDestination&&this.element&&(this.element.srcObject=new MediaStream([e])),this.pipeline.source.channelCount=((i=e.getSettings())==null?void 0:i.channelCount)||1,this.pipeline.replaceSource(e)):this.pipeline.source.deleteNode())}setVolume(e){this._volume=e,this.useDestination?(this.pipeline.setVolume(e),this._log.info("set pipeline volume: ".concat(e))):e<=1?(this.element?this._log.info("set element volume: ".concat(e)):this._log.info("set element volume: no element"),this.element&&(this.element.volume=e)):(this._log.info("start set pipeline volume: ".concat(e)),this.pipeline.setVolume(e),this.element&&!this._sourceElement&&(this.pipeline.destination.setNode(this._destination),br(this.element),this._sourceElement=this.element,this._sourceElement.muted=!0,this.element=null,this.play()))}stop(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.pipeline.destory();let t=this._sourceElement||this.element;t&&Uc&&($h=t),this._sourceElement&&(this._sourceElement.srcObject=null,delete this._sourceElement),super.stop(e)}},K_=class extends tt{constructor(e){let{userId:t,sdkAppId:r,mediaType:i,room:n,PlayerClass:a=i===1?FQ:ts}=e;var c;super(),T(this,"id",v0()),T(this,"userId",""),T(this,"isRemote"),T(this,"mediaType"),T(this,"room"),T(this,"user"),T(this,"_log"),T(this,"_inputTrack"),T(this,"_outputTrack"),T(this,"isPlayCalled"),T(this,"container",null),T(this,"player"),T(this,"subVideoPlayerMap"),T(this,"muted",!1),T(this,"abortCtrl"),T(this,"objectFit","cover"),T(this,"mirror"),T(this,"isScreen",!1),T(this,"manager"),T(this,"trackSettings"),T(this,"onPlayerError"),this.userId=t||"",this.mediaType=i,this._log=ae.createLogger({id:"".concat(this.kind[0],"t"),userId:(c=n||this.room)==null?void 0:c.userId,remoteUserId:this instanceof os?void 0:this.userId,sdkAppId:r,type:this.mediaType===2?"auxiliary":"main",isLocal:this instanceof os}),this.player=new a({id:this.userId||this.id,track:null,muted:!1,container:null,log:this.log}),this.player.on(Si.PLAYER_STATE_CHANGED,A=>{te.emit(X.PLAYER_STATE_CHANGED,_e({track:this},A)),this.emit("player-state-changed",A)}),this.kind===O.VIDEO&&(this.player.on(Si.LOADED_DATA,()=>{te.emit(X.VIDEO_LOADED_DATA,{track:this})}),this.player.on(Si.MEDIA_TRACK_CHANGED,A=>{var d;(d=this.subVideoPlayerMap)==null||d.forEach(g=>g.setTrack(A))})),this.onTrackMuted=this.onTrackMuted.bind(this),this.onTrackUnmuted=this.onTrackUnmuted.bind(this),this.onTrackEnded=this.onTrackEnded.bind(this),this.onPlayerError&&this.player.on(Si.ERROR,this.onPlayerError.bind(this))}get log(){return this._log||ae}get kind(){return this.mediaType===1?O.AUDIO:O.VIDEO}get strMediaType(){return this.mediaType===4?O.VIDEO:this.mediaType===2?O.SCREEN:O.AUDIO}get streamType(){return 2&this.mediaType?"auxiliary":"main"}play(e,t){return N(this,null,function*(){let r=pr(e)?e[0]:e;if(this.isPlayCalled)return this.log.info("play update options: ".concat(JSON.stringify(t))),t&&!K(t.muted)&&this.setPlayerMute(t.muted),t&&!K(t.objectFit)&&(this.objectFit=t.objectFit),void(this.player instanceof ts&&(this.player.setObjectFit(this.objectFit),this.container!==r&&r&&(this.container=r,this.player.setContainer(r)),pr(e)&&e.length>=1&&(yield this.playSubContainer(e.slice(1),t))));if(t&&!K(t.muted)?this.setPlayerMute(t.muted):(!this.isRemote||this.kind===O.VIDEO)&&this.setPlayerMute(!0),t&&!K(t.objectFit)&&(this.objectFit=t.objectFit),this.player instanceof ts&&this.player.setObjectFit(this.objectFit),this.isPlayCalled=!0,r&&(this.container=r,this.player instanceof ts&&this.player.setContainer(r)),te.emit(X.PLAY_TRACK_START,{track:this}),this._outputTrack){this._log.info("play with options: ".concat(JSON.stringify(t)));try{this.player.setTrack(this.playerMediaTrack),yield this.player.play(),pr(e)&&e.length>1&&(yield this.playSubContainer(e.slice(1),t))}catch(i){throw this.handleAutoPlayFailed(),this.emit("error",i),i}}else this.log.info("play has not mediaTrack, abort")})}setMirror(e,t){if(this.isScreen||this.kind!==O.VIDEO||K(e)||e===this.mirror)return;this.mirror=e;let r=this.player;t&&(r=t);let i=this.manager;if(ei(this.mirror))return r.setViewMirror(this.mirror),void(i&&(i.mirror=!1));switch(this.mirror){case"view":i&&(i.mirror=!1),r.setViewMirror(!0);break;case"publish":i&&(i.mirror=!0),r.setViewMirror(!0);break;case"both":i&&(i.mirror=!0),r.setViewMirror(!1)}}playSubContainer(e,t){return N(this,null,function*(){if(!this._outputTrack||this.kind===O.AUDIO)return;this.subVideoPlayerMap||(this.subVideoPlayerMap=new Map),this.subVideoPlayerMap.forEach((i,n)=>{var a;e.find(c=>n===c)||(i.stop(),(a=this.subVideoPlayerMap)==null||a.delete(n))});for(let[i,n]of e.entries()){let a=this.subVideoPlayerMap.get(n);a?t&&(K(t.objectFit)||a.setObjectFit(t.objectFit)):this.subVideoPlayerMap.set(n,new ts({id:this.userId||this.id,track:this.playerMediaTrack,container:n,muted:this.player.muted,objectFit:this.objectFit,log:this.log.createChild({id:"vp-sub".concat(i+1)})}))}let r=[...this.subVideoPlayerMap.values()];for(let i of r)i.setViewMirror(this.player.mirror),yield i.play()})}setAudioOutput(e){return this.player.setSinkId(e)}setAudioVolume(e){this.player.setVolume(e)}getAudioLevel(){return this.player.getAudioLevel()||0}getInternalAudioLevel(){var e;return((e=this.player)==null?void 0:e.getInternalAudioLevel())||0}stop(){!this.isPlayCalled||(this.isPlayCalled=!1,this.player&&(this.log.info("stop ".concat(this.kind," player")),this.player.stop(Zo(this)?this.jitterBufferDelay:0)),this.subVideoPlayerMap&&this.subVideoPlayerMap.size>0&&this.subVideoPlayerMap.forEach(e=>{e.stop()}),this.container=null)}resume(){return N(this,null,function*(){var e;!this.isPlayCalled||(yield(e=this.player)==null?void 0:e.resume())})}close(){this.log.info("close"),this.isPlayCalled&&this.stop()}setMute(e){this.muted=e,this._inputTrack&&(this._inputTrack.enabled=!e),this._outputTrack&&(this._outputTrack.enabled=!e),this.emit(e?"mute":"unmute",this),te.emit(e?X.TRACK_MUTED:X.TRACK_UNMUTED,{track:this})}setPlayerMute(e){this.player.setMuted(e)}get mediaTrack(){return this._inputTrack||null}get outMediaTrack(){return this._outputTrack||null}get playerMediaTrack(){return this.outMediaTrack}installTrackEvent(e){Fi(e,e).add(O.MUTE,this.onTrackMuted).add(O.UNMUTE,this.onTrackUnmuted).add(O.ENDED,this.onTrackEnded),e.muted&&this.onTrackMuted(),e.readyState===O.ENDED&&this.onTrackEnded()}uninstallTrackEvent(e){br(e)}setInputMediaStreamTrack(e){var t;let r=this._inputTrack;if(e!==r)return this._inputTrack=e,this.trackSettings=(t=e.getSettings)==null?void 0:t.call(e),e.enabled=!this.muted,r&&this.uninstallTrackEvent(r),this.installTrackEvent(e),this.emit("input-media-track-changed",e||null,r||null),this.manager?this.manager.changeInput(this):this.setOutputMediaStreamTrack(e)}setOutputMediaStreamTrack(e){var t;e!==this._outputTrack&&(this.isRemote?this.log.debug("setOutputMediaStreamTrack",e.label):this.log.info("setOutputMediaStreamTrack",(t=e.getSettings)==null?void 0:t.call(e).deviceId,e.label),this._outputTrack=e,this.updatePlayingState(!!e),this.emit("output-media-track-changed",e))}setMediaType(e){this.mediaType=e}updatePlayingState(e){if(this.isPlayCalled){if(e){if(this.player.setTrack(this.playerMediaTrack),this.player.isStopped)return this.player.play().catch(()=>this.handleAutoPlayFailed()),void this.log.info("playing state updated, play ".concat(this.kind))}else if(!this.player.isStopped)return this.player.stop(Zo(this)?this.jitterBufferDelay:0),void this.log.info("playing state updated, stop ".concat(this.kind))}this.log.debug("updatePlayingState abort ".concat(this.isPlayCalled," ").concat(e," ").concat(this.player.isStopped))}handleAutoPlayFailed(){if(this.room&&this.room.enableAutoPlayDialog)new BQ;else{let e=()=>{this.resume().then(()=>{document.removeEventListener("click",e,!0)})};document.addEventListener("click",e,!0)}}getVideoFrame(){return this.player instanceof ts?this.player.getVideoFrame():""}onTrackMuted(){this._log.warn("".concat(this.kind," track is unable to provide media output"))}onTrackUnmuted(){this._log.info("".concat(this.kind," track is able to provide media output"))}onTrackEnded(){this._log.warn("".concat(this.kind," track ended"))}};le([mr([],tt.INIT,{sync:!0})],K_.prototype,"close",1);var VQ=Object.prototype.hasOwnProperty,ns=function(e){if(e==null)return!0;if(typeof e=="boolean")return!1;if(typeof e=="number")return e===0;if(typeof e=="string"||typeof e=="function"||Array.isArray(e))return e.length===0;if(e instanceof Error)return e.message==="";if(Wn(e))switch(Object.prototype.toString.call(e)){case"[object File]":case"[object Map]":case"[object Set]":return e.size===0;case"[object Object]":for(let t in e)if(VQ.call(e,t))return!1;return!0}return!1},jQ=Ud({retryFunction:function(e){return N(this,null,function*(){let t=function(a){return{audio:HQ(a),video:GQ(a)}}(e);ae.info("getUserMedia with constraints: ".concat(JSON.stringify(t)));let r=[],i=[],n=["label","deviceId"];t.audio&&(r=yield zn(),ae.info("microphones: ".concat(Jn(r,{keysToInclude:n})))),t.video&&(i=yield is(),ae.info("cameras: ".concat(Jn(i,{keysToInclude:n}))));try{let a=yield navigator.mediaDevices.getUserMedia(t);return M0&&a.getTracks().forEach(c=>{ae.info("".concat(c.kind," capabilities: ").concat(Jn(c.getCapabilities(),{keysToInclude:jE})))}),a}catch(a){let{message:c}=a;throw a.name==="NotFoundError"&&(e.video&&i&&i.length===0&&(c=Ve({key:xe.CAMERA_NOT_FOUND})),e.audio&&r&&r.length===0&&(c=Ve({key:xe.MICROPHONE_NOT_FOUND}))),new pe({code:se.INITIALIZE_FAILED,name:a.name,message:c,constraint:a.constraint})}})},settings:{retries:3,timeout:500},onError:e=>{let{error:t,retry:r,reject:i,retryFuncArgs:n,retriedCount:a}=e,c=a+1;t.name==="NotReadableError"||t.name==="OverconstrainedError"?(c===1?n[0].video&&(n[0].maxResolution=!1,(!hn||n[0].width*n[0].height<=2073600)&&n[0].frameRate&&(n[0].frameRate=n[0].frameRate>10?10:5)):c===2?n[0].useDeviceIdOnly=!0:c===3&&!n[0].useExactDeviceId&&(n[0].useTrueAsConstraint=!0),r()):i(t),n[0].microphoneId&&oR(n[0].microphoneId,!1),n[0].cameraId&&oR(n[0].cameraId,!0)},onRetrying:e=>{ae.warn("getUserMedia NotReadableError observed, retrying [".concat(e,"/3]"))},onRetryFailed:e=>{Lt.logFailedEvent({eventType:Hn.GET_USER_MEDIA_RETRY,error:e})},onRetrySuccess:e=>{Lt.logSuccessEvent({eventType:Hn.GET_USER_MEDIA_RETRY}),Lt.uploadEvent({log:"stat-".concat(Hn.GET_USER_MEDIA_RETRY,"-success-").concat(e)})}});function oR(e,t){return N(this,null,function*(){let r=(t?yield is():yield zn()).find(i=>i.deviceId===e);r&&mt(r.getCapabilities)&&ae.warn(Jn(r.getCapabilities(),{keysToInclude:jE}))})}function HQ(e){if(!e.audio)return!1;if(e.useTrueAsConstraint)return!0;let t={echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,sampleRate:e.sampleRate};return!ns(e.microphoneId)&&(t.deviceId=e.useExactDeviceId?{exact:e.microphoneId}:e.microphoneId,e.useDeviceIdOnly)?t:(qt(e.channelCount)&&(t.channelCount=e.channelCount),ei(e.echoCancellation)&&!e.echoCancellation&&(t.echoCancellation=!1),ei(e.noiseSuppression)&&!e.noiseSuppression&&(t.noiseSuppression=!1),ei(e.autoGainControl)&&!e.autoGainControl&&(t.autoGainControl=!1),!!ns(t)||t)}function GQ(e){if(!e.video)return!1;if(e.useTrueAsConstraint)return!0;let{maxResolution:t=!0}=e,r={};return e.cameraId?r.deviceId=e.useExactDeviceId?{exact:e.cameraId}:e.cameraId:e.facingMode&&(r.facingMode=e.facingMode),e.useDeviceIdOnly&&!ns(r)?r:(e.width&&(r.width={ideal:e.width},t&&!Rt&&(r.width.max=e.width)),e.height&&(r.height={ideal:e.height},t&&!Rt&&(r.height.max=e.height)),Rt&&aa&&e.width&&e.height&&e.width*e.height<101376&&(r.width=e.width,r.height=e.height),e.frameRate&&(r.frameRate=e.frameRate),!!ns(r)||r)}var YQ=jQ;function sR(e){return St((t,r)=>function(){for(var i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return N(this,null,function*(){return yield e.apply(this,n),t.apply(this,n)})})}function X_(e){return St((t,r)=>function(){for(var i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return N(this,null,function*(){let c=yield t.apply(this,n);return yield e.call(this,...n),c})})}function St(e){return function(t,r,i){return i.value=e(i.value,r),i}}var WQ=(()=>{let e=!1,t=document.visibilityState;return()=>{document.visibilityState!==t&&ae.info("visibility change: ".concat(document.visibilityState)),!e&&(document.addEventListener("visibilitychange",()=>{ae.info("visibility change: ".concat(document.visibilityState)),t=document.visibilityState}),e=!0)}})(),JQ=0,aR=class{constructor(){this.log=ae.createLogger({id:"fq".concat(++JQ)}),this.isRunning=!1,this.queue=[]}get length(){return this.queue.length}get lastQueueItem(){return this.length===0?null:this.queue[this.length-1]}push(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];var r,i;let n=_e({},e),a=new Promise((c,A)=>{n.resolve=c,n.reject=A});return n.promise=a,t?this.length<=1?this.queue.push(n):(i=(r=this.lastQueueItem)==null?void 0:r.promise)==null||i.then(n.resolve,n.reject):this.queue.push(n),this.log.debug("push ".concat(this.length)),this.isRunning||this.callNext(),a}shift(){let e=this.queue.shift();return this.log.debug("shift ".concat(this.length)),e}callNext(){if(this.isRunning||this.length===0)return;this.log.debug("callNext ",this.length);let{fn:e,args:t,context:r,resolve:i,reject:n}=this.queue[0];this.isRunning=!0,e.apply(r,t).then(i,n).finally(()=>{this.isRunning=!1,this.shift(),this.callNext()})}},eu=new WeakMap,Zh=new WeakMap;function Kc(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return function(t,r,i){let n=i.value;return i.value=function(){let a=eu.get(this)||new aR;for(var c=arguments.length,A=new Array(c),d=0;d<c;d++)A[d]=arguments[d];return eu.set(this,a),a.push({fn:n,args:A,context:this},e)},i}}function cR(e){return function(t,r,i){let n=i.value;return i.value=function(){var a,c,A;let d=[];for(var g=arguments.length,E=new Array(g),f=0;f<g;f++)E[f]=arguments[f];return(c=(a=eu.get(this))==null?void 0:a.queue)==null||c.forEach(b=>d.push(b)),(A=Zh.get(this))==null||A.forEach(b=>b==null?void 0:b.queue.forEach(w=>d.push(w))),d.forEach(b=>{b.reject(new pe({code:se.API_CALL_ABORTED,message:e}))}),eu.delete(this),Zh.delete(this),n.apply(this,E)},i}}function Xc(e){return function(t,r,i){let n=i.value,a=c=>e(...c);return i.value=function(){for(var c=arguments.length,A=new Array(c),d=0;d<c;d++)A[d]=arguments[d];let g=Zh.get(this)||new Map,E=g.get(a(A))||new aR;return g.set(a(A),E),Zh.set(this,g),E.push({fn:n,args:A,context:this})},i}}var lR=class extends K_{constructor(e,t){super({mediaType:e,PlayerClass:t}),T(this,"isRemote",!1),T(this,"deviceId"),T(this,"groupId",""),T(this,"label",""),T(this,"_isRecapturing",!1),T(this,"_lastRecaptureTime",0),T(this,"_onMuteTimeoutId",-1),T(this,"profile")}get enableEncodeFrame(){return!1}get isPublished(){return this.state==="publish"}encodeFrame(e,t){throw new Error("Method not implemented.")}installTrackEvent(e){Fi(e,e).add(O.MUTE,this.onTrackMuted).add(O.UNMUTE,this.onTrackUnmuted).add(O.ENDED,this.onTrackEnded),e.muted&&this.onTrackMuted(),e.readyState===O.ENDED&&this.onTrackEnded()}uninstallTrackEvent(e){br(e)}setStateToCapture(){}capture(e){return N(this,null,function*(){var t;try{let r,i=He();te.emit(X.LOCAL_TRACK_CAPTURE_START,{track:this}),e.customSource?(r=new MediaStream,r.addTrack(e.customSource)):((t=this.mediaTrack)==null||t.stop(),r=yield YQ(e));let n=r.getTracks()[0];return yield this.setInputMediaStreamTrack(n),e.customSource||(this.updateDeviceIdInUse(),this.listenDeviceChange()),te.emit(X.LOCAL_TRACK_CAPTURE_SUCCESS,{track:this,cost:He()-i}),r}catch(r){throw te.emit(X.LOCAL_TRACK_CAPTURE_FAILED,{track:this,error:r}),this.log.error("getUserMedia error observed ".concat(r)),r}})}setInputMediaStreamTrack(e){return this.state===tt.INIT&&this.setStateToCapture(),super.setInputMediaStreamTrack(e)}setOutputMediaStreamTrack(e){var t;return super.setOutputMediaStreamTrack(e),(t=this.room)==null?void 0:t.replaceTrack(this)}publish(e,t){return this.room=e,this.emit("4",{mediaType:this.strMediaType,state:"starting",prevState:"stopped"}),this.userId=e.userId,this._log.setUserId(e.userId),this._log.setSdkAppId(e.sdkAppId),t}unpublish(){this.room&&this.room.localTracks.delete(this),te.emit(X.LOCAL_TRACK_UNPUBLISHED,{track:this})}updateDeviceIdInUse(){return N(this,null,function*(){if(this.mediaTrack&&Hc){let{deviceId:e,groupId:t}=this.mediaTrack.getSettings(),{label:r}=this.mediaTrack;(yield function(i){return N(this,arguments,function(n){let{newDeviceId:a,oldDeviceId:c,oldGroupId:A,oldLabel:d,kind:g}=n;return function*(){return a===c&&(g!==O.AUDIO||a!==Sd||(yield nR(A,d)))}()})}({newDeviceId:e,oldDeviceId:this.deviceId,oldGroupId:this.groupId,oldLabel:this.label,kind:this.kind}))||(this.deviceId=e,this.label=r,t&&(this.groupId=t),Y_().then(i=>{let n=i.find(a=>a.deviceId===e);n&&this.emit("2",n)}))}})}setProfile(e){this.log.info("setProfile",e),Object.assign(this.profile,e)}isNeedToRecapture(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return!(!this.deviceId||!this.mediaTrack||this.kind===O.AUDIO&&!function(t){if(t instanceof CanvasCaptureMediaStreamTrack||!(t instanceof MediaStreamTrack))return!1;let r=t.label.toLocaleLowerCase();if(r.includes("mic")||r.includes("éº¦åé£"))return!0;let i="".concat(((t==null?void 0:t.getSettings())||{}).deviceId,"_").concat(O.AUDIO_INPUT);return!!W_.has(i)}(this.mediaTrack)||this.kind===O.VIDEO&&!function(t){if(t instanceof CanvasCaptureMediaStreamTrack||!(t instanceof MediaStreamTrack))return!1;let r=t.label.toLocaleLowerCase();if(r.includes("camera")||r.includes("webcam"))return!0;let i="".concat(((t==null?void 0:t.getSettings())||{}).deviceId,"_").concat(O.VIDEO_INPUT);return!!W_.has(i)}(this.mediaTrack)||this._isRecapturing||e&&aa&&hn)}onTrackMuted(){if(super.onTrackMuted(),WQ(),this.isNeedToRecapture(!0)){if(Date.now()-this._lastRecaptureTime<Rd)return void setTimeout(()=>this.onTrackMuted(),Rd);this._onMuteTimeoutId=setTimeout(()=>N(this,null,function*(){var e;if((e=this.mediaTrack)!=null&&e.muted){if((Gn||Qr)&&document.visibilityState!=="visible")return;this.recapture(yield this.getRecoverCaptureDeviceId())}}),5e3)}}onTrackUnmuted(){super.onTrackUnmuted(),this._onMuteTimeoutId>0&&clearTimeout(this._onMuteTimeoutId)}onTrackEnded(){return N(this,null,function*(){if(Ti(lR.prototype,this,"onTrackEnded").call(this),this.isNeedToRecapture()){if(Date.now()-this._lastRecaptureTime<Rd)return void setTimeout(()=>this.onTrackEnded(),Rd);this.recapture(yield this.getRecoverCaptureDeviceId())}})}recapture(e){return N(this,null,function*(){var t;if(this._isRecapturing||!this._inputTrack)return;this.log.warn("recapture trying"),(t=this._inputTrack)==null||t.stop(),this._isRecapturing=!0,this._lastRecaptureTime=Date.now();let r={useExactDeviceId:!0};if(e==="user"||e==="environment")r.facingMode=e;else{let i;(this.kind==="audio"?yield zn():yield is()).find(n=>n.deviceId===e)&&(i=e),r.deviceId=i}return this.capture(r).then(()=>{this._isRecapturing=!1,this.log.warn("recapture success"),this.emit("1",{deviceId:this.deviceId}),te.emit(X.LOCAL_TRACK_RECAPTURE,{track:this})}).catch(i=>{this._isRecapturing=!1,this.log.warn("recapture failed ".concat(i.message)),this.emit("5",i),te.emit(X.LOCAL_TRACK_RECAPTURE,{track:this,error:i})})})}getRecoverCaptureDeviceId(){return N(this,null,function*(){let e=this instanceof ti;if(e&&this.facingMode)return this.facingMode;let{deviceId:t}=this;if(t){let r=(tu.get(t)||0)+1;if(tu.set(t,r),r>=3){let i=e?(yield is()).find(n=>!tu.has(n.deviceId)):(yield zn()).find(n=>!tu.has(n.deviceId));i&&(this.log.warn("".concat(t," capture fail ").concat(r," times, change new ").concat(i.deviceId)),t=i.deviceId)}}return t})}close(){var e;super.close(),this._inputTrack&&(this._inputTrack.stop(),this.uninstallTrackEvent(this._inputTrack)),(e=this.manager)==null||e.removeInput(this)}},os=lR;le([mr(tt.INIT,"capture",{ignoreError:!0,sync:!0})],os.prototype,"setStateToCapture",1),le([Kc()],os.prototype,"capture",1),le([mr("capture","publish",{ignoreError:!0,success(){this.room.localTracks.add(this),te.emit(X.LOCAL_TRACK_PUBLISHED,{track:this}),this.emit("4",{mediaType:this.strMediaType,state:"started",prevState:"starting"})},fail(e){let t="error",r=e.cause;r.message.includes("timeout")?t="timeout":r.code===se.API_CALL_ABORTED&&(t="api-call"),this.emit("4",{mediaType:this.strMediaType,state:"stopped",prevState:"starting",reason:t,error:r})}})],os.prototype,"publish",1),le([St(e=>function(){return N(this,null,function*(){let t=this.state==="publish"?"started":"starting";e.call(this),this.emit("4",{mediaType:this.strMediaType,state:"stopped",prevState:t,reason:"api-call"})})}),mr([],"capture",{sync:!0})],os.prototype,"unpublish",1);var tu=new Map;te.on(X.SWITCH_DEVICE_SUCCESS,e=>{e.track.deviceId&&tu.delete(e.track.deviceId)});var qn=class extends os{constructor(e){super(1,UQ),T(this,"mediaType",1),T(this,"volume",0),T(this,"profile",{echoCancellation:!0,autoGainControl:!0,noiseSuppression:!0,sampleRate:48e3,channelCount:1,bitrate:40}),T(this,"playerMuted",!0),T(this,"pipeline"),this.manager=e,this.pipeline=new eR(e),this.handleMicrophoneAdded=this.handleMicrophoneAdded.bind(this),this.handleMicrophoneRemoved=this.handleMicrophoneRemoved.bind(this)}getAudioLevel(){let e=(this.volume||super.getAudioLevel())*this.captureVolume;return e>1?1:e}get playerMediaTrack(){return this.mediaTrack}setInputMediaStreamTrack(e){return N(this,null,function*(){yield Ti(qn.prototype,this,"setInputMediaStreamTrack").call(this,e);let t=this.trackSettings||{};ve.addEnum({key:501701,value:t.channelCount||0,useUV:!1}),ve.addEnum({key:501702,value:t.sampleRate||0,useUV:!1}),ve.addEnum({key:502700,value:0});let{sampleRate:r,channelCount:i}=t;this._log.info("local audio track input ".concat(JSON.stringify({sampleRate:r,channelCount:i}))),this.pipeline.source.channelCount=i||1,this.pipeline.replaceSource(e),this.updatePlayingState(!!e)})}capture(e){let{deviceId:t,customSource:r,useExactDeviceId:i=!1}=e;return super.capture({video:!1,audio:!0,microphoneId:t,echoCancellation:this.profile.echoCancellation,autoGainControl:this.profile.autoGainControl,noiseSuppression:this.profile.noiseSuppression,sampleRate:this.profile.sampleRate,channelCount:this.profile.channelCount,useExactDeviceId:i,customSource:r})}switchDevice(e){return N(this,null,function*(){if(this.mediaTrack){if(this.deviceId===e&&(e!==Sd||(yield nR(this.groupId,this.label))))return;try{this.log.info("switchDevice audio to: ".concat(e)),this.mediaTrack&&this.mediaTrack.stop(),yield this.capture({deviceId:e,useExactDeviceId:!0}),this.room&&(yield this.room.replaceTrack(this)),te.emit(X.SWITCH_DEVICE_SUCCESS,{track:this}),this.log.info("switch microphone success")}catch(t){throw this.log.error("switch microphone failed ".concat(t)),this.deviceId&&this.recapture(this.deviceId),t}}})}listenDeviceChange(){fr&&!fr.listeners("audioInputRemoved").includes(this.handleMicrophoneRemoved)&&fr.on("audioInputRemoved",this.handleMicrophoneRemoved,this)}handleMicrophoneRemoved(e){return N(this,null,function*(){if(e.deviceId===this.deviceId){this.log.warn("current microphone is lost: ".concat(JSON.stringify(e))),kt(this.userId,{eventId:2003,param1:6,streamType:1});let t=yield zn();t[0]?this.recapture(t[0].deviceId):fr.on("audioInputAdded",this.handleMicrophoneAdded,this)}})}handleMicrophoneAdded(e){this.log.warn("microphone added: ".concat(JSON.stringify(e))),this.recapture(e.deviceId)}update3A(e){return N(this,arguments,function(t){var r=this;let{echoCancellation:i,noiseSuppression:n,autoGainControl:a}=t;return function*(){let c=!1;!K(i)&&i!==r.profile.echoCancellation&&(r.profile.echoCancellation=i,c=!0),!K(n)&&n!==r.profile.noiseSuppression&&(r.profile.noiseSuppression=n,c=!0),!K(a)&&a!==r.profile.autoGainControl&&(r.profile.autoGainControl=a,c=!0),c&&r.deviceId&&(yield r.recapture(r.deviceId))}()})}get captureVolume(){return this.pipeline.volume}setCaptureVolume(e){this.pipeline.setVolume(e/100),this.pipeline.gain.node&&ve.addEnum({key:502700,value:2}),this.resetPlayerSource()}enableTrackANS(e){if(!this._inputTrack)return;let t=this._inputTrack.getConstraints();return t.noiseSuppression=e,this._inputTrack.applyConstraints(t).catch(r=>this._log.warn("".concat(e?"enable":"disable"," ANS failed "),r))}addDenoiser(e){var t;la<=92&&((t=this.trackSettings)==null?void 0:t.sampleRate)!==48e3?this._log.warn("denoiser only support sampleRate 48000 before chrome 93"):(ve.addEnum({key:502700,value:1}),this.pipeline.denoiser.setNode(e),this.resetPlayerSource(),this.enableTrackANS(!1))}removeDenoiser(e){this.pipeline.denoiser.node===e&&(this.pipeline.denoiser.deleteNode(),this.resetPlayerSource(),this.enableTrackANS(!0))}resetPlayerSource(){this.player.setSourceNode(this.pipeline.gain.node||this.pipeline.denoiser.node||this.pipeline.source.node)}close(){this.pipeline.remove(),fr.off("audioInputAdded",this.handleMicrophoneAdded,this),fr.off("audioInputRemoved",this.handleMicrophoneRemoved,this),super.close()}recapture(e){return N(this,null,function*(){try{yield Ti(qn.prototype,this,"recapture").call(this,e)}catch(t){let r=(yield zn()).find(i=>i.deviceId!==e);if(!r)throw t;yield Ti(qn.prototype,this,"recapture").call(this,r.deviceId)}})}},dR=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this.dataView=e,this.isSEI&&(t?this.addPreventionByte():this.removePreventionByte())}addPreventionByte(){let e=this.seiPayloadStartIndex,t=this.dataView.byteLength-2,r=[],i=0;for(let a=e;a<=t;a++){let c=this.dataView.getInt8(a);switch(c){case 0:case 1:case 2:case 3:i===2&&(r.push(3),i=0),c==0?i++:i=0,r.push(c);break;default:i=0,r.push(c)}}r.push(this.dataView.getInt8(this.dataView.byteLength-1));let n=new DataView(new Uint8Array([...new Uint8Array(this.dataView.buffer).slice(0,e),...r]).buffer);this.dataView=n}removePreventionByte(){let e=this.seiPayloadStartIndex,t=this.dataView.byteLength-1,r=[],i=0;for(let a=e;a<=t;a++)switch(this.dataView.getInt8(a)){case 0:i++,r.push(this.dataView.getInt8(a));break;case 3:i!==2&&r.push(this.dataView.getInt8(a)),i=0;break;default:r.push(this.dataView.getInt8(a)),i=0}let n=new DataView(new Uint8Array([...new Uint8Array(this.dataView.buffer).slice(0,e),...r]).buffer);this.dataView=n}get isSEI(){return this.dataView.getUint8(4)===6}get seiPayloadStartIndex(){let e=6;for(let t=6;t<this.dataView.buffer.byteLength&&(e++,this.dataView.getUint8(t)===255);t++);return e}get seiPayloadType(){return this.isSEI?this.dataView.getUint8(5):null}get seiPayload(){if(!this.isSEI)return null;let e=0,t=6;for(let n=6;n<this.dataView.buffer.byteLength;n++){let a=this.dataView.getUint8(n);if(t++,a!==255){e+=a;break}e+=255}let r=new ArrayBuffer(e),i=new DataView(r);for(let n=0;n<r.byteLength;n++,t++)i.setInt8(n,this.dataView.getInt8(t));return i}},KQ=class{constructor(){T(this,"_seiMessageList",[]),T(this,"_smallSeiMessageList",[]),T(this,"_seiPayloadType",243)}encodeSEINalu(e){let t=e.byteLength,r=parseInt(String(t/255),10),i=t%255,n=[];n.push(0,0,0,1,6,this._seiPayloadType);for(let c=0;c<r;c++)n.push(255);n.push(i);let a=new DataView(e);return n.push(...new Uint8Array(a.buffer)),n.push(128),new dR(new DataView(new Uint8Array(n).buffer),!0)}sendSEI(e,t){t!=null&&t.seiPayloadType&&(this._seiPayloadType=t.seiPayloadType),this._seiMessageList.push(e),t!=null&&t.small&&this._smallSeiMessageList.push(e)}getNaluCount(e){let t=0,r=0,i=new DataView(e);for(let n=0;n<e.byteLength;n++)switch(i.getUint8(n)){case 0:t++;break;case 1:(t===2||t===3)&&r++,t=0;break;default:t=0}return r}encode(e,t){let r=t?this._smallSeiMessageList:this._seiMessageList;if(r.length>0&&e.data.byteLength>0){let i=9-this.getNaluCount(e.data);if(i<=0)return 0;let n=r.splice(0,i).reverse().map(this.encodeSEINalu.bind(this)),a=n.reduce((E,f)=>E+f.dataView.byteLength,0),c=new ArrayBuffer(a+e.data.byteLength),A=new DataView(c),d=new DataView(e.data),g=0;for(let E=0;E<n.length;E++)for(let f=0;f<n[E].dataView.byteLength;f++)A.setInt8(g++,n[E].dataView.getInt8(f));for(let E=0;E<e.data.byteLength;E++)A.setInt8(g++,d.getInt8(E));return e.data=c,n.length}return 0}},ti=class extends os{constructor(e){super(arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,ts),T(this,"profile",{width:640,height:480,frameRate:15,bitrate:500}),T(this,"states",{bytesSent:0,packetsSent:0,framesEncoded:0,framesSent:0,frameWidth:0,frameHeight:0}),T(this,"small"),T(this,"isNeedToSetBandwidth"),T(this,"muteImage"),T(this,"manager"),T(this,"_seiCodec",new KQ),this.manager=e;let t=()=>{this.isAllowed2k4k(this.profile)?this.room&&this.settings.height>=1440&&this.state==="publish"&&this.room.sendAbilityStatus({"2k4k":1}):(this.log.warn("Resolution is reset to 1080p, need to upgrade ability here https://cloud.tencent.com/document/product/647/85386"),this.setProfile(Ke(_e({},this.profile),{width:1920,height:1080})),this.applyProfile())};this.on("input-media-track-changed",t),this.on("publish",t),this.handleCameraAdded=this.handleCameraAdded.bind(this),this.handleCameraRemoved=this.handleCameraRemoved.bind(this)}get facingMode(){if(Hc&&this.mediaTrack)return this.mediaTrack.getSettings().facingMode}get isQosClearFirst(){var e;return((e=this._inputTrack)==null?void 0:e.contentHint)==="detail"}setMute(e){return N(this,null,function*(){var t,r,i;if(ut(e)){if(this.muteImage===e)return;yield(t=this.manager)==null?void 0:t.deleteWatermark("mute"),yield(r=this.manager)==null?void 0:r.setWatermark({x:0,y:0,width:this.settings.width,height:this.settings.height,type:"mute",zIndex:999,imageUrl:e}),this.muteImage=e,Ti(ti.prototype,this,"setMute").call(this,!1)}else yield(i=this.manager)==null?void 0:i.deleteWatermark("mute"),this.muteImage=void 0,Ti(ti.prototype,this,"setMute").call(this,e)})}capture(e){let{deviceId:t,facingMode:r,useExactDeviceId:i=!1,customSource:n}=e;return super.capture({audio:!1,video:!0,facingMode:r||this.facingMode,cameraId:t,width:this.profile.width,height:this.profile.height,frameRate:this.profile.frameRate,useExactDeviceId:i,customSource:n})}setProfile(e){let t=_e({},e),r=t.width>t.height;t.width*t.height<=19200&&Qr&&ca&&(this.log.warn("resolution is ".concat(t.width,"*").concat(t.height,", fallback to 240*180")),t.width=r?240:180,t.height=r?180:240,t.bitrate=Math.max(t.bitrate,150)),t.width*t.height>921600&&i0&&(t.width=r?1280:720,t.height=r?720:1280,this.log.warn("reset to 1280 * 720 on iOS 13~14")),t.bitrate&&(this.isNeedToSetBandwidth=t.bitrate!==this.profile.bitrate),this.isAllowed2k4k(this.profile)?super.setProfile(t):(this.log.warn("Resolution is reset to 1080p, need to upgrade ability here https://cloud.tencent.com/document/product/647/85386"),super.setProfile(Ke(_e({},this.profile),{width:1920,height:1080})))}applyProfile(){var e;if(!this.mediaTrack)return;let t=this.settings;return t.height!==this.profile.height||t.width!==this.profile.width||t.frameRate!==this.profile.frameRate?(e=this.mediaTrack)==null?void 0:e.applyConstraints({width:this.profile.width,height:this.profile.height,frameRate:this.profile.frameRate}).then(()=>{if(this.manager&&this.manager.changeInput(this),this.room&&this.settings.height>=1440&&this.state==="publish"&&this.room.sendAbilityStatus({"2k4k":1}),this.isNeedToSetBandwidth&&this.room&&this.room.setBandWidth)return this.isNeedToSetBandwidth=!1,this.room.setBandWidth({bandwidth:this.profile.bitrate,type:O.VIDEO,videoType:O.BIG})}):void 0}get settings(){let e={width:this.profile.width,height:this.profile.height,frameRate:this.profile.frameRate};return Hc&&this.mediaTrack&&Object.assign(e,this.mediaTrack.getSettings()),e}get scaleResolutionDownBy(){let{settings:e}=this;return e.width===this.profile.width&&e.height===this.profile.height?1:y0()&&this.profile.width>this.profile.height&&e.height>e.width?Math.max(e.width/this.profile.height,e.height/this.profile.width,1):Math.max(e.width/this.profile.width,e.height/this.profile.height,1)}isAllowed2k4k(e){var t;return!(this.room&&this.room.scheduleResult&&!this.isScreen&&!(e.height*e.width<3686400))||((t=this.room.scheduleResult.trtcAutoConf)==null?void 0:t["2k4k"])===1}isNeedToSwitchDevice(e){return!(!this.mediaTrack||this.deviceId===e||this.facingMode===e)}switchDevice(e){return N(this,null,function*(){try{if(!this.isNeedToSwitchDevice(e))return;let t={useExactDeviceId:!0};e==="user"||e==="environment"?t.facingMode=e:t.deviceId=e,this.mediaTrack.stop(),yield this.capture(t),te.emit(X.SWITCH_DEVICE_SUCCESS,{track:this}),this.log.info("switch camera success")}catch(t){throw this.log.error("switch camera failed ".concat(t)),this.deviceId&&this.recapture(this.deviceId),t}})}listenDeviceChange(){fr&&!fr.listeners("videoInputRemoved").includes(this.handleCameraRemoved)&&fr.on("videoInputRemoved",this.handleCameraRemoved,this)}handleCameraRemoved(e){return N(this,null,function*(){if(e.deviceId===this.deviceId){this.log.warn("current camera is lost: ".concat(JSON.stringify(e))),kt(this.userId,{eventId:2003,param1:7,streamType:2});let t=yield is();t[0]?this.recapture(t[0].deviceId):fr.on("videoInputAdded",this.handleCameraAdded,this)}})}handleCameraAdded(e){return N(this,null,function*(){this.log.warn("camera added: ".concat(JSON.stringify(e))),this.recapture(e.deviceId)})}encodeFrame(e,t){try{let r=this._seiCodec.encode(e,!!t);r&&this._log.debug("".concat(r," sei sent"))}catch(r){this._log.warn(r)}return e}get enableEncodeFrame(){var e;return!((e=this.room)==null||!e.enableSEI)&&ma}sendSEI(e,t){this._seiCodec.sendSEI(e,Object.assign({small:!!this.small},t))}play(e,t){return N(this,null,function*(){return K(this.mirror)&&!this.isScreen&&this.setMirror("view"),Ti(ti.prototype,this,"play").call(this,e,t)})}close(){fr.off("videoInputAdded",this.handleCameraAdded,this),fr.off("videoInputRemoved",this.handleCameraRemoved,this),super.close()}recapture(e){return N(this,null,function*(){try{yield Ti(ti.prototype,this,"recapture").call(this,e)}catch(t){let r=(yield is()).find(i=>i.deviceId!==e);if(!r)throw t;yield Ti(ti.prototype,this,"recapture").call(this,r.deviceId)}})}},uR=v0();if(navigator.mediaDevices&&"setCaptureHandleConfig"in navigator.mediaDevices)try{navigator.mediaDevices.setCaptureHandleConfig({handle:uR,exposeOrigin:!0,permittedOrigins:["*"]})}catch{}var z_,XQ=function(e){return N(this,null,function*(){let t=null,r=function(a){let c={preferCurrentTab:a.preferDisplaySurface==="current-tab"||!!a.captureElement,systemAudio:"include",selfBrowserSurface:"include",surfaceSwitching:"include"},A={width:hn?{max:a.width}:{ideal:a.width,max:a.width},height:hn?{max:a.height}:{ideal:a.height,max:a.height},frameRate:a.frameRate,displaySurface:a.preferDisplaySurface||"monitor"};if(c.video=A,a.systemAudio){let{echoCancellation:d=!0,noiseSuppression:g=!1,autoGainControl:E=!1}=a;c.audio={echoCancellation:d,noiseSuppression:g,autoGainControl:E,sampleRate:48e3}}return c}(e);ae.info("getDisplayMedia with constraints: ".concat(JSON.stringify(r)));let i=yield navigator.mediaDevices.getDisplayMedia(r);e.systemAudio&&i.getAudioTracks().length===0&&(xh&&la<74||hn||Rt)&&ae.warn("Your browser not support capture system audio");let n=i.getVideoTracks()[0];if(n){if(e.frameRate)try{yield n.applyConstraints({frameRate:{min:e.frameRate,ideal:e.frameRate},width:e.width,height:e.height})}catch(a){ae.warn("screen applyConstraints failed: ".concat(a))}e.captureElement&&(yield function(a,c){return N(this,null,function*(){var A;if("CropTarget"in window&&"fromElement"in CropTarget&&mt(a.cropTo))try{if(((A=a.getCaptureHandle())==null?void 0:A.handle)!==uR)return;let d=yield CropTarget.fromElement(c);yield a.cropTo(d)}catch(d){ae.warn("cropTo target failed ".concat(d))}})}(n,e.captureElement))}if(e.audio){let a=function(c){let A={echoCancellation:c.echoCancellation,autoGainControl:c.autoGainControl,noiseSuppression:c.noiseSuppression,sampleRate:c.sampleRate,channelCount:c.channelCount};return K(c.microphoneId)||(A.deviceId=c.microphoneId),{audio:A,video:!1}}(e);ae.info("getUserMedia with constraints: ".concat(JSON.stringify(a))),t=yield navigator.mediaDevices.getUserMedia(a),i.addTrack(t.getAudioTracks()[0])}return i})},Ia=class extends ti{constructor(e){super(e,2),T(this,"profile",{width:1920,height:1080,frameRate:5,bitrate:1600}),T(this,"objectFit","contain"),T(this,"isScreen",!0),this._log.id="s-".concat(this._log.id)}capture(e){return N(this,arguments,function(t){var r=this;let{systemAudio:i=!1,autoGainControl:n,echoCancellation:a,noiseSuppression:c,audioTrack:A,videoTrack:d,captureElement:g,preferDisplaySurface:E}=t;return function*(){try{let f;return d||A?(f=new MediaStream,d&&f.addTrack(d),A&&f.addTrack(A)):f=yield XQ({audio:!1,systemAudio:i,width:r.profile.width,height:r.profile.height,frameRate:r.profile.frameRate,autoGainControl:n,echoCancellation:a,noiseSuppression:c,captureElement:g,preferDisplaySurface:E}),yield r.setInputMediaStreamTrack(f.getVideoTracks()[0]),f}catch(f){throw r.log.error("getDisplayMedia error observed ".concat(f)),f instanceof pe?f:new pe({code:se.INITIALIZE_FAILED,name:f.name,message:f.message})}}()})}switchDevice(e){return N(this,null,function*(){throw new Error("Method not implemented.")})}},ru=class extends qn{constructor(e){super(e),this._log.id="s-".concat(this._log.id)}},zQ=class extends PQ{constructor(e){super(),this.room=e,T(this,"_localAudioTrack"),T(this,"_localScreenAudioTrack"),T(this,"log",ae.createLogger({id:"am"})),T(this,"denoiser"),e&&(this.log.setUserId(e.userId),this.log.setSdkAppId(e.sdkAppId))}get _localAudioPipline(){var e;return(e=this._localAudioTrack)==null?void 0:e.pipeline}dump(e){var t,r;if(!this._localAudioTrack)return;let i=[],n=[];(t=this._localAudioPipline)!=null&&t.source.node&&(i.push(this._localAudioPipline.source.node),n.push("mic")),(r=this._localAudioPipline)!=null&&r.denoiser.node&&(i.push(this._localAudioPipline.denoiser.node),n.push("mic-processed")),this.mixWeight>1&&(i.push(this.audioContext.createMediaStreamSource(this._localAudioPipline.stream)),n.push("mix")),this.log.info("dump audio track ".concat(n,", duration: ").concat(e));let a=new AbortController,c=[],A=setTimeout(()=>{this.log.info('dump audio track complete please input "download()" to download.'),a.abort("timeout")},1e3*e),d=()=>{for(let E=0;E<n.length;E++){let f=URL.createObjectURL(new Blob(c[E])),b=document.createElement("a");b.href=f,b.download="".concat(n[E],".pcm"),b.style.display="none",document.body.appendChild(b),b.click(),URL.revokeObjectURL(f),b.remove()}clearTimeout(A),a.abort("download")},g=function(E){return N(this,null,function*(){let f=rs();z_||(z_=j_(f,URL.createObjectURL(new Blob(["registerProcessor('dumper', class extends AudioWorkletProcessor {process(inputs) {this.port.postMessage(inputs);return true;}});"],{type:"application/javascript"})))),yield z_;let b=new AudioWorkletNode(f,"dumper",{numberOfInputs:E.length,numberOfOutputs:0});return E.forEach((w,k)=>w.connect(b,0,k)),new ReadableStream({start(w){b.port.onmessage=k=>{w.enqueue(k.data)}},cancel(){E.forEach(w=>w.disconnect(b)),b.port.close()}})})}(i).then(E=>E.pipeTo(new WritableStream({write(f){f.forEach((b,w)=>c[w]=c[w]?c[w].concat(b[0]):[b[0]])}}),a).catch(f=>d));return{then:g.then.bind(g),download:d}}get hasScreenAudioTrack(){return this._localScreenAudioTrack!==null}get hasAudioTrack(){return this._localAudioTrack!==null}changeInput(e){if(e instanceof ru)this._localScreenAudioTrack=e,e.pipeline.connect(),this.mixOnChange();else if(e instanceof qn)this._localAudioTrack=e,this.denoiser&&e.addDenoiser(this.denoiser),e.pipeline.connect(),this.mixOnChange();else if(e instanceof q_)return e.setOutputMediaStreamTrack(e.mediaTrack)}mixOnChange(){var e,t;(e=this._localAudioTrack)==null||e.setOutputMediaStreamTrack(this.mixWeight>1?this.mixTrack:this._localAudioTrack.mediaTrack),(t=this._localScreenAudioTrack)==null||t.setOutputMediaStreamTrack(this.mixWeight>1?this.mixTrack:this._localScreenAudioTrack.mediaTrack)}removeInput(e){e instanceof ru?delete this._localScreenAudioTrack:e instanceof qn&&delete this._localAudioTrack}addDenoiser(e){var t;this.denoiser=e,(t=this._localAudioTrack)==null||t.addDenoiser(e)}removeDenoiser(e){var t;delete this.denoiser,(t=this._localAudioTrack)==null||t.removeDenoiser(e)}destroy(){this.close()}};function AR(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:30,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return St((r,i)=>function(){for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return new Promise((A,d)=>{let g=setTimeout(()=>{let E=new pe({code:se.API_CALL_TIMEOUT,message:"checkPendingPromise ".concat(i,"() timeout ").concat(e,"s")});ae.warn(E),t===2?d(E):t===1&&A()},1e3*e);r.apply(this,a).then(A,d).finally(()=>{clearTimeout(g)})})})}var hR=class extends K_{constructor(e,t,r){super({userId:t.userId,sdkAppId:e.sdkAppId,mediaType:r,room:e}),this.room=e,this.user=t,T(this,"tinyId"),T(this,"isRemote",!0),T(this,"jitterBufferDelay",0),this.tinyId=t.tinyId}setMute(e){this.hasFlag&&super.setMute(e)}setInputMediaStreamTrack(e){super.setInputMediaStreamTrack(e),this.hasFlag&&this.isSubscribed&&this.player.setTrack(this.outMediaTrack)}waitHasMediaTrack(){return new Promise(e=>{this.mediaTrack?e():this.once("input-media-track-changed",e)})}get isSubscribing(){return this.state.toString()==="subscribeing"}get isSubscribed(){return this.state===hR.STATE_SUBSCRIBE}subscribe(e){return e}unsubscribe(){this.player.setTrack(null),this.streamType==="main"&&this.kind==="video"&&this.room.changeType(!1,this.user)}updatePlayingState(e){if(this.isPlayCalled&&this.player.isStopped===e){if(e&&(!this.isSubscribed||!this.hasFlag||!this.outMediaTrack))return void this.log.info("abort play, isSubscribed:".concat(this.isSubscribed," hasFlag:").concat(this.hasFlag," hasTrack:").concat(!!this.outMediaTrack));super.updatePlayingState(e)}}onFlagChanged(){this.updatePlayingState(this.hasFlag)}onTrackMuted(){this.hasFlag&&(this.isSubscribed||this.isSubscribing)&&this.isPlayCalled&&super.onTrackMuted()}onTrackUnmuted(){this.hasFlag&&(this.isSubscribed||this.isSubscribing)&&this.isPlayCalled&&super.onTrackUnmuted()}onTrackEnded(){this.hasFlag&&(this.isSubscribed||this.isSubscribing)&&this.isPlayCalled&&super.onTrackEnded()}},ss=hR;T(ss,"STATE_SUBSCRIBE","subscribe"),le([AR(5,1)],ss.prototype,"waitHasMediaTrack",1),le([mr(tt.INIT,ss.STATE_SUBSCRIBE,{success(){this.log.info("subscribed"),te.emit(X.REMOTE_TRACK_SUBSCRIBED,{track:this}),this.updatePlayingState(!0)},ignoreError:!0})],ss.prototype,"subscribe",1),le([mr(ss.STATE_SUBSCRIBE,tt.INIT,{sync:!0,success(){this.log.info("unsubscribed"),this.updatePlayingState(!1),te.emit(X.REMOTE_TRACK_UNSUBSCRIBED,{track:this})}})],ss.prototype,"unsubscribe",1);var q_=class extends ss{constructor(e,t){super(e,t,1),T(this,"volume",0),T(this,"mediaType",1),T(this,"stat",{bytesReceived:0,packetsReceived:0,packetsLost:0,end2EndDelay:0,jitterBufferDelay:0}),T(this,"audioDecoder"),this.manager=e.audioManager}onPlayerError(e){if(this.enableDecodeFrame){this.room.enableInsertableStreams();let t=new AudioDecoder({error:r=>this._log.error(r),output:r=>{this.player.write(r)}});t.configure({codec:"opus",sampleRate:48e3,numberOfChannels:1}),this._log.info("audioDecoder state:".concat(t.state)),this.audioDecoder=t}}get enableDecodeFrame(){var e,t;return((t=(e=this.player.element)==null?void 0:e.error)==null?void 0:t.code)===MediaError.MEDIA_ERR_DECODE&&ma&&D_().AudioDecoder}decodeFrame(e){var t;return((t=this.audioDecoder)==null?void 0:t.state)==="configured"&&this.audioDecoder.decode(new EncodedAudioChunk({data:e.data,timestamp:e.timestamp,type:"key"})),e}getAudioLevel(){let e=this.volume||super.getAudioLevel();return e>1?1:e}get hasFlag(){return this.user.muteState.hasAudio}isFlagChanged(e){let t=e.hasAudio&&!e.audioMuted;return this.hasFlag||(this.volume=0),this.hasFlag!==t}},iu=class extends ss{constructor(e,t){super(e,t,arguments.length>2&&arguments[2]!==void 0?arguments[2]:4),T(this,"mediaType",4),T(this,"source"),T(this,"stat",{bytesReceived:0,packetsReceived:0,packetsLost:0,framesReceived:0,framesDecoded:0,frameWidth:0,frameHeight:0,end2EndDelay:0,jitterBufferDelay:0}),this.manager=e.videoManager}get enableDecodeFrame(){return!!this.room.enableSEI&&ma}decodeFrame(e){try{if(e.type==="empty"||e.data.byteLength===0)return e;let t=new DataView(e.data);if(t.getInt32(0)!==1||t.getInt8(4)!==6)return e;let r=[],i=0,n=-1,a=-1;for(let c=0;c<e.data.byteLength;c++){let A=t.getUint8(c);if(A===0)i++;else if(A===1){if(i===2||i===3){let d=c-i;if(n===-1?n=d:a===-1&&(a=d,r.push(new dR(new DataView(t.buffer.slice(n,a)))),n=d,a=-1),t.getUint8(c+1)!==6){e.data=t.buffer.slice(d);break}}i=0}else i=0}this._log.debug("".concat(r.length," sei received")),r.reverse().forEach(c=>{this.room.emit("sei-message",{seiPayloadType:c.seiPayloadType,data:c.seiPayload.buffer,userId:this.user.userId,streamType:this.mediaType===2?"auxiliary":"main"})})}catch(t){this._log.warn(t)}return e}get isBig(){return this.mediaType===4}get isSmall(){return this.mediaType===8}changeType(e){this.room.changeType(e,this.user)}get hasFlag(){return this.user.muteState.hasVideo&&!this.user.muteState.videoMuted}isFlagChanged(e){let t=e.hasVideo&&!e.videoMuted;return this.hasFlag!==t}setMirror(e){e==="publish"||e==="both"||super.setMirror(e)}},gR=class extends iu{constructor(e,t){super(e,t,2),T(this,"mediaType",2),T(this,"objectFit","contain")}get hasFlag(){return this.user.muteState.hasAuxiliary}isFlagChanged(e){let t=e.hasAuxiliary;return this.hasFlag!==t}};function nu(){}var qQ=e=>e(),$Q=()=>typeof __FASTRX_DEVTOOLS__<"u",ZQ=1,ou=class extends Function{toString(){return"".concat(this.name,"(").concat(this.args.length?[...this.args].join(", "):"",")")}subscribe(e){let t=new e1(e,this,this.streamId++);return $n.subscribe({id:this.id,end:!1},{nodeId:t.sourceId,streamId:t.id}),this(t),t}},pR=class{constructor(){this.defers=new Set,this.disposed=!1}next(e){}complete(){this.dispose()}error(e){this.dispose()}get bindDispose(){return()=>this.dispose()}dispose(){this.disposed=!0,this.complete=nu,this.error=nu,this.next=nu,this.dispose=nu,this.subscribe=nu,this.doDefer()}subscribe(e){return e instanceof ou?e.subscribe(this):e(this),this}get bindSubscribe(){return e=>this.subscribe(e)}doDefer(){this.defers.forEach(qQ),this.defers.clear()}defer(e){this.defers.add(e)}removeDefer(e){this.defers.delete(e)}reset(){this.disposed=!1,delete this.complete,delete this.next,delete this.dispose,delete this.next,delete this.subscribe}resetNext(){delete this.next}resetComplete(){delete this.complete}resetError(){delete this.error}},mR=class extends pR{constructor(e){super(),this.sink=e,e.defer(this.bindDispose)}next(e){this.sink.next(e)}complete(){this.sink.complete()}error(e){this.sink.error(e)}};function eg(e,t,r){if($Q()){let i=Object.defineProperties(Object.setPrototypeOf(e,ou.prototype),{streamId:{value:0,writable:!0,configurable:!0},name:{value:t,writable:!0,configurable:!0},args:{value:r,writable:!0,configurable:!0},id:{value:0,writable:!0,configurable:!0}});$n.create(i);for(let n=0;n<r.length;n++){let a=r[n];typeof a=="function"&&a instanceof ou&&$n.addSource(i,a)}return i}return e}function as(e,t){window.postMessage({source:"fastrx-devtools-backend",payload:{event:e,payload:t}})}var e1=class extends mR{constructor(e,t,r){super(e),this.source=t,this.id=r,this.sourceId=e.sourceId,this.defer(()=>{$n.defer(this.source,this.id)})}next(e){$n.next(this.source,this.id,e),this.sink.next(e)}complete(){$n.complete(this.source,this.id),this.sink.complete()}error(e){$n.complete(this.source,this.id,e),this.sink.error(e)}},$n={addSource(e,t){as("addSource",{id:e.id,name:e.toString(),source:{id:t.id,name:t.toString()}})},next(e,t,r){as("next",{id:e.id,streamId:t,data:r&&r.toString()})},subscribe(e,t){let{id:r,end:i}=e;as("subscribe",{id:r,end:i,sink:{nodeId:t&&t.nodeId,streamId:t&&t.streamId}})},complete(e,t,r){as("complete",{id:e.id,streamId:t,err:r?r.toString():null})},defer(e,t){as("defer",{id:e.id,streamId:t})},pipe(e){as("pipe",{name:e.toString(),id:e.id,source:{id:e.source.id,name:e.source.toString()}})},update(e){as("update",{id:e.id,name:e.toString()})},create(e){e.id||(e.id=ZQ++),as("create",{name:e.toString(),id:e.id})}},t1=class extends pR{constructor(e){super(),this.source=e,this.sinks=new Set}add(e){e.defer(()=>this.remove(e)),this.sinks.add(e).size===1&&(this.reset(),this.subscribe(this.source))}remove(e){this.sinks.delete(e),this.sinks.size===0&&this.dispose()}next(e){this.sinks.forEach(t=>t.next(e))}complete(){this.sinks.forEach(e=>e.complete()),this.sinks.clear()}error(e){this.sinks.forEach(t=>t.error(e)),this.sinks.clear()}},r1=function(e,t){return function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return a=>{if(a instanceof ou){let c=eg(A=>{let d=new e(A,...i);d.sourceId=c.id,d.subscribe(a)},t,arguments);return c.source=a,$n.pipe(c),c}return c=>a(new e(c,...i))}}}(class extends mR{constructor(e,t,r){super(e),this.mapper=t,this.thisArg=r}next(e){super.next(this.mapper.call(this.thisArg,e))}},"map");(function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];r.reduce((n,a)=>a(n),e)})(function(e){return eg(t=>{let r=0,i=setInterval(()=>t.next(r++),e);return t.defer(()=>{clearInterval(i)}),"interval"},"interval",arguments)}(250),r1(()=>performance.now()),function(){return e=>{let t=new t1(e);if(e instanceof ou){let r=eg(i=>{t.add(i)},"share",arguments);return t.sourceId=r.id,r.source=e,$n.pipe(r),r}return eg(t.add.bind(t),"share",arguments)}}());var zc=new Map;function kt(e,t){let r=Ke(_e({},t),{timestamp:bE()});zc.has(e)?zc.get(e).push(r):zc.set(e,[r])}te.on(X.JOIN_SUCCESS,e=>{let{room:t}=e;kt(t.userId,{eventId:32788})}),te.on(X.LEAVE_START,e=>{let{room:t}=e;kt(t.userId,{eventId:32789})}),te.on(X.LOCAL_TRACK_PUBLISHED,e=>{let{track:t}=e;if(t.room){let r=32769;t.mediaType===4?r=32768:t.mediaType===2&&(r=32805),kt(t.room.userId,{eventId:r})}}),te.on(X.LOCAL_TRACK_UNPUBLISHED,e=>{let{track:t}=e;if(t.room){let r=32771;t.mediaType===4?r=32770:t.mediaType===2&&(r=32806),kt(t.room.userId,{eventId:r})}}),te.on(X.TRACK_MUTED,e=>{let{track:t}=e;t.room&&(t.kind===O.AUDIO?kt(t.room.userId,{eventId:t.isRemote?32785:32772,remoteUserId:t.isRemote?t.userId:void 0}):kt(t.room.userId,{eventId:t.isRemote?32784:32773,remoteUserId:t.isRemote?t.userId:void 0}))}),te.on(X.TRACK_UNMUTED,e=>{let{track:t}=e;t.room&&(t.kind===O.AUDIO?kt(t.room.userId,{eventId:t.isRemote?32787:32774,remoteUserId:t.isRemote?t.userId:void 0}):kt(t.room.userId,{eventId:t.isRemote?32786:32775,remoteUserId:t.isRemote?t.userId:void 0}))}),te.on(X.REMOTE_TRACK_SUBSCRIBED,e=>{let{track:t}=e;!t.room||(t.mediaType===1&&kt(t.room.userId,{eventId:32777,remoteUserId:t.userId}),t.mediaType===4&&kt(t.room.userId,{eventId:32776,remoteUserId:t.userId}),t.mediaType===8&&kt(t.room.userId,{eventId:32803,remoteUserId:t.userId}))}),te.on(X.REMOTE_TRACK_UNSUBSCRIBED,e=>{let{track:t}=e;!t.room||(t.mediaType===1&&kt(t.room.userId,{eventId:32779,remoteUserId:t.userId}),t.mediaType===4&&kt(t.room.userId,{eventId:32778,remoteUserId:t.userId}),t.mediaType===8&&kt(t.room.userId,{eventId:32804,remoteUserId:t.userId}))}),te.on(X.SWITCH_DEVICE_SUCCESS,e=>{let{track:t}=e;t.room&&kt(t.room.userId,{eventId:t.kind===O.VIDEO?32780:32781})}),te.on(X.LOCAL_TRACK_REPLACED,e=>{let{track:t}=e;t.room&&kt(t.room.userId,{eventId:t.kind===O.VIDEO?32782:32783})}),te.on(X.SIGNAL_CONNECTION_STATE_CHANGED,e=>{let t,{room:r,prevState:i,state:n}=e;switch(n){case"CONNECTED":t=i==="RECONNECTING"?32795:32791;break;case"DISCONNECTED":t=i==="RECONNECTING"?32796:32790;break;case"RECONNECTING":t=32794}t&&kt(r.userId,{eventId:t})}),te.on(X.PEER_CONNECTION_STATE_CHANGED,e=>{let t,{room:r,prevState:i,state:n,remoteUserId:a}=e,c=!!a;switch(n){case"CONNECTED":t=i==="RECONNECTING"?c?32801:32798:c?32793:32792;break;case"DISCONNECTED":i==="RECONNECTING"&&(t=c?32802:32799);break;case"RECONNECTING":t=c?32800:32797}t&&kt(r.userId,{eventId:t,remoteUserId:a})}),te.on(X.VIDEO_CODEC_IMPLEMENTATION_CHANGED,e=>{let{userId:t,remoteUserId:r,codec:i,isHWCodec:n,prevImplementation:a}=e,c=n?1:0;a||(c=n?3:2);let A={eventId:4004,param1:c,param2:i==="h264"?0:2,streamType:2};r&&(A.remoteUserId=r,A.eventId=4005),kt(t,A)}),te.on(X.LOCAL_TRACK_RECAPTURE,e=>{let{track:t,error:r}=e;if(t.userId){let i={eventId:2003,param1:0};t.kind===O.AUDIO?(i.streamType=1,r&&(i.param1=2)):(i.streamType=t.streamType==="auxiliary"?7:2,r&&(i.param1=8)),kt(t.userId,i)}});var i1=lr(Lr(),1),n1=class extends i1.EventEmitter{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"userId";super(),this.mySelfId=e,this._log=t,this.key=r,T(this,"userMap",new Map),T(this,"remotePublishedUserMap",new Map)}getPublishedUser(e){return this.remotePublishedUserMap.get(e)}addUser(e){let t=e[this.key],{userId:r,tinyId:i,role:n}=e;if(this.userMap.has(t))return;let a={userId:r,tinyId:i,role:n===20?"anchor":"audience"};this.userMap.set(t,a),this.emit("1",a)}deleteUser(e,t){let r=this.userMap.get(e);if(!r)return;let i="peer leave [".concat(e,"]");K(t)||(i+=":".concat(Yv[t])),this._log.info(i);let n=this.remotePublishedUserMap.get(e);if(n){let a=n.muteState;n.flag=0,this.emit("5",n.userId),this.deleteRemotePublishedUser(e),this.emit("6",{prevMuteState:a,muteState:n.muteState,flag:0})}this.userMap.delete(e),this.emit("2",r.userId)}setUserList(e){this.userMap.forEach(t=>{e.findIndex(r=>r[this.key]===t[this.key])<0&&this.deleteUser(t[this.key],0)}),e.forEach(t=>{!this.userMap.has(t[this.key])&&t[this.key]!==this.mySelfId&&this.addUser(t)})}addRemotePublishedUser(e){this.remotePublishedUserMap.has(e[this.key])||this.remotePublishedUserMap.set(e[this.key],e)}deleteRemotePublishedUser(e){!this.remotePublishedUserMap.has(e)||this.remotePublishedUserMap.delete(e)}setRemotePublishedUserList(e){this.remotePublishedUserMap.forEach(t=>{let r=t[this.key];if(e.findIndex(i=>i[this.key]===t[this.key])<0){this._log.info("remote [".concat(r,"] unpublish"));let i=t.muteState;t.flag=0,this.emit("5",t.userId),this.deleteRemotePublishedUser(r),this.emit("6",{prevMuteState:i,muteState:t.muteState,flag:0})}}),e.forEach(t=>{var r;let i=t[this.key];if(i===this.mySelfId)return;let{flag:n,userId:a,tinyId:c}=t,A=Hd(n,a),d=(r=this.remotePublishedUserMap.get(i))==null?void 0:r.muteState;if(d){let g=this.remotePublishedUserMap.get(i);g&&g.flag!==n&&(g.flag=n,this._log.info("remote publish updated: ".concat(JSON.stringify(g.muteState))),this.emit("6",{prevMuteState:d,muteState:A,flag:n}))}else this._log.info("remote publish. state: ".concat(JSON.stringify(A))),this.addUser({userId:a,tinyId:c,role:20}),this.emit("3",t),this.emit("6",{prevMuteState:Hd(0,a),muteState:A,flag:n})})}clear(){this.userMap.clear(),this.remotePublishedUserMap.clear()}};function fR(e){let{timesInSecond:t,maxSizeInSecond:r,getSize:i}=e;return St((n,a)=>{let c=new Map;return te.on(X.ROOM_DESTROY,A=>{let{room:d}=A;return c.delete(d)}),function(){let A=c.get(this);for(var d=arguments.length,g=new Array(d),E=0;E<d;E++)g[E]=arguments[E];if(A||(A={callCountInSecond:0,timestamp:0,totalSizeInSecond:0},c.set(this,A)),A.timestamp===0?A.timestamp=Date.now():Date.now()-A.timestamp>1e3&&(A.timestamp=Date.now(),A.callCountInSecond=0,A.totalSizeInSecond=0),i&&(A.totalSizeInSecond+=i(...g)),A.timestamp!==0&&Date.now()-A.timestamp<1e3&&(A.callCountInSecond>=t||A.totalSizeInSecond>r))throw new pe({code:se.INVALID_OPERATION,message:Ve({key:xe.CALL_FREQUENCY_LIMIT,data:{isTimes:A.callCountInSecond>=t,isSize:A.totalSizeInSecond>r,name:a,timesInSecond:t,maxSizeInSecond:r}})});A.callCountInSecond++,n.call(this,...g)}})}var W,ER=!0,Zn={SCENE_LIVE:"live",SCENE_RTC:"rtc",ROLE_ANCHOR:"anchor",ROLE_AUDIENCE:"audience",STREAM_TYPE_MAIN:"main",STREAM_TYPE_SUB:"sub",AUDIO_PROFILE_STANDARD:"standard",AUDIO_PROFILE_STANDARD_STEREO:"standard-stereo",AUDIO_PROFILE_HIGH:"high",AUDIO_PROFILE_HIGH_STEREO:"high-stereo",QOS_PREFERENCE_SMOOTH:"smooth",QOS_PREFERENCE_CLEAR:"clear"},Be={INVALID_PARAMETER:5e3,INVALID_OPERATION:5100,ENV_NOT_SUPPORTED:5200,DEVICE_ERROR:5300,SERVER_ERROR:5400,OPERATION_FAILED:5500,OPERATION_ABORT:5998,UNKNOWN_ERROR:5999},tg=((W=tg||{})[W.INVALID_PARAMETER=5e3]="INVALID_PARAMETER",W[W.INVALID_PARAMETER_REQUIRED=5001]="INVALID_PARAMETER_REQUIRED",W[W.INVALID_PARAMETER_TYPE=5002]="INVALID_PARAMETER_TYPE",W[W.INVALID_PARAMETER_EMPTY=5003]="INVALID_PARAMETER_EMPTY",W[W.INVALID_PARAMETER_INSTANCE=5004]="INVALID_PARAMETER_INSTANCE",W[W.INVALID_PARAMETER_RANGE=5005]="INVALID_PARAMETER_RANGE",W[W.INVALID_PARAMETER_LESS_THAN_ZERO=5006]="INVALID_PARAMETER_LESS_THAN_ZERO",W[W.INVALID_PARAMETER_MIN=5007]="INVALID_PARAMETER_MIN",W[W.INVALID_PARAMETER_MAX=5008]="INVALID_PARAMETER_MAX",W[W.INVALID_ELEMENT_ID=5009]="INVALID_ELEMENT_ID",W[W.INVALID_ELEMENT_ID_TYPE=5010]="INVALID_ELEMENT_ID_TYPE",W[W.INVALID_STREAM_ID=5011]="INVALID_STREAM_ID",W[W.INVALID_ROOM_ID_STRING=5012]="INVALID_ROOM_ID_STRING",W[W.INVALID_ROOM_ID_INTEGER=5013]="INVALID_ROOM_ID_INTEGER",W[W.INVALID_STREAM_TYPE=5014]="INVALID_STREAM_TYPE",W[W.INVALID_ROOM_ID_REQUIED=5015]="INVALID_ROOM_ID_REQUIED",W[W.INVALID_ROOM_ID_INTEGER_STRING=5016]="INVALID_ROOM_ID_INTEGER_STRING",W[W.INVALID_BUFFER_EMPTY=5017]="INVALID_BUFFER_EMPTY",W[W.INVALID_BUFFER_OVERSIZE=5018]="INVALID_BUFFER_OVERSIZE",W[W.INVALID_OPERATION=5100]="INVALID_OPERATION",W[W.INVALID_OPERATION_NOT_JOINED=5101]="INVALID_OPERATION_NOT_JOINED",W[W.INVALID_OPERATION_REMOTE_USER_NOT_EXIST=5102]="INVALID_OPERATION_REMOTE_USER_NOT_EXIST",W[W.INVALID_OPERATION_STREAM_TYPE_NOT_EXIST=5103]="INVALID_OPERATION_STREAM_TYPE_NOT_EXIST",W[W.INVALID_OPERATION_REPEAT_CALL=5104]="INVALID_OPERATION_REPEAT_CALL",W[W.INVALID_OPERATION_NEED_VIDEO=5105]="INVALID_OPERATION_NEED_VIDEO",W[W.INVALID_OPERATION_NEED_AUDIO=5106]="INVALID_OPERATION_NEED_AUDIO",W[W.INVALID_ROLE_AUDIENCE=5107]="INVALID_ROLE_AUDIENCE",W[W.INVALID_NOT_ENABLE_SEI=5108]="INVALID_NOT_ENABLE_SEI",W[W.INVALID_NEED_CALL_PUBLISHED=5109]="INVALID_NEED_CALL_PUBLISHED",W[W.ENV_NOT_SUPPORTED=5200]="ENV_NOT_SUPPORTED",W[W.NOT_SUPPORTED_HTTP=5201]="NOT_SUPPORTED_HTTP",W[W.NOT_SUPPORTED_WEBRTC=5202]="NOT_SUPPORTED_WEBRTC",W[W.NOT_SUPPORTED_H264_ENCODE=5203]="NOT_SUPPORTED_H264_ENCODE",W[W.NOT_SUPPORTED_H264_DECODE=5204]="NOT_SUPPORTED_H264_DECODE",W[W.NOT_SUPPORTED_SCREEN_SHARE=5205]="NOT_SUPPORTED_SCREEN_SHARE",W[W.NOT_SUPPORTED_SMALL_VIDEO=5206]="NOT_SUPPORTED_SMALL_VIDEO",W[W.NOT_SUPPORTED_SEI=5207]="NOT_SUPPORTED_SEI",W[W.NOT_SUPPORTED_WEBGL=5208]="NOT_SUPPORTED_WEBGL",W[W.NOT_SUPPORTED_CHROME_VERSION=5209]="NOT_SUPPORTED_CHROME_VERSION",W[W.DEVICE_ERROR=5300]="DEVICE_ERROR",W[W.DEVICE_NOT_FOUND_ERROR=5301]="DEVICE_NOT_FOUND_ERROR",W[W.DEVICE_NOT_ALLOWED_ERROR=5302]="DEVICE_NOT_ALLOWED_ERROR",W[W.DEVICE_NOT_READABLE_ERROR=5303]="DEVICE_NOT_READABLE_ERROR",W[W.DEVICE_OVERCONSTRAINED_ERROR=5304]="DEVICE_OVERCONSTRAINED_ERROR",W[W.DEVICE_INVALID_STATE_ERROR=5305]="DEVICE_INVALID_STATE_ERROR",W[W.DEVICE_SECURITY_ERROR=5306]="DEVICE_SECURITY_ERROR",W[W.DEVICE_ABORT_ERROR=5307]="DEVICE_ABORT_ERROR",W[W.CAMERA_RECOVER_FAILED=5308]="CAMERA_RECOVER_FAILED",W[W.MICROPHONE_RECOVER_FAILED=5309]="MICROPHONE_RECOVER_FAILED",W[W.SERVER_ERROR=5400]="SERVER_ERROR",W[W.NEED_TO_BUY=5401]="NEED_TO_BUY",W[W.ACCOUNT_NO_MONEY=-100013]="ACCOUNT_NO_MONEY",W[W.OPERATION_FAILED=5500]="OPERATION_FAILED",W[W.FIREWALL_RESTRICTION=5501]="FIREWALL_RESTRICTION",W[W.REJOIN_FAILED=5502]="REJOIN_FAILED",W[W.EVENT_HANDLER_ERROR=5503]="EVENT_HANDLER_ERROR",W[W.VIDEO_CONTEXT_ERROR=5504]="VIDEO_CONTEXT_ERROR",W[W.OPERATION_ABORT=5998]="OPERATION_ABORT",W[W.UNKNOWN_ERROR=5999]="UNKNOWN_ERROR",W),_R=Ke(_e({},xi),{INVALID_PARAMETER(e){let{fnName:t}=e;return"the parameters of the '".concat(t,"' you called does not meet the requirements, please check the API documentation.")},INVALID_PARAMETER_REQUIRED(e){let{key:t,rule:r,fnName:i,value:n}=e;return"'".concat(t||r.name,"' is a required param when calling ").concat(i,"(), received: ").concat(n,".")},INVALID_PARAMETER_TYPE(e){let{key:t,rule:r,fnName:i,value:n}=e,a="".concat(t||r.name),c="";return c=Array.isArray(r.type)?r.type.join("|"):r.type,"'".concat(a,"' must be type of ").concat(c," when calling ").concat(i,"(), received type: ").concat(xr(n),".")},INVALID_PARAMETER_EMPTY(e){let{key:t,rule:r,fnName:i,value:n}=e;return"'".concat(t||r.name,"' cannot be '").concat(n,"' when calling ").concat(i,"().")},INVALID_PARAMETER_INSTANCE(e){let{key:t,rule:r,fnName:i,value:n}=e,a="".concat(t||r.name),c="".concat(r.instanceOf.name||r.instanceOf);return"'".concat(a,"' must be instanceof ").concat(c," when calling ").concat(i,"(), received type: ").concat(xr(n),".")},INVALID_PARAMETER_RANGE(e){let{key:t,rule:r,fnName:i,value:n}=e;return"'".concat(t||r.name,"' must be one of ").concat(r.values.join("|")," when calling ").concat(i,"(), received: ").concat(n,".")},INVALID_PARAMETER_LESS_THAN_ZERO(e){let{key:t,rule:r,fnName:i}=e;return"'".concat(t||r.name,"' cannot be less than 0 when calling ").concat(i,"().")},INVALID_PARAMETER_MIN(e){let{key:t,rule:r,value:i}=e;return"the min value of ".concat(t||r.name," is ").concat(r.min,", received: ").concat(i,".")},INVALID_PARAMETER_MAX(e){let{key:t,rule:r,value:i}=e;return"the max value of ".concat(t||r.name," is ").concat(r.max,", received: ").concat(i,".")},INVALID_ELEMENT_ID(e){let{key:t,fnName:r}=e;return"'".concat(t,"' is not found in the document object when calling ").concat(r,"().")},INVALID_ELEMENT_ID_TYPE(e){let{key:t,fnName:r,type:i}=e;return"the element corresponding to '".concat(t,"' must be instanceof HTMLElement when calling ").concat(r,"(), received: ").concat(i,".")},INVALID_STREAM_ID(e){let{key:t}=e;return"'".concat(t,"' can only consist of uppercase and lowercase english letters (a-zA-Z), numbers (0-9), hyphens and underscores.")},INVALID_ROOM_ID_STRING(e){let{key:t}=e;return"'".concat(t,"' must be a valid string.")},INVALID_ROOM_ID_INTEGER(e){let{key:t}=e;return"'".concat(t,"' must be an integer between [1, 4294967294].")},INVALID_ROOM_ID_INTEGER_STRING(e){let{key:t}=e;return"'".concat(t,"' must be an integer but go a string, use 'parseInt' to convert it or use 'strRoomId' instead.")},INVALID_ROOM_ID_REQUIED:()=>"at least one of 'roomId'(between [1, 4294967294]) and 'strRoomId'(not empty) is required.",INVALID_STREAM_TYPE:e=>{let{fnName:t}=e;return"'streamType' is required when 'userId' is not '*', calling ".concat(t,"()")},INVALID_IMAGE_URL:"The 'src' param must be filled in when the background type is image.",INVALID_OPERATION(e){let{fnName:t}=e;return"the API '".concat(t,"' you called does not meet the requirements, please check the API documentation.")},INVALID_OPERATION_NOT_JOINED(e){let{fnName:t}=e;return"cannot ".concat(t," because you are not enter room yet.")},INVALID_OPERATION_REMOTE_USER_NOT_EXIST(e){let{fnName:t,value:r}=e;return"cannot ".concat(t," because remote user(userId: ").concat(r.userId,") does not publishing stream.")},INVALID_OPERATION_STREAM_TYPE_NOT_EXIST(e){let{fnName:t,value:r}=e;return"cannot ".concat(t," because remote user(userId: ").concat(r.userId,") does not publishing ").concat(r.streamType," video.")},INVALID_OPERATION_REPEAT_CALL(e){let{fnName:t}=e;return"you are already ".concat(t,"(), cannot repeated call '").concat(t,"'.")},INVALID_OPERATION_NEED_VIDEO(e){let{fnName:t}=e;return"cannot call '".concat(t,"' because the camera is not turned on.")},INVALID_OPERATION_NEED_AUDIO(e){let{fnName:t}=e;return"cannot call '".concat(t,"' because the microphone is not turned on.")},INVALID_BUFFER_EMPTY:e=>{let{key:t}=e;return"the buffer size of paramerter '".concat(t,"' cannot be empty")},INVALID_BUFFER_OVERSIZE:()=>"buffer size is over 1000 Bytes",INVALID_ROLE_AUDIENCE:()=>"role: '".concat("audience","' cannot call this api."),INVALID_NOT_ENABLE_SEI:()=>"you need to enable SEI in TRTC.create({ enableSEI: true })",INVALID_NEED_CALL_PUBLISHED:e=>{let{fnName:t}=e;return"you need to call ".concat(t,"() after publish stream.")},ENV_NOT_SUPPORTED(e){let{fnName:t}=e;return"the current browser does not support the capability of the function '".concat(t,"' you are calling, please check the API documentation.")},NOT_SUPPORTED_WEBRTC:"the current browser does not support WebRTC capability, please check the SDK documentation.",NOT_SUPPORTED_H264_ENCODE:"this browser does not support H264 encode.",NOT_SUPPORTED_H264_DECODE:"this browser does not support H264 decode.",NOT_SUPPORTED_SCREEN_SHARE:"this browser does not support screen share, please check the browser version.",NOT_SUPPORTED_SMALL_VIDEO:"this browser does not support small video, please check the browser version.",NOT_SUPPORTED_SEI:"this browser does not support SEI, please check the browser version.",NOT_SUPPORTED_WEBGL:"this browser does not support WebGL, please check the browser version.",NOT_SUPPORTED_CHROME_VERSION(e){let{fnName:t}=e;return"cannot call ".concat(t," because the browser version is too low, please upgrade to the latest version")},DEVICE_ERROR(e){let{fnName:t,error:r}=e;return"'".concat(t,"' got device exception").concat(r?", error: ".concat(r.toString(),"."):".")},DEVICE_NOT_FOUND_ERROR(e){let{fnName:t,deviceType:r=Ca(t),error:i}=e;return"NotFoundError, no ".concat(r," detected, please check your device and the configuration on '").concat(t,"'").concat(i?", error: ".concat(i.toString(),"."):".")},DEVICE_NOT_ALLOWED_ERROR(e){let{fnName:t,deviceType:r=Ca(t),error:i}=e;return"NotAllowedError, you have disabled ".concat(r," access, please allow the current application to use the ").concat(r).concat(i?", error: ".concat(i.toString(),"."):".")},DEVICE_NOT_READABLE_ERROR(e){let{fnName:t,deviceType:r=Ca(t),error:i}=e;return"NotReadableError, the ".concat(r," maybe in use by another APP, please check if the device is pre-occupied by another APP.")},DEVICE_OVERCONSTRAINED_ERROR(e){let{fnName:t,deviceType:r=Ca(t),error:i}=e;return"OverconstrainedError, the device ID is incorrect, please check whether the device ID passed in is correct".concat(i?", error: ".concat(i.toString(),"."):".")},DEVICE_INVALID_STATE_ERROR(e){let{fnName:t,deviceType:r=Ca(t),error:i}=e;return"InvalidStateError, after the user clicks and interacts with the page, turn on the ".concat(r).concat(i?", error: ".concat(i.toString(),"."):".")},DEVICE_SECURITY_ERROR(e){let{fnName:t,deviceType:r=Ca(t),error:i}=e;return"SecurityError, check whether the system security policy restricts the use of the ".concat(r,", and it is recommended to turn on the ").concat(r," after the user interacts with the page").concat(i?", error: ".concat(i.toString(),"."):".")},DEVICE_ABORT_ERROR(e){let{fnName:t,deviceType:r=Ca(t),error:i}=e;return"AbortError, an unknown exception in the system makes the device unusable, recommended to change the device or browser and re-check whether the device is normal".concat(i?" error: ".concat(i.toString(),"."):".")},CAMERA_RECOVER_FAILED(e){let{error:t}=e;return"camera recover capture failed ".concat((t==null?void 0:t.name)||"",": ").concat((t==null?void 0:t.originMessage)||(t==null?void 0:t.message))},MICROPHONE_RECOVER_FAILED(e){let{error:t}=e;return"microphone recover capture failed ".concat((t==null?void 0:t.name)||"",": ").concat((t==null?void 0:t.originMessage)||(t==null?void 0:t.message))},OPERATION_FAILED(e){let{fnName:t,error:r}=e;return"'".concat(t,"' failed, reason: ").concat(r==null?void 0:r.toString())},FIREWALL_RESTRICTION:()=>"media connection failure due to firewall restrictions, please try to change your network.",EVENT_HANDLER_ERROR(e){let{eventName:t}=e;return"an error was caught on trtc.on('".concat(t,"', handler), please check your code on 'handler'.")},VIDEO_CONTEXT_ERROR(e){let{reason:t,error:r}=e;return"video context error ".concat(t," ").concat((r==null?void 0:r.name)||""," ").concat((r==null?void 0:r.message)||"")},SERVER_ERROR(e){let{fnName:t,error:r}=e;return"'".concat(t,"' got server error: ").concat(r==null?void 0:r.toString(),", please check the SDK documentation.")},NEED_TO_BUY(e){let{value:t,url:r}=e;return"You need to buy packages for ".concat(t,". Refer to: ").concat(r)},ACCOUNT_NO_MONEY:e=>{let{fnParams:t}=e;return"your TRTC account run out of credit, please recharge.".concat(t.sdkAppId?" SDKAppId: ".concat(t.sdkAppId):"")},OPERATION_ABORT(e){let{fnName:t}=e;return"'".concat(t,"' abort")},UNKNOWN_ERROR(e){let{fnName:t,error:r}=e;return"'".concat(t,"' throw unknown exception").concat(r?", error: ".concat(r.toString(),"."):".")}});function Ca(e){if(!e)return"camera";let t=e.toLowerCase();return t.includes("screen")?"screen share":t.includes("audio")?"microphone":"camera"}var rg=class extends Error{constructor(e){let{code:t,extraCode:r,message:i="",messageParams:n,fnName:a="",originError:c}=e;var A;let d;d=i||function(g){let E,{code:f,params:b,enableDocLink:w=!1}=g,k="",x=tg[f];try{E=_R[x]}catch{E=_R.UNKNOWN_ERROR}return mt(E)?k=E(b):ut(E)&&(k=E),b.fnName&&!k.includes(b.fnName)&&(k[k.length-1]!=="."&&(k+="."),k+=" thrown from ".concat(b.fnName,"()")),w&&(k+=" doc:"),k}({code:r||t,params:_e({fnName:a,error:c},n)}),super(d),T(this,"name","RtcError"),T(this,"code"),T(this,"extraCode"),T(this,"functionName"),T(this,"message"),T(this,"handler"),T(this,"originError"),this.name=tg[t],this.code=t,this.extraCode=r,this.functionName=a,this.originError=c,this.message=d,this.extraCode===5302&&((A=this.originError)!=null&&A.message.includes("system"))&&(this.handler=()=>{let g=document.createElement("a");xc?g.href="ms-settings:privacy-".concat({startLocalVideo:"webcam",startLocalAudio:"microphone"}[this.functionName]):aa&&(g.href="x-apple.systempreferences:com.apple.preference.security?Privacy_".concat({startLocalVideo:"Camera",startLocalAudio:"Microphone",startScreenShare:"ScreenCapture"}[this.functionName])),g.href.length>0&&g.click()})}static convertFrom(e,t,r){let i=e;if(e instanceof pe){let{stack:n}=e,a={code:Be.UNKNOWN_ERROR,fnName:t,originError:e};switch(e.getCode()){case se.INVALID_PARAMETER:a.code=Be.INVALID_PARAMETER,a.message=e.message;break;case se.INVALID_OPERATION:a.code=Be.INVALID_OPERATION;break;case se.NOT_SUPPORTED:case se.NOT_SUPPORTED_H264:a.code=Be.ENV_NOT_SUPPORTED,e.getCode()===se.NOT_SUPPORTED_H264&&(a.extraCode=e.message.includes(xi.NOT_SUPPORTED_H264ENCODE)?5203:5204);break;case se.JOIN_ROOM_FAILED:a.messageParams={fnParams:r};case se.SERVER_TIMEOUT:case se.SWITCH_ROLE_FAILED:a.code=Be.SERVER_ERROR,a.extraCode=e.getExtraCode();break;case se.API_CALL_ABORTED:a.code=Be.OPERATION_ABORT;break;case se.DEVICE_NOT_FOUND:case se.DEVICE_AUTO_RECOVER_FAILED:case se.INITIALIZE_FAILED:a.code=5300,e.name&&(a.extraCode=function(c){let A;switch(c){case"NotFoundError":A=5301;break;case"NotAllowedError":A=5302;break;case"NotReadableError":A=5303;break;case"OverconstrainedError":A=5304;break;case"InvalidStateError":A=5305;break;case"SecurityError":A=5306;break;case"AbortError":A=5307;break;default:A=5300}return A}(e.name));break;case se.UNKNOWN:break;default:a.code=Be.OPERATION_FAILED}i=new rg(a),n&&(i.stack+=n.substr(n.indexOf(`
`)))}else{if(e instanceof rg)return e;i=new rg({code:Be.UNKNOWN_ERROR,fnName:t,originError:e})}return i}},Re=rg,IR={type:"object",properties:{cameraId:{type:"string"},useFrontCamera:{type:"boolean"},fillMode:{type:"string",values:["contain","cover","fill"]},mirror:{type:["string","boolean"],values:[!0,!1,"view","publish","both"]},small:{properties:{width:{type:"number"},height:{type:"number"},frameRate:{type:"number"},bitrate:{type:"number"}}},videoTrack:{instanceOf:MediaStreamTrack}}},CR={type:"object",properties:{systemAudio:{type:"boolean"},fillMode:{type:"string",values:["contain","cover","fill"]},profile:{type:["string","object"],properties:{width:{type:"number"},height:{type:"number"},frameRate:{type:"number"},bitrate:{type:"number"}}},videoTrack:{instanceOf:MediaStreamTrack},audioTrack:{instanceOf:MediaStreamTrack}}},qc={type:["string",HTMLElement,null,"array"],arrayItem:{instanceOf:HTMLElement},validate(e,t,r){if(ut(e)&&!document.getElementById(e))throw new Re({code:Be.INVALID_PARAMETER,extraCode:5009,fnName:r,messageParams:{key:t}})}},yR={name:"userId",required:!0,type:"string"},TR={type:"object",properties:{microphoneId:{type:"string"},audioTrack:{instanceOf:MediaStreamTrack},captureVolume:{type:"number",min:0},earMonitorVolume:{type:"number",min:0,max:100},profile:{values:[Zn.AUDIO_PROFILE_STANDARD,Zn.AUDIO_PROFILE_STANDARD_STEREO,Zn.AUDIO_PROFILE_HIGH,Zn.AUDIO_PROFILE_HIGH_STEREO]},echoCancellation:{type:"boolean"},autoGainControl:{type:"boolean"},noiseSuppression:{type:"boolean"}}};function su(e,t){if(!e)throw new Re({code:Be.INVALID_OPERATION,extraCode:5101,fnName:t})}function SR(e,t,r){if(!e)throw new Re({code:Be.INVALID_OPERATION,extraCode:5102,fnName:t,messageParams:{value:r}})}var o1={create:[{name:"RoomConfig",instanceOf:Function},{name:"CreateConfig",type:"object",properties:{plugins:{type:"array",arrayItem:{instanceOf:Function}}}}],enterRoom:{name:"EnterRoomConfig",type:"object",required:!0,validate(e,t,r){if(this._room.isJoined)throw new Re({code:Be.INVALID_OPERATION,extraCode:5104,fnName:r});if(e.roomId){if(ut(e.roomId))throw new Re({code:Be.INVALID_PARAMETER,extraCode:5016,fnName:r,messageParams:{key:t}});if(!(/^[1-9]\d*$/.test(String(e.roomId))&&e.roomId<4294967295))throw new Re({code:Be.INVALID_PARAMETER,extraCode:5013,fnName:r,messageParams:{key:t}})}else{if(!e.strRoomId)throw new Re({code:Be.INVALID_PARAMETER,extraCode:5015,fnName:r});if(!/^[A-Za-z\d\s!#$%&()+\-:;<=.>?@[\]^_{}|~,]{1,64}$/.test(e.strRoomId))throw new Re({code:Be.INVALID_PARAMETER,extraCode:5012,fnName:r,messageParams:{key:t}})}},properties:{sdkAppId:{required:!0,type:"number",allowEmpty:!1},userId:{required:!0,type:"string",allowEmpty:!1},userSig:{required:!0,type:"string",allowEmpty:!1},scene:{type:"string",values:["live","rtc"]},role:{type:"string",values:["audience","anchor"]},roomId:{type:["string","number"]},strRoomId:{type:"string"},proxy:{type:["object","string"],properties:{websocketProxy:{type:"string"},turnServer:{type:["object","array"],properties:{url:{required:!0,type:"string"},username:{type:"string"},credential:{type:"string"},credentialType:{type:"string",values:["password"]}}},loggerProxy:{type:"string"},webtransportProxy:{type:"string"}}},enableAutoPlayDialog:{type:"boolean"},userDefineRecordId:{type:"string"},latencyLevel:{type:"number"}}},startLocalVideo:{name:"LocalVideoConfig",type:"object",properties:{view:qc,mute:{type:["boolean","string"]},publish:{type:"boolean"},option:IR},validate(e){var t;if(((t=e==null?void 0:e.option)==null||!t.videoTrack)&&pa())throw new Re({code:Be.ENV_NOT_SUPPORTED,extraCode:5201})}},updateLocalVideo:{name:"updateLocalVideoConfig",type:"object",required:!0,properties:{view:Ke(_e({},qc),{required:!1}),publish:{type:"boolean"},mute:{type:["boolean","string"]},option:IR}},startLocalAudio:{name:"LocalAudioConfig",type:"object",properties:{publish:{type:"boolean"},option:TR},validate(e){var t;if(((t=e==null?void 0:e.option)==null||!t.audioTrack)&&pa())throw new Re({code:Be.ENV_NOT_SUPPORTED,extraCode:5201})}},updateLocalAudio:{name:"updateLocalAudioConfig",type:"object",required:!0,properties:{publish:{type:"boolean"},mute:{type:"boolean"},option:TR}},startScreenShare:{name:"ScreenShareConfig",type:"object",properties:{view:qc,publish:{type:"boolean"},option:CR},validate(e,t,r,i,n){var a;if(((a=e==null?void 0:e.option)==null||!a.videoTrack)&&pa())throw new Re({code:Be.ENV_NOT_SUPPORTED,extraCode:5201});if(!Gh())throw new Re({code:Be.ENV_NOT_SUPPORTED,fnName:r,extraCode:5205})}},updateScreenShare:{name:"updateScreenShareConfig",type:"object",required:!0,properties:{view:qc,publish:{type:"boolean"},option:CR}},muteRemoteAudio:[yR,{name:"mute",required:!0,type:"boolean"}],setRemoteAudioVolume:[yR,{name:"volume",required:!0,type:"number",min:0}],startRemoteVideo:{name:"startRemoteVideoConfig",type:"object",required:!0,properties:{view:qc,userId:{type:"string",required:!0},streamType:{values:["main","sub"],required:!0},option:{type:"object",properties:{fillMode:{type:"string",values:["contain","cover","fill"]},mirror:{type:"boolean"}}}},validate(e,t,r){su(this._room.isJoined,r);let i=this._room.remotePublishedUserMap.get(e.userId);if(SR(!!i,r,e),i&&(e.streamType==="main"&&!i.muteState.videoAvailable||e.streamType==="sub"&&!i.muteState.hasAuxiliary))throw new Re({code:Be.INVALID_OPERATION,extraCode:5103,fnName:r,messageParams:{value:e}})}},updateRemoteVideo:{name:"updateRemoteVideoConfig",type:"object",required:!0,properties:{view:Ke(_e({},qc),{required:!1}),userId:{type:"string",required:!0},streamType:{values:["main","sub"],required:!0},option:{type:"object",properties:{fillMode:{type:"string",values:["contain","cover","fill"]},mirror:{type:"boolean"}}}},validate(e,t,r){su(this._room.isJoined,r);let i=this._room.remotePublishedUserMap.get(e.userId);if(SR(!!i,r,e),i&&(e.streamType==="main"&&!i.muteState.videoAvailable||e.streamType==="sub"&&!i.muteState.hasAuxiliary))throw new Re({code:Be.INVALID_OPERATION,extraCode:5103,fnName:r,messageParams:{value:e}})}},stopRemoteVideo:{name:"stopRemoteVideoConfig",type:"object",required:!0,properties:{userId:{type:"string",required:!0},streamType:{values:["main","sub"]}},validate(e,t,r){if(e.userId!=="*"&&K(e.streamType))throw new Re({code:Be.INVALID_PARAMETER,extraCode:5014,fnName:r})}},switchRole:{name:"role",required:!0,values:["anchor","audience"],validate(e,t,r){su(this._room.isJoining||this._room.isJoined,r)}},enableAudioVolumeEvaluation:[{name:"interval",type:"number"},{name:"enableInBackground",type:"boolean"}],sendSEIMessage:[{name:"buffer",required:!0,instanceOf:ArrayBuffer,validate(e,t,r,i){if(!ma)throw new Re({code:Be.ENV_NOT_SUPPORTED,fnName:r,extraCode:5207});if(!this._room.enableSEI)throw new Re({code:Be.INVALID_OPERATION,fnName:r,extraCode:5108});if(e.byteLength>1e3)throw new Re({code:Be.INVALID_PARAMETER,extraCode:5018,fnName:r});if(e.byteLength===0)throw new Re({code:Be.INVALID_PARAMETER,extraCode:5017,messageParams:{key:t},fnName:r});su(this._room.isJoined,r)}},{name:"options",type:"object",properties:{seiPayloadType:{type:"number",values:[5,243]},toSubStream:{type:"boolean",validate(e,t,r){if(!e&&!this._room.isMainStreamPublished||e&&!this._room.isAuxStreamPublished)throw new Re({code:Be.INVALID_OPERATION,extraCode:5109,messageParams:{key:t},fnName:r})}}}}],sendCustomMessage:{name:"message",required:!0,type:"object",properties:{cmdId:{type:"number",required:!0,min:1,max:10},data:{instanceOf:ArrayBuffer,required:!0,validate(e,t,r,i){if(e.byteLength>1e3)throw new Re({code:Be.INVALID_PARAMETER,extraCode:5018,fnName:r});if(e.byteLength===0)throw new Re({code:Be.INVALID_PARAMETER,extraCode:5017,fnName:r,messageParams:{key:t}})}}},validate(e,t,r){if(su(this._room.isJoined,r),this._room.scene==="live"&&this._room.role==="audience")throw new Re({code:Be.INVALID_OPERATION,extraCode:5107,fnName:r,messageParams:{key:t}})}}},dr={TRTC:o1},ri=class extends Error{};function s1(e,t){let r=Gd(e);for(let i=0;i<t.length;i++)ha(r[i],t[i]);return r}function a1(e){this._resolve=Promise.resolve(e)}function c1(e){this._reject=Promise.reject(e)}var au=class{constructor(e,t){this.instance=e,this.group=t,this.started=!1,this.ops=[],this.startSame=()=>!0,this.mergeUpdate=s1;let r=au.instances.get(e);r?r.set(t,this):au.instances.set(e,new Map([[t,this]]))}static get(e,t){let r=au.instances.get(e);return r&&r.get(t)||new au(e,t)}action(e,t,r){let i=c=>{var A;return e===0?this.started=!0:e===3&&(this.started=!1),this.ops.shift(),(A=this.currentOp)==null||A.action(),c},n=c=>{var A,d;throw this.ops.shift(),e===0&&((A=this.currentOp)==null?void 0:A.type)===2&&this.ops.shift().reject(new ri("start failed")),(d=this.currentOp)==null||d.action(),c},a={type:e,action:()=>t(...a.args).then(i,n),args:r,resolve:a1,reject:c1};try{switch(this.state){case 1:if(e===0)throw new ri("already started");break;case 4:if(e===2)throw new ri("not started");break;default:return this.cacheOp(a)}}catch(c){return Promise.reject(c)}return this.ops.push(a),a.promise=t(...a.args).then(i,n)}cacheOp(e){if(this.ops.length===1)switch(this.state){case 0:case 2:if(e.type===0)throw new ri("already start");break;case 3:switch(e.type){case 2:throw new ri("update not allowed when stopping");case 3:return this.currentOp.promise}break;default:throw new ri("unknown state")}else switch(e.type){case 3:if(this.lastOpType===3)return this.lastOp.promise;{let r=new ri("keep stop");if(this.ops.slice(1).forEach(i=>i.reject(r)),this.ops=this.ops.slice(0,1),this.state===3)return this.currentOp.promise}break;case 2:switch(this.lastOpType){case 2:return this.lastOp.args=this.mergeUpdate(this.lastOp.args,e.args),this.lastOp.promise;case 3:throw new ri("update not allowed after stop")}break;case 0:switch(this.lastOpType){case 2:throw new ri("start not allowed after update");case 0:throw new ri("duplicate start");case 3:if(this.startSame(this.currentOp.args,e.args))throw this.ops.pop().reject(new ri("keep start")),new ri("already start")}}e.promise=new Promise((r,i)=>{e._resolve?e._resolve.then(r):e.resolve=r,e._reject?e._reject.catch(i):e.reject=i});let{action:t}=e;return e.action=()=>t().then(e.resolve,e.reject),this.ops.push(e),e.promise}get lastOp(){return this.ops[this.ops.length-1]}get lastOpType(){return this.lastOp.type}get currentOp(){return this.ops[0]}get state(){return this.currentOp?this.currentOp.type:this.started?1:4}},cu=au;cu.instances=new WeakMap;var ig=new WeakMap,ng=(e,t)=>{if(t instanceof ri){let{stack:r}=t;t=new Re({code:Be.OPERATION_ABORT,message:"".concat(e," abort: ").concat(t.message),fnName:e}),r&&(t.stack+=r.substr(r.indexOf(`
`)))}throw t};function ya(e,t){return St((r,i)=>function(){for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];let A=cu.get(this,typeof e=="string"?e:e.call(this,...a));return t&&(A.startSame=t.bind(this)),A.action(0,r.bind(this),a).catch(ng.bind(null,i))})}function $c(e,t){let{merge:r,debounce:i}=t||{};return St((n,a)=>function(){for(var c=arguments.length,A=new Array(c),d=0;d<c;d++)A[d]=arguments[d];let g=cu.get(this,typeof e=="string"?e:e.call(this,...A));if(r&&(g.mergeUpdate=r.bind(this)),i&&i.isNeedToDebounce.apply(this,A)){let{delay:E,getKey:f}=i;return new Promise((b,w)=>{var k,x;let Y=(k=ig.get(this))==null?void 0:k.get(f(...A));if(Y){let{timeoutId:F,resolve:me}=Y;clearTimeout(F),me()}let G=setTimeout(()=>{if(g.state===3||g.state===4)return b();g.action(2,n.bind(this),A).catch(ng.bind(null,a)).then(b,w)},E);ig.has(this)?(x=ig.get(this))==null||x.set(f(...A),{timeoutId:G,resolve:b}):ig.set(this,new Map([[f(...A),{timeoutId:G,resolve:b}]]))})}return g.action(2,n.bind(this),A).catch(ng.bind(null,a))})}function Ta(e){return St((t,r)=>function(){for(var i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return cu.get(this,typeof e=="string"?e:e.call(this,...n)).action(3,t.bind(this),n).catch(ng.bind(null,r))})}var Qe={ERROR:"error",AUTOPLAY_FAILED:"autoplay-failed",KICKED_OUT:"kicked-out",REMOTE_USER_ENTER:"remote-user-enter",REMOTE_USER_EXIT:"remote-user-exit",REMOTE_AUDIO_AVAILABLE:"remote-audio-available",REMOTE_AUDIO_UNAVAILABLE:"remote-audio-unavailable",REMOTE_VIDEO_AVAILABLE:"remote-video-available",REMOTE_VIDEO_UNAVAILABLE:"remote-video-unavailable",AUDIO_VOLUME:"audio-volume",NETWORK_QUALITY:"network-quality",CONNECTION_STATE_CHANGED:"connection-state-changed",AUDIO_PLAY_STATE_CHANGED:"audio-play-state-changed",VIDEO_PLAY_STATE_CHANGED:"video-play-state-changed",SCREEN_SHARE_STOPPED:"screen-share-stopped",DEVICE_CHANGED:"device-changed",PUBLISH_STATE_CHANGED:"publish-state-changed",TRACK:"track",STATISTICS:"statistics",SEI_MESSAGE:"sei-message",CUSTOM_MESSAGE:"custom-message"};function og(e){return e==="sub"?"auxiliary":e==="auxiliary"?"sub":"main"}function Zc(e){return e===Zn.QOS_PREFERENCE_CLEAR?"detail":e===Zn.QOS_PREFERENCE_SMOOTH?"motion":""}var vR=class{constructor(){T(this,"_log"),this._log=ae.createLogger({id:"fd"})}download(e,t){return N(this,null,function*(){let{type:r="blob"}=t||{};try{let i,n=He();if(i=mt(fetch)?yield this.downloadWithFetch(e,r):yield this.downloadWithXHR(e,r),!i||!i.data)throw new Error("data is empty");let a=He()-n;return this._log.info("downloaded: ".concat(e,", return type: ").concat(r,", cost: ").concat(a,"ms")),ve.addSuccessEvent({key:522700,cost:He()-n}),i.data}catch(i){throw this._log.error("failed to download: ".concat(e,", error: ").concat(i)),ve.addFailedEvent({key:522700,error:i}),i}})}downloadWithFetch(e,t){return N(this,null,function*(){this._log.info("download with fetch: ".concat(e,", return type: ").concat(t));try{let r,i=yield fetch(e);if(!i.ok)throw new Error("network response was not ok");return r=t==="arraybuffer"?yield i.arrayBuffer():yield i.blob(),{data:r}}catch(r){throw r}})}downloadWithXHR(e,t){return this._log.info("download with xhr: ".concat(e,", return type: ").concat(t)),new Promise((r,i)=>{let n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType=t,n.onload=()=>{n.status===200||n.status===0&&n.response?r({data:n.response}):i(new Error("XHR failed"))},n.onerror=i,n.send(null)})}loadWasm(e,t){return N(this,null,function*(){this._log.info("loadWasm ".concat(e,", importObject: ").concat(JSON.stringify(t)));let r=He(),i=null,n=null;if(mt(WebAssembly.instantiateStreaming)&&!e.startsWith("data:application/octet-stream;base64,")&&!(a=>a.startsWith("file://"))(e)&&mt(fetch))try{let a=fetch(e);i=(yield WebAssembly.instantiateStreaming(a,t)).instance}catch(a){n=a}if(!i)try{let a=yield this.download(e,{type:"arraybuffer"});i=(yield WebAssembly.instantiate(a,t)).instance}catch(a){n=a}if(i){let a=He()-r;return this._log.info("loadedWasm ".concat(e,", cost: ").concat(a,"ms")),ve.addSuccessEvent({key:522701,cost:a}),i}throw this._log.error("failed to loadWasm ".concat(e,", error: ").concat(n)),ve.addFailedEvent({key:522701,error:n}),n})}};le([fa({settings:{timeout:0,retries:3},onRetrying(e){this._log.warn("download retrying: ".concat(e))}})],vR.prototype,"download",1);var l1=new vR,sg=new WeakMap;function wr(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return St((i,n)=>function(){for(var a=arguments.length,c=new Array(a),A=0;A<a;A++)c[A]=arguments[A];try{$_.call(this,t,c,n,this._name)}catch(d){return Promise.reject(d)}return i.apply(this,c)})}function RR(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return St((i,n)=>function(){for(var a=arguments.length,c=new Array(a),A=0;A<a;A++)c[A]=arguments[A];try{$_.call(this,t,c,n,this._name)}catch(d){throw d}return i.apply(this,c)})}function $_(e,t,r,i){if(pr(e))for(let n=0;n<e.length;n++)ag.call(this,{rule:e[n],value:t[n],key:e[n].name,fnName:r,className:i});else ag.call(this,{rule:e,value:t[0],key:e.name,fnName:r,className:i})}function ag(e){let{rule:t,value:r,key:i,fnName:n,className:a}=e;function c(g){return{code:Be.INVALID_PARAMETER,extraCode:g,fnName:n,messageParams:{key:i,rule:t,value:r}}}if(K(r)){if(t.required)throw new Re(c(5001));if(K(t.defaultValue))return void(mt(t.validate)&&t.validate.call(this,r,i,n,a,this));r=t.defaultValue}if(Array.isArray(t.type)){let g=!1;for(let E=0;E<t.type.length;E++)t.type[E]===null&&r===null&&(g=!0),mt(t.type[E])&&r instanceof t.type[E]&&(g=!0),ut(t.type[E])&&xr(r)===t.type[E].toLowerCase()&&(g=!0);if(!g)throw new Re({code:Be.INVALID_PARAMETER,extraCode:5002,fnName:n,messageParams:{key:i,rule:{type:t.type.map(E=>m_(E)?E0(E):ut(E)?E:xr(E))},value:r}})}else if(!K(t.type)&&xr(r)!==t.type)throw new Re(c(5002));if(t.allowEmpty===!1){let g=qt(r)&&(r===0||Number.isNaN(r)),E=ut(r)&&r.trim()==="";if(g||E)throw new Re(c(5003))}if(t.notLessThanZero&&qt(r)&&r<0)throw new Re(c(5006));if(!K(t.min)&&qt(r)&&r<t.min)throw new Re(c(5007));if(!K(t.max)&&qt(r)&&r>t.max)throw new Re(c(5008));if(ut(t.instanceOf)){if(!r||r._name!==t.instanceOf)throw new Re(c(5004))}else if(mt(t.instanceOf)&&!(r instanceof t.instanceOf))throw new Re(c(5004));if(Array.isArray(t.values)&&!t.values.includes(r))throw new Re(c(5005));let{properties:A}=t;Wn(A)&&$o(r)&&Object.keys(A).forEach(g=>{ag.call(this,{rule:A[g],value:r&&r[g],key:"".concat(g),fnName:n,className:a})});let{arrayItem:d}=t;Wn(d)&&pr(r)&&r.forEach((g,E)=>{ag.call(this,{rule:d,value:g,key:"".concat(i,"[").concat(E,"]"),fnName:n,className:a})}),mt(t.validate)&&t.validate.call(this,r,i,n,a,this)}function vt(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{getRemoteId:t=()=>"",replaceArg:r,getKVReportKey:i}=e;return St((n,a)=>function(){for(var c=arguments.length,A=new Array(c),d=0;d<c;d++)A[d]=arguments[d];function g(b,w,k){if(k&&k.includes(b))return"hided";if(r){let x=r(...A);if(A[x.argIndex]===w)return x.value}if(w===A||b in A)return w;try{return w instanceof HTMLElement?"id: ".concat(w.id," type:").concat(xr(w)):(JSON.stringify(w),w)}catch{return"type:".concat(xr(w))}}let E=this._log||ae;A.length>0?E.info("".concat(a,"() ").concat(JSON.stringify(A,(b,w)=>g(b,w,["userSig","privateMapKey"])))):E.info("".concat(a,"()"));let f=i?i(...A):j0[a];try{let b=n.apply(this,A),w=He();return p_(b)?b.then(k=>(E.info("".concat(a,"() success ").concat(t.call(this,...A))),ve.addSuccessEvent({key:f,cost:He()-w}),k)).catch(k=>{throw k=Re.convertFrom.call(this,k,a,A.length===1?A[0]:A),E.error("".concat(a,"() failed ").concat(t.call(this,...A)," ").concat(k," params: ").concat(JSON.stringify(A,g))),ve.addFailedEvent({key:f,error:k}),k}):(ve.addSuccessEvent({key:f}),b)}catch(b){throw b=Re.convertFrom.call(this,b,a),E.error("".concat(a,"() failed ").concat(b," params: ").concat(JSON.stringify(A,g))),ve.addFailedEvent({key:f,error:b}),b}})}var Z_=e=>St((t,r)=>function(i,n){return N(this,null,function*(){let a=this._plugins.get(i);if(!a)throw this._log.error("plugin ".concat(String(i)," is not found")),new Re({code:Be.OPERATION_ABORT,message:"plugin ".concat(String(i)," is not found"),fnName:r});return $_.call(this,a.getValidateRule(e),[n],r,"TRTC"),t.call(this,a,n)})}),eI=0,d1=class{constructor(e,t){T(this,"player"),T(this,"publisher"),T(this,"mixInput"),this.mixInput=new eR(t),e.url?(this.player=new Audio(e.url),this.player.crossOrigin="anonymous",this.publisher=new Audio(e.url),this.publisher.crossOrigin="anonymous",this.mixInput.replaceSource(this.publisher)):this.mixInput.replaceSource(e.track),this.mixInput.connect()}updateSettings(e){!this.player||(K(e.volume)||(this.volume=e.volume),K(e.loop)||(this.loop=e.loop),K(e.playbackRate)||(this.playbackRate=e.playbackRate))}updateListener(e){if(this.player){if(e.onDurationChange){let{onDurationChange:t}=e;this.player.ondurationchange=r=>{t(r.target.duration)}}if(e.onTimeUpdate){let t=e.onTimeUpdate,{player:r}=this;r.ontimeupdate=()=>{t(r.currentTime,r.duration)}}e.onEnded&&(this.player.onended=e.onEnded)}}reset(){this.seek(0),this.mixInput.connect()}seek(e){!this.player||e<0&&e>this.player.duration||(this.player.currentTime=e,this.publisher.currentTime=e)}play(){var e,t;return(e=this.publisher)==null||e.play(),(t=this.player)==null?void 0:t.play()}pause(){var e,t;(e=this.player)==null||e.pause(),(t=this.publisher)==null||t.pause()}stop(){var e;(e=this.player)==null||e.pause(),this.mixInput.disconnect()}setOperation(e){e==="pause"&&this.pause(),e==="resume"&&(this.pause(),this.play()),e==="stop"&&(this.pause(),this.seek(0))}set volume(e){!this.player||!this.publisher||(this.player.volume=e,this.publisher.volume=e)}set loop(e){!this.player||!this.publisher||(this.player.loop=e,this.publisher.loop=e)}set playbackRate(e){!this.player||!this.publisher||(this.player.playbackRate=e,this.publisher.playbackRate=e)}};function el(e,t){if(t&&typeof t!="function")throw new Re({code:Be.INVALID_PARAMETER,message:"start audioMixer plugin: param ".concat(e," should be a function.")})}var lu=class{constructor(e){this.core=e,T(this,"log"),T(this,"mixedMusicMap",new Map),T(this,"cacheMusicMap",new Map),eI+=1,this.log=e.log.createChild({id:"".concat(this.getAlias()).concat(eI)}),this.log.info("[audioMixer] created id=".concat(this.getAlias()).concat(eI)),this.core=e}getName(){return lu.Name}getAlias(){return"ax"}getGroup(e){return e==null?void 0:e.id}getValidateRule(e){switch(e){case"start":return lu.startValidateRule;case"update":return lu.updateValidateRule;case"stop":return lu.stopValidateRule}}start(e){return N(this,null,function*(){let{room:t}=this.core;this.log.info("add music source, id: ".concat(e.id," url: ").concat(e.url,", track: ").concat(e.track));let{id:r,url:i}=e;if(this.mixedMusicMap.has(r))return;let n=this.cacheMusicMap.get(r);n?e.url?n.reset():(n.mixInput.replaceSource(e.track),n.mixInput.connect()):(n=new d1(e,t.audioManager),this.cacheMusicMap.set(r,n)),n.updateListener(e),n.updateSettings(e),yield n.play(),this.mixedMusicMap.set(r,n),this.log.info("start mix audio track ".concat(r," success.")),ve.addEnum({key:502700,value:3}),this.kvUpload(e)})}update(e){return N(this,null,function*(){let{id:t,operation:r,seekFrom:i,playbackRate:n}=e;this.log.info("update music source, ".concat(JSON.stringify(e)));let a=this.mixedMusicMap.get(t);a?(a.updateSettings(e),a.updateListener(e),K(r)||a.setOperation(r),K(i)||a.seek(i),this.kvUpload(e)):this.log.warn("update music source failed, music id: ".concat(t," not found."))})}stop(e){return N(this,arguments,function(t){var r=this;let{id:i}=t;return function*(){var n;r.mixedMusicMap.has(i)&&(r.log.info("remove music source, music id: ".concat(i)),(n=r.mixedMusicMap.get(i))==null||n.stop(),r.mixedMusicMap.delete(i)),i==="*"&&r.destroyAllMusic()}()})}kvUpload(e){let{track:t,loop:r,volume:i,playbackRate:n,operation:a,seekFrom:c,onTimeUpdate:A,onDurationChange:d,onEnded:g}=e;t&&ve.addCount({key:502711}),r&&ve.addCount({key:502703}),i&&ve.addCount({key:502704}),n&&ve.addCount({key:502705}),a&&ve.addCount({key:502706}),c&&ve.addCount({key:502707}),typeof A!="function"&&ve.addCount({key:502709}),typeof g!="function"&&ve.addCount({key:502710}),typeof d!="function"&&ve.addCount({key:502708})}destroyAllMusic(){this.log.info("destroy all music source."),this.mixedMusicMap.forEach((e,t)=>this.stop({id:t}))}destroyAllCache(){this.log.info("destroy all music cache."),this.cacheMusicMap.clear()}destroy(){this.log.info("destroy audio mixer plugin."),this.destroyAllMusic(),this.destroyAllCache()}},du=lu;T(du,"startValidateRule",{name:"options",required:!0,type:"object",properties:{id:{type:"string",required:!0},url:{type:"string",required:!1},track:{required:!1},loop:{type:"boolean"},volume:{type:"number"}},validate(e,t,r){if(e.url&&e.url!=="*"){let i=e.url.split("?")[0],n=["mp3","ogg","wav","flac"],a=i.split(".").pop(),c=n.indexOf(a)>=0,A=i.startsWith("blob"),d=i.startsWith("data");if(!(c||A||d))throw new Re({code:Be.INVALID_PARAMETER,message:"start audioMixer plugin: music url is invalid, please check your file format.",fnName:r})}if(!e.url&&!e.track)throw new Re({code:Be.INVALID_PARAMETER,message:"start audioMixer plugin: param url or track is required.",fnName:r});el("onTimeUpdate",e.onTimeUpdate),el("onEnded",e.onEnded),el("onDurationChange",e.onDurationChange)}}),T(du,"updateValidateRule",{name:"options",required:!0,type:"object",properties:{id:{type:"string",required:!0},loop:{type:"boolean"},volume:{type:"number"},seekFrom:{type:"number"},operation:{type:"string",values:["pause","resume","stop"]}},validate(e,t,r){el("onTimeUpdate",e.onTimeUpdate),el("onEnded",e.onEnded),el("onDurationChange",e.onDurationChange)}}),T(du,"stopValidateRule",{name:"options",type:"object",required:!0,properties:{id:{type:"string",required:!0}}}),T(du,"Name","AudioMixer");var u1=e=>(e=Number(e))>0&&e<14e8,tI=0,uu=class{constructor(e){this.core=e,T(this,"log"),T(this,"preloadPromise"),T(this,"audioContext",rs()),T(this,"workletNode"),tI+=1,this.log=e.log.createChild({id:"".concat(this.getAlias()).concat(tI)}),this.log.info("[audioDenoiser] created id=".concat(this.getAlias()).concat(tI)),e.assetsPath&&this.preload("".concat(e.assetsPath,"/denoiser-wasm.js"))}static startValidateRule(e){return{name:"options",required:!0,type:"object",properties:{sdkAppId:{type:"number",required:!0},userId:{type:"string",required:!0},userSig:{type:"string",required:!0}},validate(t,r,i,n){if(!e.room.audioManager.hasAudioTrack)throw new Re({code:Be.INVALID_OPERATION,extraCode:5106,fnName:i})}}}preload(e){return this.preloadPromise||(this.preloadPromise=this.doPreload(e)),this.preloadPromise}doPreload(e){return N(this,null,function*(){let t=yield this.core.fileDownloader.download(e,{type:"blob"}),r=URL.createObjectURL(t);try{yield j_(this.audioContext,r)}finally{URL.revokeObjectURL(r)}})}getName(){return uu.Name}getAlias(){return"ad"}getGroup(){return"AIDenoiser_".concat(Date.now())}getValidateRule(e){switch(e){case"start":return uu.startValidateRule(this.core);case"update":return uu.updateValidateRule;case"stop":return uu.stopValidateRule}}start(e){return N(this,null,function*(){let{room:t}=this.core;if(yield this.preload("".concat(e.assetsPath,"/denoiser-wasm.js")),!this.workletNode){let r=String(Date.now()).slice(0,-3),{auth:i,sign:n,status:a,message:c}=yield function(A){return N(this,arguments,function(d){let{sdkAppId:g,userId:E,userSig:f,timestamp:b}=d;return function*(){let w="https://".concat(function(Ze){let qe;return qe=u1(Ze)?bR.MAIN_OVERSEA:bR.MAIN,qe}(g),"/api/v1/audioAiAuth?sdkAppId=").concat(g,"&userId=").concat(E,"&userSig=").concat(f,"&timestamp=").concat(b),k=yield fetch(w),{data:{errCode:x,errMsg:Y,sign:G,status:F}}=yield k.json();if(F==="1")return{auth:!0,sign:G,status:F,message:Y};let me="Init RTCAIDenoiser failed.",Te="";switch(x){case 1:Te="Please check your params.";break;case 2:Te="You need to buy packages. Refer to: https://cloud.tencent.com/document/product/647/44247";break;case 3:Te="Server is invalid. Please contact our engineer. ";break;case 4:Te="Your packages is not active. Refer to: https://cloud.tencent.com/document/product/647/44247";break;case 5:Te="Your packages is expired. Refer to: https://cloud.tencent.com/document/product/647/44247";break;case 6:Te="Your version is not supported."}return{auth:!1,status:F,message:Y?"".concat(me," Reason: ").concat(Y,". ").concat(Te):"".concat(me,", ").concat(Te)}}()})}(Ke(_e({},e),{timestamp:r}));if(!i)throw this.log.info("RTCAIDenoiser: ".concat(e.userId," auth result: ").concat(i,". Message: ").concat(c)),new Re({code:Be.INVALID_PARAMETER,message:c});this.workletNode=new AudioWorkletNode(this.audioContext,"trtc-denoiser-processor",{numberOfInputs:1,numberOfOutputs:1}),this.workletNode.port.postMessage({type:"init",data:{sdkAppId:String(e.sdkAppId),userId:e.userId,timestamp:r,sign:n,status:a}}),this.workletNode.port.onmessage=A=>{let{data:d}=A;d.type==="cost"&&this.log.debug("[RTCAIDenoiser] ".concat(d.value))}}this.workletNode.port.postMessage({type:"enable"}),t.audioManager.addDenoiser(this.workletNode),t.sendAbilityStatus({ai_denoise:1})})}update(){return N(this,null,function*(){})}stop(){return N(this,null,function*(){if(!this.workletNode)return;let{room:e}=this.core;this.workletNode.port.postMessage({type:"disable"}),yield e.audioManager.removeDenoiser(this.workletNode)})}destroy(){}},cg=uu;T(cg,"updateValidateRule",{type:"object"}),T(cg,"stopValidateRule",{type:"object"}),T(cg,"Name","AIDenoiser");var bR={MAIN:"schedule.cloud-rtc.com",MAIN_OVERSEA:"schedule.rtc.tencentcloud.com"},A1=lr(Lr(),1),h1=class extends A1.EventEmitter{constructor(){super(),this.state="nominal",this.onPressureChange=this.onPressureChange.bind(this)}get stateNum(){switch(this.state){case"nominal":return 1;case"fair":return 2;case"serious":return 3;case"critical":return 4}}start(){return N(this,null,function*(){if(!this.observer)try{"PressureObserver"in window&&!Qr&&(this.observer=new PressureObserver(this.onPressureChange),yield this.observer.observe("cpu",{sampleInterval:2e3}))}catch(e){ae.info("PressureDetector start error:",e)}})}onPressureChange(e){let t=this.stateNum,r=e[e.length-1];this.state=r.state,(this.stateNum>3||t>3)&&ae.info("".concat(r.source,": ").concat(r.state)),this.emit("state-changed",{type:r.source,state:this.state})}destroy(){var e;(e=this.observer)==null||e.disconnect(),this.observer=null}},wR=new h1,DR=0,lg=new Set,Er=null;wv("5.7.0");var g1={RtcError:Re,ErrorCode:Be,ErrorCodeDictionary:tg},dg=class extends AL.EventEmitter{constructor(e,t){super(),T(this,"_room"),T(this,"_eventListened",new Set),T(this,"_localVideoTrack",null),T(this,"_localAudioTrack",null),T(this,"_localScreenTrack",null),T(this,"_localScreenAudioTrack",null),T(this,"_localVideoConfig",null),T(this,"_localScreenConfig",null),T(this,"_localAudioConfig",null),T(this,"_remoteVideoConfigMap",new Map),T(this,"_remoteAudioConfigMap",new Map),T(this,"_remoteAudioMuteMap",new Map),T(this,"_mediaTrackMap",new WeakMap),T(this,"_log",ae.createLogger({id:"t".concat(++DR)})),T(this,"_plugins",new Map),T(this,"_networkQuality",null),T(this,"_speakerId"),this._room=new e(_e({logger:this._log,frameWorkType:dg.frameWorkType},t)),this._log.debug(JSON.stringify(t)),Object.defineProperties(this,{dumpAudio:{enumerable:!1,value(r){return this._room.audioManager.dump(r)}}}),t.plugins&&t.plugins.forEach(r=>{this._use(r,t.assetsPath)}),this._use(du,t.assetsPath),this._use(cg,t.assetsPath),this._room.on("audio-volume",r=>{!r.find(i=>i.userId==="")&&this._localAudioTrack&&r.push({userId:"",volume:Math.floor(100*this._localAudioTrack.getAudioLevel())}),this.emit(Qe.AUDIO_VOLUME,{result:r.sort((i,n)=>n.volume-i.volume)})}),this._room.videoManager.on("error",r=>{let{reason:i,error:n}=r;this._log.error(new Re({code:Be.OPERATION_FAILED,extraCode:5504,messageParams:{reason:i,error:n}}))}),this._listenEvents(),this._initActiveSpeaker(),((r,i)=>{let{emit:n}=r;r.emit=function(){for(var a=arguments.length,c=new Array(a),A=0;A<a;A++)c[A]=arguments[A];try{return n.apply(r,c)}catch(d){let g=Ve({key:xe.CATCH_HANDLER_ERROR,data:{name:i,event:c[0]},addDocLink:!1});return ae.warn("".concat(g,`

`).concat(d.stack)),!1}}})(this,"trtc")}static create(e){}static _create(e,t){var r;ER&&(ER=!1,ae.getLogLevel()!==5&&(console.info("******************************************************************************"),console.info("*   TRTC Web SDK"),console.info("*   API Document: ".concat(na,"/en/index.html")),console.info("*   Changelog: ".concat(na,"/en/tutorial-01-info-changelog.html")),console.info("*   Report issues: https://github.com/LiteAVSDK/TRTC_Web/issues"),console.info("******************************************************************************")),ae.info("TRTC Web SDK Version:",ln),ae.info("UA:",navigator.userAgent),ae.info("URL: ".concat(location.href).concat(((r=self.frameElement)==null?void 0:r.tagName)==="IFRAME"?" in iframe":"")),d_().then(n=>{n&&ae.info(Yn)}));let i=new dg(e,t||{});return lg.add(i),wR.start(),i}_listenEvents(){Fi(this,this._room).add("peer-join",e=>{let{userId:t}=e;this.emit(Qe.REMOTE_USER_ENTER,{userId:t})}).add("peer-leave",e=>{this.emit(Qe.REMOTE_USER_EXIT,{userId:e})}).add("banned",e=>{this._exitRoom().then(()=>{this.emit(Qe.KICKED_OUT,{reason:e.reason})})}).add("error",e=>{this._exitRoom().then(()=>{this.emit(Qe.ERROR,Re.convertFrom(e))})}).add("signal-connection-state-changed",e=>{this.emit(Qe.CONNECTION_STATE_CHANGED,e)}).add("network-quality",e=>{this._networkQuality=e,this.emit(Qe.NETWORK_QUALITY,e)}).add("remote-published",e=>{[e.remoteAudioTrack,e.remoteVideoTrack,e.remoteAuxiliaryTrack].forEach(t=>{Fi(t,t).add("player-state-changed",r=>{let i=Ke(_e({},r),{userId:e.userId});t.kind===O.VIDEO&&(i.streamType=og(t.streamType)),this.emit(t.kind===O.AUDIO?Qe.AUDIO_PLAY_STATE_CHANGED:Qe.VIDEO_PLAY_STATE_CHANGED,i)}).add("error",r=>{r.getCode()===se.PLAY_NOT_ALLOWED&&this.emit(Qe.AUTOPLAY_FAILED,{userId:t.userId})})})}).add("remote-unpublished",e=>{[e.remoteAudioTrack,e.remoteVideoTrack,e.remoteAuxiliaryTrack].forEach(t=>{br(t)})}).add("remote-publish-state-changed",e=>{let{prevMuteState:t,muteState:r}=e,{userId:i}=r,n=t.audioAvailable,a=t.videoAvailable,{audioAvailable:c,videoAvailable:A}=r;c||this._remoteAudioConfigMap.delete(i),A||this._remoteVideoConfigMap.delete("".concat(i,"_","main")),r.hasAuxiliary||this._remoteVideoConfigMap.delete("".concat(i,"_","sub")),n!==c&&(this.emit(c?Qe.REMOTE_AUDIO_AVAILABLE:Qe.REMOTE_AUDIO_UNAVAILABLE,{userId:i}),c?this._onAudioAvailable({userId:i}):this._onAudioUnavailable({userId:i,muteState:r})),a!==A&&(this.emit(A?Qe.REMOTE_VIDEO_AVAILABLE:Qe.REMOTE_VIDEO_UNAVAILABLE,{userId:i,streamType:"main"}),A?this._onVideoAvailable({userId:i,streamType:"main"}):this._onVideoUnavailable({userId:i,streamType:"main"})),t.hasAuxiliary!==r.hasAuxiliary&&(this.emit(r.hasAuxiliary?Qe.REMOTE_VIDEO_AVAILABLE:Qe.REMOTE_VIDEO_UNAVAILABLE,{userId:i,streamType:"sub"}),r.hasAuxiliary?this._onVideoAvailable({userId:i,streamType:"sub"}):this._onVideoUnavailable({userId:i,streamType:"sub"}))}).add("firewall-restriction",()=>{this.emit(Qe.ERROR,new Re({code:Be.OPERATION_FAILED,extraCode:5501}))}).add("sei-message",e=>{this.emit(Qe.SEI_MESSAGE,Ke(_e({},e),{streamType:og(e.streamType)}))}).add("heartbeat-report",e=>{var t,r,i,n,a,c,A;let d={2:"big",3:"small",7:"sub"},g={rtt:e.msg_up_stream_info.msg_network_status.uint32_rtt||((t=e.msg_down_stream_info[0])==null?void 0:t.msg_network_status.uint32_rtt)||((r=this._networkQuality)==null?void 0:r.uplinkRTT)||((i=this._networkQuality)==null?void 0:i.downlinkRTT)||0,upLoss:((n=this._networkQuality)==null?void 0:n.uplinkLoss)||0,downLoss:((a=this._networkQuality)==null?void 0:a.downlinkLoss)||0,bytesSent:e.bytes_sent||0,bytesReceived:e.bytes_received||0,localStatistics:{audio:{bitrate:(((c=e.msg_up_stream_info.msg_audio_status)==null?void 0:c.uint32_audio_codec_bitrate)||0)/1e3,audioLevel:(((A=e.msg_up_stream_info.msg_audio_status)==null?void 0:A.uint32_audio_level)||0)/Ko},video:e.msg_up_stream_info.msg_video_status.filter(E=>d[E.uint32_video_stream_type]).map(E=>({bitrate:(E.uint32_video_codec_bitrate||0)/1e3,width:E.uint32_video_width,height:E.uint32_video_height,frameRate:E.uint32_video_enc_fps,videoType:d[E.uint32_video_stream_type]}))},remoteStatistics:e.msg_down_stream_info.map(E=>({userId:E.msg_user_info.str_identifier,audio:{bitrate:(E.msg_audio_status.uint32_audio_codec_bitrate||0)/1e3,audioLevel:(E.msg_audio_status.uint32_audio_level||0)/Ko},video:E.msg_video_status.map(f=>({bitrate:(f.uint32_video_codec_bitrate||0)/1e3,width:f.uint32_video_width,height:f.uint32_video_height,frameRate:f.uint32_video_dec_fps,videoType:d[f.uint32_video_stream_type]}))}))};this.emit(Qe.STATISTICS,g)}).add("custom-message",e=>{this.emit(Qe.CUSTOM_MESSAGE,e)}),Fi(this,fr).add("audioInputAdded",e=>{this.emit(Qe.DEVICE_CHANGED,{type:"microphone",action:"add",device:e})}).add("audioInputRemoved",e=>{this.emit(Qe.DEVICE_CHANGED,{type:"microphone",action:"remove",device:e})}).add("videoInputAdded",e=>{this.emit(Qe.DEVICE_CHANGED,{type:"camera",action:"add",device:e})}).add("videoInputRemoved",e=>{this.emit(Qe.DEVICE_CHANGED,{type:"camera",action:"remove",device:e})}).add("audioOutputAdded",e=>N(this,null,function*(){if(this.emit(Qe.DEVICE_CHANGED,{type:"speaker",action:"add",device:e}),Er&&Er.deviceId===Sh){let t=(yield Jc()).find(r=>r.deviceId===Sh);t&&Er.groupId!==t.groupId&&(Er=t,this.emit(Qe.DEVICE_CHANGED,{type:"speaker",action:"active",device:t}))}})).add("audioOutputRemoved",e=>N(this,null,function*(){this.emit(Qe.DEVICE_CHANGED,{type:"speaker",action:"remove",device:e});let t=(yield Jc())[0];t&&Er&&(Er.deviceId===e.deviceId||Er.deviceId===Sh&&Er.groupId!==t.groupId)&&(Er=t,this.emit(Qe.DEVICE_CHANGED,{type:"speaker",action:"active",device:t}))}))}use(e){let t,r;"plugin"in e?(t=e.plugin,r=e.assetsPath):t=e,this._use(t,r||"https://web.sdk.qcloud.com/trtc/webrtc/v5/assets/")}_use(e,t){if(this._plugins.get(e.Name))return void this._log.warn("duplicate install plugin",e.Name);let r=new e(function(i,n,a){return{room:i,assetsPath:a,fileDownloader:l1,innerEmitter:te,constants:bv,environment:Jv,utils:cn,eventLogger:Lt,log:i.getLogger(),errorModule:n,kvStatManager:ve,clearStarted(c,A){let d=c.getAlias(),g=cu.instances.get(i);if(g)if(A){let E=g.get(d+A);if(!E)return;E.started=!1}else g.forEach((E,f)=>{f.startsWith(d)&&(E.started=!1)})}}}(this._room,g1,t));this._plugins.set(e.Name,r)}enterRoom(e){return N(this,null,function*(){var t,r;let{scene:i="rtc",enableAutoPlayDialog:n=!0,autoReceiveAudio:a=!0,autoReceiveVideo:c=!1}=e;e.proxy&&(this._room.setProxyServer(e.proxy),!ut(e.proxy)&&e.proxy.turnServer&&((r=(t=this._room).setTurnServer)==null||r.call(t,e.proxy.turnServer,e.proxy.iceTransportPolicy))),this._room.enableAutoPlayDialog=n,this._room.autoReceiveAudio=a,this._room.autoReceiveVideo=c,ei(e.enableHWEncoder)&&(this._room.enableHWEncoder=e.enableHWEncoder);let A={sdkAppId:e.sdkAppId,userId:e.userId,userSig:e.userSig,privateMapKey:e.privateMapKey||null,latencyLevel:e.latencyLevel,role:e.role==="audience"?21:20,roomId:e.roomId||0,strRoomId:e.strRoomId||"",businessInfo:e.businessInfo||null,streamId:null,userDefineRecordId:e.userDefineRecordId||null,frameWorkType:e.frameWorkType,component:e.component,language:e.language};e.strRoomId&&!e.roomId?this._room.useStringRoomId=!0:this._room.useStringRoomId=!1,yield this._room.join(A,i,dg.frameWorkType),this._checkTrackToPublish()})}exitRoom(){return N(this,null,function*(){return yield this._exitRoom()})}switchRole(e,t){return N(this,null,function*(){t!=null&&t.privateMapKey&&(this._room.privateMapKey=t.privateMapKey),t!=null&&t.latencyLevel&&(this._room.latencyLevel=t.latencyLevel),yield this._room.switchRole(e),e==="anchor"&&this._checkTrackToPublish()})}destroy(){br(this),this.removeAllListeners(),this._room.destroy(),lg.delete(this),lg.size===0&&wR.destroy(),this._localAudioTrack&&this.stopLocalAudio(),this._localVideoTrack&&this.stopLocalVideo(),this._localScreenTrack&&this.stopScreenShare(),this._plugins.forEach(e=>{var t;return(t=e.destroy)==null?void 0:t.call(e)})}startLocalAudio(){return N(this,arguments,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{publish:!0};return function*(){if(e._localAudioTrack)return void e._log.warn("local audio is already started");let{publish:r=!0,mute:i,option:n}=t,a=new qn(e._room.audioManager),c={},A={muted:!0};n&&(K(n.microphoneId)?K(n.audioTrack)||(c.customSource=n.audioTrack):c.deviceId=n.microphoneId,n&&qt(n.captureVolume)&&a.setCaptureVolume(n.captureVolume),K(n.profile)||(ut(n.profile)?NE[n.profile]&&a.setProfile(NE[n.profile]):a.setProfile(n.profile)),qt(n.earMonitorVolume)&&(A.muted=!(n.earMonitorVolume>0),A.volume=n.earMonitorVolume),K(n.echoCancellation)||(a.profile.echoCancellation=n.echoCancellation),K(n.noiseSuppression)||(a.profile.noiseSuppression=n.noiseSuppression),K(n.autoGainControl)||(a.profile.autoGainControl=n.autoGainControl)),a.on("5",d=>{e.emit(Qe.ERROR,new Re({code:Be.DEVICE_ERROR,extraCode:5309,messageParams:{error:d}}))}),a.on("2",d=>{e.emit(Qe.DEVICE_CHANGED,{type:"microphone",action:"active",device:d})}),a.on("4",d=>{let g;d.error&&(g=Re.convertFrom(d.error)),e.emit(Qe.PUBLISH_STATE_CHANGED,Ke(_e({},d),{error:g}))}),e._listenOutputTrackChanged(a),e._speakerId&&a.setAudioOutput(e._speakerId),yield a.capture(c),K(i)||a.setMute(i),Fi(a,a).add("player-state-changed",d=>{e.emit(Qe.AUDIO_PLAY_STATE_CHANGED,Ke(_e({},d),{userId:""}))}),r&&e._room.isJoined&&e._room.publish(a).catch(()=>{}),e._localAudioTrack=a,e._localAudioConfig=Ke(_e({},t),{publish:r}),yield e._updateAudioPlayOption({playOption:A,track:a})}()})}updateLocalAudio(e){return N(this,null,function*(){if(!this._localAudioTrack||!this._localAudioConfig)return;let{publish:t,mute:r,option:i}=e,n={};i&&(i.microphoneId?yield this._localAudioTrack.switchDevice(i.microphoneId):K(i.audioTrack)||(yield this._localAudioTrack.setInputMediaStreamTrack(i.audioTrack)),K(i.captureVolume)||this._localAudioTrack.setCaptureVolume(i.captureVolume),K(i.earMonitorVolume)||(n.muted=!(i.earMonitorVolume>0),n.volume=i.earMonitorVolume),yield this._localAudioTrack.update3A(i)),this._room.isJoined&&!K(t)&&(t&&!this._localAudioConfig.publish&&this._room.publish(this._localAudioTrack).catch(()=>{}),this._localAudioConfig.publish&&!t&&this._room.unpublish(this._localAudioTrack).catch(()=>{})),K(r)||this._localAudioTrack.setMute(r),yield this._updateAudioPlayOption({playOption:n,track:this._localAudioTrack,prevConfig:this._localAudioConfig}),ha(this._localAudioConfig,e)})}stopLocalAudio(){return N(this,null,function*(){!this._localAudioTrack||(this._room.isJoined&&(yield this._room.unpublish(this._localAudioTrack).catch(()=>{})),this._localAudioTrack.stop(),this._localAudioTrack.close(),this._room.audioManager.removeInput(this._localAudioTrack),br(this._localAudioTrack),this._localAudioTrack=null,this._localAudioConfig=null)})}startLocalVideo(){return N(this,arguments,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{publish:!0,view:null};return function*(){if(e._localVideoTrack)return void e._log.warn("local video is already started");let{view:r,publish:i=!0,mute:n,option:a}=t,c=new ti(e._room.videoManager),A={},d={};if(a&&(a.cameraId?A.deviceId=a.cameraId:K(a.useFrontCamera)?K(a.videoTrack)||(A.customSource=a.videoTrack):A.facingMode=a.useFrontCamera?O.FACING_MODE_USER:O.FACING_MODE_ENVIRONMENT,K(a.profile)||(ut(a.profile)?dn[a.profile]&&c.setProfile(dn[a.profile]):c.setProfile(a.profile)),K(a.fillMode)||(d.objectFit=a.fillMode),K(a.mirror)||(d.mirror=a.mirror),K(a.small)||(Yh()?ut(a.small)?c.small=dn[a.small]:a.small===!0?c.small=dn["120p"]:c.small=a.small:e._log.warn("small stream is not supported"))),c.on("5",g=>{e.emit(Qe.ERROR,new Re({code:Be.DEVICE_ERROR,extraCode:5308,messageParams:{error:g}}))}),c.on("2",g=>{e.emit(Qe.DEVICE_CHANGED,{type:"camera",action:"active",device:g})}),c.on("4",g=>{let E;g.error&&(E=Re.convertFrom(g.error)),e.emit(Qe.PUBLISH_STATE_CHANGED,Ke(_e({},g),{error:E}))}),e._listenOutputTrackChanged(c),yield c.capture(A),K(n)||(yield c.setMute(n)),c.mediaTrack)if(a!=null&&a.qosPreference){let g=Zc(a.qosPreference);c.mediaTrack.contentHint=g}else a!=null&&a.videoTrack||(c.mediaTrack.contentHint=Zc(Zn.QOS_PREFERENCE_SMOOTH));Fi(c,c).add("player-state-changed",g=>{e.emit(Qe.VIDEO_PLAY_STATE_CHANGED,Ke(_e({},g),{userId:"",streamType:"main"}))}),i&&e._room.isJoined&&e._room.publish(c).catch(()=>{}),e._localVideoTrack=c,e._localVideoConfig=Ke(_e({},t),{view:r,publish:i}),yield e._updateVideoPlayOption({view:r,playOption:d,track:c})}()})}updateLocalVideo(e){return N(this,null,function*(){if(!this._localVideoTrack||!this._localVideoConfig)return;let{view:t,publish:r,mute:i,option:n}=e,a={};if(n){if(K(n.profile)||(ut(n.profile)?dn[n.profile]&&this._localVideoTrack.setProfile(dn[n.profile]):this._localVideoTrack.setProfile(n.profile),(!n.cameraId||!this._localVideoTrack.isNeedToSwitchDevice(n.cameraId))&&K(n.useFrontCamera)&&this._localVideoTrack.applyProfile()),n.cameraId?yield this._localVideoTrack.switchDevice(n.cameraId):K(n.useFrontCamera)?K(n.videoTrack)||(yield this._localVideoTrack.setInputMediaStreamTrack(n.videoTrack)):yield this._localVideoTrack.switchDevice(n.useFrontCamera?O.FACING_MODE_USER:O.FACING_MODE_ENVIRONMENT),K(n.fillMode)||(a.objectFit=n.fillMode),K(n.mirror)||(a.mirror=n.mirror),n.qosPreference&&this._localVideoTrack.mediaTrack){let c=Zc(n.qosPreference);this._localVideoTrack.mediaTrack.contentHint=c}if(n.small){let c=!this._localVideoTrack.small;Yh()?(n.small===!0?this._localVideoTrack.small=dn["120p"]:ut(n.small)?this._localVideoTrack.small=dn[n.small]:this._localVideoTrack.small=n.small,this._room.videoManager.update(),c&&this._room.enableSmall(!0)):this._log.warn("small stream is not supported")}else n.small===!1&&this._localVideoTrack.small&&(delete this._localVideoTrack.small,this._room.videoManager.update(),this._room.enableSmall(!1))}this._room.isJoined&&!K(r)&&(r&&!this._localVideoConfig.publish&&this._room.publish(this._localVideoTrack).catch(()=>{}),this._localVideoConfig.publish&&!r&&this._room.unpublish(this._localVideoTrack).catch(()=>{})),K(i)||(yield this._localVideoTrack.setMute(i)),yield this._updateVideoPlayOption({view:t,playOption:a,track:this._localVideoTrack,prevConfig:this._localVideoConfig}),ha(this._localVideoConfig,e)})}stopLocalVideo(){return N(this,null,function*(){!this._localVideoTrack||(this._room.isJoined&&(yield this._room.unpublish(this._localVideoTrack).catch(()=>{})),this._localVideoTrack.stop(),this._localVideoTrack.close(),br(this._localVideoTrack),this._localVideoTrack=null,this._localVideoConfig=null)})}startScreenShare(){return N(this,arguments,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{publish:!0,view:null};return function*(){if(e._localScreenTrack)return void e._log.warn("screen share is already started");let{view:r=null,publish:i=!0,option:n}=t,a=new Ia(e._room.videoManager);a.on("4",E=>{let f;E.error&&(f=Re.convertFrom(E.error)),e.emit(Qe.PUBLISH_STATE_CHANGED,Ke(_e({},E),{error:f}))}),e._listenOutputTrackChanged(a);let c=null,A={},d={};n&&(K(n.profile)||(ut(n.profile)?PE[n.profile]&&a.setProfile(PE[n.profile]):a.setProfile(n.profile)),n.systemAudio&&(A.systemAudio=!0,A.echoCancellation=n.echoCancellation,A.noiseSuppression=n.noiseSuppression,A.autoGainControl=n.autoGainControl),K(n.fillMode)||(d.objectFit=n.fillMode),n.videoTrack&&(A.videoTrack=n.videoTrack),n.audioTrack&&(A.audioTrack=n.audioTrack),n.captureElement&&(A.captureElement=n.captureElement),n.preferDisplaySurface&&(A.preferDisplaySurface=n.preferDisplaySurface));let g=yield a.capture(A);if(n!=null&&n.qosPreference){let E=Zc(n.qosPreference);a.mediaTrack.contentHint=E}else n!=null&&n.videoTrack||(a.mediaTrack.contentHint=Zc(Zn.QOS_PREFERENCE_CLEAR));if(a.mediaTrack.addEventListener(O.ENDED,()=>{e._stopScreenShare(),e.emit(Qe.SCREEN_SHARE_STOPPED)}),g.getAudioTracks()[0]&&(c=new ru(e._room.audioManager),c.setInputMediaStreamTrack(g.getAudioTracks()[0]),e._speakerId&&c.setAudioOutput(e._speakerId)),Fi(a,a).add("player-state-changed",E=>{e.emit(Qe.VIDEO_PLAY_STATE_CHANGED,Ke(_e({},E),{userId:"",streamType:"sub"}))}),i&&e._room.isJoined){let E=[a];c&&E.push(c),e._room.publish(...E).catch(()=>{})}e._localScreenTrack=a,e._localScreenAudioTrack=c,e._localScreenConfig=Ke(_e({},t),{view:r,publish:i}),yield e._updateVideoPlayOption({view:r,playOption:d,track:a})}()})}updateScreenShare(e){return N(this,null,function*(){if(!this._localScreenTrack||!this._localScreenConfig)return;let{view:t,publish:r,option:i}=e,n={};if(i&&(K(i.fillMode)||(n.objectFit=i.fillMode),i.qosPreference)){let a=Zc(i.qosPreference);this._localScreenTrack.mediaTrack.contentHint=a}this._room.isJoined&&!K(r)&&(r&&!this._localScreenConfig.publish&&(this._room.publish(this._localScreenTrack).catch(()=>{}),this._localScreenAudioTrack&&this._room.publish(this._localScreenAudioTrack).catch(()=>{})),this._localScreenConfig.publish&&!r&&(this._room.unpublish(this._localScreenTrack).catch(()=>{}),this._localScreenAudioTrack&&this._room.unpublish(this._localScreenAudioTrack).catch(()=>{}))),yield this._updateVideoPlayOption({view:t,playOption:n,track:this._localScreenTrack,prevConfig:this._localScreenConfig}),ha(this._localScreenConfig,e)})}stopScreenShare(){return N(this,null,function*(){return yield this._stopScreenShare()})}startRemoteVideo(e){return N(this,null,function*(){let{view:t,userId:r,streamType:i,option:n}=e,a="".concat(r,"_").concat(i);if(this._remoteVideoConfigMap.has(a))return void this._log.warn("remote video has already started. userId:".concat(r,", streamType:").concat(i));let c=this._room.remotePublishedUserMap.get(r);if(!c)return;let A={},d=i==="main"?c.remoteVideoTrack:c.remoteAuxiliaryTrack;this._listenOutputTrackChanged(d),n&&(K(n.fillMode)||(A.objectFit=n.fillMode),K(n.mirror)||(A.mirror=n.mirror),i==="main"&&!K(n.small)&&(c.remoteVideoTrack.setMediaType(n.small?8:4),this._room.changeType(n.small,d.user))),yield this._room.subscribe(d),yield this._updateVideoPlayOption({view:t,playOption:A,track:d}),this._emitTrackEvent(d),this._remoteVideoConfigMap.set(a,{config:e}),n&&!K(n.receiveWhenViewVisible)&&this._observeView({remoteTrack:d,view:t,receiveWhenViewVisible:n.receiveWhenViewVisible,viewRoot:n==null?void 0:n.viewRoot})})}updateRemoteVideo(e){return N(this,null,function*(){var t,r;let{view:i,userId:n,streamType:a,option:c}=e,A="".concat(n,"_").concat(a),d=this._remoteVideoConfigMap.get(A);if(!d||!this._room.remotePublishedUserMap.has(n))return;let g={};c&&(K(c.fillMode)||(g.objectFit=c.fillMode),K(c.mirror)||(g.mirror=c.mirror));let E=null,f=this._room.remotePublishedUserMap.get(n);if(a==="main"&&(f!=null&&f.muteState.hasVideo)&&(E=f.remoteVideoTrack),a==="sub"&&(f!=null&&f.muteState.hasAuxiliary)&&(E=f.remoteAuxiliaryTrack),!E)return;let{config:b}=d;a==="main"&&c&&!K(c.small)&&this._room.changeType(c.small,E.user),yield this._updateVideoPlayOption({view:i,playOption:g,track:E,prevConfig:b}),ha(b,e);let w=K(c==null?void 0:c.receiveWhenViewVisible)?(t=b.option)==null?void 0:t.receiveWhenViewVisible:c.receiveWhenViewVisible,k=K(i)?b.view:i,x=K(c==null?void 0:c.viewRoot)?(r=b.option)==null?void 0:r.viewRoot:c.viewRoot;this._observeView({remoteTrack:E,view:k,receiveWhenViewVisible:w,viewRoot:x})})}stopRemoteVideo(e){return N(this,null,function*(){return this._stopRemoteVideo(e)})}_stopRemoteVideo(e){let t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return N(this,null,function*(){let r=[],i=this._room.remotePublishedUserMap.get(e.userId);if(i){let{muteState:a,remoteVideoTrack:c,remoteAuxiliaryTrack:A}=i;e.streamType==="main"&&(c.stop(),a.hasVideo&&r.push(c)),e.streamType==="sub"&&(A.stop(),a.hasAuxiliary&&r.push(A))}for(let a of r)t&&(yield this._room.unsubscribe(a),this._mediaTrackMap.get(a.outMediaTrack)===a.userId&&this._mediaTrackMap.delete(a.outMediaTrack));let n=this._remoteVideoConfigMap.get("".concat(e.userId,"_").concat(e.streamType));n&&n.observer&&n.observer.disconnect(),this._remoteVideoConfigMap.delete("".concat(e.userId,"_").concat(e.streamType))})}muteRemoteAudio(e,t){return N(this,null,function*(){if(e==="*")if(t)yield this._stopRemoteAudio({userId:e});else{let r=[...this._room.remotePublishedUserMap.values()];for(let i of r)i.muteState.hasAudio&&!this._remoteAudioConfigMap.has(i.userId)&&(yield this._startRemoteAudio({userId:i.userId}))}else t?yield this._stopRemoteAudio({userId:e}):this._remoteAudioConfigMap.has(e)||(yield this._startRemoteAudio({userId:e}));this._remoteAudioMuteMap.set(e,t)})}setRemoteAudioVolume(e,t){if(e==="*"){let r=[...this._room.remotePublishedUserMap.values()];for(let i of r)this._updateAudioPlayOption({playOption:{volume:t},track:i.remoteAudioTrack})}else if(e){let r=this._room.remotePublishedUserMap.get(e);r&&this._updateAudioPlayOption({playOption:{volume:t},track:r.remoteAudioTrack})}}startPlugin(e,t){return N(this,null,function*(){return e.start(t)})}updatePlugin(e,t){return N(this,null,function*(){return e.update(t)})}stopPlugin(e,t){return N(this,null,function*(){return e.stop(t)})}enableAudioVolumeEvaluation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:2e3,t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this._room.enableAudioVolumeEvaluation(e,t)}on(e,t,r){return this.listeners(e).includes(t)||(this._log.debug("on",e),super.on(e,t,r),this._eventListened.add(e)),this}off(e,t,r){return this._log.debug("off",e),e==="*"?(this._eventListened.clear(),this.removeAllListeners()):super.off(e,t,r),this}getAudioTrack(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{userId:"",streamType:"main"};var t,r;let i,n="main";if(ut(e)?i=e:(i=e.userId,e.streamType&&(n=e.streamType)),!i)return n==="sub"?((t=this._localScreenAudioTrack)==null?void 0:t.mediaTrack)||null:((r=this._localAudioTrack)==null?void 0:r.mediaTrack)||null;{let a=this._room.remotePublishedUserMap.get(i);if(a)return a.remoteAudioTrack.mediaTrack}return null}getVideoTrack(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{userId:"",streamType:"main"},{userId:t="",streamType:r="main"}=e;if(t===""){if(r==="main"&&this._localVideoTrack)return this._localVideoTrack.mediaTrack;if(r==="sub"&&this._localScreenTrack)return this._localScreenTrack.mediaTrack}else{let i=this._room.remotePublishedUserMap.get(t);if(i)return r==="main"?i.remoteVideoTrack.mediaTrack:i.remoteAuxiliaryTrack.mediaTrack}return null}getVideoSnapshot(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{userId:t,streamType:r="main"}=e;if(t){let i=this._room.remotePublishedUserMap.get(t);if(r==="main"&&(i!=null&&i.muteState.hasVideo))return i.remoteVideoTrack.getVideoFrame();if(r==="sub"&&(i!=null&&i.muteState.hasAuxiliary))return i.remoteAuxiliaryTrack.getVideoFrame()}else{if(r==="main"&&this._localVideoTrack)return this._localVideoTrack.getVideoFrame();if(r==="sub"&&this._localScreenTrack)return this._localScreenTrack.getVideoFrame()}return""}setCurrentSpeaker(e){var t,r;this._speakerId=e,(t=this._localAudioTrack)==null||t.setAudioOutput(e),(r=this._localScreenAudioTrack)==null||r.setAudioOutput(e),this._room.remotePublishedUserMap.forEach(i=>i.remoteAudioTrack.setAudioOutput(e))}_startRemoteAudio(e){return this._doStartRemoteAudio(e)}_doStartRemoteAudio(e){return N(this,null,function*(){let{userId:t,option:r}=e;if(this._remoteAudioConfigMap.has(t))return void this._log.warn("remote audio has already started. userId:".concat(t));let i=this._room.remotePublishedUserMap.get(t);if(!i)return;let n={};r&&(K(r.volume)||(n.volume=r.volume));let a=i.remoteAudioTrack;this._listenOutputTrackChanged(a),this._speakerId&&a.setAudioOutput(this._speakerId);try{this._remoteAudioConfigMap.set(t,e),yield this._room.subscribe(a),yield this._updateAudioPlayOption({playOption:n,track:a})}catch(c){throw this._remoteAudioConfigMap.delete(t),c}this._emitTrackEvent(a)})}_stopRemoteAudio(e){let t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return N(this,null,function*(){let r=this._room.remotePublishedUserMap.get(e.userId);r&&(r.remoteAudioTrack.stop(),r.muteState.hasAudio&&t&&(yield this._room.unsubscribe(r.remoteAudioTrack)),this._mediaTrackMap.get(r.remoteAudioTrack.outMediaTrack)===e.userId&&this._mediaTrackMap.delete(r.remoteAudioTrack.outMediaTrack)),this._remoteAudioConfigMap.delete("".concat(e.userId))})}_updateVideoPlayOption(e){return N(this,arguments,function(t){let{view:r,playOption:i,track:n,prevConfig:a}=t;return function*(){if(n.setMirror(i.mirror),K(r)&&a&&a.view&&!I0(i)){let c=jh(a.view);c.length>0&&(yield n.play(c,i))}if(!K(r)){let c=jh(r);c.length>0?yield n.play(c,i):n.stop()}}()})}_updateAudioPlayOption(e){return N(this,arguments,function(t){let{playOption:r={},track:i,prevConfig:n}=t;return function*(){if(!i.isPlayCalled)try{yield i.play(null,r)}catch{}K(r.muted)||i.setPlayerMute(r.muted),K(r.volume)||i.setAudioVolume(r.volume/100)}()})}_listenOutputTrackChanged(e){e.listeners("output-media-track-changed").length===0&&e.on("output-media-track-changed",()=>this._emitTrackEvent(e,!1))}_emitTrackEvent(e){let t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],r=e.isRemote?e.userId:"";!e.outMediaTrack||t&&this._mediaTrackMap.get(e.outMediaTrack)===r||(this._mediaTrackMap.set(e.outMediaTrack,r),this.emit(Qe.TRACK,{userId:r,streamType:og(e.streamType),track:e.outMediaTrack}))}_checkTrackToPublish(){var e,t,r;let i=[];if((e=this._localAudioConfig)!=null&&e.publish&&this._localAudioTrack&&i.push(this._localAudioTrack),(t=this._localVideoConfig)!=null&&t.publish&&this._localVideoTrack&&i.push(this._localVideoTrack),(r=this._localScreenConfig)!=null&&r.publish&&(this._localScreenTrack&&i.push(this._localScreenTrack),this._localScreenAudioTrack&&i.push(this._localScreenAudioTrack)),i.length!==0)return this._room.publish(...i).catch(()=>{})}_observeView(e){let{remoteTrack:t,view:r,receiveWhenViewVisible:i=!1,viewRoot:n}=e;if(K(r))return;let a=this._remoteVideoConfigMap.get("".concat(t.userId,"_").concat(og(t.streamType)));if(!a)return;let c=a.observer||void 0;if(r===null||pr(r)&&r.length===0||!i)return c==null||c.disconnect(),void(t.isSubscribed||this._room.subscribe(t).catch(()=>{}));let A=a.visibleViewMap||new Map,d=-1;(!c||c.root!==n)&&(c==null||c.disconnect(),A.clear(),c=new IntersectionObserver(E=>{E.forEach(f=>{A.set(f.target,f.isIntersecting)}),clearTimeout(d),d=window.setTimeout(()=>{[...A.values()].find(f=>f)?t.isSubscribed||this._room.subscribe(t).catch(()=>{}):t.isSubscribed&&this._room.unsubscribe(t).catch(()=>{})},200)},{root:n}));let g=new Set(jh(r));A.forEach((E,f)=>{g.has(f)||(c.unobserve(f),A.delete(f))}),g.forEach(E=>{A.set(E,!0),c.observe(E)}),c.takeRecords().forEach(E=>{A.set(E.target,E.isIntersecting)}),a.visibleViewMap=A,a.observer=c}_exitRoom(){return N(this,null,function*(){this._room.isJoined&&(yield this._room.leave()),new Set([...this._remoteAudioConfigMap.keys(),...this._remoteAudioMuteMap.keys()]).forEach(e=>{this._stopRemoteAudio({userId:e}).catch()}),[...this._remoteVideoConfigMap.keys()].forEach(e=>{let t=e.includes("main")?"main":"sub",r=e.split("_".concat(t))[0];r&&this._stopRemoteVideo({userId:r,streamType:t}).catch()}),this._remoteVideoConfigMap.clear(),this._remoteAudioConfigMap.clear(),this._remoteAudioMuteMap.clear(),this._room.remotePublishedUserMap.forEach(e=>{br(e.remoteAudioTrack),br(e.remoteVideoTrack),br(e.remoteAuxiliaryTrack)})})}_stopScreenShare(){return N(this,null,function*(){var e;if(this._localScreenTrack){if(this._room.isJoined){let t=[this._localScreenTrack];this._localScreenAudioTrack&&t.push(this._localScreenAudioTrack),yield(e=this._room)==null?void 0:e.unpublish(...t).catch(()=>{})}this._localScreenTrack.stop(),this._localScreenTrack.close(),this._localScreenAudioTrack&&(this._localScreenAudioTrack.stop(),this._localScreenAudioTrack.close(),this._room.audioManager.removeInput(this._localScreenAudioTrack),this._localScreenAudioTrack=null),br(this._localScreenTrack),this._localScreenTrack=null,this._localScreenConfig=null}})}_initActiveSpeaker(){return N(this,null,function*(){if(Er&&!Zd(Er))this.emit(Qe.DEVICE_CHANGED,{type:"speaker",action:"active",device:Er});else{let e=yield Jc();if(e[0]&&!Zd(e[0]))Er=e[0],this.emit(Qe.DEVICE_CHANGED,{type:"speaker",action:"active",device:e[0]});else{let t=r=>{let{track:i}=r;i.kind==="audio"&&(!Er||Zd(Er))&&(this._initActiveSpeaker(),te.off("102",this._initActiveSpeaker))};te.on("102",t)}}})}_onAudioAvailable(e){let{userId:t}=e,r=this._remoteAudioMuteMap.has(t)?this._remoteAudioMuteMap.get(t):this._remoteAudioMuteMap.get("*");(r===!1||this._room.autoReceiveAudio&&!r)&&this._doStartRemoteAudio({userId:t}).catch(()=>{})}_onVideoAvailable(e){let{userId:t,streamType:r}=e;if(!this._room.autoReceiveVideo)return;let i=this._room.remotePublishedUserMap.get(t);if(i){let n=r==="main"?i.remoteVideoTrack:i.remoteAuxiliaryTrack;this._room.subscribe(n).then(()=>{this._emitTrackEvent(n)}).catch(()=>{})}}_onAudioUnavailable(e){let{userId:t,muteState:r}=e;r.hasAudio&&r.audioMuted||this._stopRemoteAudio({userId:t},!1).catch(()=>{})}_onVideoUnavailable(e){let{userId:t,streamType:r}=e;this._stopRemoteVideo({userId:t,streamType:r},!1).catch(()=>{})}sendSEIMessage(e,t){this._room.sendSEI(e,t||{seiPayloadType:243}),ve.addCount({key:5e5,useUV:!0})}sendCustomMessage(e){var t,r;(r=(t=this._room).sendCustomMessage)==null||r.call(t,e),ve.addCount({key:500001,useUV:!0})}static setLogLevel(e,t){ae.setLogLevel(e),K(t)||(t?ae.enableUploadLog():ae.disableUploadLog())}static isSupported(){return v_()}static getCameraList(){return is(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])}static getMicrophoneList(){return zn(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])}static getSpeakerList(){return Jc(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])}static setCurrentSpeaker(e){return N(this,null,function*(){(yield Jc()).forEach(t=>{t.deviceId===e&&(lg.forEach(r=>{r.setCurrentSpeaker(e),r.emit(Qe.DEVICE_CHANGED,{type:"speaker",action:"active",device:t})}),Er=t)})})}static _addKVStat(e){let{type:t,key:r,value:i,base:n,useUV:a,version:c}=e;switch(c&&($d.version=c),t){case"count":$d.addCount({key:r,useUV:a});break;case"enum":$d.addEnum({key:r,value:i,useUV:a});break;case"number":$d.addNumber({key:r,value:i,split:n})}}},Xe=dg;T(Xe,"_loggerManager",ae),T(Xe,"EVENT",Qe),T(Xe,"ERROR_CODE",Be),T(Xe,"TYPE",Zn),T(Xe,"frameWorkType",30),le([vt({replaceArg:e=>({argIndex:0,value:{name:"plugin"in e?e.plugin.Name:e.Name,assetsPath:"assetsPath"in e?e==null?void 0:e.assetsPath:"default"}})})],Xe.prototype,"use",1),le([wr(dr.TRTC.enterRoom),ya("room",(e,t)=>{let[r]=e,[i]=t;return(r.roomId||r.strRoomId)===(i.roomId||i.strRoomId)&&r.userId===i.userId&&r.sdkAppId===i.sdkAppId}),St(e=>function(t){return this._log.setUserId(t.userId),this._log.setSdkAppId(t.sdkAppId),e.call(this,t)}),vt()],Xe.prototype,"enterRoom",1),le([vt()],Xe.prototype,"exitRoom",1),le([wr(dr.TRTC.switchRole),$c("room",{merge:(e,t)=>t}),vt()],Xe.prototype,"switchRole",1),le([vt()],Xe.prototype,"destroy",1),le([wr(dr.TRTC.startLocalAudio),ya("audio",(e,t)=>{let[r]=e,[i]=t;var n,a;return((n=r==null?void 0:r.option)==null?void 0:n.microphoneId)===((a=i==null?void 0:i.option)==null?void 0:a.microphoneId)}),vt()],Xe.prototype,"startLocalAudio",1),le([wr(dr.TRTC.updateLocalAudio),$c("audio",{debounce:{delay:200,getKey:()=>"".concat(DR,"-localAudio"),isNeedToDebounce:e=>{var t;return!K((t=e.option)==null?void 0:t.captureVolume)}}}),vt()],Xe.prototype,"updateLocalAudio",1),le([Ta("audio"),vt()],Xe.prototype,"stopLocalAudio",1),le([wr(dr.TRTC.startLocalVideo),ya("video",(e,t)=>{let[r]=e,[i]=t;var n,a;return((n=r==null?void 0:r.option)==null?void 0:n.cameraId)===((a=i==null?void 0:i.option)==null?void 0:a.cameraId)}),vt()],Xe.prototype,"startLocalVideo",1),le([wr(dr.TRTC.updateLocalVideo),$c("video"),vt()],Xe.prototype,"updateLocalVideo",1),le([Ta("video"),vt()],Xe.prototype,"stopLocalVideo",1),le([wr(dr.TRTC.startScreenShare),ya("screen",()=>!0),vt()],Xe.prototype,"startScreenShare",1),le([wr(dr.TRTC.updateScreenShare),$c("screen"),vt()],Xe.prototype,"updateScreenShare",1),le([vt()],Xe.prototype,"stopScreenShare",1),le([wr(dr.TRTC.startRemoteVideo),ya(e=>"v".concat(e.userId).concat(e.streamType),()=>!0),vt({getRemoteId:e=>"".concat(e.userId,"_").concat(e.streamType)})],Xe.prototype,"startRemoteVideo",1),le([wr(dr.TRTC.updateRemoteVideo),$c(e=>"v".concat(e.userId).concat(e.streamType)),vt({getRemoteId:e=>"".concat(e.userId,"_").concat(e.streamType)})],Xe.prototype,"updateRemoteVideo",1),le([wr(dr.TRTC.stopRemoteVideo),St(e=>function(t){return N(this,null,function*(){if(t.userId==="*"){let r=[];return this._room.remotePublishedUserMap.forEach(i=>{this._remoteVideoConfigMap.has("".concat(i.userId,"_","main"))&&r.push(this.stopRemoteVideo({streamType:"main",userId:i.userId}).catch(()=>{})),this._remoteVideoConfigMap.has("".concat(i.userId,"_","sub"))&&r.push(this.stopRemoteVideo({streamType:"sub",userId:i.userId}).catch(()=>{}))}),Promise.all(r)}return e.call(this,t)})}),vt({getRemoteId:e=>"".concat(e.userId,"_").concat(e.streamType)})],Xe.prototype,"stopRemoteVideo",1),le([Ta(e=>"v".concat(e.userId).concat(e.streamType))],Xe.prototype,"_stopRemoteVideo",1),le([wr(...dr.TRTC.muteRemoteAudio),vt({getRemoteId:e=>e})],Xe.prototype,"muteRemoteAudio",1),le([RR(...dr.TRTC.setRemoteAudioVolume),function(e,t){return St((r,i)=>function(){for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];var A,d;let g=(A=sg.get(this))==null?void 0:A.get(t(...a));g&&g>0&&clearTimeout(g);let E=window.setTimeout(()=>{r.apply(this,a)},e);sg.has(this)?(d=sg.get(this))==null||d.set(t(...a),E):sg.set(this,new Map([[t(...a),E]]))})}(200,e=>e),vt({getRemoteId:e=>e})],Xe.prototype,"setRemoteAudioVolume",1),le([Z_("start"),ya((e,t)=>e.getAlias()+e.getGroup(t)),vt({replaceArg:e=>({argIndex:0,value:e.getName()}),getKVReportKey:e=>H0[e.getName()]})],Xe.prototype,"startPlugin",1),le([Z_("update"),$c((e,t)=>e.getAlias()+e.getGroup(t)),vt({replaceArg:e=>({argIndex:0,value:e.getName()}),getKVReportKey:e=>G0[e.getName()]})],Xe.prototype,"updatePlugin",1),le([Z_("stop"),Ta((e,t)=>e.getAlias()+e.getGroup(t)),vt({replaceArg:e=>({argIndex:0,value:e.getName()}),getKVReportKey:e=>Y0[e.getName()]})],Xe.prototype,"stopPlugin",1),le([RR(...dr.TRTC.enableAudioVolumeEvaluation)],Xe.prototype,"enableAudioVolumeEvaluation",1),le([vt()],Xe.prototype,"getVideoSnapshot",1),le([vt()],Xe.prototype,"setCurrentSpeaker",1),le([ya(e=>"a".concat(e.userId),()=>!0)],Xe.prototype,"_startRemoteAudio",1),le([St(e=>function(t){return N(this,null,function*(){return t.userId==="*"?Promise.all([...this._room.remotePublishedUserMap.values()].map(r=>this._stopRemoteAudio(Ke(_e({},t),{userId:r.userId})).catch(()=>{}))):e.call(this,t)})}),Ta(e=>"a".concat(e.userId))],Xe.prototype,"_stopRemoteAudio",1),le([Ta("room")],Xe.prototype,"_exitRoom",1),le([Ta("screen")],Xe.prototype,"_stopScreenShare",1),le([wr(...dr.TRTC.sendSEIMessage),fR({timesInSecond:30,maxSizeInSecond:8e3,getSize:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t[0].byteLength}})],Xe.prototype,"sendSEIMessage",1),le([wr(dr.TRTC.sendCustomMessage),fR({timesInSecond:30,maxSizeInSecond:8e3,getSize:e=>e.data.byteLength})],Xe.prototype,"sendCustomMessage",1),le([wr(dr.TRTC.create)],Xe,"_create",1);var ug=Xe,p1=class{constructor(){this._set=new Set,te.on(X.LEAVE_SUCCESS,this.delete,this)}add(e){let{room:t,roomId:r}=e;if(t.scene==="rtc")return;let i=this.getKey(t.userId,r||t.roomId,t.sdkAppId,t.useStringRoomId);this._set.add(i)}delete(e){let{room:t,roomId:r}=e;if(t.scene==="rtc")return;let i=this.getKey(t.userId,t.roomId||r,t.sdkAppId,t.useStringRoomId);this._set.delete(i)}getKey(e,t,r,i){return"".concat(r,"_").concat(t,"_").concat(e,"_").concat(i)}isJoined(e){let{userId:t,roomId:r,sdkAppId:i,room:n}=e;return n.scene!=="rtc"&&this._set.has(this.getKey(t,r,i,n.useStringRoomId))}};function m1(){return N(this,null,function*(){let e,t;try{let f=yield zn();e=f&&f.length}catch{}try{let f=yield is();t=f&&f.length}catch{}let r={microphone:e,camera:t},{isH264EncodeSupported:i,isVp8EncodeSupported:n,isH264DecodeSupported:a,isVp8DecodeSupported:c}=this.checkSystemResult.detail,A=Yd.basis(),d={webRTC:A.isWebRTCSupported,getUserMedia:A.isGetUserMediaSupported,webSocket:A.isWebSocketsSupported,screenShare:A.isScreenShareSupported,webAudio:A.isWebAudioSupported,h264Encode:i,h264Decode:a,vp8Encode:n,vp8Decode:c},g={browser:A.browser,os:A.os,trtc:d,devices:r},E={isWebCodecSupported:A.isWebCodecSupported,isMediaSessionSupported:A.isMediaSessionSupported,isWebTransportSupported:A.isWebTransportSupported};Lt.uploadEvent({log:"trtcstats-".concat(JSON.stringify(g)),userId:this.userId}),this._log.info("TrtcStats-".concat(JSON.stringify(g))),Lt.uploadEvent({log:"trtcadvancedstats-".concat(JSON.stringify(E)),userId:this.userId})})}var f1=lr(Lr(),1),OR=Symbol("instance"),rI=Symbol("cacheResult"),Ag=class{constructor(e,t,r){this.oldState=e,this.newState=t,this.action=r,this.aborted=!1}abort(e){this.aborted=!0,hu.call(e,this.oldState,new Error("action '".concat(this.action,"' aborted")))}toString(){return"".concat(this.action,"ing")}},iI=class extends Error{constructor(e,t,r){super(t),this.state=e,this.message=t,this.cause=r}},Au=new Map;function kR(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return(i,n,a)=>{let c=r.action||n;if(!r.context){let d=Au.get(i)||[];Au.has(i)||Au.set(i,d),d.push({from:e,to:t,action:c})}let A=a.value;a.value=function(){let d=this;for(var g=arguments.length,E=new Array(g),f=0;f<g;f++)E[f]=arguments[f];if(r.context&&(d=bt.get(typeof r.context=="function"?r.context.call(this,...E):r.context)),d.state===t)return d[rI];d.state instanceof Ag&&d.state.action==r.abortAction&&d.state.abort(d);let b=null;if(Array.isArray(e)?e.length==0?d.state instanceof Ag&&d.state.abort(d):(typeof d.state!="string"||!e.includes(d.state))&&(b=new iI(d._state,"".concat(d.name," ").concat(c," to ").concat(t," failed: current state ").concat(d._state," not in from config"))):e!==d.state&&(b=new iI(d._state,"".concat(d.name," ").concat(c," to ").concat(t," failed: current state ").concat(d._state," not from ").concat(e))),b){if(!r.fail){if(r.ignoreError)return b;throw b}r.fail.call(this,b)}let w=d.state,k=new Ag(w,t,c);hu.call(d,k);let x=G=>{var F;return d[rI]=G,k.aborted||(hu.call(d,t),(F=r.success)===null||F===void 0||F.call(this,d[rI])),G},Y=G=>{let F=G instanceof Error?G.message:String(G);if(hu.call(d,w,G),!r.fail){if(r.ignoreError)return G;throw G}r.fail.call(this,new iI(d._state,"action '".concat(c,"' failed :").concat(F),G instanceof Error?G:new Error(F)))};try{let G=A.apply(this,E);return function(F){return typeof F=="object"&&F&&"then"in F}(G)?G.then(x).catch(Y):x(G)}catch(G){Y(G)}}}}var E1=typeof window<"u"&&window.__AFSM__?(e,t)=>{window.dispatchEvent(new CustomEvent(e,{detail:t}))}:typeof importScripts<"u"?(e,t)=>{postMessage({type:e,payload:t})}:()=>{};function hu(e,t){let r=this._state;this._state=e;let i=e.toString();e&&this.emit(i,r),this.emit(bt.STATECHANGED,e,r,t),this.updateDevTools({value:e,old:r,err:t instanceof Error?t.message:String(t)})}var bt=class extends f1.default{constructor(e,t,r){super(),this.name=e,this.groupName=t,this._state=bt.INIT,e||(e=Date.now().toString(36)),r?Object.setPrototypeOf(this,r):r=Object.getPrototypeOf(this),t||(this.groupName=this.constructor.name);let i=r[OR];i?this.name=i.name+"-"+i.count++:r[OR]={name:this.name,count:0},this.updateDevTools({diagram:this.stateDiagram})}get stateDiagram(){let e=Object.getPrototypeOf(this),t=Au.get(e)||[],r=new Set,i=[],n=[],a=new Set,c=Object.getPrototypeOf(e);Au.has(c)&&(c.stateDiagram.forEach(d=>r.add(d)),c.allStates.forEach(d=>a.add(d))),t.forEach(d=>{let{from:g,to:E,action:f}=d;typeof g=="string"?i.push({from:g,to:E,action:f}):g.length?g.forEach(b=>{i.push({from:b,to:E,action:f})}):n.push({to:E,action:f})}),i.forEach(d=>{let{from:g,to:E,action:f}=d;a.add(g),a.add(E),a.add(f+"ing"),r.add("".concat(g," --> ").concat(f,"ing : ").concat(f)),r.add("".concat(f,"ing --> ").concat(E," : ").concat(f," ð¢")),r.add("".concat(f,"ing --> ").concat(g," : ").concat(f," ð´"))}),n.forEach(d=>{let{to:g,action:E}=d;r.add("".concat(E,"ing --> ").concat(g," : ").concat(E," ð¢")),a.forEach(f=>{f!==g&&r.add("".concat(f," --> ").concat(E,"ing : ").concat(E))})});let A=[...r];return Object.defineProperties(e,{stateDiagram:{value:A},allStates:{value:a}}),A}static get(e){let t;return typeof e=="string"?(t=bt.instances.get(e),t||bt.instances.set(e,t=new bt(e,void 0,Object.create(bt.prototype)))):(t=bt.instances2.get(e),t||bt.instances2.set(e,t=new bt(e.constructor.name,void 0,Object.create(bt.prototype)))),t}static getState(e){var t;return(t=bt.get(e))===null||t===void 0?void 0:t.state}updateDevTools(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};E1(bt.UPDATEAFSM,Object.assign({name:this.name,group:this.groupName},e))}get state(){return this._state}set state(e){hu.call(this,e)}};bt.STATECHANGED="stateChanged",bt.UPDATEAFSM="updateAFSM",bt.INIT="[*]",bt.ON="on",bt.OFF="off",bt.instances=new Map,bt.instances2=new WeakMap;var _1=lr(Lr()),BR="1",NR="5",nI="2",tl="3",I1="5",C1="4",pn={CLIENT_BANNED:9,CHANNEL_SETUP_RESULT:19,CHANNEL_RECONNECT_RESULT:514,JOIN_ROOM_RESULT:20,PEER_JOIN:4134,PEER_LEAVE:4135,STREAM_ADDED:16,STREAM_REMOVED:18,UPLINK_NETWORK_STATS:22,UPDATE_REMOTE_MUTE_STAT:23,PUBLISH_RESULT:4098,PUBLISH_STATE_CHANGE_RESULT:4112,UNPUBLISH_RESULT:4100,SUBSCRIBE_RESULT:4102,UNSUBSCRIBE_RESULT:4104,SUBSCRIBE_CHANGE_RESULT:4106,MUTE_RESULT:4108,UPDATE_OFFER_RESULT:4128,START_PUBLISH_TENCENT_CDN_RES:1286,STOP_PUBLISH_TENCENT_CDN_RES:1288,START_PUBLISH_GIVEN_CDN_RES:777,STOP_PUBLISH_GIVEN_CDN_RES:779,START_MIX_TRANSCODE_RES:781,STOP_MIX_TRANSCODE_RES:783,USER_LIST_RES:4137,SWITCH_ROLE_RES:4110,UPDATE_CONSTRAINT_CONFIG_RES:772,REBUILD_PEER_CONNECTION_RES:4150,SPC_PUBLISH_RESULT:4146,SPC_SUBSCRIBE_RESULT:4156,ABILITY_STATUS_REPORT_RESULT:4158,SERVER_FIRST_PACKAGE_RECEIVED:5e3,RECEIVE_CUSTOM_MSG:4140},y1=[pn.UPDATE_REMOTE_MUTE_STAT,pn.UPLINK_NETWORK_STATS,pn.USER_LIST_RES,pn.MUTE_RESULT,pn.SERVER_FIRST_PACKAGE_RECEIVED,pn.RECEIVE_CUSTOM_MSG],ze={CLIENT_BANNED:"client-banned",CHANNEL_SETUP_RESULT:"channel-setup-result",CHANNEL_RECONNECT_RESULT:"channel-reconnect-result",JOIN_ROOM_RESULT:"join-room-result",PEER_JOIN:"peer-join",PEER_LEAVE:"peer-leave",STREAM_ADDED:"stream-added",STREAM_REMOVED:"stream-removed",UPLINK_NETWORK_STATS:"uplink-network-stats",UPDATE_REMOTE_MUTE_STAT:"update-remote-mute-stat",PUBLISH_RESULT:"publish-result",PUBLISH_STATE_CHANGE_RESULT:"publish-state-change-result",UNPUBLISH_RESULT:"unpublish-result",SUBSCRIBE_RESULT:"subscribe-result",SUBSCRIBE_CHANGE_RESULT:"subscribe-change-result",UNSUBSCRIBE_RESULT:"unsubscribe-result",UPDATE_OFFER_RESULT:"update-offer-result",START_PUBLISH_TENCENT_CDN_RES:"start-publish-tencent-cdn-res",STOP_PUBLISH_TENCENT_CDN_RES:"stop-publish-tencent-cdn-res",START_PUBLISH_GIVEN_CDN_RES:"start-publish-given-cdn-res",STOP_PUBLISH_GIVEN_CDN_RES:"stop-publish-given-cdn-res",START_MIX_TRANSCODE_RES:"start-mix-transcode-res",STOP_MIX_TRANSCODE_RES:"stop-mix-transcode-res",USER_LIST_RES:"user-list-res",SWITCH_ROLE_RES:"switch_role_res",MUTE_RESULT:"mute-result",UPDATE_CONSTRAINT_CONFIG_RES:"update-contraint-config-res",REBUILD_PEER_CONNECTION_RES:"rebuild-pc-res",SPC_PUBLISH_RESULT:"spc-publish-result",SPC_SUBSCRIBE_RESULT:"spc-subscribe-result",ABILITY_STATUS_REPORT_RESULT:"ability-status-report",SERVER_FIRST_PACKAGE_RECEIVED:"first-pkg-received",RECEIVE_CUSTOM_MSG:"receive-custom-msg"},T1="publish_change",S1="join",v1="leave",R1="quality_report",PR="mute_uplink",b1="publish",MR="publish_state_change",oI="unpublish",w1="subscribe",LR="unsubscribe",QR="subscribe_change",D1="start_publishing",O1="stop_publishing",k1="start_push_user_cdn",B1="stop_push_user_cdn",N1="start_mcu_mix",P1="stop_mcu_mix",M1="get_user_list",L1="change_role",xR="update_constraint_config",Q1="rebuild_pc",x1="join/v2",U1="publish/v2",F1="subscribe/v3",V1="ability_status_report",j1="reconnect",H1="channel_msg",hg=new Set,UR=class extends _1.default{constructor(e){var t,r;super(),T(this,"room"),T(this,"url"),T(this,"backupUrl"),T(this,"race"),T(this,"destroyed",!1),T(this,"_socketInUse"),T(this,"_socket"),T(this,"_backupSocket"),T(this,"_signalInfo",{tinyId:void 0,clientIp:"",signalIp:"",relayIp:"",relayInnerIp:"",relayPort:0}),T(this,"_currentState","DISCONNECTED"),T(this,"_isReconnecting",!1),T(this,"_seq",0),T(this,"_log"),T(this,"_lastMessageTime",-1),T(this,"_connnectStartTime",-1),T(this,"_stopConnectRetry"),T(this,"bytesSent",0),T(this,"bytesReceived",0),T(this,"keepAlive",!1),this.room=e.room,this.race=!!K(e.race)||e.race,(((r=(t=this.room.scheduleResult)==null?void 0:t.config)==null?void 0:r.keepAliveClient)||0)-hg.size>0&&this.room.enableSPC&&(this.keepAlive=!0,hg.add(this)),this.url=e.url,this.backupUrl=e.backupUrl,this._seq=0,this._log=ae.createLogger({id:"ws",userId:this.userId,sdkAppId:this.sdkAppId}),this.onmessage=this.onmessage.bind(this),this.onerror=this.onerror.bind(this),this.onclose=this.onclose.bind(this)}get urlParam(){let e="?sdkAppId=".concat(encodeURIComponent(this.sdkAppId),"&userId=").concat(encodeURIComponent(this.userId),"&userSig=").concat(encodeURIComponent(this.userSig),"&keepAlive=").concat(encodeURIComponent(Number(this.keepAlive)));return this.race?"".concat(e,"&race=1"):e}get _urlWithParam(){return"".concat(this.url).concat(this.race?"/v2/ws":"").concat(this.urlParam)}get _backupUrlWithParam(){return"".concat(this.backupUrl).concat(this.race?"/v2/ws":"").concat(this.urlParam)}get isConnected(){return this._currentState==="CONNECTED"}get isConnecting(){return this._currentState==="CONNECTING"}get sdkAppId(){return this.room.sdkAppId}get userId(){return this.room.userId}get userSig(){return this.room.userSig}get isOnline(){return this._currentState==="CONNECTED"&&Date.now()-this._lastMessageTime<12e3}connect(){return N(this,arguments,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1e4;return function*(){if(e.isConnected)return Promise.resolve();e._log.info("connect to [".concat(e.url,", ").concat(e.backupUrl,"]").concat(t?" timeout: ".concat(t):""," keepAlive: ").concat(Number(e.keepAlive))),e.emitConnectionStateChanged("CONNECTING"),e._connnectStartTime=He();let r=[e.connectWS({url:e._urlWithParam,isMain:!0,timeout:t})];e.race&&e._backupUrlWithParam!==e._urlWithParam&&r.push(e.connectWS({url:e._backupUrlWithParam,isMain:!1,timeout:t})),e._socketInUse=yield f_(r),e.unbindAndCloseSocket(e._socketInUse===e._socket?O.BACKUP:O.MAIN),e.emitConnectionStateChanged("CONNECTED")}()})}connectWS(e){let{url:t,timeout:r,isMain:i}=e,n=new WebSocket(t);this.bindSocket(n),i?this._socket=n:this._backupSocket=n;let a=-1;return new Promise((c,A)=>{n.onclose=A,n.onerror=A,n.onopen=()=>c(n),r&&(a=setTimeout(()=>{this.unbindAndCloseSocket(i?O.MAIN:O.BACKUP),A(new pe({code:se.SIGNAL_CHANNEL_SETUP_FAILED,message:"ws connect timeout"}))},r))}).finally(()=>{n.onclose=null,n.onerror=null,n.onopen=null,clearTimeout(a)})}bindSocket(e){e.addEventListener("close",this.onclose),e.addEventListener("error",this.onerror),e.addEventListener("message",this.onmessage)}unbindSocket(e){e.removeEventListener("close",this.onclose),e.removeEventListener("error",this.onerror),e.removeEventListener("message",this.onmessage)}unbindAndCloseSocket(e){if(e===O.MAIN){if(this._socket){this.unbindSocket(this._socket);try{this._socket.close(1e3)}catch{}this._socket=null}}else if(this._backupSocket){this.unbindSocket(this._backupSocket);try{this._backupSocket.close(1e3)}catch{}this._backupSocket=null}}onclose(e){if(e.target===this._socketInUse&&(this._log.warn("".concat(e.target===this._socket?"main":"backup"," is closed code:").concat(e.code," ").concat(e.reason)),this.emitConnectionStateChanged("DISCONNECTED"),!e.wasClean||e.code!==1e3)){this._socketInUse.onclose=null,this._socketInUse.close(4011);let t=this._socketInUse===this._socket;this.unbindAndCloseSocket(t?O.MAIN:O.BACKUP),this._socketInUse=null,this.reconnect()}}onerror(e){this._log.error("".concat(e.target===this._socket?"main":"backup"," error observed")),this.emitConnectionStateChanged("DISCONNECTED"),e.target===this._socketInUse&&(this.unbindAndCloseSocket(O.MAIN),this.unbindAndCloseSocket(O.BACKUP),this._socketInUse=null,this.reconnect())}onmessage(e){if(!this.isConnected)return;this._lastMessageTime=Date.now(),this.bytesReceived+=E_(e.data);let t=JSON.parse(e.data),{cmd:r,data:i}=t,n=Object.values(pn),a=Object.keys(pn)[n.indexOf(r)],c=ze[a];switch(y1.includes(r)||(this._log.debug("received ".concat(r," msg: ").concat(e.data)),c&&this._log.info("Received event: [ ".concat(c," ]"))),r){case pn.CHANNEL_SETUP_RESULT:if(t.code===0)this._signalInfo.clientIp=i.clientIp,this._signalInfo.signalIp=i.signalInnerIp,i.svrTime&&function(A){RE=A-new Date().getTime();let d=new Date;d.setTime(A),ae.info("baseTime from server: ".concat(d," offset: ").concat(RE))}(i.svrTime),this._log.info("ChannelSetup Success"),ve.addSuccessEvent({key:521701,cost:He()-this._connnectStartTime}),this._connnectStartTime=-1,this.emit(BR,{signalInfo:this._signalInfo});else{let A=new pe({code:se.SIGNAL_CHANNEL_SETUP_FAILED,extraCode:t.code,message:Ve({key:xe.SIGNAL_CHANNEL_SETUP_FAILED,data:{errorCode:t.code,errorMsg:t.message}})});this._log.error("".concat(t.code,", ").concat(t.message)),this.close(),ve.addFailedEvent({key:521701,error:A}),this.emit(NR,A)}break;case pn.JOIN_ROOM_RESULT:t.code===0&&(this._signalInfo.relayIp=i.relayOuterIp,this._signalInfo.relayInnerIp=i.relayInnerIp,this._signalInfo.relayPort=i.relayPort,this._signalInfo.tinyId=t.tinyId,this._log.info("signalIp:".concat(this._signalInfo.signalIp," clientIp:").concat(this._signalInfo.clientIp," relayIp: ").concat(this._signalInfo.relayIp))),this.emit(c,{data:t});break;default:this.emit(c,{data:t})}}reGetSignalChannelUrl(){return N(this,null,function*(){try{if(!this.room.joinParams)return;zo(!0),yield this.room.schedule(this.room.joinParams);let{mainUrl:e,backupUrl:t}=this.room.getSignalChannelUrl();this.url=e,this.backupUrl=t}catch{}})}reconnect(){return N(this,null,function*(){if(!this._isReconnecting){if(!this.room.isJoined&&this.keepAlive)return void this.close();this._isReconnecting=!0;try{this._log.warn("reconnect"),yield this.connect();let{roomId:e,useStringRoomId:t}=this.room,{relayIp:r,relayInnerIp:i,relayPort:n}=this._signalInfo,{data:a}=yield this.sendWaitForResponse({command:j1,data:{roomId:e,useStringRoomId:t,relayInnerIp:i,relayOuterIp:r,relayPort:n},responseCommand:ze.CHANNEL_RECONNECT_RESULT});a.code===0?(this._log.warn("reconnect success"),this.stopReconnection(),ve.addSuccessEvent({key:521702,cost:He()-this._connnectStartTime}),this._connnectStartTime=-1,this.room.syncUserList(),this.room.checkConnectionsToReconnect()):(ve.addFailedEvent({key:521702,error:a.code}),this._log.warn("reconnect failed, ".concat(a.code," ").concat(a.message)),this.room.reJoin())}catch(e){this._log.error(e),this.room.reJoin()}}})}send(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.isConnected&&!this.room.isLeft){let r={cmd:e,data:t,userId:this.userId,tinyId:this._signalInfo.tinyId,seq:++this._seq},i=JSON.stringify(r);return this._socketInUse.send(i),this.bytesSent+=E_(i),r.seq}}sendWaitForResponse(e){let{command:t,data:r,timeout:i=5e3,responseCommand:n,commandDesc:a,enableLog:c=!0}=e;return new Promise((A,d)=>{let g=setTimeout(()=>{this.off(n,E);let b=new pe({code:se.API_CALL_TIMEOUT,message:Ve({key:xe.API_CALL_TIMEOUT,data:{commandDesc:a,command:t}})});c&&this._log.warn(b),d(b)},i),E=b=>{b.data.seq===f&&(clearTimeout(g),this.off(n,E),A(b))};this.on(n,E);let f=this.send(t,r)})}sendWaitForResponseWithRetry(e){let{commandDesc:t,command:r,retries:i=0,retryTimeout:n=0}=e;return Ud({retryFunction:this.sendWaitForResponse,onError:a=>{let{retry:c}=a;this.isOnline?c():(this._log.warn("retry ".concat(r," when connected")),this.once(tl,c))},onRetrying:a=>{this._log.warn("".concat(t||r," timeout observed, retrying [").concat(a,"/").concat(i,"]"))},settings:{retries:i,timeout:n},context:this})(e)}getCurrentState(){return this._currentState}getSignalInfo(){return this._signalInfo}stopReconnection(){this._isReconnecting=!1,this._stopConnectRetry&&this._stopConnectRetry()}close(){this._log.info("closed"),hg.delete(this),this.stopReconnection(),this._signalInfo={tinyId:void 0,clientIp:"",signalIp:"",relayIp:"",relayInnerIp:"",relayPort:0},this._socketInUse=null,this.bytesSent=0,this.bytesReceived=0,this._stopConnectRetry&&this._stopConnectRetry(),this.unbindAndCloseSocket(O.MAIN),this.unbindAndCloseSocket(O.BACKUP),this.emitConnectionStateChanged("DISCONNECTED")}destroy(){this.close(),this.destroyed=!0}stopKeepAliveIn(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3600;if(this.keepAlive){this._log.info("stopKeepAlive in ".concat(e,"s"));let t=setTimeout(()=>{this.keepAlive=!1,this._log.info("close due to not used ".concat(e,"s")),this.close()},1e3*e),r=i=>{i instanceof Ag&&i.action==="join"&&(this._log.info("stopKeepAlive clear timeout"),clearTimeout(t),this.room.off(bt.STATECHANGED,r))};this.room.on(bt.STATECHANGED,r)}}emitConnectionStateChanged(e){e!==this._currentState&&(this._log.info("".concat(this._currentState," -> ").concat(e)),this.emit(nI,{prevState:this._currentState,state:e}),this._currentState=e,e==="CONNECTED"?this.emit(tl):e==="DISCONNECTED"&&this.emit(I1))}};le([fa({settings:{retries:1/0,timeout:2e3},onError(e,t){!this.room.isDestroyed&&!this.destroyed&&t()},onRetrying(e,t){this._log.warn("retrying to connect ".concat(e)),e>=3&&e%3==0&&this.reGetSignalChannelUrl(),t&&(this._stopConnectRetry=t,(this.room.isDestroyed||this.destroyed)&&t())}})],UR.prototype,"connect",1);var G1=lr(Lr()),sI=0,aI=!1,gg=new Set,FR=!1,Sa=class{constructor(e){T(this,"userId"),T(this,"tinyId"),T(this,"_sdpSemantics"),T(this,"_isUplink"),T(this,"_room"),T(this,"_log"),T(this,"_signalChannel"),T(this,"_isErrorObserved",!1),T(this,"_waitForPeerConnectionConnectedPromise"),T(this,"_waitForPeerConnectionConnectedPromiseReject",null),T(this,"_peerConnection",null),T(this,"_emitter",new G1.default),T(this,"_currentState","DISCONNECTED"),T(this,"_isReconnecting",!1),T(this,"_reconnectionCount",0),T(this,"_reconnectionTimer",-1),T(this,"_isFirstConnection",!0),T(this,"_prevTime",-1),T(this,"_enableSEI"),T(this,"_sei"),T(this,"_localAddress"),T(this,"_remoteAddress"),this.userId=e.userId,this.tinyId=e.tinyId,this._room=e.room,this._sdpSemantics=e.room.sdpSemantics,this._isUplink=e.isUplink,this._log=ae.createLogger({id:"n-mpc",userId:this._room.userId,remoteUserId:this.userId,sdkAppId:this._room.sdkAppId,isLocal:this._isUplink}),this._signalChannel=e.signalChannel,this._enableSEI=e.enableSEI}beforeConnect(){this._prevTime<0&&(this._prevTime=He())}afterConnect(){try{this._isFirstConnection?(this._isFirstConnection=!1,ve.addSuccessEvent({key:521705,cost:Math.min(He()-this._prevTime,3e4)})):this._isReconnecting&&ve.addSuccessEvent({key:521706,cost:He()-this._prevTime}),this._prevTime=-1}catch(e){throw this._isFirstConnection?(this._isFirstConnection=!1,ve.addFailedEvent({key:521705,error:e})):this._isReconnecting&&this._reconnectionCount>=3&&ve.addFailedEvent({key:521706,error:e}),e}}initialize(){let e={encodedInsertableStreams:this._enableSEI&&ma,iceServers:this._room.getIceServers(),iceTransportPolicy:this._room.getIceTransportPolicy(),sdpSemantics:this._sdpSemantics,bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",tcpCandidatePolicy:"disable",IceTransportsType:"nohost"};this._peerConnection=new RTCPeerConnection(e),this._peerConnection.onconnectionstatechange=this.onConnectionStateChange.bind(this)}close(e){this._log.info("close connection"),this._emitter.emit("closed",e),this._isReconnecting&&this.stopReconnection(),this.closePeerConnection(),this._sei&&(this._sei.destroy(),this._sei=null),gg.delete(this)}closePeerConnection(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this._peerConnection&&(this._log.info("close pc"),this._peerConnection.onconnectionstatechange=null,this._peerConnection.close(),this._peerConnection=null,e&&this.emitConnectionStateChangedEvent("DISCONNECTED")),this._waitForPeerConnectionConnectedPromiseReject&&this._waitForPeerConnectionConnectedPromiseReject(new pe({code:se.API_CALL_ABORTED,message:"connection closed"}))}getDTLSTransportState(){if(!this._peerConnection)return Jo;let e=null;if(this._isUplink){if(!Jd()||this._peerConnection.getSenders().length===0)return Jo;e=this._peerConnection.getSenders()[0].transport}else{if(!Wh()||this._peerConnection.getReceivers().length===0)return Jo;e=this._peerConnection.getReceivers()[0].transport}return e?e.state:Jo}onConnectionStateChange(e){let t=this._peerConnection.iceConnectionState,r=this.getDTLSTransportState();if(this._log.info("connectionState: ".concat(e.target.connectionState,", ICE: ").concat(t,", DTLS: ").concat(r)),e.target.connectionState===Vt.CONNECTING&&this.emitConnectionStateChangedEvent("CONNECTING"),e.target.connectionState===Vt.FAILED||e.target.connectionState===Vt.CLOSED){let i="connection ".concat(e.target.connectionState,". ICE Transport state: ").concat(t,", DTLS Transport state: ").concat(r),n=new pe({message:i,code:se.ICE_TRANSPORT_ERROR});this.emitConnectionStateChangedEvent("DISCONNECTED"),this.startReconnection(),this._isErrorObserved||this._emitter.emit("error",n)}(e.target.connectionState===Vt.CONNECTED||e.target.connectionState===Vt.COMPLETED)&&(this.logSelectedCandidate(),Lt.logSuccessEvent({userId:this._room.userId,eventType:Hn.ICE_CONNECTION_STATE}),this.emitConnectionStateChangedEvent("CONNECTED"))}emitConnectionStateChangedEvent(e){return e!==this._currentState&&(e==="CONNECTED"?(sI=0,aI=!1,FR=!0,gg.add(this)):gg.delete(this),te.emit(X.PEER_CONNECTION_STATE_CHANGED,{room:this._room,prevState:this._currentState,state:e,remoteUserId:this._isUplink?void 0:this.userId}),this._emitter.emit("connection-state-changed",{prevState:this._currentState,state:e}),this._currentState=e,!0)}getPeerConnection(){return this._peerConnection}getRoom(){return this._room}getUserId(){return this.userId}getTinyId(){return this.tinyId}logSelectedCandidate(){return N(this,null,function*(){if(!this._peerConnection)return;let e=yield this._peerConnection.getStats();for(let[,t]of e)if(Wd(t)){let r=e.get(t.localCandidateId),i=e.get(t.remoteCandidateId);r&&(this._log.info("local candidate: ".concat(r.candidateType," ").concat(r.protocol,":").concat(r.ip||r.address,":").concat(r.port," ").concat(r.networkType||""," ").concat(r.candidateType==="relay"?"relayProtocol:".concat(r.relayProtocol):"")),this._localAddress="".concat(r.ip||r.address,":").concat(r.port)),i&&(this._log.info("remote candidate: ".concat(i.candidateType," ").concat(i.protocol,":").concat(i.ip||i.address,":").concat(i.port)),this._remoteAddress="".concat(i.protocol,":").concat(i.ip||i.address));break}})}getCurrentState(){return this._currentState}waitForPeerConnectionConnected(){return this._waitForPeerConnectionConnectedPromise||(this._waitForPeerConnectionConnectedPromise=new Promise((e,t)=>{if(this._currentState==="CONNECTED")return e();this._waitForPeerConnectionConnectedPromiseReject=t;let r=c=>{c.state==="CONNECTED"&&(clearTimeout(a),n(),e())},i=c=>{let{room:A}=c;A===this._room&&(clearTimeout(a),n(),t(new pe({code:se.API_CALL_ABORTED,message:Ve({key:xe.CONNECTION_ABORTED,data:"leave room"})})))},n=()=>{te.off(X.LEAVE_SUCCESS,i,this),this._emitter.off("connection-state-changed",r,this)},a=setTimeout(()=>{n();let c=new pe({code:se.API_CALL_TIMEOUT,message:"connection timeout"});var A;sI+=1,A=this._signalChannel.isConnected,sI>2&&!aI&&gg.size===0&&A&&(this._log.warn("firewall restriction"),aI=!0,this._emitter.emit("firewall-restriction")),t(c)},FE);te.on(X.LEAVE_SUCCESS,i,this),this._emitter.on("connection-state-changed",r,this)}),this._waitForPeerConnectionConnectedPromise=this._waitForPeerConnectionConnectedPromise.finally(()=>{this._waitForPeerConnectionConnectedPromise=null,this._waitForPeerConnectionConnectedPromiseReject=null})),this._waitForPeerConnectionConnectedPromise}getReconnectionCount(){return this._reconnectionCount}startReconnection(){this._isReconnecting=!0,this.reconnect()}clearReconnectionTimer(){this._reconnectionTimer!==-1&&(clearTimeout(this._reconnectionTimer),this._reconnectionTimer=-1)}stopReconnection(){this._log.info("stop reconnection"),this._isReconnecting=!1,this._reconnectionCount=0,this.clearReconnectionTimer(),this._signalChannel.off(tl,this.reconnect,this)}beforeReconnect(){if(this._reconnectionTimer!==-1)return this._log.warn("reconnect() is reconnecting, ignore"),-1;if(this._reconnectionCount>=Lc()){this._log.warn("SDK has tried reconnect for ".concat(this._reconnectionCount," times, but all failed, please check your network")),this.stopReconnection();let e=new pe({code:this._isUplink?se.UPLINK_RECONNECTION_FAILED:se.DOWNLINK_RECONNECTION_FAILED,message:Ve({key:this._isUplink?xe.UPLINK_RECONNECTION_FAILED:xe.DOWNLINK_RECONNECTION_FAILED})});return this.emitConnectionStateChangedEvent("DISCONNECTED"),this._emitter.emit("error",e),-1}return this._signalChannel.isConnected?(this._reconnectionCount+=1,this._log.warn("reconnect() trying [".concat(this._reconnectionCount,"]")),1):(this._log.warn("reconnect() signal channel is not connected, suspend reconnection until signal is connected"),this._signalChannel.once(tl,this.reconnect,this),-1)}on(e,t,r){this._emitter.on(e,t,r)}off(e,t,r){this._emitter.off(e,t,r)}getIsReconnecting(){return this._isReconnecting}get isH264(){var e,t;return!((t=(e=this._peerConnection)==null?void 0:e.remoteDescription)==null||!t.sdp.includes("H264"))}},VR=lr(Sv()),$t=function(e){return VR.default.parse(e)},cs=function(e){return VR.default.write(e)};function cI(e){return Object.keys(e).filter(t=>e[t])}var jR=class extends Sa{constructor(e){super(Ke(_e({},e),{isUplink:!1})),T(this,"_flag",0),T(this,"role","anchor"),T(this,"remoteAudioTrack"),T(this,"remoteVideoTrack"),T(this,"remoteAuxiliaryTrack"),T(this,"ssrc",{audio:0,video:0,auxiliary:0}),T(this,"_isSDPExchanging",!1),this.flag=e.flag,this.remoteAudioTrack=e.remoteAudioTrack||new q_(this._room,this),this.remoteVideoTrack=e.remoteVideoTrack||new iu(this._room,this),this.remoteAuxiliaryTrack=e.remoteAuxiliaryTrack||new gR(this._room,this)}get videoCodec(){var e,t;let r=(t=(e=this._peerConnection)==null?void 0:e.remoteDescription)==null?void 0:t.sdp;return r?r.includes("H264")?"h264":"vp8":"h264"}get subscribeState(){let e={audio:!1,video:!1,auxiliary:!1,smallVideo:!1};return this.remoteVideoTrack.isSubscribed&&(8&this.remoteVideoTrack.mediaType?e.smallVideo=!0:e.video=!0),this.remoteAudioTrack.isSubscribed&&(e.audio=!0),this.remoteAuxiliaryTrack.isSubscribed&&(e.auxiliary=!0),e}get muteState(){return Hd(this.flag,this.userId)}get flag(){return this._flag}set flag(e){var t,r,i;e!==this._flag&&(this._flag=e,(t=this.remoteAudioTrack)==null||t.onFlagChanged(),(r=this.remoteVideoTrack)==null||r.onFlagChanged(),(i=this.remoteAuxiliaryTrack)==null||i.onFlagChanged())}get hasMainStream(){return this.muteState.hasAudio||this.muteState.hasVideo||this.muteState.hasSmall}get hasAuxStream(){return this.muteState.hasAuxiliary}get isMainStreamSubscribed(){return(this.subscribeState.audio||this.subscribeState.video||this.subscribeState.smallVideo)&&(this.muteState.hasAudio||this.muteState.hasVideo||this.muteState.hasSmall)}get isAuxStreamSubscribed(){return this.subscribeState.auxiliary&&this.muteState.hasAuxiliary}get isSmallStreamSubscribed(){return this.subscribeState.smallVideo&&this.muteState.hasSmall}get isBigStreamSubscribed(){return this.subscribeState.video&&this.muteState.hasVideo}isStreamUnpublished(e){return e===O.MAIN?!this.muteState.hasAudio&&!this.muteState.hasVideo:!this.muteState.hasAuxiliary}initialize(){super.initialize(),this.installEvents(),this._peerConnection.ontrack=this.onTrack.bind(this)}close(e){super.close(e),this.emitConnectionStateChangedEvent("DISCONNECTED"),this.remoteAudioTrack.close(),this.remoteVideoTrack.close(),this.remoteAuxiliaryTrack.close(),this.uninstallEvents()}installEvents(){}uninstallEvents(){this._emitter.removeAllListeners()}emitConnectionStateChangedEvent(e){var t,r;let i=this._currentState,n=super.emitConnectionStateChangedEvent(e);return n&&i!==e&&((t=this.remoteVideoTrack)==null||t.emit("connection-state-changed",{prevState:i,state:e}),(r=this.remoteAuxiliaryTrack)==null||r.emit("connection-state-changed",{prevState:i,state:e})),n}onTrack(e){let t=e.streams[0],{track:r}=e,i=t.id===Ch?O.MAIN:O.AUXILIARY;this._log.debug("ontrack ".concat(i," ").concat(r.kind));let n=O.AUDIO;r.kind===O.VIDEO&&(n=i===O.MAIN?O.VIDEO:O.AUXILIARY);let a=this.remoteAudioTrack;n===O.VIDEO?a=this.remoteVideoTrack:n===O.AUXILIARY&&(a=this.remoteAuxiliaryTrack),a.setInputMediaStreamTrack(r)}addRRTRLine(e){let t=e.split(`\r
`),r=new Map;t.forEach((n,a)=>{/^a=rtcp-fb:/.test(n)&&t[a+1]&&!/^a=rtcp-fb:/.test(t[a+1])&&r.set(a+1,"".concat(n.match(/^a=rtcp-fb:\d+/)[0]," rrtr"))});let i=[...r];for(let n=0;n<i.length;n++){let[a,c]=i[n];t.splice(a+n,0,c)}return t.join(`\r
`)}addSPSDescription(e){let t=$t(e);return t.media.forEach(r=>{r.type===O.VIDEO&&r.fmtp.forEach(i=>{i.config+=";sps-pps-idr-in-keyframe=1"})}),cs(t)}removeSDESDescription(e){let t=["urn:ietf:params:rtp-hdrext:sdes:mid","urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id","urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id"],r=$t(e);return r.media.forEach(i=>{!i.ext||(i.ext=i.ext.filter(n=>!t.includes(n.uri)))}),cs(r)}isSubscriptionStateNotChanged(e){return JSON.stringify(e)===JSON.stringify(this.subscribeState)}subscribe(e,t){return N(this,null,function*(){var r,i;try{if((((r=this._peerConnection)==null?void 0:r.connectionState)===Vt.NEW||((i=this._peerConnection)==null?void 0:i.connectionState)===Vt.CONNECTING)&&(yield this.waitForPeerConnectionConnected()),this.isSubscriptionStateNotChanged(e))return void(this._peerConnection||(this.initialize(),yield this.connect(e)));if(this._log.info("subscribe ".concat(t," ").concat(JSON.stringify(e))),this._peerConnection||this._isSDPExchanging){let n="subscribe_change";Object.values(e).find(a=>a===!0)||(n="unsubscribe"),yield this.sendSubscription(n,e)}else this.initialize(),yield this.connect(e)}catch(n){throw this._room.isJoined&&this.isStreamUnpublished(t)?(this._log.warn("".concat(n.message," ").concat(JSON.stringify(this.muteState))),new pe({code:se.REMOTE_STREAM_NOT_EXIST,message:"remote user ".concat(this.userId," unpublished stream")})):n}})}unsubscribe(e){return N(this,arguments,function(t){var r=this;let{remoteTracks:i,streamType:n}=t;return function*(){if(r._currentState==="CONNECTED"&&(n==="main"&&!r.isMainStreamSubscribed||n==="auxiliary"&&!r.isAuxStreamSubscribed))return void r._log.info("".concat(n," stream already unsubscribed"));let a=_e({},r.subscribeState);i.forEach(A=>{switch(A.mediaType){case 1:a.audio=!1;break;case 4:a.video=!1;break;case 8:a.smallVideo=!1;break;case 2:a.auxiliary=!1}});let c="subscribe_change";Object.values(a).find(A=>A===!0)||(c="unsubscribe"),r._log.info("".concat(c==="unsubscribe"?c:"subscribe"," ").concat(n," [").concat(cI(a),"]")),yield r.sendSubscription(c,a),c==="unsubscribe"&&(r.closePeerConnection(),r.emitConnectionStateChangedEvent("DISCONNECTED"))}()})}sendSubscription(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscribeState,r={srcTinyId:this.tinyId,srcUserId:this.userId},i=LR,n=ze.UNSUBSCRIBE_RESULT;return e==="subscribe_change"&&(r={audio:t.audio,bigVideo:t.video,auxVideo:t.auxiliary,smallVideo:t.smallVideo,srcTinyId:this.tinyId},i=QR,n=ze.SUBSCRIBE_CHANGE_RESULT),this._signalChannel.sendWaitForResponse({command:i,data:r,responseCommand:n,timeout:1e4}).then(a=>{let{data:c}=a;if(c.code!==0){let A=new pe({code:c.code,message:Ve({key:xe.ERROR_MESSAGE,data:{type:e,message:c.message}})});throw this._log.error(A),A}})}connect(){return N(this,arguments,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.subscribeState;return function*(){try{yield e.exchangeSDP(t),yield e.waitForPeerConnectionConnected()}catch(r){throw e.closePeerConnection(!0),r}}()})}exchangeSDP(e){return N(this,null,function*(){try{this._isSDPExchanging=!0,yield this.createOffer(),this._log.info("createOffer success, sending offer");let{type:t,sdp:r}=this._peerConnection.localDescription,i={type:t,sdp:r,srcUserId:this.userId,srcTinyId:this.tinyId,audio:e.audio,bigVideo:e.video,auxVideo:e.auxiliary,smallVideo:e.smallVideo},n=yield this._signalChannel.sendWaitForResponse({command:w1,commandDesc:"exchange sdp",data:i,responseCommand:ze.SUBSCRIBE_RESULT,timeout:jv});if(!this._peerConnection){let a=new pe({code:se.INVALID_OPERATION,message:Ve({key:xe.CONNECTION_CLOSED})});throw this._log.warn(a),a}yield this.onSubscribeResult(n),this._isSDPExchanging=!1}catch(t){throw this._isSDPExchanging=!1,t}})}createOffer(){return N(this,null,function*(){let e={voiceActivityDetection:!1};Kn()&&this._sdpSemantics===Td?(this._peerConnection.addTransceiver(O.AUDIO,{direction:$e.RECVONLY}),this._peerConnection.addTransceiver(O.VIDEO,{direction:$e.RECVONLY}),this._peerConnection.addTransceiver(O.VIDEO,{direction:$e.RECVONLY})):(e.offerToReceiveAudio=!0,e.offerToReceiveVideo=!0);let t=yield this._peerConnection.createOffer(e);if(t.sdp){let{isH264DecodeSupported:r}=yield S_();r||(this._log.warn("remove h264 desc from sdp"),t.sdp=function(i){let n=$t(i);return n.media.forEach(a=>{var c,A;if(a.type===O.VIDEO){let d=new Set;a.rtp.forEach(E=>{let{payload:f,codec:b}=E;return b==="H264"&&d.add(f)}),a.fmtp.forEach(E=>{let{payload:f,config:b}=E,w=b.match(/apt=(\d+)/);w&&w[1]&&d.has(Number(w[1]))&&d.add(f)});let g=E=>{let{payload:f}=E;return!d.has(f)};a.rtp=a.rtp.filter(g),a.rtcpFb=(c=a.rtcpFb)==null?void 0:c.filter(g),a.fmtp=a.fmtp.filter(g),a.payloads=(A=a.payloads)==null?void 0:A.split(" ").filter(E=>!d.has(Number(E))).join(" ")}}),cs(n)}(t.sdp)),t.sdp=this.addRRTRLine(t.sdp),t.sdp=this.addSPSDescription(t.sdp),t.sdp=function(i){let n=$t(i);return n.media.forEach(a=>{a.type===O.AUDIO&&a.fmtp.forEach(c=>{c.config+=";sprop-stereo=1;stereo=1"})}),cs(n)}(t.sdp),this._sdpSemantics===Td&&(t.sdp=this.removeSDESDescription(t.sdp))}yield this._peerConnection.setLocalDescription(t)})}onSubscribeResult(e){return N(this,null,function*(){let{code:t,message:r=""}=e&&e.data||{},{type:i,sdp:n}=e&&e.data&&e.data.data||{};if(t===Th)throw new pe({code:se.NOT_SUPPORTED_H264,message:Ve({key:xe.NOT_SUPPORTED_H264DECODE})});try{if(t!==0)throw new pe({code:t,message:Ve({key:xe.EXCHANGE_SDP_FAILED,data:{errMsg:r}})});this._log.debug("accept remote answer: ".concat(n)),yield this._peerConnection.setRemoteDescription({type:i,sdp:n}),this._sei&&(this._sei.handleEncodedStreams(),this._sei.onSEIMessage=a=>{this._emitter.emit("sei-message",Ke(_e({},a),{userId:this.userId}))}),this.updateSSRC(n)}catch(a){throw this._log.error(a),a}})}updateSSRC(e){try{$t(e).media.forEach(t=>{if(t.ssrcs)if(t.type===O.AUDIO){let r=t.ssrcs.find(i=>{var n;return(n=i.value)==null?void 0:n.includes(Ch)});r&&(this.ssrc.audio=Number(r.id))}else{let r=t.ssrcs.find(n=>{var a;return(a=n.value)==null?void 0:a.includes(Ch)}),i=t.ssrcs.find(n=>{var a;return(a=n.value)==null?void 0:a.includes(Lv)});r&&(this.ssrc.video=Number(r.id)),i&&(this.ssrc.auxiliary=Number(i.id))}})}catch{}}getMainStreamVideoTrackId(){return this.remoteVideoTrack&&this.remoteVideoTrack.mediaTrack?this.remoteVideoTrack.mediaTrack.id:""}getAuxStreamVideoTrackId(){return this.remoteAuxiliaryTrack&&this.remoteAuxiliaryTrack.mediaTrack?this.remoteAuxiliaryTrack.mediaTrack.id:""}reconnect(){return N(this,null,function*(){if(!(Ti(jR.prototype,this,"beforeReconnect").call(this)<0))try{this.closePeerConnection(),this.initialize(),yield this.connect(),this.stopReconnection(),this._log.warn("reconnect() success")}catch{let t=jc(this._reconnectionCount);this._log.warn("reconnect() timeout, try again after ".concat(t/1e3,"s")),this._reconnectionTimer=setTimeout(()=>{this.clearReconnectionTimer(),this.reconnect()},t)}})}getIsReconnecting(){return this._isReconnecting}clearReconnectionTimer(){this._reconnectionTimer!==-1&&(clearTimeout(this._reconnectionTimer),this._reconnectionTimer=-1)}getCurrentState(){return this._currentState}setDelay(e){let{audioDelay:t,videoDelay:r}=e;this.remoteAudioTrack.stat.end2EndDelay=t,this.remoteVideoTrack.stat.end2EndDelay=r}},lI=jR;le([St(e=>function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return new Promise((n,a)=>{let c=A=>{this._emitter.off("closed",c),a(new pe({code:se.API_CALL_ABORTED,message:Ve({key:xe.CONNECTION_ABORTED,data:A})}))};this._emitter.on("closed",c),e.apply(this,r).then(n,a).finally(()=>{this._emitter.off("closed",c)})})})],lI.prototype,"subscribe",1),le([X_(Sa.prototype.afterConnect),sR(Sa.prototype.beforeConnect)],lI.prototype,"connect",1);var HR=lI,GR={voiceActivityDetection:!1},YR=class extends Sa{constructor(e){super(Ke(_e({},e),{isUplink:!0})),T(this,"localMainAudioTrack",null),T(this,"localMainVideoTrack",null),T(this,"localAuxAudioTrack",null),T(this,"localAuxVideoTrack",null),T(this,"ssrc",{audio:0,video:0,small:0,auxiliary:0}),T(this,"_isPublishingAux",!1),T(this,"_publishingLocalAudioTrack"),T(this,"_publishingLocalVideoTrack"),T(this,"_mediaSettings",{videoCodec:"",videoWidth:0,videoHeight:0,videoBps:0,videoFps:0,audioCodec:"opus",audioFs:0,audioChannel:0,audioBps:0,smallVideoWidth:0,smallVideoHeight:0,smallVideoFps:0,smallVideoBps:0,auxVideoWidth:0,auxVideoHeight:0,auxVideoFps:0,auxVideoBps:0}),T(this,"flag",0)}get videoCodec(){return this._mediaSettings.videoCodec.toLowerCase()||"h264"}get isMainStreamPublished(){return!(!this.localMainAudioTrack&&!this.localMainVideoTrack)}get isAuxStreamPublished(){return!(!this.localAuxVideoTrack&&!this.localAuxAudioTrack)}get publishState(){var e,t,r,i;let n={audio:!1,bigVideo:!1,smallVideo:!1,auxVideo:!1};if(this._peerConnection){let a=this._peerConnection.getSenders();a&&(es()?(n.audio=!((e=a[0])==null||!e.track),n.bigVideo=!((t=a[1])==null||!t.track),n.smallVideo=!((r=a[2])==null||!r.track),n.auxVideo=!((i=a[3])==null||!i.track)):a.forEach(c=>{c.track&&(c.track.kind===O.AUDIO?n.audio=!0:(n.bigVideo=!0,this._room.videoManager.hasSmall&&(n.smallVideo=!0)))}))}return n}initialize(){super.initialize(),this.installEvents()}reset(){this._isReconnecting&&this.stopReconnection(),this.closePeerConnection(),this.uninstallEvents()}close(e){super.close(e),this.reset(),this.emitConnectionStateChangedEvent("DISCONNECTED")}installEvents(){this._emitter.listeners("connection-state-changed").includes(this.handleConnectionStateChange)||this._emitter.on("connection-state-changed",this.handleConnectionStateChange,this)}uninstallEvents(){this._emitter.off("connection-state-changed",this.handleConnectionStateChange,this)}emitConnectionStateChangedEvent(e,t){var r,i,n;let a=this._currentState,c=super.emitConnectionStateChangedEvent(e);return c&&a!==e&&(t?t.emit("connection-state-changed",{prevState:a,state:e}):((r=this.localMainVideoTrack)==null||r.emit("connection-state-changed",{prevState:a,state:e}),(i=this.localAuxVideoTrack)==null||i.emit("connection-state-changed",{prevState:a,state:e}),(n=this._publishingLocalVideoTrack)==null||n.emit("connection-state-changed",{prevState:a,state:e}))),c}publish(e){return N(this,arguments,function(t){var r=this;let{localAudioTrack:i,localVideoTrack:n,isAuxiliary:a}=t;return function*(){var c;let A;r._peerConnection||r.initialize(),i&&(r._publishingLocalAudioTrack=i),n&&(r._publishingLocalVideoTrack=n),r._isPublishingAux=a,n&&!a&&n.small&&(A=r._room.videoManager.smallTrack),r.sendMediaSettings(),Kn()?yield r.publishByTransceiver({localAudioTrack:i,localVideoTrack:n,smallTrack:A,isAuxiliary:a}):yield r.publishByAddTrack({localAudioTrack:i,localVideoTrack:n,smallTrack:A}),r._publishingLocalAudioTrack=null,r._publishingLocalVideoTrack=null,r._isPublishingAux=!1,a?(n&&(r.localAuxVideoTrack=n),i&&(r.localAuxAudioTrack=i)):(n&&(r.localMainVideoTrack=n),i&&(r.localMainAudioTrack=i)),(c=r._sei)==null||c.handleEncodedStreams(),r.installTrackMuteEvents(i,n),r.sendMutedFlag()}()})}publishByTransceiver(e){return N(this,arguments,function(t){var r=this;let{localAudioTrack:i,localVideoTrack:n,smallTrack:a,isAuxiliary:c}=t;return function*(){r._log.info("publish by transceiver");let A=new MediaStream,d=n==null?void 0:n.outMediaTrack,g=i==null?void 0:i.outMediaTrack;g&&A.addTrack(g),d&&A.addTrack(d);let E=r._peerConnection.getTransceivers();if(E.length===0)r._peerConnection.addTransceiver(g||O.AUDIO,{direction:$e.SENDONLY,streams:[A]}),r._peerConnection.addTransceiver(c?O.VIDEO:d||O.VIDEO,{direction:$e.SENDONLY,streams:[A]}),r._peerConnection.addTransceiver(a||O.VIDEO,{direction:$e.SENDONLY,streams:[A]}),r._peerConnection.addTransceiver(c&&d||O.VIDEO,{direction:$e.SENDONLY,streams:[A]}),yield r.connect();else{let f=[];if(g&&(E[0].sender.track||f.push(0),yield E[0].sender.replaceTrack(g),yield r.setBandwidth({bandwidth:(i==null?void 0:i.profile.bitrate)||40,type:O.AUDIO})),d){let b=c?3:1;yield E[b].sender.replaceTrack(d),yield r.setBandwidth({bandwidth:n.profile.bitrate,type:O.VIDEO,videoType:c?O.AUXILIARY:O.BIG}),f.push(b),a&&(yield E[2].sender.replaceTrack(a),yield r.setBandwidth({bandwidth:n.small.bitrate,type:O.VIDEO,videoType:O.SMALL}),f.push(2))}yield r.setTransceiverDirection($e.SENDONLY,f),yield r.doPublishChange(),n==null||n.emit("connection-state-changed",{prevState:"DISCONNECTED",state:"CONNECTING"}),n==null||n.emit("connection-state-changed",{prevState:"CONNECTING",state:"CONNECTED"})}}()})}publishByAddTrack(e){return N(this,arguments,function(t){var r=this;let{localAudioTrack:i,localVideoTrack:n,smallTrack:a}=t;return function*(){r._log.info("publish by addtrack");let c=n==null?void 0:n.outMediaTrack,A=i==null?void 0:i.outMediaTrack;if(r._peerConnection&&r._peerConnection.connectionState!=="new")return i&&A&&(yield r.addTrack(i)),void(c&&(yield r.addTrack(n)));let d=new MediaStream;if(A&&d.addTrack(A),c&&d.addTrack(c),A&&r._peerConnection.addTrack(A,d),c&&(r._peerConnection.addTrack(c,d),a)){let g=new MediaStream;g.addTrack(a),r._peerConnection.addTrack(a,g)}yield r.connect()}()})}enableSmall(e){return N(this,null,function*(){let t=this._peerConnection.getTransceivers();e?this._room.videoManager.smallTrack&&(yield t[2].sender.replaceTrack(this._room.videoManager.smallTrack),yield this.setTransceiverDirection($e.SENDONLY,[2])):(yield t[2].sender.replaceTrack(null),yield this.setTransceiverDirection($e.INACTIVE,[2])),this.updateMediaSettings(),yield this.doPublishChange()})}installTrackMuteEvents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach(i=>{i&&(i==null||i.on("mute",this.sendMutedFlag,this),i==null||i.on("unmute",this.sendMutedFlag,this))})}uninstallTrackMuteEvents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach(i=>{i&&(i==null||i.off("mute",this.sendMutedFlag,this),i==null||i.off("unmute",this.sendMutedFlag,this))})}unpublish(e){return N(this,arguments,function(t){var r=this;let{localAudioTrack:i,localVideoTrack:n}=t;return function*(){if(!es())return i&&i.outMediaTrack&&!n&&r.localMainVideoTrack?(yield r.removeTrack(i),void(r.localMainAudioTrack=null)):n&&n.outMediaTrack&&!i&&r.localMainAudioTrack?(yield r.removeTrack(n),void(r.localMainVideoTrack=null)):(yield r.doUnpublish(),r.uninstallTrackMuteEvents(i,n),void r.emitConnectionStateChangedEvent("DISCONNECTED",n));let a=n&&n===r.localAuxVideoTrack,c=n==null?void 0:n.outMediaTrack,A=r._peerConnection.getSenders(),d=[];i&&(yield A[0].replaceTrack(null),d.push(0),a?r.localAuxAudioTrack=null:r.localMainAudioTrack=null),c&&(a?(yield A[3].replaceTrack(null),r.localAuxVideoTrack=null,r._mediaSettings=Ke(_e({},r._mediaSettings),{auxVideoBps:0,auxVideoFps:0,auxVideoWidth:0,auxVideoHeight:0}),d.push(3)):(yield A[1].replaceTrack(null),yield A[2].replaceTrack(null),r.localMainVideoTrack=null,r._mediaSettings=Ke(_e({},r._mediaSettings),{videoWidth:0,videoHeight:0,videoBps:0,videoFps:0,audioFs:0,audioChannel:0,audioBps:0,smallVideoWidth:0,smallVideoHeight:0,smallVideoFps:0,smallVideoBps:0}),d.push(1,2))),r.isMainStreamPublished||r.isAuxStreamPublished?(yield r.setTransceiverDirection($e.INACTIVE,d),yield r.doPublishChange(!1)):yield r.doUnpublish(),r.uninstallTrackMuteEvents(i,n),n==null||n.emit("connection-state-changed",{prevState:r._currentState,state:"DISCONNECTED"})}()})}doPublishChange(){let e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return N(this,null,function*(){let t={state:this.publishState,constraintConfig:this._mediaSettings},r=yield this._signalChannel.sendWaitForResponse({command:MR,data:t,responseCommand:ze.PUBLISH_STATE_CHANGE_RESULT,enableLog:e});this.checkPublishResultCode(r.data.code,r.data.message)})}doUnpublish(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return this._signalChannel.sendWaitForResponse({command:oI,commandDesc:"unpublish",responseCommand:ze.UNPUBLISH_RESULT,enableLog:e}).catch(t=>{if(t.getCode()===se.API_CALL_TIMEOUT)return Promise.resolve();throw t})}updateMediaSettings(){let{detail:{isH264EncodeSupported:e,isVp8EncodeSupported:t}}=this._room.checkSystemResult;e?this._mediaSettings.videoCodec="H264":t&&(this._mediaSettings.videoCodec="VP8");let r=this._publishingLocalAudioTrack||this.localMainAudioTrack||this.localAuxAudioTrack,{localMainVideoTrack:i,localAuxVideoTrack:n}=this;if(this._publishingLocalVideoTrack&&(this._isPublishingAux?n=this._publishingLocalVideoTrack:i=this._publishingLocalVideoTrack),Hc){if(r&&r.outMediaTrack){let a=r.outMediaTrack.getSettings();this._mediaSettings.audioChannel=a.channelCount||1,this._mediaSettings.audioBps=1e3*r.profile.bitrate,this._mediaSettings.audioFs=a.sampleRate||0}if(i&&i.outMediaTrack){let a=i.outMediaTrack.getSettings();this._mediaSettings.videoWidth=a.width||0,this._mediaSettings.videoHeight=a.height||0,this._mediaSettings.videoFps=a.frameRate||0,this._mediaSettings.videoBps=1e3*i.profile.bitrate,i.small&&(this._mediaSettings.smallVideoWidth=i.small.width,this._mediaSettings.smallVideoHeight=i.small.height,this._mediaSettings.smallVideoFps=i.small.frameRate,this._mediaSettings.smallVideoBps=1e3*i.small.bitrate)}if(n&&n.outMediaTrack){let a=n.outMediaTrack.getSettings();this._mediaSettings.auxVideoWidth=a.width||0,this._mediaSettings.auxVideoHeight=a.height||0,this._mediaSettings.auxVideoFps=a.frameRate||0,this._mediaSettings.auxVideoBps=1e3*n.profile.bitrate}}else r&&r.outMediaTrack&&(this._mediaSettings.audioChannel=r.profile.channelCount,this._mediaSettings.audioBps=1e3*r.profile.bitrate,this._mediaSettings.audioFs=r.profile.sampleRate),i&&i.outMediaTrack&&(this._mediaSettings.videoWidth=i.profile.width,this._mediaSettings.videoHeight=i.profile.height,this._mediaSettings.videoFps=i.profile.frameRate,this._mediaSettings.videoBps=1e3*i.profile.bitrate);this._log.info("updateMediaSettings: ".concat(JSON.stringify(this._mediaSettings)))}sendMediaSettings(){this.updateMediaSettings(),this._signalChannel.sendWaitForResponse({command:xR,data:this._mediaSettings,responseCommand:ze.UPDATE_CONSTRAINT_CONFIG_RES}).then(e=>{e.data.code!==0&&this._log.warn(e.data.message)}).catch(()=>{})}addTrack(e){return N(this,null,function*(){var t;if(!this._peerConnection)return;let r=e===this.localAuxAudioTrack||e===this.localAuxVideoTrack;this._log.info("is adding ".concat(e.kind," track to current published local ").concat(r?O.AUXILIARY:O.MAIN," stream")),(t=this._sei)==null||t.handleEncodedStreams(),Kn()?yield this.addTrackByTransceiver(e,r):yield this.addTrackBySender(e)})}addTrackByTransceiver(e,t){return N(this,null,function*(){var r;if(!e.mediaTrack)return;let i=this._peerConnection.getTransceivers();if(e.kind===O.AUDIO)yield i[0].sender.replaceTrack(e.outMediaTrack);else{let n=t?3:1;yield i[n].sender.replaceTrack(e.outMediaTrack),n===1&&((r=this.localMainVideoTrack)!=null&&r.small)&&(yield i[2].sender.replaceTrack(this._room.videoManager.smallTrack)),i[n].direction===$e.INACTIVE&&(yield this.setTransceiverDirection($e.SENDONLY,[n]))}this.updateMediaSettings(),yield this.doPublishChange()})}addTrackBySender(e){return N(this,null,function*(){if(!e.outMediaTrack)return;let t=e.outMediaTrack;es()&&this._peerConnection.getTransceivers().findIndex(i=>i.direction==="stopped")>=0&&(this._log.warn("transceiver is stopping, negotiate sdp first"),yield this.updateOffer("remove",t));let r=this._peerConnection.getSenders().find(i=>i.track&&i.track.kind===t.kind);if(r&&r.track){this._log.warn("sender already exists, remove sender first");let i=r.track;this.removeSender(r),yield this.updateOffer("remove",i)}if(t&&this._peerConnection.addTrack(t,new MediaStream([t])),t.kind===O.VIDEO&&e instanceof ti&&e.small){let i=new MediaStream,{smallTrack:n}=this._room.videoManager;i.addTrack(n),this._peerConnection.addTrack(n,i)}yield this.updateOffer("add",t)})}isNeedToResetOfferOrder(){if(this._sdpSemantics===yh||!this._peerConnection||!this._peerConnection.localDescription)return!1;let{sdp:e}=this._peerConnection.localDescription,t=$t(e);for(let r=0;r<t.media.length;r++)if(Number(t.media[r].mid)===0&&t.media[r].type===O.VIDEO)return!0;return!1}removeSender(e){let t=null;es()&&(t=this._peerConnection.getTransceivers().find(r=>r.sender&&r.sender.track===e.track)),this._peerConnection.removeTrack(e),t&&mt(t.stop)&&(this._log.info("stop transceiver"),t.stop())}removeTrack(e){return N(this,null,function*(){if(!this._peerConnection)return;let t=e===this.localAuxAudioTrack||e===this.localAuxVideoTrack;this._log.info("is removing ".concat(e.kind," track from current published local ").concat(t?O.AUXILIARY:O.MAIN," stream")),Kn()?yield this.removeTrackByTransceiver(e,t):yield this.removeTrackBySender(e)})}removeTrackByTransceiver(e,t){return N(this,null,function*(){if(!e.outMediaTrack)return;let r=this._peerConnection.getTransceivers();if(e.kind===O.AUDIO)yield r[0].sender.replaceTrack(null);else{let i=t?3:1;yield r[i].sender.replaceTrack(null),i===1&&e.small&&(yield r[2].sender.replaceTrack(null)),yield this.setTransceiverDirection($e.INACTIVE,[i])}this.updateMediaSettings(),yield this.doPublishChange()})}setTransceiverDirection(e,t){return N(this,null,function*(){if(!Rt)return;let r=!1,i=!1;this._log.info("setting transceiver ".concat(t.join(",")," direction to ").concat(e));let n=this._peerConnection.getTransceivers();if(t.forEach(A=>{n[A].direction!==e&&(n[A].direction=e,r=!0)}),r){this._log.info("updating offer");let A=yield this._peerConnection.createOffer();yield this._peerConnection.setLocalDescription(A)}let a=-1,c=this._peerConnection.remoteDescription.sdp.split(`\r
`).map(A=>{if(A.match(new RegExp("a=(".concat($e.INACTIVE,"|").concat($e.RECVONLY,"|").concat($e.SENDONLY,")")))&&a++,t.includes(a)){if(e===$e.INACTIVE&&A.includes("a=".concat($e.RECVONLY)))return i=!0,"a=".concat(e);if(e===$e.SENDONLY&&A.includes("a=".concat($e.INACTIVE)))return i=!0,"a=".concat($e.RECVONLY)}return A}).join(`\r
`);i&&(this._log.info("updating answer"),yield this._peerConnection.setRemoteDescription({type:"answer",sdp:c}))})}removeTrackBySender(e){return N(this,null,function*(){if(!e.outMediaTrack)return;if(e.kind===O.VIDEO&&this.isNeedToResetOfferOrder()&&this.localMainAudioTrack)return this.reset(),this.initialize(),void(yield this.publish({localAudioTrack:this.localMainAudioTrack,isAuxiliary:!1}));let t=this._peerConnection.getSenders().find(r=>r.track===e.outMediaTrack);t&&(this.removeSender(t),e.kind===O.VIDEO&&e.small&&this._peerConnection.getSenders().forEach(r=>{r.track&&r.track.kind===O.VIDEO&&this.removeSender(r)})),yield this.updateOffer("remove",e.outMediaTrack)})}replaceTrack(e){return N(this,null,function*(){var t;let r,i=(t=this._peerConnection)==null?void 0:t.getSenders();if(!i||i.length===0||!e.mediaTrack||(r=Kn()?e.kind===O.AUDIO?i[0]:i[1]:i.find(a=>a.track&&a.track.kind===e.kind),!r))return!1;let n=e===this.localAuxAudioTrack||e===this.localAuxVideoTrack;return this._log.info("is replacing ".concat(e.kind," track on ").concat(n?O.AUXILIARY:O.MAIN," stream")),e.kind===O.AUDIO?yield r.replaceTrack(e.outMediaTrack):e.kind===O.VIDEO&&(n?i[3]&&(yield i[3].replaceTrack(e.outMediaTrack)):yield r.replaceTrack(e.outMediaTrack)),!0})}updateOffer(e,t){return N(this,null,function*(){try{let r=yield this._peerConnection.createOffer(GR);Rt&&r.sdp&&(r.sdp=this.setSDPDirection(r.sdp,"sendrecv")),yield this._peerConnection.setLocalDescription(r);let i=this.updateMediaSettings(),n={action:e,trackId:t.id,kind:t.kind===O.VIDEO?"bigVideo":t.kind,type:"offer",sdp:this._peerConnection.localDescription.sdp,constraintConfig:i,state:this.publishState};this._log.info("createOffer success, sending updated offer to remote server"),this._log.debug("updatedOffer: ".concat(n.sdp));let a=yield this._signalChannel.sendWaitForResponse({command:T1,data:n,responseCommand:ze.UPDATE_OFFER_RESULT,timeout:Vv,commandDesc:"update offer"}),{code:c,message:A}=a.data;c!==0&&this.checkPublishResultCode(c,A),yield this.acceptAnswer(a.data.data),r.sdp&&this.updateSSRC(r.sdp)}catch(r){throw this._log.error(r),r}})}setBandwidth(e){return N(this,arguments,function(t){var r=this;let{bandwidth:i,type:n,videoType:a,sdp:c}=t;return function*(){if(!b_())return c?n===O.VIDEO?r.updateVideoBandwidthRestriction(c,i,a):r.updateAudioBandwidthRestriction(c,i):void 0;let A,d=r._peerConnection.getSenders();if(Kn()){let g=0;n===O.VIDEO&&(g=a===O.SMALL?2:a===O.AUXILIARY?3:1),A=d[g]}else A=d.find(g=>g.track&&g.track.kind===n);if(A){let g=A.getParameters();(!g.encodings||g.encodings.length===0)&&(g.encodings=[{}]),g.encodings[0].maxBitrate=1e3*i;try{return yield A.setParameters(g),r._log.info("".concat(a||"").concat(n," bandwidth ").concat(i," kbps")),c}catch(E){if(r._log.info("failed to set bandwidth by setting maxBitrate: ".concat(E)),c)return n===O.VIDEO?r.updateVideoBandwidthRestriction(c,i,a):r.updateAudioBandwidthRestriction(c,i)}}return c}()})}updateVideoBandwidthRestriction(e,t,r){let i="AS";Rt&&(i="TIAS",t*=1e3);let n=0,a=-1;return r===O.SMALL?n=1:r===O.AUXILIARY&&(n=2),e=e.replace(/m=video (.*)\r\nc=IN (.*)\r\n/g,c=>(a+=1,a===n?"".concat(c,"b=").concat(i,":").concat(t,`\r
`):c))}updateAudioBandwidthRestriction(e,t){let r="AS";return Rt&&(r="TIAS",t*=1e3),e=e.replace(/m=audio (.*)\r\nc=IN (.*)\r\n/,`m=audio $1\r
c=IN $2\r
b=`.concat(r,":").concat(t,`\r
`))}removeBandwidthRestriction(e){return e.replace(/b=AS:.*\r\n/,"").replace(/b=TIAS:.*\r\n/,"")}removeVideoOrientation(e){return e.replace(/urn:3gpp:video-orientation/,"")}connect(){return N(this,null,function*(){try{yield this.exchangeSDP(),yield this.waitForPeerConnectionConnected()}catch(e){throw this.closePeerConnection(!0),this.uninstallEvents(),e}})}exchangeSDP(){return N(this,null,function*(){try{yield this.createOffer(),this._log.info("createOffer success, sending offer to remote server"),yield this.doExchangeSDP()}catch(e){throw e}})}createOffer(){return N(this,null,function*(){try{let e=yield this._peerConnection.createOffer(GR);yield this._peerConnection.setLocalDescription(e),e.sdp&&this.updateSSRC(e.sdp)}catch(e){throw e}})}doExchangeSDP(){let e={command:b1,responseCommand:ze.PUBLISH_RESULT,data:{type:this._peerConnection.localDescription.type,sdp:this.removeVideoOrientation(this._peerConnection.localDescription.sdp),screen:this.localMainVideoTrack instanceof Ia||this.localAuxVideoTrack instanceof Ia,state:this.publishState,constraintConfig:this._mediaSettings},enableLog:!1};return this._log.debug("sending sdp offer: ".concat(e.data.sdp)),this._signalChannel.sendWaitForResponse(e).then(t=>{let{code:r,message:i,data:n}=t.data;return r===0?this.acceptAnswer(n):this.checkPublishResultCode(r,i)})}setSDPDirection(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"all",i=$t(e);return i.media.forEach(n=>{(r==="all"||n.type===r)&&(n.direction=t)}),cs(i)}acceptAnswer(e){return N(this,null,function*(){var t,r,i,n,a;try{let c;if(this._publishingLocalAudioTrack||this._publishingLocalVideoTrack||this.isMainStreamPublished){let d=((t=this._publishingLocalVideoTrack)==null?void 0:t.profile.bitrate)||((r=this.localMainVideoTrack)==null?void 0:r.profile.bitrate),g=((i=this._publishingLocalAudioTrack)==null?void 0:i.profile.bitrate)||((n=this.localMainAudioTrack)==null?void 0:n.profile.bitrate);if(d){let E=this._isPublishingAux?O.AUXILIARY:O.BIG;c=yield this.setBandwidth({bandwidth:d,type:O.VIDEO,sdp:c,videoType:E})}g&&(c=yield this.setBandwidth({bandwidth:g,type:O.AUDIO,sdp:c}))}if(c=this.removeVideoOrientation(e.sdp),(a=this._publishingLocalVideoTrack)!=null&&a.small){let{smallStreamConfig:d}=this._room;c=yield this.setBandwidth({bandwidth:this._publishingLocalVideoTrack.small.bitrate||d.bitrate,type:O.VIDEO,videoType:O.SMALL,sdp:c})}let A={type:e.type,sdp:c};yield this._peerConnection.setRemoteDescription(A),this._log.debug("accepted answer: ".concat(c))}catch(c){throw this._log.error("failed to accept remote answer ".concat(c)),c}})}sendMutedFlag(e){var t,r,i;if(e===this.localAuxAudioTrack||e===this.localAuxVideoTrack)return;let n={audio:!((t=this.localMainAudioTrack)==null||!t.muted),bigVideo:!((r=this.localMainVideoTrack)==null||!r.muted),auxVideo:!((i=this.localAuxVideoTrack)==null||!i.muted)};this._log.info("send muted state: ".concat(JSON.stringify(n))),this._signalChannel.send(PR,n)}getIsReconnecting(){return this._isReconnecting}reconnect(){return N(this,null,function*(){if(!(Ti(YR.prototype,this,"beforeReconnect").call(this)<0))try{yield this._signalChannel.sendWaitForResponse({command:oI,responseCommand:ze.UNPUBLISH_RESULT,enableLog:!1}),this.closePeerConnection(),this.initialize(),this.isMainStreamPublished&&(yield this.publish({localAudioTrack:this.localMainAudioTrack,localVideoTrack:this.localMainVideoTrack,isAuxiliary:!1})),this.isAuxStreamPublished&&(yield this.publish({localAudioTrack:this.localAuxAudioTrack,localVideoTrack:this.localAuxVideoTrack,isAuxiliary:!0})),this._log.warn("reconnect() uplink reconnect successfully"),this.stopReconnection()}catch{let t=jc(this._reconnectionCount);this._log.warn("reconnect() timeout, try again after ".concat(t/1e3,"s")),this._reconnectionTimer=setTimeout(()=>{this.clearReconnectionTimer(),this.reconnect()},t)}})}handleConnectionStateChange(e){e.state==="CONNECTED"&&(this.localMainVideoTrack||this._publishingLocalVideoTrack&&!this._isPublishingAux)&&te.emit(X.SEND_FIRST_VIDEO_FRAME,{room:this._room})}updateSSRC(e){try{$t(e).media.forEach((t,r)=>{if(t.type===O.AUDIO){let i=t.ssrcs&&t.ssrcs[0];i&&(this.ssrc.audio=Number(i.id))}else{if(this._sdpSemantics===yh&&t.ssrcGroups)return void t.ssrcGroups.forEach((n,a)=>{let c=Number(n.ssrcs.split(" ")[0]);a===0?this.ssrc.video=c:a===1&&(this.ssrc.small=c)});let i=t.ssrcs&&t.ssrcs[0];if(!i)return;switch(r){case 1:this.ssrc.video=Number(i.id);break;case 2:this.ssrc.small=Number(i.id);break;case 3:this.ssrc.auxiliary=Number(i.id)}}})}catch{}}getVideoTrackId(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:O.VIDEO;if(this._peerConnection){let t=this._peerConnection.getSenders();if(e===O.AUXILIARY&&t[3]&&t[3].track)return t[3].track.id;if(e===O.VIDEO&&t[1]&&t[1].track)return t[1].track.id}if(this.localMainVideoTrack&&e===O.VIDEO){let t=this.localMainVideoTrack.mediaTrack;if(t)return t.id}if(this.localAuxVideoTrack&&e===O.AUXILIARY){let t=this.localAuxVideoTrack.mediaTrack;if(t)return t.id}return""}getSSRC(){return this.ssrc}checkPublishResultCode(e,t){if(e!==0)throw e===Th?(this._log.error(xi.NOT_SUPPORTED_H264ENCODE),new pe({code:se.NOT_SUPPORTED_H264,message:Ve({key:xe.NOT_SUPPORTED_H264ENCODE})})):new pe({code:se.UNKNOWN,message:Ve({key:xe.SIGNAL_RESPONSE_FAILED,data:{signalResponse:ze.PUBLISH_RESULT,code:e,message:t}})})}sendSEI(e,t){var r;(r=this._sei)==null||r.push(e,t)}},dI=YR;le([St(e=>function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return new Promise((n,a)=>{let c=A=>{this._emitter.off("closed",c),a(new pe({code:se.API_CALL_ABORTED,message:Ve({key:xe.CONNECTION_ABORTED,data:A})}))};this._emitter.on("closed",c),e.apply(this,r).then(n,a).finally(()=>{this._emitter.off("closed",c)})})})],dI.prototype,"publish",1),le([X_(Sa.prototype.afterConnect),sR(Sa.prototype.beforeConnect)],dI.prototype,"connect",1);var uI=dI,Y1=class{constructor(e,t){this.room=e,T(this,"_log"),T(this,"_prevReportTime",0),T(this,"_prevReport",{}),T(this,"_prevStats",null),T(this,"_prevEncoderImplementation",""),T(this,"_prevQualityLimitationReason",""),T(this,"_prevAuxQualityLimitationReason",""),T(this,"_prevDecoderImplementationMap",new Map),T(this,"totalBytesSent",0),T(this,"totalBytesReceived",0),T(this,"_spcStats",null),this._log=t}get statInterval(){return this._prevReportTime===0?2:(Date.now()-this._prevReportTime)/1e3}getSenderStats(e){return N(this,null,function*(){let t={audio:{bytesSent:0,packetsSent:0,audioLevel:0,totalAudioEnergy:0},video:{bytesSent:0,packetsSent:0,framesEncoded:0,frameWidth:0,frameHeight:0,framesSent:0,fpsCapture:0},small:{bytesSent:0,packetsSent:0,framesEncoded:0,frameWidth:0,frameHeight:0,framesSent:0,fpsCapture:0},auxiliary:{bytesSent:0,packetsSent:0,framesEncoded:0,frameWidth:0,frameHeight:0,framesSent:0,fpsCapture:0},rtt:0},r=e.getPeerConnection(),i=e.getSSRC();if(r)try{if((this._spcStats||(yield r.getStats())).forEach(n=>{var a,c,A;if(n.type==="outbound-rtp")if((n.mediaType||n.kind)===O.VIDEO){let d,g;if(n.ssrc===i.video?(d=O.VIDEO,g=e.localMainVideoTrack):n.ssrc===i.small?d=O.SMALL:n.ssrc===i.auxiliary&&(g=e.localAuxVideoTrack,d=O.AUXILIARY),!d)return;if(t[d].bytesSent=n.bytesSent,t[d].packetsSent=n.packetsSent,t[d].framesEncoded=n.framesEncoded,K(n.keyFramesEncoded)||(t[d].keyFramesEncoded=n.keyFramesEncoded),K(n.nackCount)||(t[d].nackCount=n.nackCount),K(n.pliCount)||(t[d].pliCount=n.pliCount),K(n.retransmittedPacketsSent)||(t[d].retransmittedPacketsSent=n.retransmittedPacketsSent),K(n.totalEncodeTime)||(t[d].totalEncodeTime=n.totalEncodeTime),K(n.totalPacketSendDelay)||(t[d].totalPacketSendDelay=n.totalPacketSendDelay),n.ssrc===i.video){if(!K(n.encoderImplementation)&&this._prevEncoderImplementation!==n.encoderImplementation){te.emit("262",{userId:e.userId,prevImplementation:this._prevEncoderImplementation,implementation:n.encoderImplementation,codec:e.videoCodec,isHWCodec:n.powerEfficientEncoder}),this._prevEncoderImplementation=n.encoderImplementation;let E="".concat(n.encoderImplementation,"(").concat(e.videoCodec,")");this._log.info("encoderImplementation change to ".concat(E," HWEncoder: ").concat(n.powerEfficientEncoder))}!K(n.qualityLimitationReason)&&n.bytesSent!==0&&this._prevQualityLimitationReason!==n.qualityLimitationReason&&(this._log.info("qualityLimitationReason change to ".concat(n.qualityLimitationReason)),te.emit("263",{userId:e.userId,reason:n.qualityLimitationReason,prevReason:this._prevQualityLimitationReason,streamType:2,isQosClearFirst:(a=e.localMainVideoTrack)==null?void 0:a.isQosClearFirst}),this._prevQualityLimitationReason=n.qualityLimitationReason)}else n.ssrc===i.auxiliary&&!K(n.qualityLimitationReason)&&n.bytesSent!==0&&this._prevAuxQualityLimitationReason!==n.qualityLimitationReason&&(this._log.info("aux qualityLimitationReason change to ".concat(n.qualityLimitationReason)),te.emit("263",{userId:e.userId,reason:n.qualityLimitationReason,prevReason:this._prevAuxQualityLimitationReason,streamType:7,isQosClearFirst:(c=e.localAuxVideoTrack)==null?void 0:c.isQosClearFirst}),this._prevAuxQualityLimitationReason=n.qualityLimitationReason)}else t.audio.bytesSent=n.bytesSent,t.audio.packetsSent=n.packetsSent;else n.type==="candidate-pair"?Wd(n)&&qt(n.currentRoundTripTime)&&(t.rtt=Math.floor(1e3*n.currentRoundTripTime),this.totalBytesSent=n.bytesSent):n.type==="media-source"&&(n.kind===O.AUDIO?(t.audio.audioLevel=n.audioLevel||0,t.audio.totalAudioEnergy=n.totalAudioEnergy||0,n.echoReturnLoss,n.totalSamplesDuration&&(t.audio.totalSamplesDuration=n.totalSamplesDuration)):n.kind===O.VIDEO&&(n.trackIdentifier===e.getVideoTrackId(O.VIDEO)?t.video.fpsCapture=n.framesPerSecond:n.trackIdentifier===e.getVideoTrackId(O.AUXILIARY)?t.auxiliary.fpsCapture=n.framesPerSecond:t.small.fpsCapture=n.framesPerSecond));if(!K(n.audioLevel)&&((A=e.localMainAudioTrack)!=null&&A.mediaTrack)&&n.trackIdentifier===e.localMainAudioTrack.mediaTrack.id&&(t.audio.audioLevel=n.audioLevel||0),!K(n.frameWidth)){let d=O.SMALL;n.trackIdentifier===e.getVideoTrackId(O.VIDEO)||n.ssrc===i.video?d=O.VIDEO:(n.trackIdentifier===e.getVideoTrackId(O.AUXILIARY)||n.ssrc===i.auxiliary)&&(d=O.AUXILIARY),t[d].frameWidth=n.frameWidth,t[d].frameHeight=n.frameHeight,t[d].framesSent=n.framesSent}}),e.localMainAudioTrack){let n=e.localMainAudioTrack.getInternalAudioLevel();t.audio.micAudioLevel=n,t.audio.audioLevel===0&&(t.audio.audioLevel=n)}this.totalBytesSent||(this.totalBytesSent+=t.audio.bytesSent+t.video.bytesSent+t.auxiliary.bytesSent)}catch(n){this._log.warn("failed to getStats on sender connection ".concat(n))}return t})}getReceiverStats(e){return N(this,null,function*(){let t={tinyId:e.tinyId,userId:e.userId,rtt:0,hasAudio:!1,hasVideo:!1,hasAuxiliary:!1,isSmallSubscribed:!1,audio:{bytesReceived:0,packetsReceived:0,packetsLost:0,p2pDelay:0,totalJitter:0,totalJitterCount:0,audioLevel:0,totalAudioEnergy:0,insertedSamplesForDeceleration:0,removedSamplesForAcceleration:0},video:{bytesReceived:0,packetsReceived:0,packetsLost:0,framesReceived:0,framesDecoded:0,frameWidth:0,frameHeight:0,fpsDecoded:0,freezeCount:0,totalFreezesDuration:0,totalJitter:0,totalJitterCount:0},auxiliary:{bytesReceived:0,packetsReceived:0,packetsLost:0,framesReceived:0,framesDecoded:0,frameWidth:0,frameHeight:0,fpsDecoded:0,totalJitter:0,totalJitterCount:0}},r=e.getPeerConnection();if(r)try{let{ssrc:i}=e,{muteState:n,subscribeState:a}=e;(this._spcStats||(yield r.getStats())).forEach(c=>{if(c.type==="inbound-rtp"){let A=(c.mediaType||c.kind)===O.AUDIO;if(A){if(c.ssrc!==i.audio||!n.hasAudio)return;t.audio.packetsReceived=c.packetsReceived,t.audio.bytesReceived=c.bytesReceived,t.audio.packetsLost=c.packetsLost,c.insertedSamplesForDeceleration&&(t.audio.insertedSamplesForDeceleration=c.insertedSamplesForDeceleration),c.removedSamplesForAcceleration&&(t.audio.removedSamplesForAcceleration=c.removedSamplesForAcceleration),c.totalSamplesDuration&&(t.audio.totalSamplesDuration=c.totalSamplesDuration),c.totalSamplesReceived&&(t.audio.totalSamplesReceived=c.totalSamplesReceived),c.concealedSamples&&(t.audio.concealedSamples=c.concealedSamples);let{remoteAudioTrack:d}=e;d.stat.packetsReceived=c.packetsReceived,d.stat.bytesReceived=c.bytesReceived,d.stat.packetsLost=c.packetsLost,t.audio.p2pDelay=d.stat.end2EndDelay,t.hasAudio=!0}else{if(Rt&&c.bytesReceived===0)return;let d;c.ssrc===i.video&&n.hasVideo&&(t.video.packetsReceived=c.packetsReceived,t.video.bytesReceived=c.bytesReceived,t.video.packetsLost=c.packetsLost,t.video.framesReceived=c.framesReceived,t.video.framesDecoded=c.framesDecoded,t.video.fpsDecoded=c.framesPerSecond,t.hasVideo=!0,d=e.remoteVideoTrack,n.hasSmall&&a.smallVideo&&(t.isSmallSubscribed=!0),c.decoderImplementation&&(!this._prevDecoderImplementationMap.has(t.userId)||this._prevDecoderImplementationMap.get(t.userId)!==c.decoderImplementation)&&(this._log.info("".concat(t.userId," decoderImplementation change to ").concat(c.decoderImplementation," HWDecoder: ").concat(c.powerEfficientDecoder)),te.emit("262",{userId:this.room.userId,remoteUserId:t.userId,prevImplementation:this._prevDecoderImplementationMap.get(t.userId),implementation:c.decoderImplementation,codec:e.videoCodec,isHWCodec:c.powerEfficientDecoder}),this._prevDecoderImplementationMap.set(t.userId,c.decoderImplementation))),c.ssrc===i.auxiliary&&n.hasAuxiliary&&(t.auxiliary.packetsReceived=c.packetsReceived,t.auxiliary.bytesReceived=c.bytesReceived,t.auxiliary.packetsLost=c.packetsLost,t.auxiliary.framesReceived=c.framesReceived,t.auxiliary.framesDecoded=c.framesDecoded,t.auxiliary.fpsDecoded=c.framesPerSecond,d=e.remoteAuxiliaryTrack,t.hasAuxiliary=!0),d&&(d.stat.packetsReceived=c.packetsReceived,d.stat.bytesReceived=c.bytesReceived,d.stat.packetsLost=c.packetsLost,d.stat.framesReceived=c.framesReceived,d.stat.framesDecoded=c.framesDecoded,c.jitterBufferDelay&&(d.stat.jitterBufferDelay=Math.floor(c.jitterBufferDelay/c.jitterBufferEmittedCount*1e3)))}c.jitterBufferDelay&&(A?(t.audio.totalJitter=c.jitterBufferDelay,t.audio.totalJitterCount=c.jitterBufferEmittedCount):c.ssrc===i.video&&n.hasVideo?(t.video.totalJitter=c.jitterBufferDelay,t.video.totalJitterCount=c.jitterBufferEmittedCount):c.ssrc===i.auxiliary&&n.hasAuxiliary&&(t.auxiliary.totalJitter=c.jitterBufferDelay,t.auxiliary.totalJitterCount=c.jitterBufferEmittedCount))}else c.type==="candidate-pair"&&Wd(c)&&qt(c.currentRoundTripTime)&&(t.rtt=Math.floor(1e3*c.currentRoundTripTime),this.totalBytesReceived=c.bytesReceived);K(c.frameWidth)||((c.trackIdentifier===e.getMainStreamVideoTrackId()||c.ssrc===i.video)&&(t.video.frameWidth=c.frameWidth,t.video.frameHeight=c.frameHeight,e.remoteVideoTrack.stat.frameWidth=c.frameWidth,e.remoteVideoTrack.stat.frameHeight=c.frameHeight),(c.trackIdentifier===e.getAuxStreamVideoTrackId()||c.ssrc===i.auxiliary)&&(t.auxiliary.frameWidth=c.frameWidth,t.auxiliary.frameHeight=c.frameHeight,e.remoteAuxiliaryTrack.stat.frameWidth=c.frameWidth,e.remoteAuxiliaryTrack.stat.frameHeight=c.frameHeight)),!K(c.audioLevel)&&e.muteState.audioAvailable&&e.remoteAudioTrack.mediaTrack&&c.trackIdentifier===e.remoteAudioTrack.mediaTrack.id&&(t.audio.audioLevel=c.audioLevel||0,t.audio.totalAudioEnergy=c.totalAudioEnergy||0)}),t.audio.audioLevel===0&&e.muteState.audioAvailable&&(t.audio.audioLevel=e.remoteAudioTrack.getInternalAudioLevel()||0),this.totalBytesReceived||(this.totalBytesReceived+=t.audio.bytesReceived+t.video.bytesReceived+t.auxiliary.bytesReceived)}catch(i){this._log.warn("failed to getStats on receiver connection ".concat(i))}return t})}getStats(e,t){return N(this,null,function*(){let r={},i=[];if(this.room.singlePC){let n=this.room.singlePC.getPeerConnection();if(!n)return{senderStats:r,receiverStats:i};let a=He(),c=yield n.getStats(),A=He();A-a>2e3&&this._log.warn("getStats cost ".concat(A-a,"ms"));let d=[],g=new Set(["inbound-rtp","outbound-rtp","track","candidate-pair","media-source"]);c.forEach(E=>g.has(E.type)&&d.push(E)),this._spcStats=d}e&&(r=yield this.getSenderStats(e));for(let[n,a]of t){let c=yield this.getReceiverStats(a);i.push(c)}return{senderStats:r,receiverStats:i}})}getDifferenceValue(e,t){if(ns(e))return t;let r=t-e;return r<0?0:r}prepareReport(e){let{stats:t,report:r,freezeMap:i}=e;var n;if(!ns(t.senderStats)){let f={uint32_audio_level:t.senderStats.audio.audioLevel*Ko,uint32_audio_energy:1e6*t.senderStats.audio.totalAudioEnergy,uint32_audio_codec_bitrate:t.senderStats.audio.bytesSent};t.senderStats.audio.micAudioLevel&&(f.uint32_mic_audio_level=t.senderStats.audio.micAudioLevel*Ko),t.senderStats.audio.totalSamplesDuration&&(r.msg_device_info.uint32_audio_capture_cost=t.senderStats.audio.totalSamplesDuration);let b=[];if(t.senderStats.video.bytesSent){let k={uint32_video_stream_type:2,uint32_video_codec_fps:t.senderStats.video.framesSent,uint32_video_capture_fps:t.senderStats.video.fpsCapture,uint32_video_width:t.senderStats.video.frameWidth,uint32_video_height:t.senderStats.video.frameHeight,uint32_video_codec_bitrate:t.senderStats.video.bytesSent,uint32_video_enc_fps:t.senderStats.video.framesEncoded,uint32_key_frame_count:t.senderStats.video.keyFramesEncoded,uint32_nack_count:t.senderStats.video.nackCount,uint32_pli_count:t.senderStats.video.pliCount,uint32_encode_cost:1e3*(t.senderStats.video.totalEncodeTime||0),uint32_send_packet_cost:1e3*(t.senderStats.video.totalPacketSendDelay||0),uint32_video_arq_packets:t.senderStats.video.retransmittedPacketsSent};b.push(k)}if(t.senderStats.small.bytesSent){let k={uint32_video_stream_type:3,uint32_video_codec_fps:t.senderStats.small.framesSent||0,uint32_video_capture_fps:t.senderStats.small.fpsCapture||0,uint32_video_width:t.senderStats.small.frameWidth||0,uint32_video_height:t.senderStats.small.frameHeight||0,uint32_video_codec_bitrate:t.senderStats.small.bytesSent,uint32_video_enc_fps:t.senderStats.small.framesEncoded||0,uint32_key_frame_count:t.senderStats.small.keyFramesEncoded,uint32_nack_count:t.senderStats.small.nackCount,uint32_pli_count:t.senderStats.small.pliCount,uint32_encode_cost:1e3*(t.senderStats.small.totalEncodeTime||0),uint32_send_packet_cost:1e3*(t.senderStats.small.totalPacketSendDelay||0),uint32_video_arq_packets:t.senderStats.small.retransmittedPacketsSent};b.push(k)}if(t.senderStats.auxiliary.bytesSent){let k={uint32_video_stream_type:7,uint32_video_codec_fps:t.senderStats.auxiliary.framesSent||0,uint32_video_capture_fps:t.senderStats.auxiliary.fpsCapture||0,uint32_video_width:t.senderStats.auxiliary.frameWidth||0,uint32_video_height:t.senderStats.auxiliary.frameHeight||0,uint32_video_codec_bitrate:t.senderStats.auxiliary.bytesSent,uint32_video_enc_fps:t.senderStats.auxiliary.framesEncoded||0,uint32_key_frame_count:t.senderStats.auxiliary.keyFramesEncoded,uint32_nack_count:t.senderStats.auxiliary.nackCount,uint32_pli_count:t.senderStats.auxiliary.pliCount,uint32_encode_cost:1e3*(t.senderStats.auxiliary.totalEncodeTime||0),uint32_send_packet_cost:1e3*(t.senderStats.auxiliary.totalPacketSendDelay||0),uint32_video_arq_packets:t.senderStats.auxiliary.retransmittedPacketsSent};b.push(k)}let w={uint32_bitrate:0,uint32_lost:0,uint32_rtt:t.senderStats.rtt};r.msg_up_stream_info={msg_audio_status:f,msg_video_status:b,msg_network_status:w}}let{statInterval:a}=this;r.msg_down_stream_info=[],t.receiverStats.forEach(f=>{let b={msg_user_info:{str_identifier:f.userId,uint64_tinyid:f.tinyId},msg_network_status:{uint32_rtt:f.rtt,uint32_bitrate:0,uint32_lost:0},msg_audio_status:{},msg_video_status:[]};if(f.hasAudio){let w={uint32_audio_p2p_delay:f.audio.p2pDelay,uint32_audio_cache_ms:f.audio.totalJitter,uint32_audio_cache_ms_count:f.audio.totalJitterCount,uint32_audio_codec_bitrate:f.audio.bytesReceived,uint32_audio_total_bitrate:f.audio.bytesReceived,uint32_audio_level:1e8*f.audio.audioLevel,uint32_audio_energy:1e6*f.audio.totalAudioEnergy,uint32_audio_receive:f.audio.packetsReceived,uint32_audio_origin_lost:f.audio.packetsLost};b.msg_audio_status=w}if(f.hasVideo){let w=i.get("".concat(f.userId,"_").concat(Qv)),k=w?w.duration:0,x={uint32_video_stream_type:f.isSmallSubscribed?3:2,uint32_video_receive_fps:f.video.framesReceived,uint32_video_width:f.video.frameWidth,uint32_video_height:f.video.frameHeight,uint32_video_codec_bitrate:f.video.bytesReceived,uint32_video_receive:f.video.packetsReceived,uint32_video_origin_lost:f.video.packetsLost,uint32_video_block_time:k,uint32_video_dec_fps:f.video.framesDecoded,uint32_video_cache_ms:f.video.totalJitter,uint32_video_cache_ms_count:f.video.totalJitterCount};b.msg_video_status.push(x)}if(f.hasAuxiliary){let w=i.get("".concat(f.userId,"_").concat(xv)),k=w?w.duration:0,x={uint32_video_stream_type:7,uint32_video_receive_fps:f.auxiliary.framesReceived,uint32_video_width:f.auxiliary.frameWidth,uint32_video_height:f.auxiliary.frameHeight,uint32_video_codec_bitrate:f.auxiliary.bytesReceived,uint32_video_receive:f.auxiliary.packetsReceived+f.auxiliary.packetsLost,uint32_video_origin_lost:f.auxiliary.packetsLost,uint32_video_block_time:k,uint32_video_dec_fps:f.auxiliary.framesDecoded,uint32_video_cache_ms:f.auxiliary.totalJitter,uint32_video_cache_ms_count:f.auxiliary.totalJitterCount};b.msg_video_status.push(x)}r.msg_down_stream_info.push(b)});let c=this._prevReport,A=this._prevStats;if(this._prevReport=JSON.parse(JSON.stringify(r)),this._prevStats=JSON.parse(JSON.stringify(t)),r.msg_up_stream_info.msg_audio_status&&c.msg_up_stream_info.msg_audio_status){let f=c.msg_up_stream_info.msg_audio_status,b=r.msg_up_stream_info.msg_audio_status;if(f.uint32_audio_codec_bitrate===0)b.uint32_audio_codec_bitrate=0;else{let w=this.getDifferenceValue(f.uint32_audio_codec_bitrate,b.uint32_audio_codec_bitrate);b.uint32_audio_codec_bitrate=Math.round(8*w/a),r.msg_up_stream_info.msg_network_status.uint32_bitrate+=b.uint32_audio_codec_bitrate}(n=c.msg_device_info)!=null&&n.uint32_audio_capture_cost?r.msg_device_info.uint32_audio_capture_cost=2*Math.floor(1e3*this.getDifferenceValue(c.msg_device_info.uint32_audio_capture_cost,r.msg_device_info.uint32_audio_capture_cost)/a):delete r.msg_device_info.uint32_audio_capture_cost}let d=c.msg_up_stream_info.msg_video_status;r.msg_up_stream_info.msg_video_status.forEach(f=>{let b=d.find(G=>G.uint32_video_stream_type===f.uint32_video_stream_type);if(!b||b.uint32_video_codec_bitrate===0)return f.uint32_video_codec_bitrate=0,f.uint32_video_enc_fps=0,void(f.uint32_video_codec_fps=0);let w=0,k=0,x=0;b&&f.uint32_video_codec_bitrate>=b.uint32_video_codec_bitrate&&(w=b.uint32_video_codec_bitrate,k=b.uint32_video_enc_fps,x=b.uint32_video_codec_fps);let Y=this.getDifferenceValue(w,f.uint32_video_codec_bitrate);f.uint32_video_codec_bitrate=Math.round(8*Y/a),r.msg_up_stream_info.msg_network_status.uint32_bitrate+=f.uint32_video_codec_bitrate,f.uint32_video_enc_fps=Math.round(this.getDifferenceValue(k,f.uint32_video_enc_fps)/a),f.uint32_video_codec_fps=Math.round(this.getDifferenceValue(x,f.uint32_video_codec_fps)/a),xc&&Qd()===115&&b.uint32_video_width===0&&b.uint32_video_height===0&&b.uint32_video_codec_fps===0&&(f.uint32_video_codec_fps=f.uint32_video_enc_fps),K(b.uint32_key_frame_count)||(f.uint32_key_frame_count=Math.round(this.getDifferenceValue(b.uint32_key_frame_count,f.uint32_key_frame_count))),K(b.uint32_nack_count)||(f.uint32_nack_count=Math.round(this.getDifferenceValue(b.uint32_nack_count,f.uint32_nack_count))),K(b.uint32_pli_count)||(f.uint32_pli_count=Math.round(this.getDifferenceValue(b.uint32_pli_count,f.uint32_pli_count))),K(b.uint32_video_arq_packets)||(f.uint32_video_arq_packets=Math.round(this.getDifferenceValue(b.uint32_video_arq_packets,f.uint32_video_arq_packets))),K(b.uint32_encode_cost)||(f.uint32_encode_cost=Math.round(this.getDifferenceValue(b.uint32_encode_cost,f.uint32_encode_cost)/a)),K(b.uint32_send_packet_cost)||(f.uint32_send_packet_cost=Math.round(this.getDifferenceValue(b.uint32_send_packet_cost,f.uint32_send_packet_cost)/a))});let g=c.msg_down_stream_info;r.msg_down_stream_info=r.msg_down_stream_info.filter(f=>g.find(b=>b.msg_user_info.uint64_tinyid===f.msg_user_info.uint64_tinyid));let E=r.msg_down_stream_info;return E.forEach(f=>{let b=g.find(w=>w.msg_user_info.uint64_tinyid===f.msg_user_info.uint64_tinyid);if(ns(f.msg_audio_status)||ns(b.msg_audio_status))f.msg_audio_status={};else{let w=f.msg_audio_status,k=b.msg_audio_status,x=this.getDifferenceValue(k.uint32_audio_cache_ms_count,w.uint32_audio_cache_ms_count);delete w.uint32_audio_cache_ms_count,w.uint32_audio_cache_ms=Math.floor(1e3*this.getDifferenceValue(k.uint32_audio_cache_ms,w.uint32_audio_cache_ms)/x)||0;let Y=this.room.remotePublishedUserMap.get(f.msg_user_info.str_identifier);Y&&(Y.remoteAudioTrack.stat.jitterBufferDelay=w.uint32_audio_cache_ms),w.uint32_audio_origin_lost=this.getDifferenceValue(k.uint32_audio_origin_lost,w.uint32_audio_origin_lost),w.uint32_audio_receive=this.getDifferenceValue(k.uint32_audio_receive,w.uint32_audio_receive),w.uint32_audio_receive+=w.uint32_audio_origin_lost;let G=this.getDifferenceValue(k.uint32_audio_codec_bitrate,w.uint32_audio_codec_bitrate);w.uint32_audio_codec_bitrate=Math.round(8*G/a),w.uint32_audio_total_bitrate=Math.round(8*G/a)}if(f.msg_video_status&&b.msg_video_status){let w=b.msg_video_status;f.msg_video_status=f.msg_video_status.filter(k=>w.find(x=>x.uint32_video_stream_type===k.uint32_video_stream_type)),f.msg_video_status.forEach(k=>{let x=w.find(eo=>eo.uint32_video_stream_type===k.uint32_video_stream_type),Y=x.uint32_video_receive,G=x.uint32_video_origin_lost,F=x.uint32_video_codec_bitrate,me=x.uint32_video_receive_fps,Te=x.uint32_video_dec_fps;k.uint32_video_origin_lost=this.getDifferenceValue(G,k.uint32_video_origin_lost),k.uint32_video_receive=this.getDifferenceValue(Y,k.uint32_video_receive)+k.uint32_video_origin_lost;let Ze=this.getDifferenceValue(F,k.uint32_video_codec_bitrate);k.uint32_video_codec_bitrate=Math.round(8*Ze/a);let qe=this.getDifferenceValue(me,k.uint32_video_receive_fps);k.uint32_video_receive_fps=Math.round(qe/a),k.uint32_video_dec_fps=Math.round(this.getDifferenceValue(Te,k.uint32_video_dec_fps)/a);let Ne=this.getDifferenceValue(x.uint32_video_cache_ms_count,k.uint32_video_cache_ms_count);delete k.uint32_video_cache_ms_count,k.uint32_video_cache_ms=Math.floor(1e3*this.getDifferenceValue(x.uint32_video_cache_ms,k.uint32_video_cache_ms)/Ne)||0})}}),A&&t.receiverStats.forEach(f=>{if(f.audio.concealedSamples&&f.audio.totalSamplesReceived){let b=A.receiverStats.find(w=>w.userId===f.userId);if(b&&b.audio.concealedSamples&&b.audio.totalSamplesReceived){let w=f.audio.concealedSamples-b.audio.concealedSamples,k=f.audio.totalSamplesReceived-b.audio.totalSamplesReceived,x=Math.floor(w/k*1e3*a);if(x>a/5){let Y=E.find(G=>G.msg_user_info.str_identifier===f.userId);Y&&(Y.msg_audio_status.uint32_audio_block_time=x)}}}}),r}getStatsReport(e){return N(this,arguments,function(t){var r=this;let{uplinkConnection:i,downlinkConnections:n,freezeMap:a}=t;return function*(){let c={msg_device_info:{},msg_up_stream_info:{msg_audio_status:{uint32_audio_format:11,uint32_audio_sample_rate:0,uint32_audio_codec_bitrate:0,uint32_audio_receive:0,uint32_audio_origin_lost:0,uint32_audio_level:0,uint32_audio_energy:0},msg_video_status:[],msg_network_status:{uint32_bitrate:0,uint32_rtt:0,uint32_lost:0}},msg_down_stream_info:[{msg_user_info:{str_identifier:"",uint64_tinyid:0},msg_audio_status:{uint32_audio_cache_ms:0,uint32_audio_format:11,uint32_audio_sample_rate:0,uint32_audio_codec_bitrate:0,uint32_audio_total_bitrate:0,uint32_audio_level:0,uint32_audio_energy:0,uint32_audio_receive:0,uint32_audio_origin_lost:0,uint32_audio_final_lost:0},msg_video_status:[{uint32_video_cache_ms:0,uint32_video_stream_type:0,uint32_video_receive_fps:0,uint32_video_width:0,uint32_video_height:0,uint32_video_codec_bitrate:0,uint32_video_receive:0,uint32_video_origin_lost:0,uint32_video_block_time:0,uint32_video_dec_fps:0}],msg_network_status:{uint32_bitrate:0,uint32_rtt:0,uint32_lost:0}}]},A=yield r.getStats(i,n);return JSON.stringify(r._prevReport)==="{}"&&(r._prevReport=JSON.parse(JSON.stringify(c))),r.prepareReport({stats:A,report:c,freezeMap:a}),r._prevReportTime=Date.now(),c}()})}reset(){this._prevReportTime=0,this._prevReport={},this._prevEncoderImplementation="",this._prevQualityLimitationReason="",this._prevDecoderImplementationMap=new Map}},W1=lr(Lr()),WR=class extends W1.default{constructor(e){let{signalChannel:t,room:r}=e;super(),T(this,"_room"),T(this,"_signalChannel"),T(this,"_log"),T(this,"_uplinkRTT",0),T(this,"_uplinkLoss",0),T(this,"_downlinkRTT",0),T(this,"_downlinkLoss",0),T(this,"_downlinkPrevStatMap",new Map),T(this,"_downlinkLossAndRTTMap",new Map),T(this,"_interval",-1),T(this,"_uplinkNetworkQuality",0),T(this,"_downlinkNetworkQuality",0),this._room=r,this._signalChannel=t,this._log=ae.createLogger({id:"q",userId:this._room.userId,sdkAppId:this._room.sdkAppId}),this.initialize()}get uplinkNetworkQuality(){return this._uplinkNetworkQuality}set uplinkNetworkQuality(e){e!==this._uplinkNetworkQuality&&this._log.info("uplink ".concat(this.uplinkNetworkQuality," -> ").concat(e,", rtt: ").concat(this._uplinkRTT,", loss: ").concat(this._uplinkLoss)),this._uplinkNetworkQuality=e}get downlinkNetworkQuality(){return this._downlinkNetworkQuality}set downlinkNetworkQuality(e){if(e!==this._downlinkNetworkQuality){let{rtt:t,loss:r}=this.getAverageLossAndRTT([...this._downlinkLossAndRTTMap.values()]);this._log.info("downlink ".concat(this.downlinkNetworkQuality," -> ").concat(e,", rtt: ").concat(t,", loss: ").concat(r))}this._downlinkNetworkQuality=e}initialize(){this._signalChannel.on(ze.UPLINK_NETWORK_STATS,e=>{this.handleUplinkNetworkQuality(e)}),this._signalChannel.on(nI,this.handleSignalConnectionStateChange.bind(this)),this.start()}handleUplinkNetworkQuality(e){var t,r;if(e.data.code!==0)return;let i=e.data.data;if(i.delay&&this.updateDelay(i.delay),!this._room.uplinkConnection)return this.uplinkNetworkQuality=0,this._uplinkLoss=0,void(this._uplinkRTT=0);let n=(r=(t=this._room)==null?void 0:t.uplinkConnection)==null?void 0:r.getPeerConnection();if(n&&this.isPeerConnectionDisconnected(n))return this.uplinkNetworkQuality=6,this._uplinkLoss=0,void(this._uplinkRTT=0);let a=i.expectAudPkg+i.expectVidPkg,c=i.recvAudPkg+i.recvVidPkg,A=a-c;a===0&&c===0||(this._uplinkLoss=A<=0?0:Math.round(A/a*100),this._uplinkRTT=i.rtt,this.uplinkNetworkQuality=this.getNetworkQuality(this._uplinkLoss,this._uplinkRTT))}handleDownlinkNetworkQuality(){return N(this,null,function*(){if(this._room.remotePublishedUserMap.size===0)return void(this.downlinkNetworkQuality=0);let e=[...this._room.remotePublishedUserMap.values()],t=e.filter(n=>{var a;return((a=n.getPeerConnection())==null?void 0:a.connectionState)===Vt.CONNECTED});if(e.filter(n=>this.isPeerConnectionDisconnected(n.getPeerConnection())).length===e.length)return void(this.downlinkNetworkQuality=6);for(let n=0;n<t.length;n++){let a=t[n].getPeerConnection();if(!a)return;let{rtt:c,totalPacketsLost:A,totalPacketsReceived:d}=yield this.getStat(a);if(!this._downlinkPrevStatMap.has(a)){this._downlinkPrevStatMap.set(a,{totalPacketsLost:A,totalPacketsReceived:d});continue}let g=0,E=this._downlinkPrevStatMap.get(a),f=A-E.totalPacketsLost,b=d-E.totalPacketsReceived;g=f<=0||b<0?0:Math.round(f/(f+b)*100),this._downlinkPrevStatMap.set(a,{totalPacketsLost:A,totalPacketsReceived:d}),this._downlinkLossAndRTTMap.set(a,{rtt:c,loss:g,userId:t[n].getUserId(),audioDelay:t[n].remoteAudioTrack.stat.end2EndDelay,videoDelay:t[n].remoteVideoTrack.stat.end2EndDelay})}if([...this._downlinkPrevStatMap.keys()].forEach(n=>{this.isPeerConnectionDisconnected(n)&&(this._downlinkPrevStatMap.delete(n),this._downlinkLossAndRTTMap.delete(n))}),this._downlinkLossAndRTTMap.size===0)return;let{rtt:r,loss:i}=this.getAverageLossAndRTT([...this._downlinkLossAndRTTMap.values()]);this._downlinkRTT=r,this._downlinkLoss=i,this.downlinkNetworkQuality=this.getNetworkQuality(i,r)})}getStat(e){return N(this,null,function*(){let t={rtt:0,totalPacketsLost:0,totalPacketsReceived:0};if(!e||!Wh())return t;let r=e.getReceivers();try{for(let i=0;i<r.length;i++)(yield r[i].getStats()).forEach(n=>{n.type==="candidate-pair"&&qt(n.currentRoundTripTime)&&(t.rtt=Math.round(1e3*n.currentRoundTripTime)),n.type==="inbound-rtp"&&(n.mediaType===O.AUDIO||n.mediaType===O.VIDEO)&&(t.totalPacketsLost+=n.packetsLost,t.totalPacketsReceived+=n.packetsReceived)});return t}catch{return t}})}getAverageLossAndRTT(e){let t={rtt:0,loss:0};return Array.isArray(e)&&e.length>0&&(e.forEach(r=>{t.rtt+=r.rtt,t.loss+=r.loss}),Object.keys(t).forEach(r=>{t[r]=Math.round(t[r]/e.length)})),t}getNetworkQuality(e,t){return e>50||t>500?5:e>30||t>350?4:e>20||t>200?3:e>10||t>100?2:e>=0||t>=0?1:0}handleSignalConnectionStateChange(e){e.state==="DISCONNECTED"?(this._uplinkRTT=0,this._uplinkLoss=0,this.uplinkNetworkQuality=6):e.state==="CONNECTED"&&this.uplinkNetworkQuality===6&&(this.uplinkNetworkQuality=5)}handleUplinkConnectionStateChange(e){let{state:t}=e;t==="DISCONNECTED"?(this._uplinkLoss=0,this._uplinkRTT=0,this.uplinkNetworkQuality=6):t==="CONNECTED"&&this.uplinkNetworkQuality===6&&(this.uplinkNetworkQuality=5)}isPeerConnectionDisconnected(e){return!(!e||e.connectionState!==Vt.DISCONNECTED&&e.connectionState!==Vt.FAILED&&e.connectionState!==Vt.CLOSED)}setUplinkConnection(e){this._room.uplinkConnection=e,this._room.uplinkConnection?this._room.uplinkConnection.on("connection-state-changed",this.handleUplinkConnectionStateChange.bind(this)):(this.uplinkNetworkQuality=0,this._uplinkRTT=0,this._uplinkLoss=0)}start(){this._interval===-1?(this._log.debug("start network quality calculating"),this._interval=Qt.run(bd,()=>{this.handleDownlinkNetworkQuality();let e=[...this._downlinkLossAndRTTMap.values()];te.emit(X.NETWORK_QUALITY,{room:this._room,uplink:{rtt:this._uplinkRTT,loss:this._uplinkLoss},downlinks:e}),this.emit(WR.EVENT_NETWORK_QUALITY,{uplinkNetworkQuality:this.uplinkNetworkQuality,downlinkNetworkQuality:this.downlinkNetworkQuality,uplinkRTT:this._uplinkRTT,uplinkLoss:this._uplinkLoss,downlinkRTT:this._downlinkRTT,downlinkLoss:this._downlinkLoss,downlinkInfo:e})},{delay:2e3})):this._log.info("network quality calculating is already started")}stop(){this._log.debug("stopped"),this._interval!==-1&&(Qt.clearTask(this._interval),this._interval=-1),this._downlinkLossAndRTTMap.clear(),this._downlinkPrevStatMap.clear()}updateDelay(e){let{tinyIdToUserIdMap:t}=this._room;e.forEach(r=>{let{srcTinyId:i,videoDelay:n,audioDelay:a}=r,c=t.get(i);if(c){let A=this._room.remotePublishedUserMap.get(c);A==null||A.setDelay({videoDelay:n,audioDelay:a})}})}},AI=WR;T(AI,"EVENT_NETWORK_QUALITY","0");var JR=class{constructor(e){this._signalInfo={tinyId:void 0,clientIp:"",signalIp:"",relayIp:"",relayInnerIp:"",relayPort:0},this._eventMap=new Map,this._captureCostSum=0,this._captureCostCount=0,this._frameWorkType=e.frameWorkType||30,this._component=e.component||0,this.connectionType=e.connectionType||1,this._language=e.language||0,this._room=e.room,this._keyPrefix="key_point",this._log=ae.createLogger({id:"kpm",userId:this._room.userId,sdkAppId:this._room.sdkAppId}),Object.getOwnPropertyNames(this.__proto__).forEach(t=>{t.startsWith("handle")&&mt(this[t])&&(this[t]=function(r){let{fn:i,context:n}=r;return function(){try{for(var a=arguments.length,c=new Array(a),A=0;A<a;A++)c[A]=arguments[A];let d=i.apply(n,c);return p_(d)?d.catch(g=>ae.error("".concat(i.name,"() error observed ").concat(g))):d}catch(d){ae.error("".concat(i.name,"() error observed ").concat(d))}}}({fn:this[t],context:this}))}),this.initData(),this.installEvents()}initData(){this._firstPublishedUserList=[],this._networkQuality={totalUplinkRTT:0,totalUplinkLoss:0,count:0,totalDownlinkRTTAndLossMap:new Map},this._basicInfo={string_sdk_version:ln,uint32_os_type:15,string_device_name:"",string_http_user_agent:navigator.userAgent,string_os_version:"",uint32_avg_rtt:0,uint32_avg_up_loss:0,uint32_scene:this._room.scene==="live"?1:0,uint32_joining_duration:0,uint32_networkType:0,uint32_framework:this._frameWorkType,uint32_component:this._component,uint32_connection_type:this.connectionType,uint32_caller_coding_language:this._language,string_domain:location.hostname},this._pathJoinRoom={uint64_start_time:0,uint64_send_request_acc_ip_cmd_start_time:0,uint64_send_request_acc_ip_cmd_end_time:0,uint64_send_request_enter_room_cmd_start_time:0,uint64_send_request_enter_room_cmd_end_time:0,uint64_send_first_video_frame_time:0,uint64_recv_userlist_time:0,uint64_end_time:0,int32_send_request_acc_ip_cmd_ret:0,int32_send_request_enter_room_cmd_ret:0,int32_end_ret:0},this._pathLeaveRoom={uint64_start_time:0,uint64_send_request_exit_room_cmd_start_time:0,uint64_send_request_exit_room_cmd_end_time:0,uint64_end_time:0,int32_send_request_exit_room_cmd_ret:0,int32_end_ret:0},this._localStreamStat={totalVideoBitrate:0,totalVideoFPS:0,totalVideoHeight:0,totalVideoWidth:0,totalAudioLevel:0,videoCount:0,audioLevelCount:0,publishStartTime:0,statsToReport:{uint32_audio_capture_db:0,uint32_video_big_capture_fps:0,uint32_video_big_bitrate:0,uint32_video_big_resolution:0}},this._pathMainVideoMap=new Map,this._pathMainAudioMap=new Map,this._pathAuxiliaryMap=new Map,this._remoteStreamStatMap=new Map,d_().then(e=>{this._basicInfo.string_os_version=A_(),this._basicInfo.string_device_name=e&&e.mobile?e.model:this._basicInfo.string_os_version})}addEvent(e,t){return this._eventMap.set(e,t),te.on(e,t),this}installEvents(){this.handleUnload=this.handleUnload.bind(this),window.addEventListener("pagehide",this.handleUnload),this._room.once("banned",()=>this.handleLeaveSuccess({room:this._room,roomId:this._room.roomId})),this.addEvent(X.JOIN_START,this.handleJoinStart).addEvent(X.JOIN_SCHEDULE_SUCCESS,this.handleJoinScheduleSuccess).addEvent(X.JOIN_SIGNAL_CONNECTION_START,this.handleSignalConnectionStart).addEvent(X.JOIN_SIGNAL_CONNECTION_END,this.handleSignalConnectionEnd).addEvent(X.JOIN_SEND_CMD,this.handleJoinSendCMD).addEvent(X.JOIN_RECEIVED_CMD_RES,this.handleJoinReceivedCMDResponce).addEvent(X.JOIN_SUCCESS,this.handleJoinSuccess).addEvent(X.JOIN_FAILED,this.handleJoinFailed).addEvent(X.LEAVE_START,this.handleLeaveStart).addEvent(X.LEAVE_SUCCESS,this.handleLeaveSuccess).addEvent(X.LEAVE_SEND_CMD,this.handleLeaveSendCMD).addEvent(X.LOCAL_TRACK_CAPTURE_START,this.handleTrackCaptureStart).addEvent(X.LOCAL_TRACK_CAPTURE_SUCCESS,this.handleTrackCaptureSuccess).addEvent(X.LOCAL_TRACK_CAPTURE_FAILED,this.handleTrackCaptureFailed).addEvent(X.PUBLISH_START,this.handlePublishStart).addEvent(X.SEND_FIRST_VIDEO_FRAME,this.handleSendFirstVideoFrame).addEvent(X.SUBSCRIBE_START,this.handleSubscribeStart).addEvent(X.SUBSCRIBE_SUCCESS,this.handleSubscribed).addEvent(X.PLAY_TRACK_START,this.handlePlayStart).addEvent(X.VIDEO_LOADED_DATA,this.handleVideoLoadedData).addEvent(X.PLAYER_STATE_CHANGED,e=>{let{track:t,state:r,type:i}=e;!Zo(t)||!this.hitTest(t.room)||r==="PLAYING"&&(i===O.AUDIO?this.handleAudioPlaying(t):this.handleVideoPlaying(t))}).addEvent(X.NETWORK_QUALITY,this.handleNetworkQuality).addEvent(X.HEARTBEAT_REPORT,this.handleHeartbeatStats).addEvent(X.RECEIVED_PUBLISHED_USER_LIST,this.handleReceivedPublishUserList).addEvent(X.REMOTE_PUBLISH_STATE_CHANGED,e=>{let{room:t,prevMuteState:r,muteState:i}=e;if(!this.hitTest(t))return;let n=r.hasAudio||r.hasVideo||r.hasSmall,a=r.hasAuxiliary,c=i.hasAudio||i.hasVideo||i.hasSmall,A=i.hasAuxiliary;!n&&c&&this.handleRemoteStreamAdded(i.userId,"main"),!a&&A&&this.handleRemoteStreamAdded(i.userId,"auxiliary")}).addEvent(X.SINGLE_CONNECTION_STAT,e=>{let{room:t,stat:r}=e;this.hitTest(t)&&(this._pathJoinRoom.int32_ice_cost=r.ice,this._pathJoinRoom.int32_dtls_cost=r.dtls,this._pathJoinRoom.int32_peer_connection_cost=r.peerConnection)})}uninstallEvents(){window.removeEventListener("unload",this.handleUnload),this._eventMap.forEach((e,t)=>te.off(t,e)),this._eventMap.clear()}destroy(){this.uninstallEvents(),Qt.clearTask(this._intervalId)}handleUnload(){this._room.isJoined&&this.handleLeaveSuccess({room:this._room,roomId:this._room.roomId})}handleJoinStart(e){this.hitTest(e.room)&&(this._pathJoinRoom.uint64_start_time===0&&(this._pathJoinRoom.uint64_start_time=Date.now()),e.params&&(K(e.params.frameWorkType)||(this._frameWorkType=e.params.frameWorkType,this._basicInfo.uint32_framework=this._frameWorkType),K(e.params.component)||(this._component=e.params.component,this._basicInfo.uint32_component=this._component),K(e.params.language)||(this._language=e.params.language,this._basicInfo.uint32_caller_coding_language=this._language)))}handleJoinScheduleSuccess(e){let{room:t,detailCost:r}=e;if(this.hitTest(t)&&r){let{totalCost:i,local:n,dns:a,tcp:c,tls:A,request:d,response:g}=r;this._pathJoinRoom.int32_schedule_cost=i,this._pathJoinRoom.int32_schedule_local=n,this._pathJoinRoom.int32_schedule_dns=a,this._pathJoinRoom.int32_schedule_tcp=c,this._pathJoinRoom.int32_schedule_tls=A,this._pathJoinRoom.int32_schedule_request=d,this._pathJoinRoom.int32_schedule_response=g}}handleSignalConnectionStart(e){let{room:t}=e;this.hitTest(t)&&this._pathJoinRoom.uint64_send_request_acc_ip_cmd_start_time===0&&(this._pathJoinRoom.uint64_send_request_acc_ip_cmd_start_time=Date.now())}handleSignalConnectionEnd(e){let{room:t,error:r}=e;this.hitTest(t)&&this._pathJoinRoom.uint64_send_request_acc_ip_cmd_end_time===0&&(this._pathJoinRoom.uint64_send_request_acc_ip_cmd_end_time=Date.now(),r&&(this._pathJoinRoom.int32_send_request_acc_ip_cmd_ret=r instanceof pe?Number(r.getExtraCode()||r.getCode()):se.UNKNOWN,this._pathJoinRoom.int32_end_ret=this._pathJoinRoom.int32_send_request_acc_ip_cmd_ret))}handleJoinSendCMD(e){this.hitTest(e.room)&&this._pathJoinRoom.uint64_send_request_enter_room_cmd_start_time===0&&(this._pathJoinRoom.uint64_send_request_enter_room_cmd_start_time=Date.now())}handleJoinReceivedCMDResponce(e){this.hitTest(e.room)&&this._pathJoinRoom.uint64_send_request_enter_room_cmd_end_time===0&&(this._pathJoinRoom.uint64_send_request_enter_room_cmd_end_time=Date.now(),this._pathJoinRoom.int32_send_request_enter_room_cmd_ret=e.code,e.code!==0&&(this._pathJoinRoom.int32_end_ret=this._pathJoinRoom.int32_send_request_enter_room_cmd_ret))}handleJoinSuccess(e){this.hitTest(e.room)&&this._pathJoinRoom.uint64_end_time===0&&(this._pathJoinRoom.uint64_end_time=Date.now(),this._pathJoinRoom.int32_end_ret=0,this._signalInfo=e.room.getSignalInfo())}handleJoinFailed(e){let{room:t,error:r}=e;this.hitTest(t)&&(this._pathJoinRoom.uint64_end_time=Date.now(),this._pathJoinRoom.int32_end_ret===0&&(this._pathJoinRoom.int32_end_ret=r.code||this._pathJoinRoom.int32_send_request_enter_room_cmd_ret||this._pathJoinRoom.int32_send_request_acc_ip_cmd_ret),setTimeout(()=>{this.report()}))}handleReceivedPublishUserList(e){this.hitTest(e.room)&&this._pathJoinRoom.uint64_recv_userlist_time===0&&(this._pathJoinRoom.uint64_recv_userlist_time=Date.now(),this._firstPublishedUserList=e.publishedUserList||[])}handleSendFirstVideoFrame(e){let{room:t}=e;!this.hitTest(t)||this._pathJoinRoom.uint64_send_first_video_frame_time===0&&this._pathJoinRoom.uint64_start_time!==0&&(this._pathJoinRoom.uint64_send_first_video_frame_time=Date.now())}handleLeaveStart(e){this.hitTest(e.room)&&(this._pathLeaveRoom.uint64_start_time=Date.now())}handleLeaveSuccess(e){this.hitTest(e.room)&&this._pathLeaveRoom.uint64_end_time===0&&(this._pathLeaveRoom.uint64_end_time=Date.now(),this._pathJoinRoom.uint64_end_time!==0?this._basicInfo.uint32_joining_duration=this._pathLeaveRoom.uint64_end_time-this._pathJoinRoom.uint64_end_time:this._log.warn("pathJoinRoom endTime is 0"),this.report())}handleLeaveSendCMD(e){this.hitTest(e.room)&&(this._pathLeaveRoom.uint64_send_request_exit_room_cmd_start_time=Date.now(),this._pathLeaveRoom.uint64_send_request_exit_room_cmd_end_time=Date.now())}handleRemoteStreamAdded(e,t){var r;let i="".concat(e,"_").concat(t);if(!this._remoteStreamStatMap.has(i)){let n={userId:e,totalVideoFPS:0,totalVideoBitrate:0,totalAudioLevel:0,totalAudioBitrate:0,totalLoss:0,audioCount:0,audioLevelCount:0,videoCount:0,networkQualityCount:0,streamAddedTime:Date.now(),subscribeStartTime:0,subscribedTime:0,playStreamTime:0,statsToReport:Ke(_e({},J1),{msg_user_info:new hI({userId:e,tinyId:(r=this._room.remotePublishedUserMap.get(e))==null?void 0:r.tinyId,role:20})})};n.statsToReport.uint32_stream_type=t==="main"?2:7,this._remoteStreamStatMap.set(i,n)}}handleSubscribeStart(e){let{room:t,remotePublishedUser:r,streamType:i,subscribeState:n}=e;if(!this.hitTest(t))return;let{userId:a,tinyId:c,role:A}=r,d=new hI({userId:a,tinyId:c,role:A==="anchor"?20:21}),g=Date.now(),E="".concat(a,"_").concat(i),f=this._remoteStreamStatMap.get(E);f&&f.subscribeStartTime===0&&(f.subscribeStartTime=g),i==="main"?(r.muteState.hasVideo&&(n.video||n.smallVideo)&&!this._pathMainVideoMap.has(E)&&this._pathMainVideoMap.set(E,{statsToReport:{msg_user_info:d,uint64_start_enter_time:this._pathJoinRoom.uint64_start_time,uint64_render_first_frame_time:0,uint64_combine_first_frame_time:0},userId:a,sendSubscribeCMDTime:g}),r.muteState.hasAudio&&n.audio&&!this._pathMainAudioMap.has(E)&&this._pathMainAudioMap.set(E,{statsToReport:{msg_user_info:d,uint64_start_enter_time:this._pathJoinRoom.uint64_start_time,uint64_play_first_frame_time:0},userId:a,sendSubscribeCMDTime:g})):r.muteState.hasAuxiliary&&n.auxiliary&&!this._pathAuxiliaryMap.has(E)&&this._pathAuxiliaryMap.set(E,{sendSubscribeCMDTime:g})}handleSubscribed(e){let{room:t,remotePublishedUser:r,streamType:i}=e;if(this.hitTest(t)){let n="".concat(r.userId,"_").concat(i),a=this._remoteStreamStatMap.get(n);a&&a.subscribedTime===0&&(a.subscribedTime=Date.now())}}handlePlayStart(e){let{track:t}=e;if(!Zo(t)||!this.hitTest(t.room))return;let r="".concat(t.userId,"_").concat(t.streamType),i=this._remoteStreamStatMap.get(r);(i==null?void 0:i.playStreamTime)===0&&(i.playStreamTime=Date.now())}handleVideoLoadedData(e){let{track:t}=e;if(!Zo(t)||!this.hitTest(t.room))return;let r="".concat(t.userId,"_").concat(t.streamType),i=this._pathMainVideoMap.get(r);i&&i.statsToReport.uint64_combine_first_frame_time===0&&(i.statsToReport.uint64_combine_first_frame_time=Date.now())}handleVideoPlaying(e){let t="".concat(e.userId,"_").concat(e.streamType),r=Date.now(),i=this._pathMainVideoMap.get(t),n=this._remoteStreamStatMap.get(t);if(i&&(i.statsToReport.uint64_render_first_frame_time===0&&(i.statsToReport.uint64_render_first_frame_time=r),n)){let{statsToReport:c,playStreamTime:A,subscribedTime:d}=n;c.uint32_video_render_first===0&&A-d<=100&&(c.uint32_video_render_first=r-i.sendSubscribeCMDTime)}let a=this._pathAuxiliaryMap.get(t);if(a&&n){let{statsToReport:c,playStreamTime:A,subscribedTime:d}=n;c.uint32_video_render_first===0&&A-d<=100&&(c.uint32_video_render_first=r-a.sendSubscribeCMDTime)}}handleAudioPlaying(e){let t="".concat(e.userId,"_").concat(e.streamType),r=this._pathMainAudioMap.get(t);r&&r.statsToReport.uint64_play_first_frame_time===0&&(r.statsToReport.uint64_play_first_frame_time=Date.now())}handleNetworkQuality(e){this.hitTest(e.room)&&(this._networkQuality.totalUplinkLoss+=e.uplink.loss,this._networkQuality.totalUplinkRTT+=e.uplink.rtt,this._networkQuality.count++,e.downlinks.forEach(t=>{let{rtt:r,loss:i,userId:n,videoDelay:a,audioDelay:c}=t,A=this._networkQuality.totalDownlinkRTTAndLossMap.get(n);if(A)A.totalRTT+=r,A.totalLoss+=i,a&&(A.totalVideoDelay=(A.totalVideoDelay||0)+a,A.videoDelayCount=(A.videoDelayCount||0)+1),c&&(A.totalAudioDelay=(A.totalAudioDelay||0)+c,A.audioDelayCount=(A.audioDelayCount||0)+1),A.count++;else{let d,g,E,f;a&&(g=a,E=1),c&&(d=c,f=1),this._networkQuality.totalDownlinkRTTAndLossMap.set(n,{totalRTT:r,totalLoss:i,count:1,totalAudioDelay:d,totalVideoDelay:g,audioDelayCount:f,videoDelayCount:E})}}))}handleHeartbeatStats(e){if(this.hitTest(e.room)){let{msg_device_info:t,msg_up_stream_info:r,msg_down_stream_info:i}=e.report;if(r.msg_video_status[0]){let{uint32_video_codec_bitrate:n,uint32_video_enc_fps:a,uint32_video_width:c,uint32_video_height:A}=r.msg_video_status[0];this._localStreamStat.totalVideoBitrate+=n,this._localStreamStat.totalVideoFPS+=a,this._localStreamStat.totalVideoWidth+=c,this._localStreamStat.totalVideoHeight+=A,this._localStreamStat.videoCount++}if(r.msg_audio_status){let{uint32_audio_level:n}=r.msg_audio_status;Math.floor(n/Ko*100)>0&&(this._localStreamStat.totalAudioLevel+=n/Ko,this._localStreamStat.audioLevelCount++)}i.forEach(n=>{let{msg_user_info:a,msg_audio_status:c,msg_video_status:A}=n,d=a.str_identifier,g=this._room.remotePublishedUserMap.get(d);if(A.forEach(E=>{let f=E.uint32_video_stream_type===2,b=E.uint32_video_stream_type===7,w="".concat(d,"_").concat(f?"main":"auxiliary"),k=this._remoteStreamStatMap.get(w);if(k&&(f&&(g!=null&&g.remoteVideoTrack.isSubscribed)||b&&(g!=null&&g.remoteAuxiliaryTrack))){k.totalVideoFPS+=E.uint32_video_receive_fps,k.totalVideoBitrate+=E.uint32_video_codec_bitrate,k.videoCount++,k.statsToReport.uint32_video_width===0&&(k.statsToReport.uint32_video_width=E.uint32_video_width),k.statsToReport.uint32_video_height===0&&(k.statsToReport.uint32_video_height=E.uint32_video_height);let x=f?g.remoteVideoTrack:g.remoteAuxiliaryTrack;x.stat.jitterBufferDelay&&(k.videoJitterBufferDelay=x.stat.jitterBufferDelay),x.stat.framesReceived&&(k.statsToReport.uint32_video_consume_render_rate=Math.floor(x.stat.framesDecoded/x.stat.framesReceived*SE(10,6)))}}),c){let E="".concat(d,"_","main"),f=this._remoteStreamStatMap.get(E);this._remoteStreamStatMap.has(E)&&f&&(g!=null&&g.remoteAudioTrack.isSubscribed)&&(f.totalAudioBitrate+=c.uint32_audio_codec_bitrate,f.audioCount++,g.remoteAudioTrack.stat.jitterBufferDelay&&(f.audioJitterBufferDelay=g.remoteAudioTrack.stat.jitterBufferDelay),Math.floor(c.uint32_audio_level/Ko*100)>0&&(f.totalAudioLevel+=c.uint32_audio_level/Ko,f.audioLevelCount++))}}),t.uint32_audio_capture_cost&&(this._captureCostSum+=t.uint32_audio_capture_cost,this._captureCostCount+=1,this._captureCostCount>=100&&(this._basicInfo.uint32_audio_capture_cost=Math.floor(this._captureCostSum/this._captureCostCount),this._captureCostSum=0,this._captureCostCount=0))}}handlePublishStart(e){let{room:t}=e;this.hitTest(t)&&this._localStreamStat.publishStartTime===0&&(this._localStreamStat.publishStartTime=Date.now())}handleTrackCaptureStart(e){let{track:t}=e;t.mediaType===1&&!this._pathJoinRoom.uint64_init_audio_start_time&&(this._pathJoinRoom.uint64_init_audio_start_time=Date.now()),t.mediaType===4&&!this._pathJoinRoom.uint64_init_camera_start_time&&(this._pathJoinRoom.uint64_init_camera_start_time=Date.now())}handleTrackCaptureSuccess(e){let{track:t}=e;t.mediaType===1&&!this._pathJoinRoom.uint64_init_audio_end_time&&(this._pathJoinRoom.int32_init_audio_ret=0,this._pathJoinRoom.uint64_init_audio_end_time=Date.now()),t.mediaType===4&&!this._pathJoinRoom.uint64_init_camera_end_time&&(this._pathJoinRoom.int32_init_camera_ret=0,this._pathJoinRoom.uint64_init_camera_end_time=Date.now())}handleTrackCaptureFailed(e){let{track:t,error:r}=e,i={NotFoundError:1,NotAllowedError:2,NotReadableError:3,OverConstrainedError:4,AbortError:5,InvalidStateError:6,SecurityError:7,TypeError:8}[r.name]||(r instanceof pe?r.getExtraCode()||r.getCode():se.UNKNOWN);t.mediaType===1&&!this._pathJoinRoom.uint64_init_audio_end_time&&(this._pathJoinRoom.int32_init_audio_ret=i,this._pathJoinRoom.uint64_init_audio_end_time=Date.now()),t.mediaType===4&&!this._pathJoinRoom.uint64_init_camera_end_time&&(this._pathJoinRoom.int32_init_camera_ret=i,this._pathJoinRoom.uint64_init_camera_end_time=Date.now())}hasVideoFlag(e){return this._firstPublishedUserList.findIndex(t=>t.userId===e&&t.flag&Cd)>=0}hasAudioFlag(e){return this._firstPublishedUserList.findIndex(t=>t.userId===e&&t.flag&yd)>=0}hasAuxFlag(e){return this._firstPublishedUserList.findIndex(t=>t.userId===e&&t.flag&Ih)>=0}hitTest(e){return e===this._room}prepareReport(){if(this._captureCostCount>0&&!this._basicInfo.uint32_audio_capture_cost&&(this._basicInfo.uint32_audio_capture_cost=Math.floor(this._captureCostSum/this._captureCostCount),this._captureCostSum=0,this._captureCostCount=0),this._networkQuality.count>0&&(this._basicInfo.uint32_avg_rtt=Math.floor(this._networkQuality.totalUplinkRTT/this._networkQuality.count),this._basicInfo.uint32_avg_up_loss=Math.floor(this._networkQuality.totalUplinkLoss/this._networkQuality.count)),this._localStreamStat.videoCount>0){this._localStreamStat.statsToReport.uint32_video_big_capture_fps=Math.floor(this._localStreamStat.totalVideoFPS/this._localStreamStat.videoCount),this._localStreamStat.statsToReport.uint32_video_big_bitrate=Math.floor(this._localStreamStat.totalVideoBitrate/this._localStreamStat.videoCount);let e=Math.floor(this._localStreamStat.totalVideoWidth/this._localStreamStat.videoCount),t=Math.floor(this._localStreamStat.totalVideoHeight/this._localStreamStat.videoCount);this._localStreamStat.statsToReport.uint32_video_big_resolution=e<<16|t}this._localStreamStat.audioLevelCount>0&&(this._localStreamStat.statsToReport.uint32_audio_capture_db=Math.floor(this._localStreamStat.totalAudioLevel/this._localStreamStat.audioLevelCount*100)),this._remoteStreamStatMap.forEach((e,t)=>{let{userId:r}=e,i=this._networkQuality.totalDownlinkRTTAndLossMap.get(r);if(i){let{totalLoss:g,count:E,audioDelayCount:f,videoDelayCount:b,totalAudioDelay:w,totalVideoDelay:k}=i;e.statsToReport.uint32_avg_down_loss=Math.floor(g/E),f&&w&&(e.statsToReport.uint32_audio_network_p2p_delay=Math.floor(w/f),e.audioJitterBufferDelay&&(e.statsToReport.uint32_p2p_delay=Math.floor(e.statsToReport.uint32_audio_network_p2p_delay+e.audioJitterBufferDelay))),b&&k&&(e.statsToReport.uint32_video_network_p2p_delay=Math.floor(k/b))}e.videoCount>0&&(e.statsToReport.uint32_video_avg_fps=Math.floor(e.totalVideoFPS/e.videoCount),e.statsToReport.uint32_video_avg_bitrate=Math.floor(e.totalVideoBitrate/e.videoCount)),e.audioCount>0&&(e.statsToReport.uint32_audio_recv_bitrate=e.statsToReport.uint32_audio_bitrate=Math.floor(e.totalAudioBitrate/e.audioCount)),e.audioLevelCount>0&&(e.statsToReport.uint32_audio_play_db=Math.floor(e.totalAudioLevel/e.audioLevelCount*100));let{callDurationCalculator:n}=this._room;n&&(e.statsToReport.uint32_audio_play_time=n.getDuration(t,O.AUDIO),e.statsToReport.uint32_video_play_time=n.getDuration(t,O.VIDEO)),e.statsToReport.uint32_video_render_first=Math.min(e.statsToReport.uint32_video_render_first,va);let{badCaseDetector:a}=this._room,{dataFreeze:c,count:A}=a.getDataFreezeDuration(t),{renderFreeze:d}=a.getRenderFreezeDuration(t);e.statsToReport.uint32_video_block_count=A,e.statsToReport.uint32_video_block_time=Math.min(c,e.statsToReport.uint32_video_play_time),e.statsToReport.uint32_video_external_block_time=Math.min(d,e.statsToReport.uint32_video_play_time),a.isBlackStream(t)&&e.statsToReport.uint32_video_avg_fps===0?e.statsToReport.uint32_video_black_screen_subjective=1:e.statsToReport.uint32_video_black_screen_subjective=0,(e.subscribeStartTime===0||e.subscribeStartTime-e.streamAddedTime>100||e.playStreamTime===0)&&(this._pathMainAudioMap.delete(t),this._pathMainVideoMap.delete(t),e.statsToReport.uint32_video_render_first=0)}),this._pathMainAudioMap.forEach((e,t)=>{this.hasAudioFlag(e.userId)?e.statsToReport.uint64_play_first_frame_time-e.statsToReport.uint64_start_enter_time>va&&(e.statsToReport.uint64_play_first_frame_time=e.statsToReport.uint64_start_enter_time+va):this._pathMainAudioMap.delete(t)}),this._pathMainVideoMap.forEach((e,t)=>{this.hasVideoFlag(e.userId)?e.statsToReport.uint64_render_first_frame_time-e.statsToReport.uint64_start_enter_time>va&&(e.statsToReport.uint64_render_first_frame_time=e.statsToReport.uint64_start_enter_time+va):this._pathMainVideoMap.delete(t)}),this._pathJoinRoom.uint64_end_time-this._pathJoinRoom.uint64_start_time>va&&(this._pathJoinRoom.uint64_end_time=this._pathJoinRoom.uint64_start_time+va)}getReportData(){this._basicInfo.uint32_networkType=Fh();let e={uint32_sdk_app_id:Number(this._room.sdkAppId),msg_user_info:new hI({userId:this._room.userId,tinyId:this._room.tinyId,role:this._room.role==="anchor"?20:21}),msg_basic_info:this._basicInfo,uint32_acc_ip:Vh(this._signalInfo.relayIp),uint32_client_ip:Vh(this._signalInfo.clientIp,!1),uint32_acc_port:this._signalInfo.relayPort||0,uint64_timestamp:Date.now(),uint32_seq:Math.floor(Math.random()*SE(2,31)),msg_path_enter_room:this._pathJoinRoom,msg_path_exit_room:this._pathLeaveRoom,msg_path_recv_video:[...this._pathMainVideoMap.values()].map(t=>t.statsToReport),msg_quality_statistics:[...this._remoteStreamStatMap.values()].map(t=>t.statsToReport),str_room_name:String(this._room.roomId||0),msg_path_recv_audio:[...this._pathMainAudioMap.values()].map(t=>t.statsToReport),uint32_info_client_ip:Vh(this._signalInfo.clientIp,!1),error_code:[],msg_local_statistics:this._localStreamStat.statsToReport};return __(e),e}report(){return N(this,null,function*(){try{this.prepareReport();let e=this.getReportData();yield this.upload(e),this.initData()}catch(e){this._log.warn(e)}})}upload(e){return N(this,null,function*(){if(e.msg_path_enter_room.uint64_start_time===0)return;let t=Number(this._room.sdkAppId),r=yield Wv(e),i=r instanceof ArrayBuffer,n="".concat(Fd(t,Id.KEY_POINT),"&gzip=").concat(+i),a=!1;navigator.sendBeacon&&(a=navigator.sendBeacon(n,r)),a||Dd({url:n,body:r}),this.uploadKVStat(ve),this.uploadKVStat($d)})}setConnectionType(e){this.connectionType=e,this._basicInfo.uint32_connection_type=e}uploadKVStat(e){return N(this,null,function*(){let t=e.getReportData();if(t.stats_count.length===0&&t.stats_distribution.length===0)return;t.msg_sdk_basic_info=Ke(_e({},t.msg_sdk_basic_info),{bytes_device_name:this._basicInfo.string_device_name||"",bytes_os_version:this._basicInfo.string_os_version||"",uint32_framework:this._frameWorkType,uint32_network_type:this._basicInfo.uint32_networkType||0}),this._log.debug(t);let r=yield Wv(t),i="".concat(Fd(+this._room.sdkAppId,Id.KV_STAT),"&gzip=").concat(+(r instanceof ArrayBuffer)),n=!1;navigator.sendBeacon&&(n=navigator.sendBeacon(i,r)),n||Dd({url:i,body:r})})}};le([fa({settings:{timeout:500,retries:3}})],JR.prototype,"upload",1);var va=5e3,J1={msg_user_info:null,uint32_video_avg_fps:0,uint32_video_width:0,uint32_video_height:0,uint32_video_avg_bitrate:0,uint32_video_block_time:0,uint32_video_play_time:0,uint32_audio_block_time:0,uint32_audio_play_time:0,uint32_audio_play_db:0,uint32_avg_down_loss:0,uint32_stream_type:0,uint32_video_render_first:0,uint32_video_block_count:0,uint32_audio_block_count:0,uint32_audio_bitrate:0,uint32_video_black_screen_subjective:0,uint32_audio_recv_bitrate:0,uint32_video_external_block_time:0,uint32_video_consume_render_rate:0},hI=class{constructor(e){this.str_identifier=String(e.userId),this.str_tinyid=String(e.tinyId||0),this.uint32_role=e.role}},K1=JR,pg=class{constructor(){T(this,"_startTime"),T(this,"_endTime"),this._startTime=0,this._endTime=0,this.start()}start(){this._startTime===0&&(this._startTime=He())}stop(){this._endTime===0&&(this._endTime=He())}getDuration(){return this._endTime===0?He()-this._startTime:this._endTime-this._startTime}get endTime(){return this._endTime}},X1=class{constructor(e){T(this,"_room",null),T(this,"_durationMap"),T(this,"_eventMap",new Map),this._room=e.room,this._durationMap=new Map,this.installEvents()}installEvents(){this._eventMap.set(X.SUBSCRIBE_SUCCESS,this.handleSubscribed).set(X.UNSUBSCRIBE_SUCCESS,this.handleStreamStopped).set(X.REMOTE_PUBLISH_STATE_CHANGED,e=>{let{room:t,prevMuteState:r,muteState:i}=e;var n;let{userId:a}=i;if(!this.hitTest(t))return;r.hasAudio&&!i.hasAudio&&this.stopDurationItem("".concat(a,"_","main"),O.AUDIO),r.hasVideo&&!i.hasVideo&&this.stopDurationItem("".concat(a,"_","main"),O.VIDEO),r.hasAuxiliary&&!i.hasAuxiliary&&this.stopDurationItem("".concat(a,"_","auxiliary"),O.VIDEO);let c=(n=this._room)==null?void 0:n.remotePublishedUserMap.get(a);!c||(!r.hasAudio&&i.hasAudio&&c.remoteAudioTrack.isSubscribed&&this.addDuractionItem(a,O.AUDIO,"main"),!r.hasVideo&&i.hasVideo&&c.remoteVideoTrack.isSubscribed&&this.addDuractionItem(a,O.VIDEO,"main"),!r.hasAuxiliary&&i.hasAuxiliary&&c.remoteAuxiliaryTrack.isSubscribed&&this.addDuractionItem(a,O.VIDEO,"auxiliary"))}),this._eventMap.forEach((e,t)=>te.on(t,e,this))}uninstallEvents(){this._eventMap.forEach((e,t)=>te.off(t,e,this)),this._eventMap.clear()}handleSubscribed(e){let{room:t,streamType:r,remotePublishedUser:i}=e;if(!this.hitTest(t))return;let{userId:n}=i,a="".concat(n,"_").concat(r);if(i.muteState.hasAudio&&r==="main")if(i.remoteAudioTrack.isSubscribed){let c=new pg,A=this._durationMap.get(a);A?this.isRecording(A.audio)||A.audio.push(c):this._durationMap.set(a,{userId:n,type:r,audio:[c],video:[]})}else this.stopDurationItem(a,O.AUDIO);if(i.muteState.hasVideo||i.muteState.hasAuxiliary)if(i.remoteVideoTrack.isSubscribed||i.remoteAuxiliaryTrack.isSubscribed){let c=new pg,A=this._durationMap.get(a);A?this.isRecording(A.video)||A.video.push(c):this._durationMap.set(a,{userId:n,type:r,audio:[],video:[c]})}else this.stopDurationItem(a,O.VIDEO)}handleStreamStopped(e){let{room:t,streamType:r,remotePublishedUser:i}=e;if(!this.hitTest(t))return;let{userId:n}=i,a="".concat(n,"_").concat(r);this.stopDurationItem(a,O.AUDIO),this.stopDurationItem(a,O.VIDEO)}isRecording(e){return e.findIndex(t=>t.endTime===0)>=0}addDuractionItem(e,t,r){let i="".concat(e,"_").concat(r),n=new pg,a=this._durationMap.get(i);a?this.isRecording(a[t])||a[t].push(n):this._durationMap.set(i,{userId:e,type:r,audio:t===O.AUDIO?[n]:[],video:t===O.AUDIO?[]:[n]})}stopDurationItem(e,t){if(this._durationMap.has(e)){let r=this._durationMap.get(e)[t].find(i=>i.endTime===0);r&&r.stop()}}hitTest(e){return this._room===e}getDuration(e,t){return this._durationMap.has(e)?this._durationMap.get(e)[t].reduce((r,i)=>r+i.getDuration(),0):0}getDurationMap(){return this._durationMap}reset(){this._durationMap.clear()}destroy(){this._room=null,this.uninstallEvents()}},z1=class{constructor(e){T(this,"_room"),T(this,"_renderFreezeMap",new Map),T(this,"_isVideoPlayingEventFiredMap",new Map),T(this,"_dataFreezeMap",new Map),T(this,"_monitorFreezeData",new Map),T(this,"_eventMap",new Map),this._room=e.room,this.installEvents()}installEvents(){this._eventMap.set(X.LEAVE_SUCCESS,e=>{let{room:t}=e;this.hitTest(t)&&this.stop()}).set(X.PLAY_TRACK_START,this.onPlayTrackStart).set(X.UNSUBSCRIBE_SUCCESS,e=>{let{room:t,streamType:r,remotePublishedUser:i}=e;if(!this.hitTest(t))return;let{userId:n}=i,a="".concat(n,"_").concat(r);this.stopDataFreeze({key:a,userId:n,type:r})}).set(X.REMOTE_PUBLISH_STATE_CHANGED,e=>{let{room:t,prevMuteState:r,muteState:i}=e;if(!this.hitTest(t))return;let{userId:n}=i;if(r.hasVideo&&!i.hasVideo){let a="main",c="".concat(i.userId,"_").concat(a);this.stopDataFreeze({key:c,userId:n,type:a})}if(r.hasAuxiliary&&!i.hasAuxiliary){let a="auxiliary",c="".concat(i.userId,"_").concat(a);this.stopDataFreeze({key:c,userId:n,type:a})}}).set(X.PLAYER_STATE_CHANGED,e=>{let{track:t,state:r,reason:i,type:n}=e;if(Zo(t)&&this.hitTest(t.room)&&n===O.VIDEO){if(r==="PLAYING"){let a="".concat(t.userId,"_").concat(t.streamType);this._isVideoPlayingEventFiredMap.set(a,!0)}i===O.MUTE?this.onVideoTrackMuted(t):i===O.UNMUTE&&this.onVideoTrackUnmuted(t)}}).set(X.HEARTBEAT_REPORT,this.onHearBeatReport),this._eventMap.forEach((e,t)=>te.on(t,e,this))}uninstallEvents(){this._eventMap.forEach((e,t)=>te.off(t,e,this)),this._eventMap.clear()}stop(){this._renderFreezeMap.clear(),this._dataFreezeMap.clear(),this._isVideoPlayingEventFiredMap.clear()}onVideoTrackMuted(e){if(!e.isSubscribed)return;let{userId:t,streamType:r}=e,i="".concat(t,"_").concat(r),n=this._dataFreezeMap.get(i),a=new pg;n?n.durationItemList.push(a):this._dataFreezeMap.set(i,{userId:t,type:r,durationItemList:[a],isFreezing(){let c=this.durationItemList[this.durationItemList.length-1];return c&&c.endTime===0}})}onVideoTrackUnmuted(e){if(!e.isSubscribed)return;let{userId:t,streamType:r}=e,i="".concat(t,"_").concat(r);this.stopDataFreeze({key:i,userId:t,type:r})}onHearBeatReport(e){let{room:t,report:r}=e;!this.hitTest(t)||r.msg_down_stream_info.forEach(i=>{let n=this._room.remotePublishedUserMap.get(i.msg_user_info.str_identifier);if(!n)return;let{userId:a,muteState:c}=n;i.msg_video_status.forEach(A=>{A.uint32_video_stream_type===2&&c.hasVideo&&!c.videoMuted&&n.remoteVideoTrack.isSubscribed&&this.handleRenderFreeze({userId:a,fps:A.uint32_video_dec_fps,type:"main"}),A.uint32_video_stream_type===7&&c.hasAuxiliary&&n.remoteAuxiliaryTrack.isSubscribed&&this.handleRenderFreeze({userId:a,fps:A.uint32_video_dec_fps,type:"auxiliary"})})})}stopDataFreeze(e){let{key:t,userId:r,type:i}=e,n=this._dataFreezeMap.get(t);if(!n||!n.isFreezing())return;let a=n.durationItemList[n.durationItemList.length-1];a.stop();let c=a.getDuration();c>UE?this._monitorFreezeData.set(t,{userId:r,type:i,duration:c}):n.durationItemList.pop()}getTotalDuration(e){return e.reduce((t,r)=>{let i=r.getDuration();return t+Math.min(i,5e3)},0)}handleRenderFreeze(e){return N(this,arguments,function(t){var r=this;let{userId:i,fps:n,type:a}=t;return function*(){let c="".concat(i,"_").concat(a),A=r._renderFreezeMap.get(c);if(n<=2){let d=He();A&&!A.isFreeze&&(A.freezeTimeline.push({startTime:d,endTime:0}),A.isFreeze=!0),A||r._renderFreezeMap.set(c,{userId:i,type:a,isFreeze:!0,freezeTimeline:[{startTime:d,endTime:0}],renderFreezeTotal:0})}else if(A&&A.isFreeze){A.isFreeze=!1;let d=A.freezeTimeline.pop();if(d){d.endTime=He();let g=d.endTime-d.startTime;A.freezeTimeline.push(d),A.renderFreezeTotal+=Math.min(5e3,g)}}}()})}onPlayTrackStart(e){let{track:t}=e;if(!Zo(t)||!this.hitTest(t.room)||t.kind!==O.VIDEO||t.hasFlag)return;let r="".concat(t.userId,"_").concat(t.streamType);this._isVideoPlayingEventFiredMap.has(r)||this._isVideoPlayingEventFiredMap.set(r,!1)}getDataFreezeDuration(e){let t={dataFreeze:0,count:0},r=this._dataFreezeMap.get(e);if(r){if(r.isFreezing()){let i=r.durationItemList[r.durationItemList.length-1];i.stop(),i.getDuration()<UE&&r.durationItemList.pop()}t.dataFreeze=this.getTotalDuration(r.durationItemList),t.count=r.durationItemList.length}return t}getRenderFreezeDuration(e){let t=this._renderFreezeMap.get(e),r=0,i=0;if(t)if(t.isFreeze){let n=He()-t.freezeTimeline[t.freezeTimeline.length-1].startTime;r=t.renderFreezeTotal+Math.min(n,5e3),i=t.freezeTimeline.length}else r=t.renderFreezeTotal;return{renderFreeze:r,count:i}}getMonitorFreeze(){return this._monitorFreezeData}isBlackStream(e){return!!this._isVideoPlayingEventFiredMap.has(e)&&!this._isVideoPlayingEventFiredMap.get(e)}resetMonitor(){this._monitorFreezeData.clear()}hitTest(e){return e===this._room}destroy(){this.uninstallEvents()}},q1=lr(Lr(),1),$1=[-1,-1,1,-1,-1,1,1,1],Z1=[0,0,1,0,0,1,1,1],Ra=class extends tt{constructor(e,t){if(super(),this.context=e,T(this,"name"),T(this,"input"),T(this,"output"),T(this,"texture"),T(this,"ctx2d",null),T(this,"fbo"),T(this,"width",0),T(this,"height",0),T(this,"x",0),T(this,"y",0),T(this,"program"),T(this,"vertexShader"),T(this,"fragmentShader"),T(this,"totalFrames",0),T(this,"dropFrames",0),T(this,"matchInputSize",!0),T(this,"texCoordBuffer"),T(this,"positionBuffer"),T(this,"lastInfo",{name:"",timestamp:0,totalFrames:0,x:0,y:0,width:0,height:0,fps:0}),T(this,"cost",0),T(this,"_canvas",null),T(this,"_image"),this.context.on("disconnect",this.close,this),this.name=t.name,this.matchInputSize=t.matchInputSize!==!1,this.width=t.width||e.width,this.height=t.height||e.height,this._image=t.image,e instanceof ls){if(e.ctx&&t.create2d){let r=document.createElement("canvas"),i=typeof r.transferControlToOffscreen=="function"?r.transferControlToOffscreen():r;i.width=this.width,i.height=this.height,this.ctx2d=i.getContext("2d"),this._image=i,this._canvas=i}}else try{let r=e.ctx;this.texCoordBuffer=this.createBuffer(Z1),this.positionBuffer=this.createBuffer($1),t.createTexture!==!1&&(this.texture=r.createTexture(),this.useTexture(),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.pixelStorei(r.PACK_ALIGNMENT,1),r.pixelStorei(r.UNPACK_ALIGNMENT,1)),t.useFbo&&(this.fbo=r.createFramebuffer(),this.useBufferFrame(),this.useTexture(),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,this.width,this.height,0,r.RGBA,r.UNSIGNED_BYTE,null),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,this.texture,0)),t.useDefaultProgram?this.program=e.defaultProgam:(t.vertexShaderSource||t.fragmentShaderSource)&&(this.vertexShader=t.vertexShaderSource?e.createShader(r.VERTEX_SHADER,t.vertexShaderSource):e.defaultVShader,this.fragmentShader=t.fragmentShaderSource?e.createShader(r.FRAGMENT_SHADER,t.fragmentShaderSource):e.defaultFShader,this.program=e.createProgram(this.vertexShader,this.fragmentShader))}catch(r){this.context.destroy(r)}}get image(){return this._image}set image(e){this._image=e}createFramebuffer(e){let t=this.context.ctx,r=t.createFramebuffer();return t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),r}connect(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return e.addInput(this,...r),this.output=e,e}addInput(e){this.input=e,this.matchInputSize&&e.width&&e.height&&this.resize(e.width,e.height)}requestFrame(e){let t=Date.now();return!!(this.context instanceof mn&&this.render(e)||this.context instanceof ls&&this.render2d(e))&&(this.totalFrames++,this.cost=Date.now()-t,!0)}render2d(e){var t;return!((t=this.input)==null||!t.requestFrame(e))&&this.draw2d(this.input.image,0,0,this.width,this.height)}disconnect(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=this.output)==null||e.removeInput(this,...r),delete this.output}removeInput(e){delete this.input}close(){var e,t;if(this.context.off("disconnect",this.close,this),(e=this.output)==null||e.removeInput(this),delete this.output,(t=this.input)==null||t.disconnect(),this.context instanceof mn){let r=this.context.ctx;r.deleteBuffer(this.texCoordBuffer),r.deleteBuffer(this.positionBuffer),this.fbo&&r.deleteFramebuffer(this.fbo),this.texture&&r.deleteTexture(this.texture),this.vertexShader&&this.vertexShader!==this.context.defaultVShader&&r.deleteShader(this.vertexShader),this.fragmentShader&&this.fragmentShader!==this.context.defaultFShader&&r.deleteShader(this.fragmentShader),this.program&&this.program!==this.context.defaultProgam&&r.deleteProgram(this.program)}this._canvas&&(this._canvas.width=0,this._canvas.height=0,this.ctx2d=null),this.removeAllListeners()}useTexture(){this.useTextures(this.texture)}useInputTexture(){var e;this.useTextures((e=this.input)==null?void 0:e.texture)}useTextures(){let e=this.context.ctx;for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];r.forEach((n,a)=>{n&&(e.activeTexture(e.TEXTURE0+a),e.bindTexture(e.TEXTURE_2D,n))})}useProgram(){this.context.ctx.useProgram(this.program)}useBufferFrame(){let e=this.context.ctx;e.bindFramebuffer(e.FRAMEBUFFER,this.fbo||null)}createBuffer(e){let t=this.context.ctx,r=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW),r}setTexBuffer(e){let t=this.context.ctx;t.bindBuffer(t.ARRAY_BUFFER,this.texCoordBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW)}setPosBuffer(e){let t=this.context.ctx;t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW)}changeBufferData(e,t){let r=this.context.ctx;r.bindBuffer(r.ARRAY_BUFFER,e),r.bufferData(r.ARRAY_BUFFER,new Float32Array(t),r.STATIC_DRAW)}setAttributes(){let e=this.context.ctx;for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];r.forEach((n,a)=>{e.enableVertexAttribArray(a),e.bindBuffer(e.ARRAY_BUFFER,n),e.vertexAttribPointer(a,2,e.FLOAT,!1,0,0)})}getVertexPoint(e,t){return[e/this.width*2-1,t/this.height*2-1]}layout2texCoords(e){return[...this.getVertexPoint(e.x,e.y),...this.getVertexPoint(e.x+e.width,e.y),...this.getVertexPoint(e.x,e.y+e.height),...this.getVertexPoint(e.x+e.width,e.y+e.height)]}resize(e,t){if(this.width!==e||this.height!==t){if(this.width=e,this.height=t,this._canvas&&(this._canvas.width=e,this._canvas.height=t),this.texture&&this.fbo){this.useTexture();let r=this.context.ctx;r.texImage2D(r.TEXTURE_2D,0,r.RGBA,e,t,0,r.RGBA,r.UNSIGNED_BYTE,null)}this.output&&this.output.matchInputSize&&this.output.resize(e,t)}}draw(e,t){this.setAttributes(e||this.positionBuffer,t||this.texCoordBuffer);let r=this.context.ctx;r.drawArrays(r.TRIANGLE_STRIP,0,4)}draw2d(e,t,r,i,n){return!(!this.ctx2d||!e)&&(e instanceof ImageData?this.ctx2d.putImageData(e,t,r):this.ctx2d.drawImage(e,t,r,i,n),!0)}getInfo(){var e;let{totalFrames:t,x:r,y:i,width:n,height:a,name:c,cost:A}=this,d=Date.now(),g=(t-this.lastInfo.totalFrames)/((d-this.lastInfo.timestamp)/1e3)|0;return this.lastInfo={totalFrames:t,x:r,y:i,width:n,height:a,timestamp:d,fps:g,name:c,cost:A},_e({parent:(e=this.input)==null?void 0:e.getInfo()},this.lastInfo)}createTexture(e){let t=this.context.ctx,r=t.createTexture();return this.useTextures(r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.pixelStorei(t.PACK_ALIGNMENT,1),t.pixelStorei(t.UNPACK_ALIGNMENT,1),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),r}};le([mr(tt.INIT,"connected",{sync:!0})],Ra.prototype,"connect",1),le([mr("connected",tt.INIT,{ignoreError:!0,sync:!0})],Ra.prototype,"disconnect",1),le([mr([],"closed",{sync:!0})],Ra.prototype,"close",1);var ex=[0,1,1,1,0,0,1,0],KR=class extends Ra{constructor(e,t){super(e,Object.assign({useDefaultProgram:!0,createTexture:!1,name:"destination"},t)),T(this,"_intervalId",0),T(this,"_sequence",0),T(this,"checkGLError",!1),e instanceof ls?this.ctx2d=e.ctx:e.available&&(t!=null&&t.mirrorUpAndDown)&&this.setTexBuffer(ex)}start(e){this._intervalId=Qt.run("intervalInWorker",()=>{if(e!==this.context.frameRate&&(Qt.clearTask(this._intervalId),this.start(this.context.frameRate)),this.requestFrame(this._sequence++),this.checkGLError&&this.context instanceof mn){let t=this.context.ctx.getError();t&&this.context.destroy(new Error("".concat(this.name," req ").concat(this._sequence," render ").concat(this.totalFrames," faild ").concat(t)))}},{fps:this.context.frameRate})}render(e){var t;return!((t=this.input)==null||!t.requestFrame(e))&&(this.useProgram(),this.useBufferFrame(),this.useInputTexture(),this.draw(),!0)}addInput(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];super.addInput(e,...r),this.start(this.context.frameRate)}removeInput(e){super.removeInput(e),Qt.clearTask(this._intervalId)}resize(e,t){super.resize(e,t),this.context.setSize(e,t)}},gI=class extends KR{constructor(e,t){super(e,t),T(this,"_videoTrack"),[this._videoTrack]=e._canvas.captureStream(e.frameRate).getVideoTracks();let r=i=>{var n;let a=()=>{var A;return(A=this._videoTrack)==null?void 0:A.removeEventListener(i,c)},c=()=>{a(),this.context.destroy(new Error("video track ".concat(i)))};this.once("closed",a),(n=this._videoTrack)==null||n.addEventListener(i,c)};e instanceof mn&&r("mute"),r("ended")}get videoTrack(){return this._videoTrack}close(){var e;super.close(),(e=this._videoTrack)==null||e.stop(),delete this._videoTrack}},tx=class extends gI{render(e){var t;return!((t=this.input)==null||!t.requestFrame(e))}},rx=class extends gI{constructor(e,t){super(e,{name:"smallDestination"}),this.resolution=t}resize(e,t){let r,i=e*t,n=this.resolution.width*this.resolution.height;ae.info("big res: ".concat(e,"*").concat(t," small res: ").concat(this.resolution.width,"*").concat(this.resolution.height," ")),i>n?r=i/n:(ae.warn("Small stream resolution is not smaller than big stream, which is invalid. big: ".concat(e," * ").concat(t," small: ").concat(this.resolution.width," * ").concat(this.resolution.height)),r=i/19200),super.resize(e/Math.sqrt(r),t/Math.sqrt(r))}},XR=class extends Ra{constructor(e,t){super(e,_e({name:"imageSource"},t)),T(this,"_lastImage"),T(this,"_totalFrames",0),T(this,"_autoResize",!1),this._autoResize=(t==null?void 0:t.autoResize)!==!1}_render(e,t){let{width:r,height:i}=this;if(this.image instanceof HTMLVideoElement){if(mt(this.image.getVideoPlaybackQuality)&&!Uc){let n=this.image.getVideoPlaybackQuality().totalVideoFrames;if(this._totalFrames===n)return!1;this._totalFrames=n,this.dropFrames=this._totalFrames-this.totalFrames}if({videoWidth:r,videoHeight:i}=this.image,!r||!i)return!1;this.image.width=r,this.image.height=i}else if(this.image instanceof HTMLImageElement||this.image instanceof ImageData||this.image instanceof ImageBitmap){if({width:r,height:i}=this.image,this.image!==this._lastImage)this._lastImage=this.image;else if(r===this.width&&i===this.height)return!1}else(this.image instanceof HTMLCanvasElement||this.image instanceof OffscreenCanvas)&&({width:r,height:i}=this.image,this._lastImage=this.image);if(!this._autoResize)return!0;if(this.width===r&&this.height===i&&this.totalFrames){if(t){this.useTexture();let n=this.context.ctx;n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.image)}}else{if(t){this.useTexture();let n=this.context.ctx;n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,this.image)}this.resize(r,i)}return!0}render(e){return this._render(e,!0)}render2d(e){return this._render(e,!1)}},zR=class extends XR{constructor(e,t,r){super(e,r),T(this,"_player"),this._player=new ts({id:r.name,track:t,muted:!0,container:null,objectFit:"contain",log:r.logger}),this.name="videoTrackSource",this._player.play()}get image(){return this._player.element}replaceTrack(e){this._player.setTrack(e),this._player.play()}close(){super.close(),this._player.stop()}},qR=class extends tt{constructor(e){super(),T(this,"frameRate"),T(this,"_canvas"),T(this,"log"),T(this,"hasAlpha",!1),T(this,"name"),this.name=e.name,this.log=e.logger.createChild({id:"vc-".concat(this.name)}),this.frameRate=e.frameRate}set width(e){this._canvas&&(this._canvas.width=e)}get width(){var e;return((e=this._canvas)==null?void 0:e.width)||0}set height(e){this._canvas&&(this._canvas.height=e)}get height(){var e;return((e=this._canvas)==null?void 0:e.height)||0}setSize(e,t){this._canvas&&(this._canvas.width=e,this._canvas.height=t)}createVideoTrackSource(e,t){return new zR(this,e,{logger:this.log,name:t})}createVideoTrackDestination(e){return new gI(this,e)}createVideoImageSource(e,t){return new XR(this,t?Object.assign(t,{logger:this.log,image:e}):{logger:this.log,image:e})}get available(){return this.state==="created"}disconnect(){this.emit("disconnect")}},ix={alpha:!0,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0,powerPreference:"low-power"},mn=class extends qR{constructor(){super(...arguments),T(this,"defaultProgam"),T(this,"defaultVShader"),T(this,"defaultFShader"),T(this,"ctx")}create(){if(this._canvas||(this._canvas=document.createElement("canvas")),this.ctx=this._canvas.getContext("webgl2",ix),!this.ctx)throw new Error("webgl2 not supported");this.defaultVShader=this.createShader(this.ctx.VERTEX_SHADER,`
// é¡¶ç¹çè²å¨
attribute vec4 a_position;
attribute vec2 a_texCoord;
varying vec2 v_texCoord;

void main() {
  gl_Position = a_position;
  v_texCoord = a_texCoord;
}
`),this.defaultFShader=this.createShader(this.ctx.FRAGMENT_SHADER,`
// çåçè²å¨
precision mediump float;
varying vec2 v_texCoord;
uniform sampler2D u_texture;

void main() {
  gl_FragColor = texture2D(u_texture, v_texCoord);
} `),this.defaultProgam=this.createProgram(this.defaultVShader,this.defaultFShader),this._canvas.addEventListener("webglcontextlost",()=>{this.destroy(new Error("webgl context lost"))}),this.log.info("video context created use webgl")}destroy(e){return this.disconnect(),this.log.info("video context destroy ".concat(e?": ".concat(e):"")),this.ctx&&(this.ctx.deleteShader(this.defaultVShader),this.ctx.deleteShader(this.defaultFShader),this.ctx.deleteProgram(this.defaultProgam),delete this.ctx),e}set width(e){var t;(t=this.ctx)==null||t.viewport(0,0,e,this.height),super.width=e}set height(e){var t;(t=this.ctx)==null||t.viewport(0,0,this.width,e),super.height=e}setSize(e,t){var r;(r=this.ctx)==null||r.viewport(0,0,e,t),super.setSize(e,t)}createShader(e,t){let r=this.ctx,i=r.createShader(e);return r.shaderSource(i,t),r.compileShader(i),i}createProgram(e,t){let r=this.ctx,i=r.createProgram();return r.attachShader(i,e),r.attachShader(i,t),r.linkProgram(i),r.getProgramParameter(i,r.LINK_STATUS)||this.log.error(r.getProgramInfoLog(i)),i}};le([mr(tt.INIT,"created",{sync:!0})],mn.prototype,"create",1),le([mr("created",tt.INIT,{ignoreError:!0,sync:!0,success(e){e&&this.emit("unavailable",e),this.removeAllListeners()}})],mn.prototype,"destroy",1);var ls=class extends qR{constructor(){super(...arguments),T(this,"ctx")}create(e){if(this.hasAlpha=e.alpha,this._canvas=document.createElement("canvas"),this.ctx=this._canvas.getContext("2d",{alpha:e.alpha}),!this.ctx)throw new Error("2d context not supported");this.log.info("video context created use 2d")}destroy(e){this.disconnect(),this.log.info("video context destroy ".concat(e?": ".concat(e):"")),delete this.ctx,this._canvas&&(this._canvas.remove(),this._canvas.width=0,this._canvas.height=0,delete this._canvas),this.removeAllListeners()}};le([mr(tt.INIT,"created",{sync:!0})],ls.prototype,"create",1),le([mr("created",tt.INIT,{ignoreError:!0,sync:!0})],ls.prototype,"destroy",1);var nx=[1,0,0,0,1,1,0,1],ox=class extends Ra{constructor(e){if(super(e,{useDefaultProgram:!0,useFbo:!0,create2d:!0,name:"mirror"}),e instanceof mn)try{this.setTexBuffer(nx)}catch(t){e.destroy(t)}}draw2d(e,t,r,i,n){if(this.ctx2d){this.ctx2d.save(),this.ctx2d.scale(-1,1),this.ctx2d.translate(-this.width,0);let a=super.draw2d(e,t,r,i,n);return this.ctx2d.restore(),a}return!1}render(e){var t;return!((t=this.input)==null||!t.requestFrame(e))&&(this.useProgram(),this.useBufferFrame(),this.useInputTexture(),this.draw(),!0)}},sx=class{constructor(e,t){this.node=e,this.layout=t,T(this,"positionBuffer")}get x(){return this.layout.x||this.node.x}get y(){return this.layout.y||this.node.y}get width(){return this.layout.width||this.node.width}get height(){return this.layout.height||this.node.height}get right(){return this.x+this.width}get bottom(){return this.y+this.height}},ax=class extends Ra{constructor(e){super(e,{useDefaultProgram:!0,useFbo:!0,name:"mix",create2d:!0}),T(this,"inputs",[])}addInput(e,t){if(this.inputs[t.zIndex])throw new Error("input already exists");let r=new sx(e,t);this.inputs[t.zIndex]=r}resize(e,t){let r=this.inputs.reduce((i,n)=>n?Object.assign(i,{width:Math.max(i.width,n.right),height:Math.max(i.height,n.bottom)}):i,{width:0,height:0});super.resize(r.width,r.height),this.context instanceof mn&&this.inputs.forEach(i=>{if(i){let n=this.layout2texCoords(i);i.positionBuffer?this.changeBufferData(i.positionBuffer,n):i.positionBuffer=this.createBuffer(n)}})}connect(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return super.connect(e,...r),this.resize(0,0),e}removeInput(e){this.inputs[this.inputs.findIndex(t=>(t==null?void 0:t.node)===e)]=void 0}render(e){let t=this.context.ctx;if(t.clearColor(0,0,0,0),!this.inputs.reduce((r,i)=>(!i||!i.node.requestFrame(e))&&r,!0)&&t){this.useProgram(),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),this.useBufferFrame();for(let r=0;r<this.inputs.length;r++){let i=this.inputs[r];i&&(i.node.useTexture(),this.draw(i.positionBuffer))}return!0}return!1}render2d(e){if(!this.inputs.reduce((t,r)=>(!r||!r.node.requestFrame(e))&&t,!0)&&this.ctx2d){this.ctx2d.clearRect(0,0,this.width,this.height);for(let t=0;t<this.inputs.length;t++){let r=this.inputs[t];r&&this.draw2d(r.node.image,r.x,r.y,r.width,r.height)}return!0}return!1}getInfo(){let{totalFrames:e,x:t,y:r,width:i,height:n,name:a}=this,c=Date.now(),A=(e-this.lastInfo.totalFrames)/((c-this.lastInfo.timestamp)/1e3)|0;return this.lastInfo={totalFrames:e,x:t,y:r,width:i,height:n,timestamp:c,fps:A,name:a},_e({parent:this.inputs.filter(d=>d).map(d=>d.node.getInfo())},this.lastInfo)}close(){super.close(),this.inputs.forEach(e=>{var t,r;if(e&&((t=e.node)==null||t.disconnect(),e.positionBuffer&&this.context instanceof mn))try{(r=this.context.ctx)==null||r.deleteBuffer(e.positionBuffer)}catch{}})}},cx=class extends zR{constructor(e,t){super(e,t.input,{name:"vb",create2d:!1,useDefaultProgram:!1,useFbo:!1,createTexture:!0,logger:e.log}),T(this,"ready",!1),T(this,"_bgTexture"),T(this,"_waterMarkTexture"),T(this,"_lastMaskTexture"),T(this,"_lastMaskFbo"),T(this,"_textureValid",!1),T(this,"_selfieTextureValid",!1),T(this,"_selfieSegmentation"),T(this,"wasm"),T(this,"_prePrograme"),T(this,"_segmentationMask"),T(this,"_weixin",!1),t.selfieSegmentation&&(this._selfieSegmentation=t.selfieSegmentation,this._selfieSegmentation.onResults=this.onPredict.bind(this)),this.init(t).catch(()=>this.context.destroy(new Error("selfie_segmentation init faild")))}init(e){return N(this,null,function*(){var t,r;let i=e.Wasm,n=this.context.ctx;if(this.wasm=new i.AllIn1(n),this.wasm.blurRadius=e.blurRadius||3,this.wasm.mirror=!!e.mirror,this.wasm.vbMode=e.bg==="blur"?1:e.bg instanceof HTMLImageElement?2:e.bg==="green"?3:0,e.waterMark){let{x:a,y:c,width:A,height:d}=e.waterMark;this.wasm.setWaterMark(a,c,A,d)}if(e.beautyParams){let{beauty:a,brightness:c,ruddy:A}=e.beautyParams;this.wasm.setBeauty(a,c,A,(t=this.context._canvas)==null?void 0:t.width,(r=this.context._canvas)==null?void 0:r.height)}if(this.program=this.wasm.init(),this.useProgram(),this.setAttributes(this.positionBuffer,this.texCoordBuffer),n.uniform1i(n.getUniformLocation(this.program,"mask"),1),e.bg instanceof HTMLImageElement&&(n.uniform1i(n.getUniformLocation(this.program,"bg"),2),this._bgTexture=this.createTexture(e.bg)),e.waterMark&&(n.uniform1i(n.getUniformLocation(this.program,"waterMark"),3),this._waterMarkTexture=this.createTexture(e.waterMark.image)),n.uniform1i(n.getUniformLocation(this.program,"lastMask"),4),this._weixin){let a=this.context.createShader(n.FRAGMENT_SHADER,`#version 300 es
precision highp float;
uniform sampler2D u_texture;
uniform sampler2D mask;

in vec2 v_texCoord;
out vec4 outColor;
void main() {
  outColor = vec4(texture(u_texture, v_texCoord).rgb, texture(mask, v_texCoord).a);
}`),c=this.context.createShader(n.VERTEX_SHADER,`#version 300 es
in vec2 a_position;
in vec2 a_texCoord;
out vec2 v_texCoord;
void main() {
  gl_Position = vec4(a_position.x, a_position.y, 0, 1);
  v_texCoord = a_texCoord;
}`);this._prePrograme=this.context.createProgram(c,a),n.useProgram(this._prePrograme),this.setAttributes(this.positionBuffer,this.texCoordBuffer),n.uniform1i(n.getUniformLocation(this._prePrograme,"mask"),1)}this.ready=!0})}onPredict(e){var t;let r=this.context.ctx;this._weixin&&(this._lastMaskTexture||(this._lastMaskTexture=this.createTexture(this.image),this._lastMaskFbo=this.createFramebuffer(this._lastMaskTexture))),this.useProgram(),this._weixin?this.useTexture():this==null||this._selfieSegmentation.bindTexture(),r.activeTexture(r.TEXTURE1),(t=this._selfieSegmentation)==null||t.bindTexture2d(e),r.activeTexture(r.TEXTURE2),r.bindTexture(r.TEXTURE_2D,this._bgTexture||null),r.activeTexture(r.TEXTURE3),r.bindTexture(r.TEXTURE_2D,this._waterMarkTexture||null),this.useBufferFrame(),r.drawArrays(r.TRIANGLE_STRIP,0,4),this._segmentationMask=e,this.totalFrames++}render(e){var t,r,i;let n=this.context.ctx;if(typeof this.image.getVideoPlaybackQuality=="function"&&!Uc){let d=this.image.getVideoPlaybackQuality().totalVideoFrames;if(this._totalFrames===d)return!1;this._totalFrames=d,this.dropFrames=this._totalFrames-this.totalFrames}let{videoWidth:a,videoHeight:c}=this.image;this.image.width=a,this.image.height=c;let A=!1;if(this.totalFrames)this._weixin?this.useTexture():this==null||this._selfieSegmentation.bindTexture(),A=this._selfieTextureValid,this._selfieTextureValid=!0;else{if(!this.program)return!1;this.useTexture(),A=this._textureValid,this._textureValid=!0}return this.width===a&&this.height===c&&A?n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.image):(this.resize(a,c),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,this.image)),this.ready&&(this._weixin&&(n.useProgram(this._prePrograme),this.useTexture(),this._segmentationMask&&(n.activeTexture(n.TEXTURE1),(t=this._selfieSegmentation)==null||t.bindTexture2d(this._segmentationMask),n.bindFramebuffer(n.FRAMEBUFFER,this._lastMaskFbo||null)),n.drawArrays(n.TRIANGLE_STRIP,0,4),(r=this._selfieSegmentation)==null||r.bindTexture(),this._segmentationMask?n.copyTexSubImage2D(n.TEXTURE_2D,0,0,0,0,0,a,c):n.copyTexImage2D(n.TEXTURE_2D,0,n.RGBA,0,0,a,c,0)),(i=this._selfieSegmentation)==null||i.send(a,c)),this.totalFrames||(n.activeTexture(n.TEXTURE2),n.bindTexture(n.TEXTURE_2D,this._bgTexture||null),n.activeTexture(n.TEXTURE3),n.bindTexture(n.TEXTURE_2D,this._waterMarkTexture||null),n.drawArrays(n.TRIANGLE_STRIP,0,4)),!1}close(){var e;super.close();let t=this.context.ctx;this._bgTexture&&t.deleteTexture(this._bgTexture),this._waterMarkTexture&&t.deleteTexture(this._waterMarkTexture),this._lastMaskTexture&&t.deleteTexture(this._lastMaskTexture),this._lastMaskFbo&&t.deleteFramebuffer(this._lastMaskFbo),this._prePrograme&&t.deleteProgram(this._prePrograme),(e=this.wasm)==null||e.close()}},lx=class extends q1.EventEmitter{constructor(e){super(),this.room=e,T(this,"videoContext"),T(this,"_glVideoContext"),T(this,"_2dVideoContext"),T(this,"destination"),T(this,"smallVideoContext"),T(this,"smallDestination"),T(this,"smallTrackSource"),T(this,"smallImageSource"),T(this,"_isMirror",!1),T(this,"cameraTrack"),T(this,"cameraNode"),T(this,"mirrorNode"),T(this,"mixNode"),T(this,"screenTrack"),T(this,"screenNode"),T(this,"selfModel",!1),T(this,"blurRadius",3),T(this,"arTrack"),T(this,"Wasm"),T(this,"waterMarkNode"),T(this,"_waterMarkOption"),T(this,"watermarkImageList",[]),T(this,"_beautyParams"),T(this,"isUsingArTrack",!1),T(this,"_isMixScreen",!1),T(this,"_virtualBackground"),T(this,"virtualBackgroundInstance"),T(this,"_bgAssetPath"),T(this,"log",ae.createLogger({id:"vm"})),T(this,"_checkId",0),T(this,"_use2d",!1),T(this,"_autoSwitchRenderMode",!0),T(this,"_selfieSegmentation"),e&&(this.log.setUserId(e.userId),this.log.setSdkAppId(e.sdkAppId)),this.smallVideoContext=new ls({frameRate:15,logger:this.log,name:"s"}),this.enablePrintDetail()}get _hasVirtualBg(){return!!this._virtualBackground}get _hasWaterMark(){return this.watermarkImageList.length>0}get renderMode(){return this._autoSwitchRenderMode?"auto":this._use2d?"2d":"webgl"}set renderMode(e){if(this._autoSwitchRenderMode=e==="auto",this._autoSwitchRenderMode)return;let t=e==="2d";this._use2d!==t&&(this._use2d=t,this.clear(),this.videoContext=this._use2d?this.get2dVideoContext():this.getGlVideoContext(),this.update())}get2dVideoContext(){return this._2dVideoContext?this._2dVideoContext.destroy():this._2dVideoContext=new ls({frameRate:15,logger:this.log,name:"m"}),this._2dVideoContext.create({alpha:this._hasWaterMark||this._hasVirtualBg}),this.sendCreateResult("videoCtx2d",this._2dVideoContext.ctx?void 0:new Error("create 2d context failed")),this._2dVideoContext}getGlVideoContext(){if(this._glVideoContext){if(this._glVideoContext.available)return this._glVideoContext}else this._glVideoContext=new mn({frameRate:15,logger:this.log,name:"m"});try{this._glVideoContext.create(),this.sendCreateResult(),this._glVideoContext.on("unavailable",(e,t)=>{this.emit("error",{reason:e,error:t}),this.log.warn("video context unavailable",e,t),this.sendCreateResult("videoCtxGl",t||new Error(e)),this.update()})}catch(e){this.emit("error",{reason:"create",error:e}),this.sendCreateResult("videoCtxGl",e)}return this._glVideoContext}enablePrintDetail(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:2e3;this._checkId=Qt.run(vh,()=>{this.destination&&this.log.debug(this.destination.getInfo())},{delay:e})}destroy(){var e,t;(e=this._2dVideoContext)==null||e.destroy(),(t=this._glVideoContext)==null||t.destroy(),this.smallVideoContext.destroy(),Qt.clearTask(this._checkId)}get needAlpha(){return this._hasWaterMark||this._hasVirtualBg}get active(){return(Uc||this._isMixScreen||this._isMirror||this._hasWaterMark||this._hasVirtualBg||this._beautyParams)&&this.checkOrCreateVideoContext()}sendCreateResult(){let e=arguments.length>1?arguments[1]:void 0,t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"videoCtxGl")==="videoCtxGl"?512700:512701;e?ve.addFailedEvent({key:t,error:e}):ve.addSuccessEvent({key:t})}checkOrCreateVideoContext(){let e=this._use2d;if(this._autoSwitchRenderMode&&(this._use2d=!this._hasVirtualBg),this.videoContext)if(this.videoContext.available){let t=!this.videoContext.hasAlpha&&this.needAlpha;if(this._autoSwitchRenderMode&&e===this._hasVirtualBg)this.clear();else{if(!t||!this._use2d)return!0;this.clear()}}else this.clear(),this._use2d=!0;return this.videoContext=this._use2d?this.get2dVideoContext():this.getGlVideoContext(),this.videoContext.available}get smallTrack(){var e;return(e=this.smallDestination)==null?void 0:e.videoTrack}get hasSmall(){return!!this.smallTrack}get initialTrack(){var e;return(e=this.cameraTrack)==null?void 0:e.mediaTrack}initVirtualBackground(e){return this._selfieSegmentation=e,this._selfieSegmentation.changeModel()}_setMainOutput(e){var t;try{let r=this.cameraTrack,{small:i,settings:n,player:a}=r;i?(this.smallVideoContext.available||(this.smallVideoContext.create({alpha:!1}),this.smallDestination=new rx(this.smallVideoContext,i)),this.smallVideoContext.frameRate=i.frameRate,this.smallDestination.resolution=i,e?(this.smallTrackSource&&(this.smallTrackSource.close(),delete this.smallTrackSource),this.smallImageSource?this.smallImageSource.image=e:(this.smallImageSource=this.smallVideoContext.createVideoImageSource(e),this.smallImageSource.connect(this.smallDestination))):(this.smallImageSource&&(this.smallImageSource.close(),delete this.smallImageSource),this.smallTrackSource?this.smallTrackSource.replaceTrack(this.initialTrack):(this.smallTrackSource=this.smallVideoContext.createVideoTrackSource(this.initialTrack,"smallTrackSource"),this.smallTrackSource.width=n.width,this.smallTrackSource.height=n.height,this.smallTrackSource.connect(this.smallDestination)))):this.smallVideoContext.available&&(this.smallVideoContext.destroy(),delete this.smallDestination,delete this.smallTrackSource,delete this.smallImageSource),Uc&&a.setCanvas(e);let c=e&&((t=this.destination)==null?void 0:t.videoTrack)||this.initialTrack;return this.isUsingArTrack&&this.arTrack&&(this.emit("output-track-changed"),c=this.arTrack),this._selfieSegmentation&&e&&!this._use2d&&(this._selfieSegmentation._glName||this._selfieSegmentation.setCanvas(e)),this.log.info("set main output ".concat(c?c.label:"no output track")),r.setOutputMediaStreamTrack(c)}catch(r){this.log.error("set main output failed",r)}}update(){return N(this,null,function*(){var e,t;if(!this.cameraTrack||!this.cameraTrack.mediaTrack)return;if(!this.active)return this.cameraNode&&this.clear(),this._setMainOutput();let{settings:r,profile:i}=this.cameraTrack;if(this._use2d||!this._virtualBackground&&!this._beautyParams?(this.destination||(this.destination=this.videoContext.createVideoTrackDestination({name:"mainDestination",logger:this.log})),this.cameraNode?this.cameraNode.replaceTrack(this.initialTrack):(this.cameraNode=this.videoContext.createVideoTrackSource(this.initialTrack,"cameraNodeSource"),this.cameraNode.resize(r.width,r.height))):(this.cameraNode&&this.cameraNode.close(),this.destination||(this.destination=new tx(this.videoContext,{name:"mainDestination",logger:this.log})),this.cameraNode=new cx(this.videoContext,{input:this.cameraTrack.mediaTrack,mirror:this._isMirror,bg:this._virtualBackground,selfModel:this.selfModel,waterMark:this._waterMarkOption,beautyParams:this._beautyParams,useTflite:!0,blurRadius:this.blurRadius,assetPath:this._bgAssetPath,selfieSegmentation:this._selfieSegmentation,Wasm:this.Wasm}),this.cameraNode.connect(this.destination)),this.videoContext.frameRate=i.frameRate,this._use2d){let n=this.cameraNode;n.disconnect(),this._isMirror&&(this.mirrorNode||(this.mirrorNode=new ox(this.videoContext)),n=n.connect(this.mirrorNode),n.disconnect(),this.log.info("start mirror")),this.mixNode&&this.mixNode.close(),delete this.mixNode,(this._isMixScreen||this._hasWaterMark)&&(this.mixNode=new ax(this.videoContext),n.connect(this.mixNode,{zIndex:1}),this._hasWaterMark&&!this.waterMarkNode&&this._waterMarkOption&&(this.waterMarkNode=this.videoContext.createVideoImageSource(this._waterMarkOption.image,{autoResize:!1,logger:this.log}),this.waterMarkNode.resize(this._waterMarkOption.width,this._waterMarkOption.height),this.waterMarkNode.x=this._waterMarkOption.x,this.waterMarkNode.y=this._waterMarkOption.y),(e=this.waterMarkNode)==null||e.connect(this.mixNode,{zIndex:2}),this._isMixScreen&&this.screenTrack&&!this.screenNode&&(this.screenNode=this.videoContext.createVideoTrackSource(this.screenTrack.mediaTrack,"screenNodeSource")),(t=this.screenNode)==null||t.connect(this.mixNode,{zIndex:0}),n=this.mixNode,this.log.info("start mix","".concat(this.mixNode.width,"x").concat(this.mixNode.height))),n.connect(this.destination)}return this.log.info("update ".concat(this._use2d?"2d":"webgl")),this._setMainOutput(this.videoContext._canvas)})}changeInput(e){var t,r,i,n;if(e instanceof Ia)return this.log.info("change screen input",(t=e.mediaTrack)==null?void 0:t.label),this.setScreenTrack(e);if(e instanceof ti)return this.log.info("change video input",(r=e.mediaTrack)==null?void 0:r.label),this.setCameraTrack(e);if(e instanceof iu){this.log.info("change remote input",(i=e.mediaTrack)==null?void 0:i.label);let a=e.mediaTrack;if(l_===17&&!e.source&&e.player.element){let c=new ls({frameRate:15,logger:this.log,name:e.userId});c.create({alpha:!1});let A=c.createVideoImageSource(e.player.element);e.source=A;let d=new KR(c);A.connect(d),e.player.setCanvas(c._canvas)}return e.setOutputMediaStreamTrack(a)}this.log.warn("change unknown input",(n=e.mediaTrack)==null?void 0:n.label)}removeInput(e){var t;e instanceof Ia?((t=this.screenNode)==null||t.close(),delete this.screenNode,delete this.screenTrack,this.update()):e instanceof ti?(this.clear(),delete this.cameraTrack,this.smallImageSource&&(this.smallImageSource.close(),delete this.smallImageSource),this.smallTrackSource&&(this.smallTrackSource.close(),delete this.smallTrackSource)):e instanceof iu&&e.source&&e.source.context.destroy()}setCameraTrack(e){return N(this,null,function*(){this.cameraTrack=e,this.update()})}setScreenTrack(e){return this.screenTrack=e,this._isMixScreen&&(this.screenNode?this.screenNode.replaceTrack(e.mediaTrack):this.update()),e.setOutputMediaStreamTrack(e.mediaTrack)}getWatermarkImage(e,t){return N(this,null,function*(){let r=document.createElement("canvas");t&&e&&(r.height=t,r.width=e);let i=r.getContext("2d");if(!i)throw new pe({code:se.NOT_SUPPORTED,message:"Make image failed because of canvas context is null"});return this.watermarkImageList.sort((n,a)=>n.zIndex-a.zIndex),this.watermarkImageList.forEach(n=>{let{image:a,x:c,y:A,width:d,height:g}=n;i.drawImage(a,c,A,d,g)}),Hh(r.toDataURL())})}pushWaterMarkImageList(e){let{type:t}=e;this.watermarkImageList.some(r=>r.imageUrl===e.imageUrl&&r.height===e.height&&r.width===e.width&&r.x===e.x&&r.y===e.y&&r.type===e.type&&r.zIndex===e.zIndex)||((t==="mute"||t==="watermark")&&(this.watermarkImageList=this.watermarkImageList.filter(r=>r.type!==t)),this.watermarkImageList.push(e))}setBeautyParams(e){return N(this,null,function*(){this._beautyParams=e,this.update()})}stopBeauty(){return N(this,null,function*(){this._beautyParams=void 0,this.update()})}setWatermark(e){return N(this,null,function*(){let t;try{t=yield Hh((e==null?void 0:e.imageElement)||e.imageUrl)}catch{throw new pe({code:se.INVALID_PARAMETER,message:"load image failed, url: ".concat(e.imageUrl)})}let{x:r=0,y:i=0,width:n=t.width,height:a=t.height,type:c="watermark",zIndex:A=2}=e;this.pushWaterMarkImageList({x:r,y:i,width:n,height:a,image:t,zIndex:A,type:c,imageUrl:e.imageUrl}),yield this.freshWatermark(),this.log.info("set watermark",JSON.stringify(this.watermarkImageList))})}deleteWatermark(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"watermark";return N(this,null,function*(){this.watermarkImageList=this.watermarkImageList.filter(t=>t.type!==e),this.log.info("delete watermark",e,JSON.stringify(this.watermarkImageList)),yield this.freshWatermark()})}freshWatermark(){return N(this,null,function*(){var e,t,r;(e=this.waterMarkNode)==null||e.close(),delete this.waterMarkNode,delete this._waterMarkOption;let i=yield this.getWatermarkImage((t=this.cameraTrack)==null?void 0:t.settings.width,(r=this.cameraTrack)==null?void 0:r.settings.height);this._waterMarkOption={x:0,y:0,width:i.width,height:i.height,image:i},this.update()})}setVirtualBackground(e){return N(this,null,function*(){if(e){if(this._use2d&&!this._autoSwitchRenderMode)return Promise.reject(new Error("not support virtual background in 2d mode"));this._bgAssetPath=e.assetPath,e.type==="image"?this._virtualBackground=yield Hh(e.imageUrl):(this.blurRadius=e.blurLevel||this.blurRadius||3,this._virtualBackground=e.type)}else this._virtualBackground=void 0;this.log.info("".concat(this._virtualBackground?"start":"stop"," virtual background, ").concat((e==null?void 0:e.type)||"",", ").concat(this.blurRadius||"")),this.update()})}get mixScreen(){return this._isMixScreen}set mixScreen(e){var t;this._isMixScreen=e,this._isMixScreen||((t=this.screenNode)==null||t.close(),delete this.screenNode),this.update()}set mirror(e){var t;this._isMirror!==e&&(this._isMirror=e,this._isMirror||((t=this.mirrorNode)==null||t.close(),delete this.mirrorNode),this.update())}get mirror(){return this._isMirror}enableAr(e){this.arTrack=e,this.isUsingArTrack=!0,this.update()}updateAr(){return N(this,null,function*(){var e;(e=this.cameraTrack)==null||!e.mediaTrack||(yield this.virtualBackgroundInstance.ar.updateInputTrack(this.cameraTrack.mediaTrack.clone()))})}disableAr(){var e;this.isUsingArTrack=!1,(e=this.arTrack)==null||e.stop(),this.arTrack=void 0,this.update()}clear(){var e;(e=this.videoContext)==null||e.disconnect(),delete this.destination,delete this.cameraNode,delete this.mirrorNode,delete this.screenNode,delete this.waterMarkNode}},dx=0,ux=class extends tt{constructor(e){super("room"),this.seq=++dx,this.role="anchor",this.joinParams=null,this.localTracks=new Set,this.enableAutoPlayDialog=!0,this.autoReceiveAudio=!0,this.autoReceiveVideo=!0,this.scheduleResult={domains:null,iceServers:null,iceTransportPolicy:null,trtcAutoConf:null},this._isUsingCachedSchedule=!1,this._log=ae.createLogger({id:"r".concat(this.seq)}),this._joinedTimestamp=0,this.isDestroyed=!1,this.useStringRoomId=!!e.useStringRoomId,ei(e.autoReceiveAudio)&&(this.autoReceiveAudio=e.autoReceiveAudio),ei(e.autoReceiveVideo)&&(this.autoReceiveVideo=e.autoReceiveVideo),ei(e.enableAutoPlayDialog)&&(this.enableAutoPlayDialog=e.enableAutoPlayDialog),this._sdkType=e.sdkType,this.keyPointManager=new K1({room:this,frameWorkType:e.frameWorkType,component:e.component,language:e.language}),this.callDurationCalculator=new X1({room:this}),this.badCaseDetector=new z1({room:this}),this.audioManager=new zQ(this),this.videoManager=new lx(this)}get isMainStreamPublished(){for(let e of this.localTracks)if(4&e.mediaType)return!0;return!1}get isAuxStreamPublished(){for(let e of this.localTracks)if(2&e.mediaType)return!0;return!1}get hasAuxStream(){for(let e of this.remotePublishedUserMap.values())if(e.muteState.hasAuxiliary)return!0;return this.isAuxStreamPublished}getLogger(){return this._log}get isJoining(){return this.state.toString()==="joining"}get isJoined(){return this.state==="joined"}get isLeft(){return this.state==="left"}addTrack(e){return N(this,null,function*(){return this.publish(e)})}removeTrack(e){return N(this,null,function*(){return this.unpublish(e)})}replaceTrack(e){return N(this,null,function*(){})}setEncodedDataProcessingListener(e){throw new Error("Method not implemented.")}enableAIVoice(e){throw new Error("Method not implemented.")}setProxyServer(e){if(ut(e))e.startsWith("wss://")?this.proxy_ws=e:e.startsWith("https://")&&(this.proxy_wt=e);else if(Wn(e)){let{websocketProxy:t,webtransportProxy:r,loggerProxy:i,scheduleProxy:n,unifiedProxy:a}=e;this.proxy_ws=t,this.proxy_wt=r,this.proxy_unified=a,a?(d0([a,a]),_d("https://".concat(a))):(i&&_d(i),n&&d0(n))}te.once(X.JOIN_RECEIVED_CMD_RES,()=>this.sendAbilityStatus({sched_domain:Aa.main,sched_back_domain:Aa.backup,signal_domain:this.proxy_ws||this.proxy_wt||""}))}getRemoteAudioStats(){return N(this,null,function*(){let e={};return this.remotePublishedUserMap.forEach(t=>{e[t.userId]=t.remoteAudioTrack.stat}),e})}getTransportStats(){return N(this,null,function*(){var e;let t={rtt:((e=this.quality)==null?void 0:e.uplinkRTT)||0,downlinksRTT:{}};if(this.quality)for(let r of this.quality.downlinkInfo)t.downlinksRTT[r.userId]=r.rtt;return t})}getRemoteVideoStats(){return N(this,arguments,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"main";return function*(){let r={};return e.remotePublishedUserMap.forEach(i=>{let n=t==="auxiliary"?i.remoteAuxiliaryTrack:i.remoteVideoTrack;r[i.userId]=n.stat}),r}()})}checkDestroy(){if(this.isDestroyed)throw new pe({code:se.INVALID_OPERATION,message:Ve({key:xe.CLIENT_DESTROYED,data:{funName:"join"}})})}destroy(){if(this.isJoined)throw this._log.warn(xi.INVALID_DESTROY),new pe({code:se.INVALID_OPERATION,message:Ve({key:xe.INVALID_DESTROY})});this._log.info("destroy room"),this.audioManager.destroy(),this.videoManager.destroy(),this.keyPointManager.destroy(),this.callDurationCalculator.destroy(),this.badCaseDetector.destroy(),this.isDestroyed=!0,te.emit(X.ROOM_DESTROY,{room:this})}schedule(e,t){return N(this,null,function*(){var r,i;let n=He();try{let{isCached:a,result:c,detailCost:A}=yield XL({userId:this.userId,sdkAppId:this.sdkAppId,roomId:this.useStringRoomId?e.strRoomId:e.roomId,useStringRoomId:this.useStringRoomId,version:ln,userSig:this.userSig,role:this.scene==="live"?e.role:void 0,frameWorkType:t,latencyLevel:e.latencyLevel});this._isUsingCachedSchedule=a,this._log.info("schedule cache:".concat(+a," ").concat(Jn(c,{keysToExclude:["username","credential"]}))),a&&te.once(X.JOIN_RECEIVED_CMD_RES,()=>this.sendAbilityStatus({scheduleCache:1})),this.scheduleResult=_e(_e({},this.scheduleResult),c),qt((r=c.config)==null?void 0:r.retryCount)&&Fv(c.config.retryCount),ut((i=c.config)==null?void 0:i.loggerDomain)&&_d(c.config.loggerDomain),te.emit(X.JOIN_SCHEDULE_SUCCESS,{room:this,schedule:this.scheduleResult,detailCost:A}),ve.addSuccessEvent({key:521700,cost:He()-n,split:50})}catch(a){throw ve.addFailedEvent({key:521700,error:a}),a}})}},Ax=lr(Lr()),$R=lr(Sv());function ZR(e){var t;let r=[];for(let i=0;i<e.rtp.length;i++){if(["rtx","red","ulpfec"].includes(e.rtp[i].codec))continue;let n=e.fmtp.filter(a=>a.payload===e.rtp[i].payload)[0];r.push({payload:e.rtp[i].payload,codec:e.rtp[i].codec,fmtp:n?n.config:"",rate:e.rtp[i].rate,rtx:((t=e.rtp[i+1])==null?void 0:t.codec)==="rtx"?e.rtp[i+1].payload:0,rtcpFb:((e==null?void 0:e.rtcpFb)||[]).filter(a=>a.payload===e.rtp[i].payload).map(a=>{let{type:c,subtype:A}=a;return{id:c,params:A?[A]:[]}})})}return r}var hx=(e,t)=>N(void 0,null,function*(){var r;let i=$t(e),n={ice:{ufrag:"",password:""},dtls:{hash:"",fingerprint:"",setup:""},audio:{codecs:[],extensions:[]},video:{codecs:[],decoders:[],extensions:[]},useDataChannel:!1};n.ice.ufrag=String(i.media[0].iceUfrag),n.ice.password=i.media[0].icePwd||"",i.fingerprint&&(n.dtls.hash=i.fingerprint.type,n.dtls.fingerprint=i.fingerprint.hash,n.dtls.setup=i.setup||""),i.media[0].fingerprint&&(n.dtls.hash=i.media[0].fingerprint.type,n.dtls.fingerprint=i.media[0].fingerprint.hash),n.dtls.setup=i.media[0].setup||"";let a=i.media[0],c=i.media[1];a.ext&&(n.audio.extensions=a.ext.map(g=>({id:g.value,uri:g.uri}))),c.ext&&(n.video.extensions=c.ext.map(g=>({id:g.value,uri:g.uri})));let A={codec:a.rtp[0].codec,fmtp:a.fmtp[0].config,payload:a.fmtp[0].payload,rate:a.rtp[0].rate,channel:a.rtp[0].encoding,rtcpFb:[],rtx:0};(r=a.rtcpFb)==null||r.forEach(g=>{let{payload:E,type:f,subtype:b}=g;if(E===A.payload){let w={id:f,params:[]};b&&w.params.push(b),A.rtcpFb.push(w)}}),n.audio.codecs.push(A);let d=["h264","vp8"];return t&&d.shift(),n.video.codecs=[...ZR(c)].filter(g=>d.includes(g.codec.toLocaleLowerCase())),n.video.decoders=(yield function(){return N(this,null,function*(){let g=new RTCPeerConnection;g.addTransceiver(O.VIDEO,{direction:O.TRANSCEIVER_DIRECTION_RECVONLY});let E=yield g.createOffer();if(!E.sdp)return[];let f=ZR($t(E.sdp).media[0]);return g.close(),f})}()).filter(g=>["h264","vp8"].includes(g.codec.toLocaleLowerCase())),n}),gx=e=>{let{serverAbility:t,clientAbility:r,offerSDP:i,enableCustomMessage:n}=e,a=$t(i),c={extmapAllowMixed:"extmap-allow-mixed",groups:a.groups,icelite:"ice-lite",media:[],msidSemantic:{semantic:"",token:"WMS"},name:"-",origin:{address:"127.0.0.1",username:"-",sessionId:String(Date.now()),sessionVersion:1,netType:"IN",ipVer:4},timing:{start:0,stop:0},version:0},A={candidates:t.candidates.map(d=>({component:1,foundation:"1",generation:0,ip:d.ip,port:d.port,priority:d.priority,transport:d.foundation,type:d.type})),connection:{version:4,ip:"0.0.0.0"},direction:O.TRANSCEIVER_DIRECTION_RECVONLY,ext:t.audio.extensions.map(d=>({value:d.id,uri:d.uri})),fingerprint:{type:t.dtls.hash,hash:t.dtls.fingerprint},fmtp:[{payload:t.audio.codecs[0].payload,config:t.audio.codecs[0].fmtp}],icePwd:t.ice.password,iceUfrag:t.ice.ufrag,mid:"0",payloads:String(t.audio.codecs[0].payload),port:a.media[0].port,protocol:a.media[0].protocol,type:O.AUDIO,setup:t.dtls.setup,rtcpFb:t.audio.codecs[0].rtcpfb.map(d=>({payload:t.audio.codecs[0].payload,type:d.id,subtype:d.params[0]})),rtcpMux:"rtcp-mux",rtcpRsize:"rtcp-rsize",rtp:[{payload:t.audio.codecs[0].payload,codec:t.audio.codecs[0].codec,rate:t.audio.codecs[0].rate,encoding:t.audio.codecs[0].channels}]};return c.media.push(A),[1,2,3].forEach(d=>{c.media.push(eb({mid:d,serverAbility:t,clientAbility:r,parsedOffer:a}))}),n&&c.media.push(a.media.find(d=>d.mid==="dc")),cs(c)},eb=e=>{let{mid:t,serverAbility:r,clientAbility:i,parsedOffer:n,isDownlink:a=!1}=e,c={candidates:r.candidates.map(A=>({component:1,foundation:"1",generation:0,ip:A.ip,port:A.port,priority:A.priority,transport:A.foundation,type:A.type})),connection:{version:4,ip:"0.0.0.0"},direction:O.TRANSCEIVER_DIRECTION_RECVONLY,ext:r.video.extensions.map(A=>({value:A.id,uri:A.uri})),fingerprint:{type:r.dtls.hash,hash:r.dtls.fingerprint},fmtp:[],icePwd:r.ice.password,iceUfrag:r.ice.ufrag,mid:String(t),payloads:"",port:n.media[0].port,protocol:n.media[0].protocol,type:O.VIDEO,setup:r.dtls.setup,rtcpFb:[],rtcpMux:"rtcp-mux",rtcpRsize:"rtcp-rsize",rtp:[]};if(a)(r.video.decoders||r.video.codecs).forEach(A=>{mg(c,A)});else{let A=r.video.codecs.findIndex(g=>g.codec.toLowerCase()===(r.useVp8?"vp8":"h264")),d=r.video.codecs[A]||i.video.codecs[0];mg(c,d)}return c},mg=(e,t)=>{e.payloads="".concat(e.payloads," ").concat(t.payload).trim(),e.fmtp.push({payload:t.payload,config:t.fmtp}),e.rtcpFb=[...e.rtcpFb||[],...(t.rtcpfb||t.rtcpFb).map(r=>({payload:t.payload,type:r.id,subtype:r.params[0]}))],e.rtp.push({payload:t.payload,codec:t.codec.toUpperCase(),rate:t.rate}),t.rtx&&(e.payloads="".concat(e.payloads," ").concat(t.rtx),e.fmtp.push({payload:t.rtx,config:"apt=".concat(t.payload)}),e.rtp.push({payload:t.rtx,codec:"rtx",rate:t.rate}))},ji,px=(e,t,r)=>{let i=$R.default.parse(e);return i.media.forEach((n,a)=>{var c;(n.type===O.AUDIO||n.type===O.VIDEO)&&(function(A){if(!A.rtcpFb)return;let d=[];A.rtcpFb.forEach((g,E)=>{var f;d.push(g),A.rtcpFb&&((f=A.rtcpFb[E+1])==null?void 0:f.payload)!==g.payload&&g.type!=="rrtr"&&d.push({payload:g.payload,type:"rrtr"})}),A.rtcpFb=d}(n),function(A){A.type===O.VIDEO&&A.fmtp&&A.fmtp.forEach(d=>{d.config.includes("apt")||(d.config+=";sps-pps-idr-in-keyframe=1")})}(n),function(A){A.type===O.AUDIO&&A.fmtp&&A.fmtp.forEach(d=>{d.config+=";sprop-stereo=1;stereo=1"})}(n),function(A){let d=new Set(["urn:ietf:params:rtp-hdrext:sdes:mid","urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id","urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id"]);A.ext&&(A.ext=A.ext.filter(g=>!d.has(g.uri)))}(n),n.type===O.VIDEO&&(a<4?(n.payloads="",n.fmtp=[],n.rtp=[],n.rtcpFb=[],t.video.codecs.forEach(A=>mg(n,A))):r&&(n.payloads="",n.fmtp=[],n.rtp=[],n.rtcpFb=[],(r.video.decoders||r.video.codecs).forEach(A=>mg(n,A))))),(c=n.payloads)!=null&&c.includes("datachannel")&&i.groups&&n.mid&&(i.groups[0].mids=i.groups[0].mids.replace(n.mid,"dc"),n.mid="dc")}),$R.default.write(i)},ba=((ji=ba||{}).TRACK="track",ji.DATA_CHANNEL_MESSAGE="data_channel_msg",ji[ji.CONNECTION_STATE_CHANGED="connection-state-changed"]="CONNECTION_STATE_CHANGED",ji[ji.FIREWALL_RESTRICTION="firewall-restriction"]="FIREWALL_RESTRICTION",ji.RECONNECTED="spc-reconnected",ji.RECONNECT_FAILED="spc-reconnect-failed",ji.ERROR="error",ji.SEI_MESSAGE="sei-message",ji),tb=0,rb=!1,mx=new Set,fx=1,gu=class extends Ax.default{constructor(e){let{signalChannel:t,room:r,enableCustomMessage:i}=e;super(),T(this,"stat",{iceStartTime:0,iceEndTime:0,dtlsStartTime:0,dtlsEndTime:0,peerConnectionStartTime:0,peerConnectionEndTime:0}),T(this,"currentState","DISCONNECTED"),T(this,"_room"),T(this,"_signalChannel"),T(this,"_peerConnection",null),T(this,"_datachannel",null),T(this,"_enableCustomMessage"),T(this,"_log"),T(this,"_downlinkMIDMap",new Map),T(this,"_downlinkMIDUserIDMap",new Map),T(this,"_reconnectionTimer",-1),T(this,"reconnectionCount",0),T(this,"clientAbility"),T(this,"_serverAbility",null),T(this,"addDownlinkQueue",new Set),T(this,"removeDownlinkQueue",new Set),T(this,"_parsedAnswer",null),T(this,"_updateSDPPromise",null),T(this,"_waitForPCConnectedPromise"),T(this,"_waitForPCConnectedPromiseReject",null),T(this,"_isSDPLogged",!1),T(this,"abortMap",new Map),T(this,"enableInsertableStreams",!1),this._room=r,this._enableCustomMessage=i,this._signalChannel=t,this._log=ae.createLogger({id:"spc".concat(fx++),userId:this._room.userId,sdkAppId:this._room.sdkAppId}),this._room.enableSEI&&ma&&(this.enableInsertableStreams=!0)}get isH264EncodeSupported(){let e=this._room.checkSystemResult.detail.isH264EncodeSupported;return this._serverAbility&&(e=e&&!!this._serverAbility.video.codecs.find(t=>t.codec.toLowerCase()==="h264")),e}addAbortController(e,t){var r;(r=this.abortMap.get(e))==null||r.abort("destory"),this.abortMap.set(e,t)}get isVP8EncodeSupported(){let e=this._room.checkSystemResult.detail.isVp8EncodeSupported;return this._serverAbility&&(e=e&&this._serverAbility.useVp8),e}get videoCodec(){var e;return(e=this._serverAbility)!=null&&e.useVp8?"vp8":"h264"}get downlinkVideoCodec(){var e;return(e=this._serverAbility)!=null&&e.video.codecs.find(t=>t.codec.toLowerCase()==="h264")?"h264":"vp8"}get isUsingH264(){return this.videoCodec==="h264"}get uplinkSSRC(){return this._peerConnection&&this._peerConnection.localDescription?(e=>{let t=$t(e),r={audioSsrc:0,audioRtxSsrc:0,bigVideoSsrc:0,bigVideoRtxSsrc:0,smallVideoSsrc:0,smallVideoRtxSsrc:0,auxVideoSsrc:0,auxVideoRtxSsrc:0};return t.media.forEach((i,n)=>{var a;if(i.ssrcs&&!K(i.ssrcs[0].id)){let c=Number(i.ssrcs[0].id),A=Number((a=i.ssrcs.filter(d=>d.attribute==="cname")[1])==null?void 0:a.id);switch(n){case 0:r.audioSsrc=c;break;case 1:r.bigVideoSsrc=c,r.bigVideoRtxSsrc=A;break;case 2:r.smallVideoSsrc=c,r.smallVideoRtxSsrc=A;break;case 3:r.auxVideoSsrc=c,r.auxVideoRtxSsrc=A}}}),r})(this._peerConnection.localDescription.sdp):{audioSsrc:0,audioRtxSsrc:0,bigVideoSsrc:0,bigVideoRtxSsrc:0,smallVideoSsrc:0,smallVideoRtxSsrc:0,auxVideoSsrc:0,auxVideoRtxSsrc:0}}get isReconnecting(){return this.currentState==="RECONNECTING"||this._reconnectionTimer>0||this.reconnectionCount>0}get dtlsTransport(){if(!this._peerConnection)return null;let e=this._peerConnection.getSenders();return e.length===0?null:e[0].transport}initialize(){return N(this,null,function*(){var e;let t;try{this._peerConnection=new RTCPeerConnection({encodedInsertableStreams:this.enableInsertableStreams,offerExtmapAllowMixed:!0,iceServers:this._room.getIceServers(),iceTransportPolicy:this._room.getIceTransportPolicy(),sdpSemantics:this._room.sdpSemantics,bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",tcpCandidatePolicy:"disable",IceTransportsType:"nohost"}),this._peerConnection.oniceconnectionstatechange=()=>{if(!this._peerConnection)return;let i=this._peerConnection.iceConnectionState;this._log.debug("ice state: ".concat(i)),i==="checking"&&this.stat.iceStartTime===0?this.stat.iceStartTime=Date.now():i==="connected"&&this.stat.iceEndTime===0&&(this.stat.iceEndTime=Date.now())},this._peerConnection.onconnectionstatechange=this.onConnectionStateChange.bind(this),this._peerConnection.ontrack=i=>this.emit("track",i),this._enableCustomMessage&&(this._datachannel=this._peerConnection.createDataChannel("".concat(this._room.userId,"dc")),this._datachannel.binaryType="arraybuffer",this._datachannel.onopen=()=>{this._log.info("datachannel open")},this._datachannel.onclose=()=>{this._log.warn("datachannel close")},this._datachannel.onmessage=i=>{let n=new _x(i.data);this.emit("data_channel_msg",{data:n})},this._datachannel.onerror=i=>{this._log.warn("datachannel error",i)}),this._peerConnection.addTransceiver(O.AUDIO,{direction:O.TRANSCEIVER_DIRECTION_SENDONLY}),this._peerConnection.addTransceiver(O.VIDEO,{direction:O.TRANSCEIVER_DIRECTION_SENDONLY}),this._peerConnection.addTransceiver(O.VIDEO,{direction:O.TRANSCEIVER_DIRECTION_SENDONLY}),this._peerConnection.addTransceiver(O.VIDEO,{direction:O.TRANSCEIVER_DIRECTION_SENDONLY}),t=yield this._peerConnection.createOffer();let r=!this.isH264EncodeSupported;return K((e=this._room.scheduleResult.config)==null?void 0:e.remove264FromSDP)||(r=r&&this._room.scheduleResult.config.remove264FromSDP),this.clientAbility=yield hx(t.sdp,r),yield this.setOffer(t),this.dtlsTransport&&(this.dtlsTransport.onstatechange=()=>{let{dtlsTransport:i}=this;!i||(this._log.debug("dtls state: ".concat(i.state)),i.state==="connecting"&&this.stat.dtlsStartTime===0?this.stat.dtlsStartTime=Date.now():i.state==="connected"&&this.stat.dtlsEndTime===0&&(this.stat.dtlsEndTime=Date.now()))}),ve.addSuccessEvent({key:521707}),this.clientAbility}catch(r){throw ve.addFailedEvent({key:521707,error:r}),this._log.error("initialize failed ".concat(r,` 
offer: `).concat(t==null?void 0:t.sdp)),r}})}connect(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return N(this,null,function*(){try{if(this.currentState==="CONNECTED")return;let r=He(),i={type:"answer",sdp:gx({serverAbility:e,clientAbility:this.clientAbility,offerSDP:this._peerConnection.localDescription.sdp,enableCustomMessage:this._enableCustomMessage})};this._serverAbility=e,yield this.setAnswer(i),yield this.waitForPeerConnectionConnected(),t||ve.addSuccessEvent({key:521703,cost:He()-r})}catch(r){let i=r instanceof pe&&r.code===se.API_CALL_ABORTED;throw i||this._log.error("connect failed: ".concat(r),e),this.reset(),!i&&!this.isReconnecting&&(ve.addFailedEvent({key:521703,error:r}),this.emitConnectionStateChangedEvent("DISCONNECTED"),this.startReconnection()),r}})}reconnect(){return N(this,null,function*(){if(this._reconnectionTimer===-1){if(!this._signalChannel.isConnected)return this._log.warn("reconnect() wait signal channel is connected"),void this._signalChannel.once(tl,this.reconnect,this);try{this.reconnectionCount++,this._log.warn("reconnect() trying [".concat(this.reconnectionCount,"]")),this.reset();let e=yield this.initialize(),t=yield this._signalChannel.sendWaitForResponse({command:Q1,responseCommand:ze.REBUILD_PEER_CONNECTION_RES,data:{ability:e},enableLog:!1});if(t.data.code!==0)throw new pe({code:t.data.code,message:t.data.message});yield this.connect(t.data.data.ability,!0),ve.addSuccessEvent({key:521704}),this._log.warn("reconnect() success"),this.stopReconnection(),te.emit(X.SPC_RECONNECTED,{room:this._room}),this.emit("spc-reconnected")}catch(e){if(!this.isReconnecting)return;if(e!=null&&e.message.includes("timeout")){let t=jc(this.reconnectionCount);this._log.warn("reconnect() timeout, try again after ".concat(t/1e3,"s")),this._reconnectionTimer=window.setTimeout(()=>{this.clearReconnectionTimer(),this.reconnect()},t)}else this._log.error("reconnect() failed ".concat(e==null?void 0:e.code," ").concat(e)),ve.addFailedEvent({key:521704,error:e}),this.reconnectionCount>=Lc()&&this._log.warn("SDK has tried reconnect for ".concat(Lc()," times, but all failed, please check your network")),this.stopReconnection(),this.emitConnectionStateChangedEvent("DISCONNECTED"),this.emit("error")}}else this._log.warn("reconnect() is reconnecting, ignore current reconnection")})}getPeerConnection(){return this._peerConnection}startReconnection(){return N(this,null,function*(){this._log.warn("start reconnect"),this._updateSDPPromise=null,this.emitConnectionStateChangedEvent("RECONNECTING"),yield this.reconnect()})}stopReconnection(){this.isReconnecting&&(this._log.info("stop reconnect"),this.reconnectionCount=0,this.clearReconnectionTimer(),this._signalChannel.off(tl,this.reconnect,this))}checkPeerConnectionToReconnect(){var e;!this.isReconnecting&&((e=this._peerConnection)==null?void 0:e.connectionState)===Vt.CLOSED&&this.startReconnection()}clearReconnectionTimer(){this._reconnectionTimer!==-1&&(clearTimeout(this._reconnectionTimer),this._reconnectionTimer=-1)}onConnectionStateChange(e){let t=this._peerConnection.iceConnectionState,r=this.getDTLSTransportState();this._log.info("connectionState: ".concat(e.target.connectionState," ICE: ").concat(t," DTLS: ").concat(r)),e.target.connectionState===Vt.CONNECTING&&(this.stat.peerConnectionStartTime===0&&(this.stat.peerConnectionStartTime=Date.now()),this.emitConnectionStateChangedEvent("CONNECTING")),(e.target.connectionState===Vt.FAILED||e.target.connectionState===Vt.CLOSED)&&(this.emitConnectionStateChangedEvent("DISCONNECTED"),this.startReconnection()),(e.target.connectionState===Vt.CONNECTED||e.target.connectionState===Vt.COMPLETED)&&(this.stat.peerConnectionEndTime===0&&(this.stat.peerConnectionEndTime=Date.now()),te.emit(X.SINGLE_CONNECTION_STAT,{room:this._room,stat:{ice:this.stat.iceEndTime-this.stat.iceStartTime,dtls:this.stat.dtlsEndTime-this.stat.dtlsStartTime,peerConnection:this.stat.peerConnectionEndTime-this.stat.peerConnectionStartTime}}),this.logSelectedCandidate(),this.emitConnectionStateChangedEvent("CONNECTED"))}getDTLSTransportState(){if(!this._peerConnection)return Jo;let e=null;return Jd()&&this._peerConnection.getSenders().length!==0?(e=this._peerConnection.getSenders()[0].transport,Wh()&&this._peerConnection.getReceivers().length!==0&&e?e.state:Jo):Jo}emitConnectionStateChangedEvent(e){e!==this.currentState&&(this.currentState==="RECONNECTING"&&e==="CONNECTING"||(this.emit(ba.CONNECTION_STATE_CHANGED,{prevState:this.currentState,state:e}),this.currentState=e))}logSelectedCandidate(){return N(this,null,function*(){if(!this._peerConnection)return;let e=yield this._peerConnection.getStats();for(let[t,r]of e)if(Wd(r)){let i=e.get(r.localCandidateId),n=e.get(r.remoteCandidateId);i&&(this._log.info("local candidate: ".concat(i.candidateType," ").concat(i.protocol,":").concat(i.ip||i.address,":").concat(i.port," ").concat(i.networkType||""," ").concat(i.candidateType==="relay"?"relayProtocol:".concat(i.relayProtocol):"")),i.networkType&&p0(i.networkType)),n&&this._log.info("remote candidate: ".concat(n.candidateType," ").concat(n.protocol,":").concat(n.ip||n.address,":").concat(n.port));break}})}waitForPeerConnectionConnected(){return this._waitForPCConnectedPromise||(this._waitForPCConnectedPromise=new Promise((e,t)=>{if(this.currentState==="CONNECTED")return e();this._waitForPCConnectedPromiseReject=t;let r=c=>{c.state==="CONNECTED"&&(clearTimeout(a),n(),e())},i=c=>{let{room:A}=c;A===this._room&&(clearTimeout(a),n(),t(new pe({code:se.API_CALL_ABORTED,message:Ve({key:xe.CONNECTION_ABORTED,data:"leave room"})})))},n=()=>{te.off(X.LEAVE_SUCCESS,i,this),this.off(ba.CONNECTION_STATE_CHANGED,r,this)},a=setTimeout(()=>{n();let c=new pe({code:se.API_CALL_TIMEOUT,message:"connection timeout"});var A;tb+=1,A=this._signalChannel.isConnected,tb>2&&!rb&&mx.size===0&&A&&(this._log.warn("firewall restriction"),rb=!0,this.emit(ba.FIREWALL_RESTRICTION)),t(c)},FE);te.on(X.LEAVE_SUCCESS,i,this),this.on(ba.CONNECTION_STATE_CHANGED,r,this)}),this._waitForPCConnectedPromise=this._waitForPCConnectedPromise.finally(()=>{this._waitForPCConnectedPromise=null,this._waitForPCConnectedPromiseReject=null})),this._waitForPCConnectedPromise}waitForReconnected(){return this.isReconnecting?new Promise((e,t)=>{this.once("spc-reconnected",e),this.once("error",t)}):Promise.resolve()}addDownlink(e){return N(this,null,function*(){if(this._log.info("addDownlink(".concat(e.userId,") trying")),this.isReconnecting&&(yield this.waitForReconnected()),this._updateSDPPromise&&(yield this._updateSDPPromise),this.updateLocalAndRemoteSDPConfig(e),this.addDownlinkQueue.size===0)try{yield this.updateSDP(),this._log.info("addDownlink(".concat(e.userId,") done"))}catch(t){this._log.error("addDownlink(".concat(e.userId,") failed ").concat(t)),yield this.startReconnection()}})}updateLocalAndRemoteSDPConfig(e){let{ssrc:t,userId:r,tinyId:i}=e;if(!this._peerConnection)return;this._log.info("updateLocalAndRemoteSDPConfig ".concat(r," ").concat(JSON.stringify(t)));let n=this._peerConnection.getTransceivers().filter(f=>f.direction==="inactive").slice(0,3).map(f=>(f.direction=O.TRANSCEIVER_DIRECTION_RECVONLY,Number(f.mid)));this._parsedAnswer||(this._parsedAnswer=$t(this._peerConnection.remoteDescription.sdp));let a,c,A,d=this._parsedAnswer.media.filter(f=>{var b;return(b=f.ssrcs)==null?void 0:b.find(w=>{var k;return(k=w.value)==null?void 0:k.includes(i)})});if(d.length===3)a=d[0],c=d[1],A=d[2];else if(n.length===3)a=this._parsedAnswer.media.find(f=>Number(f.mid)===Number(n[0])),c=this._parsedAnswer.media.find(f=>Number(f.mid)===Number(n[1])),A=this._parsedAnswer.media.find(f=>Number(f.mid)===Number(n[2]));else if(n.length===0){this._peerConnection.addTransceiver(O.AUDIO,{direction:O.TRANSCEIVER_DIRECTION_RECVONLY}),this._peerConnection.addTransceiver(O.VIDEO,{direction:O.TRANSCEIVER_DIRECTION_RECVONLY}),this._peerConnection.addTransceiver(O.VIDEO,{direction:O.TRANSCEIVER_DIRECTION_RECVONLY}),a=JSON.parse(JSON.stringify(this._parsedAnswer.media[0]));let f=eb({mid:1,serverAbility:this._serverAbility,clientAbility:this.clientAbility,parsedOffer:$t(this._peerConnection.localDescription.sdp),isDownlink:!0});c=JSON.parse(JSON.stringify(f)),A=JSON.parse(JSON.stringify(f)),a.mid=this._parsedAnswer.media.length,this._parsedAnswer.media.push(a),c.mid=this._parsedAnswer.media.length,this._parsedAnswer.media.push(c),A.mid=this._parsedAnswer.media.length,this._parsedAnswer.media.push(A)}a.direction=O.TRANSCEIVER_DIRECTION_SENDONLY;let g="".concat(i,"-").concat(t.audio);a.ssrcs=[{id:t.audio,attribute:"cname",value:"".concat(g)},{id:t.audio,attribute:"msid",value:"".concat(g,"-").concat(O.MAIN," ").concat(g,"-audio")}],c.direction=O.TRANSCEIVER_DIRECTION_SENDONLY,c.ssrcs=[{id:t.video,attribute:"cname",value:"".concat(g)},{id:t.video,attribute:"msid",value:"".concat(g,"-").concat(O.MAIN," ").concat(g,"-bigvideo")},{id:t.videoRtx,attribute:"cname",value:"".concat(g)},{id:t.videoRtx,attribute:"msid",value:"".concat(g,"-").concat(O.MAIN," ").concat(g,"-bigvideo")}],c.ssrcGroups=[{semantics:"FID",ssrcs:"".concat(t.video," ").concat(t.videoRtx)}],A.direction=O.TRANSCEIVER_DIRECTION_SENDONLY;let E="".concat(g,"-aux");A.ssrcs=[{id:t.auxiliary,attribute:"cname",value:E},{id:t.auxiliary,attribute:"msid",value:"".concat(E," ").concat(g,"-aux").concat(O.VIDEO)},{id:t.auxiliaryRtx,attribute:"cname",value:"".concat(E," ").concat(g,"-aux").concat(O.VIDEO)},{id:t.auxiliaryRtx,attribute:"msid",value:"".concat(E," ").concat(g,"-aux").concat(O.VIDEO)}],A.ssrcGroups=[{semantics:"FID",ssrcs:"".concat(t.auxiliary," ").concat(t.auxiliaryRtx)}],this._parsedAnswer.groups&&(this._parsedAnswer.groups[0].mids=this._parsedAnswer.media.map(f=>f.mid).join(" ")),this._downlinkMIDMap.set(r,[a.mid,c.mid,A.mid]),this._downlinkMIDUserIDMap.set(a.mid,r),this._downlinkMIDUserIDMap.set(c.mid,r),this._downlinkMIDUserIDMap.set(A.mid,r)}removeDownlink(e){return N(this,null,function*(){if(!this._downlinkMIDMap.has(e)||!this._peerConnection)return;this._log.info("removeDownlink(".concat(e,") trying")),this.isReconnecting&&(yield this.waitForReconnected()),this._updateSDPPromise&&(yield this._updateSDPPromise);let t=this._downlinkMIDMap.get(e),r=!1;this._peerConnection.getTransceivers().forEach(i=>{t!=null&&t.includes(Number(i.mid))&&(r=!0,i.direction="inactive")}),this._parsedAnswer||(this._parsedAnswer=$t(this._peerConnection.remoteDescription.sdp)),this._parsedAnswer.media.forEach(i=>{t!=null&&t.includes(Number(i.mid))&&(r=!0,i.direction="inactive",i.ssrcs=[],i.ssrcGroups=[])}),this.removeDownlinkQueue.size===0&&r&&(yield this.updateSDP()),this._downlinkMIDMap.delete(e),t==null||t.forEach(i=>this._downlinkMIDUserIDMap.delete(i)),this._log.info("removeDownlink(".concat(e,") done"))})}setBandwidth(e){return N(this,null,function*(){if(!this._peerConnection)return;let{audio:t,bigVideo:r,smallVideo:i,auxVideo:n}=e;try{if(b_()){let a=this._peerConnection.getSenders().slice(0,4);for(let A=0;A<a.length;A++){let d,g=a[A];A===0&&t?d=t:A===1&&r?d=r:A===2&&i?d=i:A===3&&n&&(d=n),d&&(yield this.setSenderMaxBitrate(g,d))}let c=!1;r&&a[1].track&&(c=this.setStartBitrate(1,r)),n&&a[3].track&&(c=this.setStartBitrate(3,n)||c),c&&(yield this.updateSDP())}else yield this.setBandwidthBySDP(e);this._log.info("setBandwidth ".concat(JSON.stringify(e)))}catch(a){this._log.error("failed to set bandwidth: ".concat(a))}})}setStartBitrate(e,t){var r,i;return!((r=this._peerConnection)==null||!r.remoteDescription||(this._parsedAnswer||(this._parsedAnswer=$t(this._peerConnection.remoteDescription.sdp)),(i=this._parsedAnswer.media[e])==null||!i.fmtp[0]))&&(this._parsedAnswer.media[e].fmtp[0].config+=";x-google-start-bitrate=".concat(t>5e3?5e3:t),!0)}setSenderMaxBitrate(e,t){let r=e.getParameters();return(!r.encodings||r.encodings.length===0)&&(r.encodings=[{}]),t==="unlimited"?delete r.encodings[0].maxBitrate:r.encodings[0].maxBitrate=1e3*t,e.setParameters(r)}setBandwidthBySDP(e){let{audio:t,bigVideo:r,smallVideo:i,auxVideo:n}=e;if(!this._peerConnection||!this._peerConnection.localDescription)return;let a=$t(this._peerConnection.localDescription.sdp);this._parsedAnswer||(this._parsedAnswer=$t(this._peerConnection.remoteDescription.sdp));let c=Rt?"TIAS":"AS";t&&(a.media[0].bandwidth=[{type:c,limit:Rt?1e3*t:t}],this._parsedAnswer.media[0].bandwidth=[{type:c,limit:Rt?1e3*t:t}]),r&&(a.media[1].bandwidth=[{type:c,limit:Rt?1e3*r:r}],this._parsedAnswer.media[1].bandwidth=[{type:c,limit:Rt?1e3*r:r}]),i&&(a.media[2].bandwidth=[{type:c,limit:Rt?1e3*i:i}],this._parsedAnswer.media[2].bandwidth=[{type:c,limit:Rt?1e3*i:i}]),n&&(a.media[3].bandwidth=[{type:c,limit:Rt?1e3*n:n}],this._parsedAnswer.media[3].bandwidth=[{type:c,limit:Rt?1e3*n:n}]);let A={type:"offer",sdp:cs(a)};return this.updateSDP({localDescription:A})}setScaleResolutionDownBy(e,t){if(t===1)return;let r=e.getParameters();return(!r.encodings||r.encodings.length===0)&&(r.encodings=[{}]),r.encodings[0].scaleResolutionDownBy=t,e.setParameters(r)}updateSDP(){let{localDescription:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this._parsedAnswer)return Promise.resolve();let t=cs(this._parsedAnswer);return this._updateSDPPromise=new Promise((r,i)=>N(this,null,function*(){var n,a;try{!e&&this._peerConnection&&(this._log.info("creating offer"),e=yield this._peerConnection.createOffer()),e&&(yield this.setOffer(e)),yield this.setAnswer({type:"answer",sdp:t}),this._updateSDPPromise=null,r()}catch(c){this._log.error(c),!this._isSDPLogged&&this._peerConnection&&(this._log.warn("current offer: ".concat(this.filterSDPDirection((n=this._peerConnection.localDescription)==null?void 0:n.sdp),` 
next offer: `).concat(this.filterSDPDirection(e==null?void 0:e.sdp))),this._log.warn("current answer: ".concat(this.filterSDPDirection((a=this._peerConnection.remoteDescription)==null?void 0:a.sdp),` 
next answer: `).concat(this.filterSDPDirection(t))),this._log.warn("offer: ".concat(e==null?void 0:e.sdp)),this._log.warn("answer: ".concat(t)),this._log.warn("transceivers: ".concat(JSON.stringify(this._peerConnection.getTransceivers().map(A=>{let{mid:d,currentDirection:g,direction:E,stopped:f}=A;return{mid:d,currentDirection:g,direction:E,stopped:f}})))),this._log.warn("parsedAnswer: ".concat(JSON.stringify(this._parsedAnswer))),this._isSDPLogged=!0),this._updateSDPPromise=null,i(c)}})),this._updateSDPPromise}filterSDPDirection(){return $t(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"").media.map(e=>e.direction)}setOffer(e){return this._log.info("setting offer"),this._log.debug(e.sdp),this._peerConnection.setLocalDescription({type:"offer",sdp:px(e.sdp,this.clientAbility,this._serverAbility)})}setAnswer(e){return this._log.info("setting answer"),this._log.debug(e.sdp),this._room.enableHWEncoder&&e.sdp&&(e.sdp=e.sdp.replaceAll("42e01f","42001f")),this._peerConnection.setRemoteDescription(e)}sendDataChannelMessage(e){var t;(t=this._datachannel)==null||t.send(e)}reset(){var e;(e=this._peerConnection)==null||e.close(),this._waitForPCConnectedPromise=null,this._parsedAnswer=null}close(){this._log.info("close pc"),this.abortMap.forEach(e=>typeof e.abort=="function"&&e.abort("destroy")),this.abortMap.clear(),this.reset(),this.emitConnectionStateChangedEvent("DISCONNECTED"),this._downlinkMIDMap.clear(),this.stopReconnection(),this.removeAllListeners()}getReceiversByUserId(e){if(!this._peerConnection)return[];let t=this._peerConnection.getReceivers();return(this._downlinkMIDMap.get(e)||[]).map(r=>t[r])}};le([cR("reconnect")],gu.prototype,"startReconnection",1),le([Xc(e=>e.userId)],gu.prototype,"addDownlink",1),le([Xc(e=>e)],gu.prototype,"removeDownlink",1),le([Kc(!0)],gu.prototype,"updateSDP",1);var Ex=class{constructor(e){T(this,"tag"),T(this,"len"),T(this,"data");let t=new DataView(e);this.tag=t.getUint16(),this.len=t.getUint16(2),this.data=new Uint8Array(e).slice(4,4+this.len).buffer}},_x=class{constructor(e){T(this,"tinyId"),T(this,"data");let t=new DataView(e),r=0,i=[];for(;r<t.byteLength;){let n=t.getUint16(r+2),a=new Ex(new Uint8Array(e).slice(r,r+2+2+n).buffer);i.push(a),r+=4+n}i.forEach(n=>{n.tag===1?this.tinyId=new TextDecoder().decode(n.data):n.tag===2&&(this.data=n.data)})}},ib=new Set;function rl(){let e=Math.floor(4294967296*Math.random());return ib.has(e)?rl():(ib.add(e),e)}var Ix=lr(Lr()),nb=class extends Ix.default{constructor(e){super(),T(this,"userId"),T(this,"tinyId"),T(this,"_sdpSemantics"),T(this,"_isUplink"),T(this,"_room"),T(this,"_log"),T(this,"_signalChannel"),T(this,"_currentState","DISCONNECTED"),T(this,"_prevTime",-1),T(this,"_enableSEI"),this.userId=e.userId,this.tinyId=e.tinyId,this._room=e.room,this._sdpSemantics=e.room.sdpSemantics,this._isUplink=e.isUplink,this._log=ae.createLogger({id:"n",userId:this._room.userId,remoteUserId:this._isUplink?void 0:this.userId,sdkAppId:this._room.sdkAppId,isLocal:this._isUplink}),this._signalChannel=e.signalChannel,this._enableSEI=e.enableSEI}get _peerConnection(){var e;return((e=this.singlePC)==null?void 0:e.getPeerConnection())||null}get singlePC(){return this._room.singlePC}close(e){this._log.info("close connection"),this.emit("closed",e)}emitConnectionStateChangedEvent(e){return e!==this._currentState&&(te.emit(X.PEER_CONNECTION_STATE_CHANGED,{room:this._room,prevState:this._currentState,state:e,remoteUserId:this._isUplink?void 0:this.userId}),this.emit("connection-state-changed",{prevState:this._currentState,state:e}),this._currentState=e,!0)}getPeerConnection(){return this._peerConnection}getRoom(){return this._room}getUserId(){return this.userId}getTinyId(){return this.tinyId}getCurrentState(){return this._currentState}get isH264(){var e,t;return!((t=(e=this._peerConnection)==null?void 0:e.remoteDescription)==null||!t.sdp.includes("H264"))}},pI=class extends nb{constructor(e){super(Ke(_e({},e),{isUplink:!0})),T(this,"localMainAudioTrack",null),T(this,"localMainVideoTrack",null),T(this,"localAuxAudioTrack",null),T(this,"localAuxVideoTrack",null),T(this,"_isPublishingAux",!1),T(this,"_publishingLocalAudioTrack"),T(this,"_publishingLocalVideoTrack"),T(this,"_mediaSettings",{videoCodec:"",videoWidth:0,videoHeight:0,videoBps:0,videoFps:0,audioCodec:"opus",audioFs:0,audioChannel:0,audioBps:0,smallVideoWidth:0,smallVideoHeight:0,smallVideoFps:0,smallVideoBps:0,auxVideoWidth:0,auxVideoHeight:0,auxVideoFps:0,auxVideoBps:0}),T(this,"_flag",0),T(this,"_checkPublishStateTimeoutId",-1),this.initialize()}get videoCodec(){var e;return((e=this.singlePC)==null?void 0:e.videoCodec)||"h264"}get ssrc(){if(!this.singlePC)return{audio:0,video:0,videoRtx:0,small:0,smallRtx:0,auxiliary:0,auxiliaryRtx:0};let{audioSsrc:e,bigVideoSsrc:t,bigVideoRtxSsrc:r,smallVideoSsrc:i,smallVideoRtxSsrc:n,auxVideoSsrc:a,auxVideoRtxSsrc:c}=this.singlePC.uplinkSSRC;return{audio:e||0,video:t||0,videoRtx:r||0,small:i||0,smallRtx:n||0,auxiliary:a||0,auxiliaryRtx:c||0}}get flag(){return this._flag}set flag(e){this._flag!==e&&(this._flag=e,this.checkPublishState())}checkPublishState(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(!e&&this._checkPublishStateTimeoutId>0)return;let{publishState:t,serverPublishState:r}=this,i=Object.keys(t).find(n=>t[n]!==r[n]);if(i){if(!e)return void(this._checkPublishStateTimeoutId=Qt.run(wd,()=>this.checkPublishState(!0),{delay:1e4,count:1}));this._log.warn("publish state not matched, ".concat(i," local:").concat(t[i]," server:").concat(r[i]," ").concat(A_()," ").concat(o0())),ve.addCount({key:521e3})}Qt.clearTask(this._checkPublishStateTimeoutId),this._checkPublishStateTimeoutId=-1}get isMainStreamPublished(){return!(!this.localMainAudioTrack&&!this.localMainVideoTrack)}get isAuxStreamPublished(){return!(!this.localAuxVideoTrack&&!this.localAuxAudioTrack)}get publishState(){var e,t,r,i;let n={audio:!1,bigVideo:!1,smallVideo:!1,auxVideo:!1};if(this._peerConnection){let a=this._peerConnection.getSenders();a&&(es()?(n.audio=!((e=a[0])==null||!e.track),n.bigVideo=!((t=a[1])==null||!t.track),n.smallVideo=!((r=a[2])==null||!r.track),n.auxVideo=!((i=a[3])==null||!i.track)):a.forEach(c=>{c.track&&(c.track.kind===O.AUDIO?n.audio=!0:(n.bigVideo=!0,this._room.videoManager.hasSmall&&(n.smallVideo=!0)))}))}return n}get serverPublishState(){return{audio:!!(this.flag&yd),bigVideo:!!(this.flag&Cd),smallVideo:!!(this.flag&LE),auxVideo:!!(this.flag&Ih)}}get muteState(){var e,t,r;return{audio:!((e=this.localMainAudioTrack)==null||!e.muted),bigVideo:!((t=this.localMainVideoTrack)==null||!t.muted),auxVideo:!((r=this.localAuxVideoTrack)==null||!r.muted)}}initialize(){this.installEvents()}reset(){this.uninstallEvents(),this.uninstallTrackMuteEvents(this.localMainAudioTrack,this.localMainVideoTrack,this.localAuxVideoTrack)}close(e){var t;let r=((t=this._peerConnection)==null?void 0:t.getSenders())||[];for(let i of r)i.replaceTrack(null);super.close(e),this.reset(),this.emitConnectionStateChangedEvent("DISCONNECTED")}installEvents(){var e,t;this.listeners("connection-state-changed").includes(this.handleConnectionStateChange)||this.on("connection-state-changed",this.handleConnectionStateChange,this),(e=this.singlePC)!=null&&e.listeners("spc-reconnected").includes(this.onSinglePCReconnected)||(t=this.singlePC)==null||t.on("spc-reconnected",this.onSinglePCReconnected,this)}uninstallEvents(){var e;this.off("connection-state-changed",this.handleConnectionStateChange,this),(e=this.singlePC)==null||e.off("spc-reconnected",this.onSinglePCReconnected,this)}emitConnectionStateChangedEvent(e,t){var r,i,n;let a=this._currentState,c=super.emitConnectionStateChangedEvent(e);return c&&a!==e&&(t?t.emit("connection-state-changed",{prevState:a,state:e}):((r=this.localMainVideoTrack)==null||r.emit("connection-state-changed",{prevState:a,state:e}),(i=this.localAuxVideoTrack)==null||i.emit("connection-state-changed",{prevState:a,state:e}),(n=this._publishingLocalVideoTrack)==null||n.emit("connection-state-changed",{prevState:a,state:e}))),c}publish(e){return N(this,arguments,function(t){var r=this;let{localAudioTrack:i,localVideoTrack:n,isAuxiliary:a}=t;return function*(){var c,A,d,g,E,f;if(!r.singlePC)return;yield r.singlePC.waitForPeerConnectionConnected();let b,{publishState:w,muteState:k}=r;if(i&&(r._publishingLocalAudioTrack=i,w.audio=!0,k.audio=i.muted),n){if(!r.singlePC.isH264EncodeSupported&&!r.singlePC.isVP8EncodeSupported)throw new pe({code:se.NOT_SUPPORTED_H264,message:Ve({key:xe.NOT_SUPPORTED_H264ENCODE})});Qr&&Qd()===115&&n.profile.width*n.profile.height<=230400&&(r._log.warn("fallback video to 480p"),n.setProfile(dn["480p_2"]),yield n.applyProfile()),r._publishingLocalVideoTrack=n,a?(w.auxVideo=!0,k.auxVideo=n.muted):(w.bigVideo=!0,k.bigVideo=n.muted)}if(r._isPublishingAux=a,n&&!a&&n.small&&(b=r._room.videoManager.smallTrack,w.smallVideo=!0),yield r._signalChannel.sendWaitForResponseWithRetry({command:U1,responseCommand:ze.SPC_PUBLISH_RESULT,data:Ke(_e({},r.singlePC.uplinkSSRC),{state:w,muteState:k}),retries:3}),yield r.publishByTransceiver({localAudioTrack:i,localVideoTrack:n,smallTrack:b,isAuxiliary:a}),r._publishingLocalAudioTrack=null,r._publishingLocalVideoTrack=null,r._isPublishingAux=!1,a)n&&(r.localAuxVideoTrack=n),i&&(r.localAuxAudioTrack=i);else{if(n){r.localMainVideoTrack=n;let{scaleResolutionDownBy:x}=n;x>1&&(r._log.warn("setScaleResolutionDownBy main ".concat(x)),yield r.singlePC.setScaleResolutionDownBy(r._peerConnection.getSenders()[1],x))}i&&(r.localMainAudioTrack=i)}yield r.singlePC.setBandwidth({audio:((c=r.localMainAudioTrack)==null?void 0:c.profile.bitrate)||((A=r.localAuxAudioTrack)==null?void 0:A.profile.bitrate),bigVideo:(d=r.localMainVideoTrack)==null?void 0:d.profile.bitrate,smallVideo:(E=(g=r.localMainVideoTrack)==null?void 0:g.small)==null?void 0:E.bitrate,auxVideo:(f=r.localAuxVideoTrack)==null?void 0:f.profile.bitrate}),r.sendMediaSettings(),r.installTrackMuteEvents(i,n)}()})}publishByTransceiver(e){let{localAudioTrack:t,localVideoTrack:r,smallTrack:i,isAuxiliary:n}=e;if(!Kn())return;this._log.info("publish by transceiver");let a=r==null?void 0:r.outMediaTrack,c=t==null?void 0:t.outMediaTrack,A=this._peerConnection.getTransceivers(),d=[],g=[],E=(b,w,k)=>{var x;let Y=A[w].sender.replaceTrack(k);g.push(w),(x=this.singlePC)!=null&&x.enableInsertableStreams&&Y.then(()=>this.createEncodedStreams(A[w].sender,b)),d.push(Y)};c&&E(t.mediaType,0,c),a&&E(r.mediaType,n?3:1,a),i&&E(8,2,i);let f=this.setTransceiverDirection($e.SENDONLY,g);return d.push(f),Promise.all(d)}getTrackByMeidaType(e){switch(e){case 1:return this.localMainAudioTrack||this._publishingLocalAudioTrack;case 4:case 8:return this.localMainVideoTrack||this._publishingLocalVideoTrack;case 2:return this.localAuxVideoTrack||this._publishingLocalVideoTrack;default:throw new Error("mediaType error")}}createEncodedStreams(e,t){var r,i;if(this.singlePC.abortMap.has(e))return;let n=e.createEncodedStreams(),a=new AbortController;(r=this.singlePC)==null||r.addAbortController(e,a),((i=this.getTrackByMeidaType(t))!=null&&i.enableEncodeFrame?n.readable.pipeThrough(new TransformStream({transform:(c,A)=>{var d;return A.enqueue((d=this.singlePC)!=null&&d.isUsingH264?this.getTrackByMeidaType(t).encodeFrame(c,t===8):c)}}),a):n.readable).pipeTo(n.writable,a).catch(c=>{this._log.debug("encoded stream error",c),c!=="destory"&&this._log.warn(c)})}enableSmall(e){return N(this,null,function*(){if(!this.singlePC)return;let t=this._peerConnection.getTransceivers();e?this._room.videoManager.smallTrack&&(yield t[2].sender.replaceTrack(this._room.videoManager.smallTrack),yield this.setTransceiverDirection($e.SENDONLY,[2])):(yield t[2].sender.replaceTrack(null),yield this.setTransceiverDirection($e.INACTIVE,[2])),this.updateMediaSettings(),yield this.doPublishChange()})}installTrackMuteEvents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach(i=>{i&&(i==null||i.on("mute",this.sendMutedFlag,this),i==null||i.on("unmute",this.sendMutedFlag,this))})}uninstallTrackMuteEvents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach(i=>{i&&(i==null||i.off("mute",this.sendMutedFlag,this),i==null||i.off("unmute",this.sendMutedFlag,this))})}unpublish(e){return N(this,arguments,function(t){var r=this;let{localAudioTrack:i,localVideoTrack:n}=t;return function*(){let a=n&&n===r.localAuxVideoTrack,c=n==null?void 0:n.outMediaTrack,A=r._peerConnection.getSenders(),d=[];i&&(yield A[0].replaceTrack(null),d.push(0),a?r.localAuxAudioTrack=null:r.localMainAudioTrack=null),c&&(a?(yield A[3].replaceTrack(null),r.localAuxVideoTrack=null,r._mediaSettings=Ke(_e({},r._mediaSettings),{auxVideoBps:0,auxVideoFps:0,auxVideoWidth:0,auxVideoHeight:0}),d.push(3)):(yield A[1].replaceTrack(null),yield A[2].replaceTrack(null),r.localMainVideoTrack=null,r._mediaSettings=Ke(_e({},r._mediaSettings),{videoWidth:0,videoHeight:0,videoBps:0,videoFps:0,audioFs:0,audioChannel:0,audioBps:0,smallVideoWidth:0,smallVideoHeight:0,smallVideoFps:0,smallVideoBps:0}),d.push(1,2))),r.isMainStreamPublished||r.isAuxStreamPublished?(yield r.setTransceiverDirection($e.INACTIVE,d),yield r.doPublishChange(!1)):yield r.doUnpublish(),r.uninstallTrackMuteEvents(i,n),n==null||n.emit("connection-state-changed",{prevState:r._currentState,state:"DISCONNECTED"})}()})}doPublishChange(){let e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return N(this,null,function*(){let t={state:this.publishState,constraintConfig:this._mediaSettings},r=yield this._signalChannel.sendWaitForResponseWithRetry({command:MR,data:t,responseCommand:ze.PUBLISH_STATE_CHANGE_RESULT,enableLog:e,retries:3});this.checkPublishResultCode(r.data.code,r.data.message)})}doUnpublish(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return this._signalChannel.sendWaitForResponse({command:oI,commandDesc:"unpublish",responseCommand:ze.UNPUBLISH_RESULT,enableLog:e}).catch(t=>{if(t.getCode()===se.API_CALL_TIMEOUT)return Promise.resolve();throw t})}updateMediaSettings(){let{detail:{isH264EncodeSupported:e,isVp8EncodeSupported:t}}=this._room.checkSystemResult;e?this._mediaSettings.videoCodec="H264":t&&(this._mediaSettings.videoCodec="VP8");let r=this._publishingLocalAudioTrack||this.localMainAudioTrack||this.localAuxAudioTrack,{localMainVideoTrack:i,localAuxVideoTrack:n}=this;if(this._publishingLocalVideoTrack&&(this._isPublishingAux?n=this._publishingLocalVideoTrack:i=this._publishingLocalVideoTrack),Hc){if(r&&r.outMediaTrack){let a=r.outMediaTrack.getSettings();this._mediaSettings.audioChannel=a.channelCount||1,this._mediaSettings.audioBps=1e3*r.profile.bitrate,this._mediaSettings.audioFs=a.sampleRate||0}if(i&&i.outMediaTrack){let a=i.outMediaTrack.getSettings();this._mediaSettings.videoWidth=a.width||0,this._mediaSettings.videoHeight=a.height||0,this._mediaSettings.videoFps=a.frameRate||0,this._mediaSettings.videoBps=1e3*i.profile.bitrate,i.small&&(this._mediaSettings.smallVideoWidth=i.small.width,this._mediaSettings.smallVideoHeight=i.small.height,this._mediaSettings.smallVideoFps=i.small.frameRate,this._mediaSettings.smallVideoBps=1e3*i.small.bitrate)}if(n&&n.outMediaTrack){let a=n.outMediaTrack.getSettings();this._mediaSettings.auxVideoWidth=a.width||0,this._mediaSettings.auxVideoHeight=a.height||0,this._mediaSettings.auxVideoFps=a.frameRate||0,this._mediaSettings.auxVideoBps=1e3*n.profile.bitrate}}else r&&r.outMediaTrack&&(this._mediaSettings.audioChannel=r.profile.channelCount,this._mediaSettings.audioBps=1e3*r.profile.bitrate,this._mediaSettings.audioFs=r.profile.sampleRate),i&&i.outMediaTrack&&(this._mediaSettings.videoWidth=i.profile.width,this._mediaSettings.videoHeight=i.profile.height,this._mediaSettings.videoFps=i.profile.frameRate,this._mediaSettings.videoBps=1e3*i.profile.bitrate);this._log.info("updateMediaSettings: ".concat(JSON.stringify(this._mediaSettings)))}sendMediaSettings(){this.updateMediaSettings(),this._signalChannel.sendWaitForResponse({command:xR,data:this._mediaSettings,responseCommand:ze.UPDATE_CONSTRAINT_CONFIG_RES}).then(e=>{e.data.code!==0&&this._log.warn(e.data.message)}).catch(()=>{})}addTrack(e){return N(this,null,function*(){if(!this._peerConnection)return;let t=e===this.localAuxAudioTrack||e===this.localAuxVideoTrack;this._log.info("is adding ".concat(e.kind," track to current published local ").concat(t?O.AUXILIARY:O.MAIN," stream")),es()&&(yield this.addTrackByTransceiver(e,t))})}addTrackByTransceiver(e,t){return N(this,null,function*(){var r;if(!e.mediaTrack)return;let i=this._peerConnection.getTransceivers();if(e.kind===O.AUDIO)yield i[0].sender.replaceTrack(e.outMediaTrack);else{let n=t?3:1;yield i[n].sender.replaceTrack(e.outMediaTrack),n===1&&((r=this.localMainVideoTrack)!=null&&r.small)&&(yield i[2].sender.replaceTrack(this._room.videoManager.smallTrack)),i[n].direction===$e.INACTIVE&&(yield this.setTransceiverDirection($e.SENDONLY,[n]))}this.updateMediaSettings(),yield this.doPublishChange()})}removeTrack(e){return N(this,null,function*(){if(!this._peerConnection)return;let t=e===this.localAuxAudioTrack||e===this.localAuxVideoTrack;this._log.info("is removing ".concat(e.kind," track from current published local ").concat(t?O.AUXILIARY:O.MAIN," stream")),es()&&(yield this.removeTrackByTransceiver(e,t))})}removeTrackByTransceiver(e,t){return N(this,null,function*(){if(!e.mediaTrack)return;let r=this._peerConnection.getTransceivers();if(e.kind===O.AUDIO)yield r[0].sender.replaceTrack(null);else{let i=t?3:1;yield r[i].sender.replaceTrack(null),i===1&&this._room.videoManager.hasSmall&&(yield r[2].sender.replaceTrack(null)),yield this.setTransceiverDirection($e.INACTIVE,[i])}this.updateMediaSettings(),yield this.doPublishChange()})}setTransceiverDirection(e,t){return N(this,null,function*(){if(!Rt)return;let r=!1,i=!1;this._log.info("setting transceiver ".concat(t.join(",")," direction to ").concat(e));let n=this._peerConnection.getTransceivers();if(t.forEach(A=>{n[A].direction!==e&&(n[A].direction=e,r=!0)}),r){this._log.info("updating offer");let A=yield this._peerConnection.createOffer();yield this._peerConnection.setLocalDescription(A)}let a=-1,c=this._peerConnection.remoteDescription.sdp.split(`\r
`).map(A=>{if(A.match(new RegExp("a=(".concat($e.INACTIVE,"|").concat($e.RECVONLY,"|").concat($e.SENDONLY,")")))&&a++,t.includes(a)){if(e===$e.INACTIVE&&A.includes("a=".concat($e.RECVONLY)))return i=!0,"a=".concat(e);if(e===$e.SENDONLY&&A.includes("a=".concat($e.INACTIVE)))return i=!0,"a=".concat($e.RECVONLY)}return A}).join(`\r
`);i&&(this._log.info("updating answer"),yield this._peerConnection.setRemoteDescription({type:"answer",sdp:c}))})}replaceTrack(e){return N(this,null,function*(){var t;let r=(t=this._peerConnection)==null?void 0:t.getSenders(),i=e.outMediaTrack||e.mediaTrack;if(!r||r.length===0||!i||r.find(a=>a.track===i))return!1;let n=e===this.localAuxAudioTrack||e===this.localAuxVideoTrack;return this._log.info("is replacing ".concat(i.kind," track ").concat(i.id," on ").concat(n?O.AUXILIARY:O.MAIN," stream")),i.kind===O.AUDIO&&r[0]&&(yield r[0].replaceTrack(i)),i.kind===O.VIDEO&&(!n&&r[1]&&(yield r[1].replaceTrack(i)),n&&r[3]&&(yield r[3].replaceTrack(i))),!0})}setBandwidth(e){return N(this,arguments,function(t){var r=this;let{bandwidth:i,type:n,videoType:a}=t;return function*(){if(r.singlePC){let c={};n===O.AUDIO?c.audio=i:a==="big"?c.bigVideo=i:a==="small"?c.smallVideo=i:c.auxVideo=i,yield r.singlePC.setBandwidth(c)}}()})}sendMutedFlag(e){e===this.localAuxAudioTrack||e===this.localAuxVideoTrack||(this._log.info("send muted state: ".concat(JSON.stringify(this.muteState))),this._signalChannel.sendWaitForResponseWithRetry({command:PR,responseCommand:ze.MUTE_RESULT,data:this.muteState,retries:3}).catch(()=>{}))}handleConnectionStateChange(e){e.state==="CONNECTED"&&(this.localMainVideoTrack||this._publishingLocalVideoTrack&&!this._isPublishingAux)&&te.emit(X.SEND_FIRST_VIDEO_FRAME,{room:this._room})}getVideoTrackId(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:O.VIDEO;if(this._peerConnection){let t=this._peerConnection.getSenders();if(e===O.AUXILIARY&&t[3]&&t[3].track)return t[3].track.id;if(e===O.VIDEO&&t[1]&&t[1].track)return t[1].track.id}if(this.localMainVideoTrack&&e===O.VIDEO){let t=this.localMainVideoTrack.mediaTrack;if(t)return t.id}if(this.localAuxVideoTrack&&e===O.AUXILIARY){let t=this.localAuxVideoTrack.mediaTrack;if(t)return t.id}return""}getSSRC(){return this.ssrc}checkPublishResultCode(e,t){if(e!==0)throw e===Th?(this._log.error(xi.NOT_SUPPORTED_H264ENCODE),new pe({code:se.NOT_SUPPORTED_H264,message:Ve({key:xe.NOT_SUPPORTED_H264ENCODE})})):new pe({code:se.UNKNOWN,message:Ve({key:xe.SIGNAL_RESPONSE_FAILED,data:{signalResponse:ze.PUBLISH_RESULT,code:e,message:t}})})}onSinglePCReconnected(){return N(this,null,function*(){this.isMainStreamPublished&&(this._log.warn("republish main stream"),yield this.publish({localAudioTrack:this.localMainAudioTrack,localVideoTrack:this.localMainVideoTrack,isAuxiliary:!1})),this.isAuxStreamPublished&&(this._log.warn("republish aux stream"),yield this.publish({localAudioTrack:this.localAuxAudioTrack,localVideoTrack:this.localAuxVideoTrack,isAuxiliary:!0}))})}};function ob(e){return Object.keys(e).filter(t=>e[t])}var fg=class extends nb{constructor(e){super(Ke(_e({},e),{isUplink:!1})),T(this,"_flag",0),T(this,"role","anchor"),T(this,"remoteAudioTrack"),T(this,"remoteVideoTrack"),T(this,"remoteAuxiliaryTrack"),T(this,"ssrc",{audio:0,video:0,videoRtx:0,auxiliary:0,auxiliaryRtx:0}),this.flag=e.flag,this.remoteAudioTrack=new q_(this._room,this),this.remoteVideoTrack=new iu(this._room,this),this.remoteAuxiliaryTrack=new gR(this._room,this),this.initialize()}get videoCodec(){var e;return((e=this.singlePC)==null?void 0:e.downlinkVideoCodec)||"h264"}get subscribeState(){return{audio:this.remoteAudioTrack.isSubscribed||this.remoteAudioTrack.isSubscribing,video:this.remoteVideoTrack.isBig&&(this.remoteVideoTrack.isSubscribed||this.remoteVideoTrack.isSubscribing),smallVideo:this.remoteVideoTrack.isSmall&&(this.remoteVideoTrack.isSubscribed||this.remoteVideoTrack.isSubscribing),auxiliary:this.remoteAuxiliaryTrack.isSubscribed||this.remoteAuxiliaryTrack.isSubscribing}}get muteState(){return Hd(this.flag,this.userId)}get flag(){return this._flag}set flag(e){var t,r,i;e!==this._flag&&(this._flag=e,(t=this.remoteAudioTrack)==null||t.onFlagChanged(),(r=this.remoteVideoTrack)==null||r.onFlagChanged(),(i=this.remoteAuxiliaryTrack)==null||i.onFlagChanged())}get hasMainStream(){return this.muteState.hasAudio||this.muteState.hasVideo||this.muteState.hasSmall}get hasAuxStream(){return this.muteState.hasAuxiliary}get isMainStreamSubscribed(){return(this.subscribeState.audio||this.subscribeState.video||this.subscribeState.smallVideo)&&(this.muteState.hasAudio||this.muteState.hasVideo||this.muteState.hasSmall)}get isAuxStreamSubscribed(){return this.subscribeState.auxiliary&&this.muteState.hasAuxiliary}get isSmallStreamSubscribed(){return this.subscribeState.smallVideo&&this.muteState.hasSmall}get isBigStreamSubscribed(){return this.subscribeState.video&&this.muteState.hasVideo}isStreamUnpublished(e){return e===O.MAIN?!this.muteState.hasAudio&&!this.muteState.hasVideo:!this.muteState.hasAuxiliary}initialize(){this.installEvents()}close(e){super.close(e),this.emitConnectionStateChangedEvent("DISCONNECTED"),this.remoteAudioTrack.close(),this.remoteVideoTrack.close(),this.remoteAuxiliaryTrack.close(),this.uninstallEvents(),this.removeDownlink()}installEvents(){!this.singlePC||(this.listeners("track").includes(this.onTrack)||this.singlePC.on("track",this.onTrack,this),this.listeners("spc-reconnected").includes(this.onSinglePCReconnected)||this.singlePC.on("spc-reconnected",this.onSinglePCReconnected,this))}uninstallEvents(){!this.singlePC||(this.singlePC.off("track",this.onTrack,this),this.singlePC.off("spc-reconnected",this.onSinglePCReconnected,this))}emitConnectionStateChangedEvent(e){var t,r;let i=this._currentState,n=super.emitConnectionStateChangedEvent(e);return n&&i!==e&&((t=this.remoteVideoTrack)==null||t.emit("connection-state-changed",{prevState:i,state:e}),(r=this.remoteAuxiliaryTrack)==null||r.emit("connection-state-changed",{prevState:i,state:e})),n}onTrack(e){let t=e.streams[0],{track:r,receiver:i}=e;if(!t.id.includes(this.tinyId))return;let n=t.id.includes("aux")?"auxiliary":"main";this._log.debug("ontrack ".concat(n," ").concat(r.kind));let a=O.AUDIO;r.kind===O.VIDEO&&(a=n===O.MAIN?O.VIDEO:O.AUXILIARY);let c=this.remoteAudioTrack;a===O.VIDEO?c=this.remoteVideoTrack:a===O.AUXILIARY&&(c=this.remoteAuxiliaryTrack),this.singlePC.enableInsertableStreams&&this.createEncodedStreams(c,i),c.setInputMediaStreamTrack(r)}createEncodedStreams(e,t){if(!this.singlePC.abortMap.has(t)){let r=t.createEncodedStreams(),i=new AbortController,n={abortController:i,enqueue:a=>{var c;return(c=this.singlePC)!=null&&c.isUsingH264?e.decodeFrame(a):a}};(e.enableDecodeFrame?r.readable.pipeThrough(new TransformStream({transform:(a,c)=>c.enqueue(n.enqueue(a))})):r.readable).pipeTo(r.writable,i).catch(a=>{a!=="destory"&&this._log.warn(a)}),this.singlePC.addAbortController(t,i)}}subscribe(e,t){return N(this,null,function*(){try{if(this._log.info("subscribe ".concat(t," ").concat(ob(e))),this.hasSSRC){let r="subscribe_change";Object.values(e).find(i=>i===!0)||(r="unsubscribe"),yield this.sendSubscription(r,e)}else yield this.doSubscribe(e),this.checkTrackEnded(e)}catch(r){throw this._room.isJoined&&this.isStreamUnpublished(t)?(this._log.warn("".concat(r.message," ").concat(JSON.stringify(this.muteState))),new pe({code:se.REMOTE_STREAM_NOT_EXIST,message:"remote user ".concat(this.userId," unpublished stream")})):r}})}checkTrackEnded(e){var t,r,i;if((e.audio&&((t=this.remoteAudioTrack.mediaTrack)==null?void 0:t.readyState)==="ended"||e.video&&((r=this.remoteVideoTrack.mediaTrack)==null?void 0:r.readyState)==="ended"||e.auxiliary&&((i=this.remoteAuxiliaryTrack.mediaTrack)==null?void 0:i.readState)==="ended")&&this.singlePC&&!this.singlePC.isReconnecting){if(this._log.warn("remote track ended start spc reconnect"),ca&&la<92)return;this.singlePC.startReconnection()}}unsubscribe(e){return N(this,arguments,function(t){var r=this;let{remoteTracks:i,streamType:n}=t;return function*(){var a;if(n==="main"&&!r.isMainStreamSubscribed||n==="auxiliary"&&!r.isAuxStreamSubscribed)return void r._log.info("".concat(n," stream already unsubscribed"));let c=_e({},r.subscribeState);i.forEach(d=>{switch(d.mediaType){case 1:c.audio=!1;break;case 4:c.video=!1;break;case 8:c.smallVideo=!1;break;case 2:c.auxiliary=!1}});let A="subscribe_change";Object.values(c).find(d=>d===!0)||(A="unsubscribe"),r._log.info("".concat(A==="unsubscribe"?A:"subscribe"," ").concat(n," [").concat(ob(c),"]")),A==="unsubscribe"&&((a=r.singlePC)==null||a.removeDownlinkQueue.add(r.tinyId)),yield r.sendSubscription(A,c),A==="unsubscribe"&&(yield r.removeDownlink())}()})}sendSubscription(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscribeState,r={srcTinyId:this.tinyId,srcUserId:this.userId},i=LR,n=ze.UNSUBSCRIBE_RESULT;return e==="subscribe_change"&&(r={audio:t.audio,bigVideo:t.video,auxVideo:t.auxiliary,smallVideo:t.smallVideo,srcTinyId:this.tinyId},i=QR,n=ze.SUBSCRIBE_CHANGE_RESULT),this._signalChannel.sendWaitForResponseWithRetry({command:i,data:r,responseCommand:n,timeout:1e4,retries:3}).then(a=>{let{data:c}=a;if(c.code!==0){let A=new pe({code:c.code,message:Ve({key:xe.ERROR_MESSAGE,data:{type:e,message:c.message}})});throw this._log.error(A),A}})}getMainStreamVideoTrackId(){return this.remoteVideoTrack&&this.remoteVideoTrack.mediaTrack?this.remoteVideoTrack.mediaTrack.id:""}getAuxStreamVideoTrackId(){return this.remoteAuxiliaryTrack&&this.remoteAuxiliaryTrack.mediaTrack?this.remoteAuxiliaryTrack.mediaTrack.id:""}setDelay(e){let{audioDelay:t,videoDelay:r}=e;this.remoteAudioTrack.stat.end2EndDelay=t,this.remoteVideoTrack.stat.end2EndDelay=r}onSinglePCReconnected(){(this.ssrc.audio||this.ssrc.video||this.ssrc.auxiliary)&&(this._log.warn("resubscribe ".concat(JSON.stringify(this.subscribeState))),this.doSubscribe(this.subscribeState))}get hasSSRC(){return this.ssrc.audio&&this.ssrc.video&&this.ssrc.auxiliary}doSubscribe(){return N(this,arguments,function(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.subscribeState,r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return function*(){if(e.singlePC){e.singlePC.addDownlinkQueue.add(e.tinyId),yield e.singlePC.waitForPeerConnectionConnected();try{if(r||!e.hasSSRC){let i={audioSsrc:rl(),bigVideoSsrc:rl(),bigVideoRtxSsrc:rl(),auxVideoSsrc:rl(),auxVideoRtxSsrc:rl()},{audioSsrc:n,bigVideoSsrc:a,bigVideoRtxSsrc:c,auxVideoSsrc:A,auxVideoRtxSsrc:d}=i;e.ssrc={audio:n,video:a,videoRtx:c,auxiliary:A,auxiliaryRtx:d},e.singlePC.addDownlinkQueue.delete(e.tinyId),yield e.singlePC.addDownlink({userId:e.userId,tinyId:e.tinyId,ssrc:e.ssrc});try{let g=yield e._signalChannel.sendWaitForResponseWithRetry({command:F1,responseCommand:ze.SPC_SUBSCRIBE_RESULT,data:{srcUserId:e.userId,srcTinyId:e.tinyId,audio:t.audio,bigVideo:t.video,auxVideo:t.auxiliary,smallVideo:t.smallVideo,customData:!1,ssrc:i},retries:3,retryTimeout:0});if(g.data.code!==0)throw new pe({code:g.data.code,message:g.data.message})}catch(g){throw yield e.removeDownlink(),g}return}e.singlePC.addDownlinkQueue.delete(e.tinyId),yield e.singlePC.addDownlink({userId:e.userId,tinyId:e.tinyId,ssrc:e.ssrc})}finally{let i=e._room.scheduleResult.config;(i!=null&&i.jitterDelay||i!=null&&i.jitterDelayAux)&&e.setJitterBufferDelay({mainDelay:i.jitterDelay,auxDelay:i.jitterDelayAux})}}}()})}removeDownlink(){return N(this,null,function*(){if(!this.singlePC)return;this.ssrc={audio:0,video:0,videoRtx:0,auxiliary:0,auxiliaryRtx:0},this.singlePC.removeDownlinkQueue.delete(this.tinyId);let e=this._room.scheduleResult.config;(e!=null&&e.jitterDelay||e!=null&&e.jitterDelayAux)&&this.setJitterBufferDelay({mainDelay:0,auxDelay:0}),yield this.singlePC.removeDownlink(this.userId)})}setJitterBufferDelay(e){let{mainDelay:t,auxDelay:r}=e;if(!this.singlePC||!this._peerConnection||ga(t)&&ga(r))return;this._log.info("set jitterBuffer main: ".concat(t," aux: ").concat(r));let i=this.singlePC.getReceiversByUserId(this.userId);return qt(t)&&(this.remoteAudioTrack.jitterBufferDelay=t,this.remoteVideoTrack.jitterBufferDelay=t),qt(r)&&(this.remoteAuxiliaryTrack.jitterBufferDelay=r,ga(t)&&(this.remoteAudioTrack.jitterBufferDelay=r)),new Promise(n=>{this.doSetJitterBufferDelay({mainDelay:t,auxDelay:r,receivers:i,resolve:n})})}doSetJitterBufferDelay(e){let{mainDelay:t,auxDelay:r,receivers:i,resolve:n}=e,a=-1;try{if(t===0&&r===0)return i.forEach(c=>c.jitterBufferTarget=0),n();if(i.forEach(c=>{var A;let d=c.track===this.remoteAuxiliaryTrack.outMediaTrack||ga(t)&&c.track===this.remoteAudioTrack.outMediaTrack;if(d&&ga(r)||!d&&ga(t))return;let g=d?r||0:t,E=(c.jitterBufferTarget||0)+100;E>g||(c.jitterBufferTarget=E,this._log.debug("set ".concat(d?"aux ":"").concat((A=c==null?void 0:c.track)==null?void 0:A.kind," jitterBuffer delay ").concat(E," -> ").concat(g)))}),!i.find(c=>{let A=c.track===this.remoteAuxiliaryTrack.outMediaTrack?r||0:t;return c.jitterBufferTarget<A}))return this._log.info("set jitterBuffer main: ".concat(t," aux: ").concat(r," done")),n();a=setTimeout(()=>{this.doSetJitterBufferDelay({mainDelay:t,auxDelay:r,receivers:i,resolve:n})},1e3)}catch(c){this._log.warn("set jitterBuffer delay error: ".concat(c)),clearTimeout(a),n()}}};le([Kc(),St(e=>function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return new Promise((n,a)=>{let c=A=>{this.off("closed",c),a(new pe({code:se.API_CALL_ABORTED,message:Ve({key:xe.CONNECTION_ABORTED,data:A})}))};this.on("closed",c),e.apply(this,r).then(n,a).finally(()=>{this.off("closed",c)})})})],fg.prototype,"subscribe",1),le([Kc()],fg.prototype,"unsubscribe",1),le([Xc(()=>"jitter")],fg.prototype,"setJitterBufferDelay",1);var Cx=fg,yx=lr(Lr()),sb=class extends yx.EventEmitter{constructor(e,t){super(),this.room=e,this.signalChannel=t,T(this,"log"),T(this,"cmdIdSeqMap",new Map),T(this,"messageMap",new Map),this.log=ae.createLogger({id:"cmm",userId:e.userId}),this.onReceiveMsg=this.onReceiveMsg.bind(this),t.on(ze.RECEIVE_CUSTOM_MSG,this.onReceiveMsg)}send(e){let{cmdId:t,data:r}=e,i=this.cmdIdSeqMap.get(t)||Math.floor(16383*Math.random()),n={cmdId:t,msg:btoa(String.fromCharCode(...new Uint8Array(r))),ordered:!0,reliable:!0,streamSeq:i};this.cmdIdSeqMap.set(t,i+1),this.signalChannel.send(H1,n)}onReceiveMsg(e){let{data:t}=e.data,r=this.room.tinyIdToUserIdMap.get(t.srcTinyId);if(r){let i={userId:r,cmdId:t.cmdId,seq:t.streamSeq,data:Uint8Array.from(atob(t.msg),n=>n.charCodeAt(0)).buffer};if(t.ordered){let n="".concat(r,"_").concat(i.cmdId),a=this.messageMap.get(n);if(!a||Math.abs(a.lastSeq-i.seq)>sb.SEQ_INTERVAL)this.messageMap.set(n,{lastSeq:i.seq,cachedMessageMap:new Map}),this.emitMessage(i);else if(i.seq>a.lastSeq){if(i.seq===a.lastSeq+1)this.emitMessage(i);else if(!a.cachedMessageMap.has(i.seq)){let c=setTimeout(()=>this.emitMessage(i,!0),5e3);a.cachedMessageMap.set(i.seq,{message:i,timeoutId:c})}}else this.log.debug("drop message ".concat(i.userId,"-").concat(i.cmdId,"-").concat(i.seq))}else this.emit("message",i)}}emitMessage(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];var r;let i=this.messageMap.get("".concat(e.userId,"_").concat(e.cmdId)),n=e;if(i){if(t){let c=[...i.cachedMessageMap.values()].sort((A,d)=>A.message.seq-d.message.seq);c[0]&&(n=c[0].message)}n.seq-i.lastSeq>1&&this.log.debug("msg lost userId: ".concat(n.userId," seq: ").concat(i.lastSeq," -> ").concat(n.seq)),i.lastSeq=n.seq,clearTimeout((r=i.cachedMessageMap.get(n.seq))==null?void 0:r.timeoutId),i.cachedMessageMap.delete(n.seq)}this.emit("message",n);let a=i==null?void 0:i.cachedMessageMap.get(n.seq+1);a&&this.emitMessage(a.message)}},ab=sb;T(ab,"SEQ_INTERVAL",300);var cb,{isString:lb,isUndefined:il,getNetworkType:Tx,isEmpty:pu}=cn,ds=class extends ux{constructor(e){super(e),this._heartbeat=-1,this._lastHeartBeatTime=-1,this._joinTimeout=-1,this._firstPublishedList=null,this._joinReject=null,this._isRelayChanged=!1,this._signalChannel=null,this.uplinkConnection=null,this.singlePC=null,this.enableSPC=Kd,this._changeBigSmallRecords=new Map,this._networkQuality=null,this._turnServers=[],this._syncUserListInterval=-1,this._smallStreamConfig={bitrate:100,frameRate:15,height:120,width:160},this.enableSEI=!1,this._enableAudioVolumeEvaluation=!1,this._audioVolumeIntervalId=0,this._enableMultiAuxStream=!1,this._pureAudioPushMode=!1,this.enableHWEncoder=!1,this._stats=new Y1(this,this._log),this.userManager=new n1(this.userId,this._log),this._version=ln,this.sdpSemantics=yh,il(e.sdpSemantics)?Yd.isUnifiedPlanDefault()&&(this.sdpSemantics=Td):this.sdpSemantics=e.sdpSemantics,this._log.info("sdpSemantics: ".concat(this.sdpSemantics,", netType: ").concat(Tx())),e.iceTransportPolicy&&(this._iceTransportPolicy=e.iceTransportPolicy),this._enableMultiAuxStream=!il(e.enableMultiAuxStream)&&e.enableMultiAuxStream,this.enableSEI=e.enableSEI&&Kd,!il(e.enableSPC)&&Kd&&(this.enableSPC=e.enableSPC),this.enableHWEncoder=e.enableHWEncoder||!1,this._initBusinessInfo(e)}get isMainStreamPublished(){var e;return!((e=this.uplinkConnection)==null||!e.isMainStreamPublished)}get isMainAudioPublished(){var e;return!((e=this.uplinkConnection)==null||!e.localMainAudioTrack)}get isAuxStreamPublished(){var e;return!((e=this.uplinkConnection)==null||!e.isAuxStreamPublished)}get hasAuxStream(){return[...this.remotePublishedUserMap.values()].findIndex(e=>e.muteState.hasAuxiliary)>=0}get userMap(){return this.userManager.userMap}get remotePublishedUserMap(){return this.userManager.remotePublishedUserMap}get tinyIdToUserIdMap(){return new Map([...this.userMap.values()].map(e=>[e.tinyId,e.userId]))}join(e,t,r){return N(this,null,function*(){return this.userManager.mySelfId=this.userId,this.userManager.on("1",i=>{this.emit("peer-join",i)}),this.userManager.on("2",i=>{this.closeDownLinkConnection(i,"remote user exitRoom"),this.emit("peer-leave",i)}),this.userManager.on("3",this.createDownlinkConnection,this),this.userManager.on("5",this.closeDownLinkConnection,this),this.userManager.on("6",i=>{var n=((a,c)=>{var A={};for(var d in a)TE.call(a,d)&&c.indexOf(d)<0&&(A[d]=a[d]);if(a!=null&&Eh)for(var d of Eh(a))c.indexOf(d)<0&&Cv.call(a,d)&&(A[d]=a[d]);return A})(i,[]);te.emit(X.REMOTE_PUBLISH_STATE_CHANGED,_e({room:this},n)),this.emit("remote-publish-state-changed",_e({},n))}),this.joinParams=e,new Promise((i,n)=>N(this,null,function*(){var a,c;this._joinReject=n;try{this.checkDestroy();try{yield Promise.all([this.initialize(),this.initSinglePC()])}catch(A){if(!(A instanceof pe&&A.code===se.SPC_INITIALIZED_FAILED))return n(A);(a=this._signalChannel)==null||a.destroy(),yield this.initialize()}yield this.doJoin(e,(c=this.singlePC)==null?void 0:c.clientAbility),i(),this._firstPublishedList&&this.onPublishedUserList({data:{userList:this._firstPublishedList}})}catch(A){n(A)}this._joinReject=null}))})}initSinglePC(){return N(this,null,function*(){if(this.enableSPC&&!this.singlePC){this.singlePC=new gu({signalChannel:this._signalChannel,room:this,enableCustomMessage:!1}),this.singlePC.on("sei-message",e=>this.emit("sei-message",e)),this.singlePC.once("error",()=>this.fallbackToMPC());try{return yield this.singlePC.initialize()}catch(e){throw this.fallbackToMPC(),new pe({code:se.SPC_INITIALIZED_FAILED,message:e==null?void 0:e.message})}}})}doJoin(e,t){return new Promise((r,i)=>N(this,null,function*(){var n,a,c;e.privateMapKey&&(this.privateMapKey=e.privateMapKey),e.latencyLevel&&(this.latencyLevel=e.latencyLevel),this._signalChannel.once(NR,g=>{this.clearJoinTimeout(),te.emit(X.JOIN_SIGNAL_CONNECTION_END,{room:this,error:g}),i(g)}),ei((a=(n=this.scheduleResult)==null?void 0:n.config)==null?void 0:a.singlePC)&&Kd&&(this.enableSPC=this.scheduleResult.config.singlePC),this.keyPointManager.setConnectionType(this.singlePC?1:2);let A={roomId:String(e.roomId||e.strRoomId),useStringRoomId:this.useStringRoomId,privateMapKey:this.privateMapKey,latencyLevel:this.latencyLevel,trtcRole:e.role,trtcScene:this.scene==="live"?2:1,sdpSemantics:this.sdpSemantics,version:this._version,ua:navigator&&navigator.userAgent||"",terminalType:a0(),netType:Fh(),bussinessInfo:this._businessInfo,ability:t,sdkType:this._sdkType,userSig:this.userSig};this._log.debug("join room signal data: ".concat(JSON.stringify(A)));let d=5e3;(c=this.scheduleResult.config)!=null&&c.enterRoomTimeout&&this.scheduleResult.config.enterRoomTimeout>=1&&(d=1e3*this.scheduleResult.config.enterRoomTimeout),this._joinTimeout=window.setTimeout(()=>{i(new pe({code:se.JOIN_ROOM_FAILED,message:Ve({key:xe.JOIN_ROOM_TIMEOUT})}))},d),te.emit(X.JOIN_SEND_CMD,{room:this}),this._signalChannel.send(this.singlePC?x1:S1,A),this._signalChannel.once(ze.JOIN_ROOM_RESULT,g=>{this.clearJoinTimeout();let{code:E,message:f,data:b,tinyId:w}=g.data;te.emit(X.JOIN_RECEIVED_CMD_RES,{room:this,code:E}),E===0?(this._log.info("Join room success, start heartbeat"),w&&(this.tinyId=w),this.startHeartbeat(),this.syncUserList(),this.startSyncUserListInterval(),this._firstPublishedList=b.publishers,this.singlePC&&this.singlePC.connect(b.ability).catch(()=>{}),r()):(this._log.error("Join room failed result: ".concat(E," error: ").concat(f)),i(new pe({code:se.JOIN_ROOM_FAILED,extraCode:E,message:Ve({key:xe.JOIN_ROOM_FAILED,data:{error:f,code:E}})})))})}))}reJoin(){let e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return N(this,null,function*(){if(this.isJoined)try{this._log.warn("reJoin pending: ".concat(this.joinParams.roomId));let t,r=[];if(this.singlePC&&(this.singlePC.close(),this.singlePC=null,r.push(this.initSinglePC().then(i=>(t=i,i)))),this._signalChannel&&(this._signalChannel.race=e,this._signalChannel.close(),r.push(this._signalChannel.connect())),yield Promise.all(r),yield this.doJoin(Ke(_e({},this.joinParams),{role:this.role==="anchor"?20:21,privateMapKey:this.privateMapKey,latencyLevel:this.latencyLevel}),t),this._log.warn("reJoin success"),Lt.logSuccessEvent({userId:this.userId,eventType:Hn.REJOIN}),this.singlePC){let i=n=>{var a;n.state==="CONNECTED"&&((a=this.singlePC)==null||a.off(ba.CONNECTION_STATE_CHANGED,i),this.uplinkConnection instanceof pI&&(this.uplinkConnection.installEvents(),this.uplinkConnection.onSinglePCReconnected()),this.remotePublishedUserMap.forEach(c=>{c.installEvents(),c.onSinglePCReconnected()}))};this.singlePC.on(ba.CONNECTION_STATE_CHANGED,i),this.checkConnectionsToReconnect(),this.uplinkConnection instanceof uI&&!this.uplinkConnection.getIsReconnecting()&&this.uplinkConnection.startReconnection()}}catch(t){this._log.warn("reJoin fail ".concat(t)),this.reset(),Lt.logFailedEvent({userId:this.userId,eventType:Hn.REJOIN,error:t}),this.emit("error",new pe({code:se.JOIN_ROOM_FAILED,message:Ve({key:xe.REJOIN_ROOM_FAILED,data:{roomId:this.joinParams.roomId}})}))}else this._log.warn("reJoin abort")})}initialize(){return N(this,null,function*(){let{mainUrl:e,backupUrl:t}=this.getSignalChannelUrl(),r=this._signalChannel||function(n){return[...hg.values()].find(c=>c.room.userId===n&&!c.room.isJoined)||null}(this.userId),i=!!(r&&r.isConnected&&r.keepAlive);return this._log.info("".concat(i?"reuse":"setup"," signal channel")),i?(r.url=e,r.backupUrl=t,r.room=this,this._signalChannel=r):(this._signalChannel=new UR({sdkAppId:this.sdkAppId,userId:this.userId,userSig:this.userSig,url:e,backupUrl:t,race:this.enableSPC&&!this.proxy_ws,room:this}),this._customMessageManager=new ab(this,this._signalChannel),this._customMessageManager.on("message",n=>{this.emit("custom-message",n)})),this._networkQuality||(this._networkQuality=new AI({signalChannel:this._signalChannel,room:this}),this._networkQuality.on(AI.EVENT_NETWORK_QUALITY,n=>{this.emit("network-quality",n)})),Fi(this,this._signalChannel).add(nI,n=>{te.emit(X.SIGNAL_CONNECTION_STATE_CHANGED,_e({room:this},n)),this.emit("signal-connection-state-changed",n)}).add(C1,n=>{this.reset(),this.emit("error",n)}).add(ze.PEER_JOIN,n=>{let{srcTinyId:a,userId:c,role:A}=n.data.data;this.userManager.addUser({userId:c,tinyId:a,role:A})}).add(ze.PEER_LEAVE,n=>{let{userId:a,reason:c=0}=n.data.data;this.userManager.deleteUser(a,c)}).add(ze.UPDATE_REMOTE_MUTE_STAT,n=>{this._lastHeartBeatTime>0&&Date.now()-this._lastHeartBeatTime>=1e4&&this.doHeartbeat(),this.onPublishedUserList(n.data)}).add(ze.CLIENT_BANNED,n=>{let a=n.data.data,{reason:c}=a;if(Lt.uploadEvent({log:"stat-banned:".concat(c),userId:this.userId}),c==="user_time_out")return this._log.warn("".concat(c," last heart beat time: ").concat(this._lastHeartBeatTime," interval: ").concat(Date.now()-this._lastHeartBeatTime,", visibility: ").concat(document.visibilityState)),void this.reJoin();this._log[c==="kick"?"error":"info"]("user was banned because of [".concat(c,"]")),this.reset(),this.emit("banned",{reason:c})}),this._signalChannel.once(BR,n=>{this.tinyId=n.signalInfo.tinyId,te.emit(X.JOIN_SIGNAL_CONNECTION_END,{room:this})}),te.emit(X.JOIN_SIGNAL_CONNECTION_START,{room:this}),yield this._signalChannel.connect(),i&&te.emit(X.JOIN_SIGNAL_CONNECTION_END,{room:this}),i})}setSignalChannel(e){this._signalChannel=e,e||br(this)}leave(){return N(this,null,function*(){var e;try{yield this.doHeartbeat()}catch{}this._log.info("leave() => leaving room"),te.emit(X.LEAVE_SEND_CMD,{room:this}),(e=this._signalChannel)==null||e.send(v1)})}clearNetworkQuality(){this._networkQuality&&(this._networkQuality.stop(),this._networkQuality=null)}closeConnections(){this.remotePublishedUserMap.forEach(e=>{this.closeDownLinkConnection(e.userId,"you exitRoom")})}clearJoinTimeout(){clearTimeout(this._joinTimeout),this._joinTimeout=-1}startHeartbeat(){this._heartbeat===-1&&(this._heartbeat=Qt.run(bd,this.doHeartbeat.bind(this),{delay:2e3}))}stopHeartbeat(){this._heartbeat!==-1&&(this._log.info("stopHeartbeat"),Qt.clearTask(this._heartbeat),this._heartbeat=-1,this._lastHeartBeatTime=-1)}doHeartbeat(){return N(this,null,function*(){var e;let t=this.badCaseDetector.getMonitorFreeze(),r=yield this._stats.getStatsReport({uplinkConnection:this.uplinkConnection,downlinkConnections:this.remotePublishedUserMap,freezeMap:t});if(this.badCaseDetector.resetMonitor(),(e=this._signalChannel)==null||!e.isConnected)return;let i=this._signalChannel.isConnected?function(c){if(zc.has(c)){let A=zc.get(c).map(d=>({uint32_event_id:d.eventId,uint64_date:d.timestamp,str_userid:d.remoteUserId,uint32_param1:d.param1,uint32_param2:d.param2,uint32_video_stream_type:d.streamType}));return zc.delete(c),A}return[]}(this.userId):[],n=Ke(_e({str_sdk_version:wE,uint64_datetime:new Date().getTime(),msg_user_info:{str_identifier:this.userId,uint64_tinyid:this.tinyId},msg_event_msg:i,str_acc_ip:this.getSignalInfo().relayIp,str_client_ip:this.getSignalInfo().clientIp},r),{msg_device_info:_e({uint32_terminal_type:15,str_device_name:navigator.platform,str_os_version:"",uint32_net_type:Fh()},r.msg_device_info)});te.emit(X.HEARTBEAT_REPORT,{room:this,report:n}),this._signalChannel.send(R1,n),this.emit("heartbeat-report",Ke(_e({},n),{bytes_sent:this._stats.totalBytesSent+this._signalChannel.bytesSent,bytes_received:this._stats.totalBytesReceived+this._signalChannel.bytesReceived}));let a=Date.now();this._lastHeartBeatTime>0&&a-this._lastHeartBeatTime>1e4&&this._log.warn("heartbeat took ".concat(a-this._lastHeartBeatTime)),this._signalChannel.isConnected&&(this._lastHeartBeatTime=a),!this._isRelayChanged&&this.isRelayMaybeFailed()&&(this.reJoin(),this._isRelayChanged=!0)})}onPublishedUserList(e){if(!this.isJoined)return;let t=e.data.userList.map(r=>{let{userId:i,srcTinyId:n,flag:a}=r;i===this.userId&&this.uplinkConnection&&(this.uplinkConnection.flag=a);let c=this.remotePublishedUserMap.get(i);return c&&this.checkSubscribeBigSmallVideo(c),{userId:i,tinyId:n,flag:a}});te.emit(X.RECEIVED_PUBLISHED_USER_LIST,{room:this,publishedUserList:t}),this.userManager.setRemotePublishedUserList(t)}closeUplink(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"you unpublished";this.uplinkConnection&&(this.localTracks.size>0&&this.uplinkConnection.doUnpublish(),this.uplinkConnection.close(e),this.uplinkConnection=null),this.localTracks.forEach(t=>t.unpublish()),this.localTracks.clear()}createDownlinkConnection(e){let{userId:t,tinyId:r,flag:i}=e,n=new(this.singlePC?Cx:HR)({userId:t,tinyId:r,room:this,signalChannel:this._signalChannel,enableSEI:this.enableSEI,flag:i});this.userManager.addRemotePublishedUser(n),this.installDownlinkEvents(n,t),this.emit("remote-published",n)}closeDownLinkConnection(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"remote user unpublished",r=this.remotePublishedUserMap.get(e);r&&(r.close(t),this.emit("remote-unpublished",r))}installDownlinkEvents(e,t){e.on("error",r=>{let i=r.getCode();i!==se.ICE_TRANSPORT_ERROR&&(i===se.DOWNLINK_RECONNECTION_FAILED&&this.closeDownLinkConnection(t),this.emit("error",r))}),e.on("connection-state-changed",r=>{this.emit("media-connection-state-changed",Ke(_e({},r),{userId:e.userId}))}),e.on("firewall-restriction",()=>{this.emit("firewall-restriction")})}startSyncUserListInterval(){this._syncUserListInterval===-1&&(this._syncUserListInterval=Qt.run(bd,this.syncUserList.bind(this)))}stopSyncUserListInterval(){Qt.clearTask(this._syncUserListInterval),this._syncUserListInterval=-1}syncUserList(){return this.getUserList().then(e=>{this.userManager.setUserList(e)}).catch(e=>{this._log.debug("sync user list failed: ".concat(e))})}getUserList(){var e;return(e=this._signalChannel)!=null&&e.isConnected?this._signalChannel.sendWaitForResponse({command:M1,responseCommand:ze.USER_LIST_RES,enableLog:!1,timeout:2e3}).then(t=>{let{data:r}=t,{code:i,message:n}=r;if(i===0)return(r.data&&r.data.userList||[]).map(a=>{let{userId:c,srcTinyId:A,role:d}=a;return{userId:c,tinyId:A,role:d}});throw Ve({key:xe.SIGNAL_RESPONSE_FAILED,data:{signalResponse:ze.USER_LIST_RES,code:i,message:n}})}):Promise.reject("not connected")}getAllConnections(){let e=[...this.remotePublishedUserMap.values()];return this.uplinkConnection&&e.push(this.uplinkConnection),e}isRelayMaybeFailed(){if(this._signalChannel&&!this._signalChannel.isOnline||!FR)return!1;if(this.singlePC)return this.singlePC.reconnectionCount>6;let e=this.getAllConnections();if(e.length===0)return!1;for(let t=0;t<e.length;t++)if(e[t].getReconnectionCount()<6)return!1;return!0}checkConnectionsToReconnect(){var e;this.singlePC?((e=this.singlePC.getPeerConnection())==null?void 0:e.connectionState)===Vt.CLOSED&&!this.singlePC.isReconnecting&&(this._log.warn("spc pc is closed but not reconnect"),this.singlePC.startReconnection()):this.getAllConnections().forEach(t=>{if(t instanceof Sa&&!t.getIsReconnecting()){let r=t.getPeerConnection();r&&r.connectionState===Vt.CLOSED&&(this._log.warn("[".concat(t.getUserId(),"] pc is closed but not reconnect")),t.startReconnection())}})}fallbackToMPC(){return N(this,null,function*(){var e;if(this._log.warn("fallback to multi pc"),Lt.uploadEvent({log:"stat-fallback",userId:this.userId}),this.enableSPC=!1,(e=this.singlePC)==null||e.close(),this.singlePC=null,this.isJoined&&(yield this.reJoin(!1)),this.uplinkConnection){let t=this.uplinkConnection;this.uplinkConnection=new uI({userId:this.userId,tinyId:this.tinyId,room:this,signalChannel:this._signalChannel,enableSEI:this.enableSEI,audioManager:this.audioManager}),t.isMainStreamPublished&&(yield this.uplinkConnection.publish({localAudioTrack:t.localMainAudioTrack,localVideoTrack:t.localMainVideoTrack,isAuxiliary:!1})),t.isAuxStreamPublished&&(yield this.uplinkConnection.publish({localAudioTrack:t.localAuxAudioTrack,localVideoTrack:t.localAuxVideoTrack,isAuxiliary:!0})),t.close()}this.remotePublishedUserMap.forEach(t=>{let r=new HR({userId:t.userId,tinyId:t.tinyId,room:this,signalChannel:this._signalChannel,enableSEI:this.enableSEI,flag:t.flag,remoteAudioTrack:t.remoteAudioTrack,remoteVideoTrack:t.remoteVideoTrack,remoteAuxiliaryTrack:t.remoteAuxiliaryTrack});this.installDownlinkEvents(r,t.userId),this.remotePublishedUserMap.set(t.userId,r),t.isMainStreamSubscribed&&r.subscribe(t.subscribeState,"main"),t.isAuxStreamSubscribed&&r.subscribe(t.subscribeState,"auxiliary")})})}destroy(){this.isDestroyed||(this._signalChannel&&(this._log.info("destroying SignalChannel"),this._signalChannel.close(),this._signalChannel=null),super.destroy(),this._joinReject&&(this._joinReject(new pe({code:se.INVALID_OPERATION,message:Ve({key:xe.CLIENT_DESTROYED,data:{funName:"join"}})})),this.clearJoinTimeout(),this.reset()),this.removeAllListeners())}switchRole(e){return N(this,null,function*(){this.role!==e&&(e==="audience"&&this.uplinkConnection&&this.closeUplink("you switch role to audience"),yield this.doSwitchRole(e))})}doSwitchRole(e){let t={command:L1,data:{role:e==="anchor"?20:21,privateMapKey:this.privateMapKey,latencyLevel:this.latencyLevel},responseCommand:ze.SWITCH_ROLE_RES,retries:1};return this._log.info("switchRole signal data: ".concat(JSON.stringify(t.data))),this._signalChannel.sendWaitForResponseWithRetry(t).then(r=>{let{code:i,message:n}=r.data;if(i!==0)throw new pe({code:se.SWITCH_ROLE_FAILED,message:Ve({key:xe.SWITCH_ROLE_FAILED,data:{message:n,code:i}})});this.role=e}).catch(r=>{throw r instanceof pe&&r.getCode()===se.API_CALL_TIMEOUT&&(r=new pe({code:se.SWITCH_ROLE_FAILED,message:Ve({key:xe.SWITCH_ROLE_TIMEOUT})})),this._log.error(r),r})}publish(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return N(this,null,function*(){let i={},n={};t.forEach(d=>{d instanceof qn&&(d instanceof ru?n.audio=d:i.audio=d),d instanceof ti&&(d instanceof Ia&&d.mediaType===2?n.video=d:i.video=d)});let a=pu(i),c=pu(n);(!a||!c)&&!this.uplinkConnection&&(this.singlePC?this.uplinkConnection=new pI({userId:this.userId,tinyId:this.tinyId,room:this,signalChannel:this._signalChannel,enableSEI:this.enableSEI,audioManager:this.audioManager}):this.uplinkConnection=new uI({userId:this.userId,tinyId:this.tinyId,room:this,signalChannel:this._signalChannel,enableSEI:this.enableSEI,audioManager:this.audioManager}),this.uplinkConnection.on("connection-state-changed",d=>{this.emit("media-connection-state-changed",Ke(_e({},d),{userId:this.userId}))}),this.uplinkConnection.on("firewall-restriction",()=>{this.emit("firewall-restriction")}),this.uplinkConnection.on("error",d=>{let g=d.getCode();g!==se.ICE_TRANSPORT_ERROR&&(g===se.UPLINK_RECONNECTION_FAILED&&this.closeUplink(),this.emit("error",d))}));let A=t.map(d=>d.kind).join(",");a||(this._log.info("publish() => main ".concat(A)),yield this.uplinkConnection.publish({localAudioTrack:i.audio,localVideoTrack:i.video,isAuxiliary:!1}),this._log.info("main is published")),c||(this._log.info("publish() => aux ".concat(A)),yield this.uplinkConnection.publish({localAudioTrack:n.audio,localVideoTrack:n.video,isAuxiliary:!0}),this._log.info("aux is published"))})}unpublish(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return N(this,null,function*(){if(this.scene==="live"&&this.role!=="anchor"||!this.isMainStreamPublished&&!this.isAuxStreamPublished||!this.uplinkConnection)return;let i={},n={};t.forEach(a=>{!a.mediaTrack||!a.isPublished||(a instanceof qn&&(a instanceof ru?n.audio=a:i.audio=a),a instanceof ti&&(a instanceof Ia&&a.mediaType===2?n.video=a:i.video=a))});try{let a=t.map(c=>c.kind).join(",");pu(i)||(this._log.info("unpublish() => main ".concat(a)),yield this.uplinkConnection.unpublish({localAudioTrack:i.audio,localVideoTrack:i.video})),pu(n)||(this._log.info("unpublish() => aux ".concat(a)),yield this.uplinkConnection.unpublish({localAudioTrack:n.audio,localVideoTrack:n.video}))}catch{}this.localTracks.size===0&&this.closeUplink("you unpublished")})}addTrack(e){if(!this.uplinkConnection||!e.mediaTrack)return Promise.resolve();let t=this.uplinkConnection.addTrack(e);return e.publish(this,t),t}removeTrack(e){return this.uplinkConnection&&e.mediaTrack?this.uplinkConnection.removeTrack(e).then(t=>(e.unpublish(),t)):Promise.resolve()}replaceTrack(e){return this.uplinkConnection&&e.mediaTrack&&P0()?this.uplinkConnection.replaceTrack(e).then(t=>{t&&te.emit(X.LOCAL_TRACK_REPLACED,{track:e})}):Promise.resolve()}setBandWidth(e){return N(this,null,function*(){!this.uplinkConnection||(yield this.uplinkConnection.setBandwidth(e),yield this.uplinkConnection.sendMediaSettings())})}enableSmall(e){return N(this,null,function*(){if(!this.uplinkConnection||!this.uplinkConnection.localMainVideoTrack)return Promise.resolve();e&&this.uplinkConnection.localMainVideoTrack.small&&(yield this.setBandWidth({type:O.VIDEO,videoType:O.SMALL,bandwidth:this.uplinkConnection.localMainVideoTrack.small.bitrate})),yield this.uplinkConnection.enableSmall(e)})}subscribe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return N(this,null,function*(){if(t=t.filter(c=>!c.isSubscribed),t.length===0)return;let{userId:i}=t[0],n=this.remotePublishedUserMap.get(i);if(!n)return;let a=t.find(c=>c.mediaType===2)?"auxiliary":"main";try{let c=_e({},n.subscribeState);t.forEach(d=>{switch(d.mediaType){case 1:c.audio=!0;break;case 4:c.video=!0;break;case 8:c.smallVideo=!0;break;case 2:c.auxiliary=!0}});let A=this._changeBigSmallRecords.get(i);A&&A.options.smallVideo&&n.muteState.hasSmall&&c.video&&(c.video=!1,c.smallVideo=!0),te.emit(X.SUBSCRIBE_START,{room:this,streamType:a,remotePublishedUser:n,subscribeState:c}),this._log.info("subscribe() => ".concat(i," ").concat(a," [").concat(cI(c),"] prev: [").concat(cI(n.subscribeState),"]")),yield n.subscribe(c,a),this._log.info("subscribe ".concat(i," ").concat(a," done"));for(let d of t)d.mediaTrack||(yield d.waitHasMediaTrack());te.emit(X.SUBSCRIBE_SUCCESS,{room:this,streamType:a,remotePublishedUser:n})}catch(c){let A=c instanceof pe?c.getCode():se.UNKNOWN,d=c;throw c instanceof pe?A===se.REMOTE_STREAM_NOT_EXIST&&(d=new pe({code:se.API_CALL_ABORTED,message:Ve({key:xe.API_CALL_ABORTED,data:{message:c.message,userId:i,streamType:a}})}),this._log.warn(d)):(d=new pe({code:A,message:Ve({key:xe.SUBSCRIBE_FAILED,data:{message:c.message,userId:i,streamType:a}})}),this._log.error(d)),d}})}unsubscribe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return N(this,null,function*(){let{userId:i}=t[0],n=this.remotePublishedUserMap.get(i);if(!n)return;let a=t.find(c=>c.mediaType===2)?"auxiliary":"main";this._log.info("unsubscribe() => ".concat(i," ").concat(a));try{yield n.unsubscribe({remoteTracks:t,streamType:a})}catch(c){this._log.warn("unsubscribe() => failed ".concat(c))}t.forEach(c=>{c.unsubscribe(),c.mediaType===8&&c.setMediaType(4)}),te.emit(X.UNSUBSCRIBE_SUCCESS,{room:this,streamType:a,remotePublishedUser:n})})}setEncodedDataProcessingListener(e){throw new Error("Method not implemented.")}enableAudioVolumeEvaluation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:2e3,t=arguments.length>1?arguments[1]:void 0;if(e<=0)return this._enableAudioVolumeEvaluation=!1,void Qt.clearTask(this._audioVolumeIntervalId);e=Math.floor(Math.max(e,100)),te.emit(X.AUDIO_LEVEL_INTERVAL,{interval:e}),this._audioVolumeIntervalId&&Qt.clearTask(this._audioVolumeIntervalId),this._enableAudioVolumeEvaluation=!0,this._audioVolumeIntervalId=Qt.run(VE,()=>{var r;let i=[];(r=this.remotePublishedUserMap)==null||r.forEach(n=>{if(n.muteState.hasAudio){let a=Math.floor(100*n.remoteAudioTrack.getAudioLevel());i.push({userId:n.userId,volume:a})}}),this.emit("audio-volume",i)},{fps:1e3/e,backgroundTask:t})}getLocalAudioStats(){return N(this,null,function*(){let e={};if(e[this.userId]={bytesSent:0,packetsSent:0},this.uplinkConnection){let t=yield this._stats.getSenderStats(this.uplinkConnection);e[this.userId]={bytesSent:t.audio.bytesSent,packetsSent:t.audio.packetsSent}}return e})}getLocalVideoStats(){return N(this,null,function*(){let e={};if(e[this.userId]={bytesSent:0,packetsSent:0,framesEncoded:0,framesSent:0,frameWidth:0,frameHeight:0},this.uplinkConnection){let{video:{bytesSent:t,packetsSent:r,framesEncoded:i,framesSent:n,frameWidth:a,frameHeight:c}}=yield this._stats.getSenderStats(this.uplinkConnection);e[this.userId]={bytesSent:t,packetsSent:r,framesEncoded:i,framesSent:n,frameWidth:a,frameHeight:c}}return e})}getTransportStats(){return N(this,null,function*(){let e={rtt:0,downlinksRTT:{}};if(this.uplinkConnection){let t=yield this._stats.getSenderStats(this.uplinkConnection);e.rtt=t.rtt}for(let[,t]of this.remotePublishedUserMap){let r=yield this._stats.getReceiverStats(t);e.downlinksRTT[r.userId]=r.rtt}return e})}getRemoteVideoStats(e){return N(this,null,function*(){let t={};for(let[r,i]of this.remotePublishedUserMap)e==="main"&&i.muteState.hasVideo&&(t[r]=i.remoteVideoTrack.stat),e==="auxiliary"&&i.muteState.hasAuxiliary&&(t[r]=i.remoteAuxiliaryTrack.stat);return t})}getRemoteAudioStats(){return N(this,null,function*(){let e={};for(let[t,r]of this.remotePublishedUserMap)r.muteState.hasAudio&&(e[t]=r.remoteAudioTrack.stat);return e})}setTurnServer(e,t){this._log.info("set turn server: ".concat(JSON.stringify(e)," ").concat(t||""));let r=[];Array.isArray(e)?e.forEach(i=>r.push(cn.getTurnServer(i))):cn.isPlainObject(e)&&r.push(cn.getTurnServer(e)),this._turnServers=r,t&&(this._iceTransportPolicy=t)}sendStartMixTranscode(e){return this._signalChannel.sendWaitForResponse({command:N1,data:e,timeout:5e3,responseCommand:ze.START_MIX_TRANSCODE_RES,commandDesc:"startMixTranscode"})}sendStopMixTranscode(e){return this._signalChannel.sendWaitForResponse({command:P1,data:e,timeout:5e3,responseCommand:ze.STOP_MIX_TRANSCODE_RES,commandDesc:"stopMixTranscode"})}sendStartPublishCDN(e){let t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return this._signalChannel.sendWaitForResponse({command:t?D1:k1,data:e,timeout:5e3,responseCommand:t?ze.START_PUBLISH_TENCENT_CDN_RES:ze.START_PUBLISH_GIVEN_CDN_RES,commandDesc:"startPublishCDN"})}sendStopPublishCDN(e){let t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return this._signalChannel.sendWaitForResponse({command:t?O1:B1,data:e,timeout:5e3,responseCommand:t?ze.STOP_PUBLISH_TENCENT_CDN_RES:ze.STOP_PUBLISH_GIVEN_CDN_RES,commandDesc:"stopPublishCDN"})}sendAbilityStatus(e){var t;(t=this._signalChannel)==null||t.sendWaitForResponse({command:V1,data:e,timeout:5e3,responseCommand:ze.ABILITY_STATUS_REPORT_RESULT,commandDesc:"ability status report"}).catch(r=>{})}getIceServers(){return this._turnServers.length===0&&this.scheduleResult.iceServers?this.scheduleResult.iceServers:this._turnServers}getIceTransportPolicy(){return this._iceTransportPolicy||this.scheduleResult.iceTransportPolicy||"all"}getLogger(){return this._log}enableAIVoice(){throw new Error("Method not implemented.")}getSignalChannelUrl(){let e={mainUrl:"",backupUrl:""},t=cn.getEnv();return t?(e.mainUrl="wss://".concat(t,".rtc.qq.com"),e.backupUrl=e.mainUrl):this.proxy_ws?(e.mainUrl=this.proxy_ws,e.backupUrl=e.mainUrl):Array.isArray(this.scheduleResult.domains)&&this.scheduleResult.domains.length>0&&(e.mainUrl="wss://".concat(this.scheduleResult.domains[0]),e.backupUrl=e.mainUrl,this.scheduleResult.domains[1]&&(e.backupUrl="wss://".concat(this.scheduleResult.domains[1]))),e}getSignalInfo(){var e;return((e=this._signalChannel)==null?void 0:e.getSignalInfo())||{clientIp:"",relayIp:""}}reset(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.stopSyncUserListInterval(),this.stopHeartbeat(),this.closeConnections(),this.clearNetworkQuality(),this.closeUplink("you exitRoom"),this._signalChannel&&(e&&this._signalChannel.keepAlive&&this._signalChannel.isConnected?this._signalChannel.stopKeepAliveIn(3600):this._signalChannel.close(),this.setSignalChannel(null)),this._stats.reset(),this.userManager.clear(),this.userManager.removeAllListeners(),this.singlePC&&(this.singlePC.close(),this.singlePC=null),this.scheduleResult={domains:null,iceServers:null,iceTransportPolicy:null,trtcAutoConf:null}}checkSubscribeBigSmallVideo(e){return N(this,null,function*(){let{subscribeState:t,userId:r,muteState:{hasSmall:i,hasVideo:n}}=e;if(!i&&!n||!t.video&&!t.smallVideo)return;let a=this._changeBigSmallRecords.get(r);if(!a||a.isSubscribing||a.reSubscribeCount<=0)return;let{options:c,reSubscribeCount:A}=a;if(c.video&&t.video||c.smallVideo&&t.smallVideo&&i)return;let d={audio:e.remoteAudioTrack.isSubscribed||e.remoteAudioTrack.isSubscribing,auxiliary:e.remoteAuxiliaryTrack.isSubscribed||e.remoteAuxiliaryTrack.isSubscribing,video:c.video,smallVideo:c.smallVideo};try{if(!i&&d.smallVideo&&(d.video=!0,d.smallVideo=!1),d.smallVideo===t.smallVideo&&d.video===t.video)return;a.isSubscribing=!0,a.reSubscribeCount=A-1,yield e.subscribe(d,"main"),e.remoteVideoTrack.setMediaType(d.smallVideo?8:4),this._log.info("change [".concat(r,"] to ").concat(d.smallVideo?"small":"big"," video successfully. count ").concat(vd-a.reSubscribeCount,".")),a.isSubscribing=!1,a.reSubscribeCount=vd}catch{this._log.info("change [".concat(r,"] to ").concat(d.smallVideo?"small":"big"," video failed. count ").concat(vd-a.reSubscribeCount,".")),a.isSubscribing=!1,a.reSubscribeCount===0&&this._changeBigSmallRecords.delete(r)}})}changeType(e,t){let r={options:{video:!e,smallVideo:e},isSubscribing:!1,reSubscribeCount:vd};this._changeBigSmallRecords.set(t.userId,r),this._log.info("set [".concat(t.userId,"] video prefer type: ").concat(e?"small":"big"))}get smallStreamConfig(){return this._smallStreamConfig}_initBusinessInfo(e){this._businessInfo=e.businessInfo;let t={};if(lb(e.businessInfo)&&(t=JSON.parse(e.businessInfo)),!il(e.pureAudioPushMode)){if(!Number.isInteger(Number(e.pureAudioPushMode)))throw new pe({code:se.INVALID_PARAMETER,message:Ve({key:xe.INVALID_PURE_AUDIO})});this._pureAudioPushMode=e.pureAudioPushMode,t.Str_uc_params||(t.Str_uc_params={}),t.Str_uc_params.pure_audio_push_mod=this._pureAudioPushMode}if(!il(e.userDefineRecordId)){let r=/^[A-Za-z0-9_-]{1,64}$/gi;if(e.userDefineRecordId.match(r)===null)throw new pe({code:se.INVALID_PARAMETER,message:Ve({key:xe.INVALID_USER_DEFINE_RECORDID})});t.Str_uc_params||(t.Str_uc_params={}),t.Str_uc_params.userdefine_record_id=e.userDefineRecordId}if(!il(e.userDefinePushArgs)){if(!(lb(e.userDefinePushArgs)&&String(e.userDefinePushArgs)&&String(e.userDefinePushArgs).length<=256))throw new pe({code:se.INVALID_PARAMETER,message:Ve({key:xe.INVALID_USER_DEFINE_PUSH_ARGS})});t.Str_uc_params||(t.Str_uc_params={}),t.Str_uc_params.userdefine_push_args=e.userDefinePushArgs}pu(t)||(this._businessInfo=JSON.stringify(t))}sendSEI(e,t){var r,i;this.uplinkConnection instanceof pI&&(t!=null&&t.toSubStream?(r=this.uplinkConnection.localAuxVideoTrack)==null||r.sendSEI(e,t):(i=this.uplinkConnection.localMainVideoTrack)==null||i.sendSEI(e,t))}sendCustomMessage(e){var t;(t=this._customMessageManager)==null||t.send(e)}enableInsertableStreams(){if(this.singlePC&&!this.singlePC.enableInsertableStreams)return this.singlePC.enableInsertableStreams=!0,this.singlePC.startReconnection()}};return le([kR(["left",bt.INIT],"joined"),fa({settings:{retries:1,timeout:0},onError(e,t,r){this._isUsingCachedSchedule&&!this.isDestroyed?(this._log.warn("is using cached schedule, retry join"),zo(!0),this.reset(),t()):this._signalChannel&&this._signalChannel.isConnected&&this._signalChannel.keepAlive?(this._log.warn("is using keepAlive ws, retry join"),this._signalChannel.close(),this.reset(),t()):(this.reset(),this._log.error(e),r(e))}}),St(e=>{let t=new p1;return function(r,i,n){return N(this,null,function*(){let a=String(r.roomId||r.strRoomId);if(this.userId=r.userId,this.sdkAppId=r.sdkAppId,this.userSig=r.userSig,this._log.setSdkAppId(this.sdkAppId),this._log.setUserId(this.userId),this.scene=i,r.privateMapKey=r.privateMapKey||"",this.isJoined)throw new pe({code:se.INVALID_OPERATION,message:Ve({key:xe.INVALID_JOIN})});if(this.checkDestroy(),t.isJoined({userId:this.userId,roomId:a,sdkAppId:this.sdkAppId,room:this}))throw new pe({code:se.INVALID_OPERATION,message:Ve({key:xe.REPEAT_JOIN,data:this.userId})});t.add({room:this,roomId:a}),this.role=r.role===21?"audience":"anchor",this._log.info("Join() => joining room: ".concat(a," useStringRoomId: ").concat(this.useStringRoomId," scene: ").concat(this.scene," role: ").concat(this.role)),te.emit(X.JOIN_START,{room:this,roomId:a,params:r}),this.checkSystemResult=yield Yd.checkSystemRequirementsInternal(),this.checkDestroy();let c=cn.getEnv();c||(c=oa.QCLOUD,this.proxy_ws&&(this.proxy_ws.startsWith(ME.OLD_CLOUD_LADDER)?c=oa.OLD_CLOUD_LADDER:this.proxy_ws.startsWith(ME.WEBRTC)&&(c=oa.WEBRTC))),Lt.setConfig({env:c,sdkAppId:String(this.sdkAppId),userId:this.userId,roomId:a}),m1.call(this);let{isH264EncodeSupported:A,isVp8EncodeSupported:d}=this.checkSystemResult.detail;if(!Yd.isWebRTCSupported()||!A&&!d)throw new pe({code:se.NOT_SUPPORTED,message:Ve({key:xe.NOT_SUPPORTED_WEBRTC})});try{!this.proxy_ws&&!this.proxy_wt&&!this.scheduleResult.domains&&!cn.getEnv()&&(yield this.schedule(r,n));let g=yield e.call(this,r,i,n);return this.roomId=a,this._joinedTimestamp=cn.performanceNow(),te.emit(X.JOIN_SUCCESS,{room:this}),n===30&&!r.component&&Lt.uploadEvent({log:"stat-conv-".concat(Number(Fc),"-").concat(location.hostname),userId:this.userId}),g}catch(g){throw t.delete({room:this,roomId:a}),te.emit(X.JOIN_FAILED,{room:this,error:g}),g}})}})],ds.prototype,"join",1),le([kR("joined","left",{ignoreError:!0,success(){this.reset(!0)}}),St(e=>function(){return N(this,null,function*(){te.emit(X.LEAVE_START,{room:this}),yield e.call(this),te.emit(X.LEAVE_SUCCESS,{room:this,roomId:this.roomId})})}),cR("leave room"),Kh({fnName:"publish",validateArgs:!1}),Kh({fnName:"unsubscribe",validateArgs:!1})],ds.prototype,"leave",1),le([Kc(),St(e=>function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return N(this,null,function*(){if(this.scene==="live"&&this.role!=="anchor"||(r=r.filter(a=>a.outMediaTrack&&a.state==="capture"),!r.length))return;te.emit("61",{room:this});let n=e.apply(this,r);return r.forEach(a=>a.publish(this,n)),n})}),fa({settings:{retries:Lc,timeout:e=>jc(e)},onError(e,t,r){var i;(i=e.message)!=null&&i.includes("timeout")?(this._log.warn("publish timeout"),t()):(this._log.error("publish failed: ".concat(e)),r(e),te.emit(X.PUBLISH_FAILED,{room:this}))}})],ds.prototype,"publish",1),le([Kh({fnName:"publish"}),(cb="api-call",function(e,t,r){let i=r.value;return r.value=function(){for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];let A=eu.get(this);if(A){let d=A.queue.filter((g,E)=>{if(E===0)return!0;let f=!0;return g.args.forEach(b=>{a.find(w=>w===b)||(f=!1)}),!f||(g.reject(new pe({code:se.API_CALL_ABORTED,message:cb})),!1)});A.queue=d}return i.apply(this,a)},r}),Kc(),St(e=>function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];let n=e.apply(this,r);return r.forEach(a=>a.unpublish()),n}),X_(function(){var e,t;!this.uplinkConnection&&Jd()&&((t=(e=this.singlePC)==null?void 0:e.getPeerConnection())==null||t.getSenders().forEach(r=>r.track&&r.replaceTrack(null)))})],ds.prototype,"unpublish",1),le([Xc(e=>e.userId)],ds.prototype,"replaceTrack",1),le([Xc(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t[0].userId}),AR(),St(e=>function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];let n=e.apply(this,r);return r.forEach(a=>!a.isSubscribed&&a.subscribe(n)),n}),fa({settings:{retries:Lc,timeout:e=>jc(e)},onError(e,t,r,i){e.message.includes("timeout")?(this._log.warn("subscribe timeout"),t()):(this._log.error("subscribe failed: ".concat(e)),r(e),te.emit(X.SUBSCRIBE_FAILED,{room:this,remoteTracks:i}))}})],ds.prototype,"subscribe",1),le([Kh({fnName:"subscribe",callback(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.singlePC||t.forEach(i=>{let n=this.remotePublishedUserMap.get(i.userId);n&&!n.isMainStreamSubscribed&&!n.isAuxStreamSubscribed&&n.close("you unsubscribed")})}}),Xc(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t[0].userId})],ds.prototype,"unsubscribe",1),ug.create=ug._create.bind(ug,ds),ug})}(fI)),fI.exports}var Rx=Object.defineProperty,bx=Object.defineProperties,wx=Object.getOwnPropertyDescriptors,pb=Object.getOwnPropertySymbols,Dx=Object.prototype.hasOwnProperty,Ox=Object.prototype.propertyIsEnumerable,EI=(ge,de,u)=>de in ge?Rx(ge,de,{enumerable:!0,configurable:!0,writable:!0,value:u}):ge[de]=u,kx=(ge,de)=>{for(var u in de||(de={}))Dx.call(de,u)&&EI(ge,u,de[u]);if(pb)for(var u of pb(de))Ox.call(de,u)&&EI(ge,u,de[u]);return ge},Bx=(ge,de)=>bx(ge,wx(de)),Nx=(ge=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(ge,{get:(de,u)=>(typeof require<"u"?require:de)[u]}):ge)(function(ge){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+ge+'" is not supported')}),_r=(ge,de,u)=>(EI(ge,typeof de!="symbol"?de+"":de,u),u);async function Px({sdkAppId:ge,userId:de,userSig:u,core:Z}){var we;let _t=Z.utils.getAbilityConfigUrl(ge),It=Math.round(new Date().getTime()/1e3),Ht=`${_t}?sdkAppId=${ge}&userId=${de}&userSig=${u}&timestamp=${It}`;try{let dt=await(await fetch(Ht)).json();Z.log.info(`virtual background send ${Ht}, response: ${JSON.stringify(dt)}`);let{data:ir}=dt;return(we=ir==null?void 0:ir.trtcAutoConf)!=null&&we.web_ar?{auth:!0,timestamp:It}:{auth:!1}}catch(dt){return Z.log.error("beauty fetch error",dt),{auth:!1}}}var Mx={sdkAppId:{required:!0,type:"number"},userId:{required:!0,type:"string"},userSig:{required:!0,type:"string"}};function Lx(ge){return{name:"VirtualBackgroundOptions",type:"object",required:!0,allowEmpty:!1,properties:Bx(kx({},Mx),{type:{required:!1,type:"string",values:["image","blur"]},src:{required:!1,type:"string"},blurLevel:{required:!1,type:"number",min:1,max:10},onError:{required:!1}}),validate(de,u,Z,we){var _t;let{RtcError:It,ErrorCode:Ht,ErrorCodeDictionary:dt}=ge.errorModule;if(!de)return;let{type:ir,src:Oe,onError:Ur}=de;if(ir==="image"&&!Oe)throw new It({code:Ht.INVALID_PARAMETER,extraCode:dt.INVALID_PARAMETER_REQUIRED,fnName:Z,messageParams:{key:"src"}});if(Ur&&!ge.utils.isFunction(Ur))throw new It({code:Ht.INVALID_PARAMETER,extraCode:dt.INVALID_PARAMETER_TYPE,fnName:Z,messageParams:{key:"onError",value:typeof Ur,rule:{type:"Function"}}});if(!((_t=ge.room.videoManager.cameraTrack)!=null&&_t.mediaTrack))throw new It({code:Ht.INVALID_OPERATION,extraCode:dt.INVALID_OPERATION_NEED_VIDEO,fnName:Z});if(ge.environment.CHROME_MAJOR_VERSION<90)throw new It({code:Ht.ENV_NOT_SUPPORTED,extraCode:dt.NOT_SUPPORTED_CHROME_VERSION,fnName:Z})}}}function Qx(ge){return{name:"UpdateVirtualBackgroundOptions",type:"object",required:!0,allowEmpty:!1,properties:{type:{required:!0,type:"string",values:["image","blur"]},src:{required:!1,type:"string"},blurLevel:{required:!1,type:"number",min:1,max:10}},validate(de,u,Z,we){if(!de)return;let{RtcError:_t,ErrorCode:It,ErrorCodeDictionary:Ht}=ge.errorModule,{type:dt,src:ir}=de;if(dt==="image"&&!ir)throw new _t({code:It.INVALID_PARAMETER,extraCode:Ht.INVALID_PARAMETER_REQUIRED,fnName:Z,messageParams:{key:"src"}})}}}function xx(ge){return{name:"StopVirtualBackgroundOptions",required:!1}}var Ux=function(){let ge=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(ge=ge||__filename),function(de){de=de||{};let u=typeof de<"u"?de:{},Z,we;u.ready=new Promise((o,s)=>{Z=o,we=s}),Object.getOwnPropertyDescriptor(u.ready,"_main")||(Object.defineProperty(u.ready,"_main",{configurable:!0,get(){y("You are getting _main on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"_main",{configurable:!0,set(){y("You are setting _main on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"_emscripten_stack_get_end")||(Object.defineProperty(u.ready,"_emscripten_stack_get_end",{configurable:!0,get(){y("You are getting _emscripten_stack_get_end on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"_emscripten_stack_get_end",{configurable:!0,set(){y("You are setting _emscripten_stack_get_end on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"_emscripten_stack_get_free")||(Object.defineProperty(u.ready,"_emscripten_stack_get_free",{configurable:!0,get(){y("You are getting _emscripten_stack_get_free on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"_emscripten_stack_get_free",{configurable:!0,set(){y("You are setting _emscripten_stack_get_free on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"_emscripten_stack_init")||(Object.defineProperty(u.ready,"_emscripten_stack_init",{configurable:!0,get(){y("You are getting _emscripten_stack_init on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"_emscripten_stack_init",{configurable:!0,set(){y("You are setting _emscripten_stack_init on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"_stackSave")||(Object.defineProperty(u.ready,"_stackSave",{configurable:!0,get(){y("You are getting _stackSave on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"_stackSave",{configurable:!0,set(){y("You are setting _stackSave on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"_stackRestore")||(Object.defineProperty(u.ready,"_stackRestore",{configurable:!0,get(){y("You are getting _stackRestore on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"_stackRestore",{configurable:!0,set(){y("You are setting _stackRestore on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"_stackAlloc")||(Object.defineProperty(u.ready,"_stackAlloc",{configurable:!0,get(){y("You are getting _stackAlloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"_stackAlloc",{configurable:!0,set(){y("You are setting _stackAlloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"___wasm_call_ctors")||(Object.defineProperty(u.ready,"___wasm_call_ctors",{configurable:!0,get(){y("You are getting ___wasm_call_ctors on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"___wasm_call_ctors",{configurable:!0,set(){y("You are setting ___wasm_call_ctors on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"_fflush")||(Object.defineProperty(u.ready,"_fflush",{configurable:!0,get(){y("You are getting _fflush on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"_fflush",{configurable:!0,set(){y("You are setting _fflush on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"___errno_location")||(Object.defineProperty(u.ready,"___errno_location",{configurable:!0,get(){y("You are getting ___errno_location on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"___errno_location",{configurable:!0,set(){y("You are setting ___errno_location on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"_malloc")||(Object.defineProperty(u.ready,"_malloc",{configurable:!0,get(){y("You are getting _malloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"_malloc",{configurable:!0,set(){y("You are setting _malloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"_free")||(Object.defineProperty(u.ready,"_free",{configurable:!0,get(){y("You are getting _free on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"_free",{configurable:!0,set(){y("You are setting _free on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"_setThrew")||(Object.defineProperty(u.ready,"_setThrew",{configurable:!0,get(){y("You are getting _setThrew on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"_setThrew",{configurable:!0,set(){y("You are setting _setThrew on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"___cxa_is_pointer_type")||(Object.defineProperty(u.ready,"___cxa_is_pointer_type",{configurable:!0,get(){y("You are getting ___cxa_is_pointer_type on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"___cxa_is_pointer_type",{configurable:!0,set(){y("You are setting ___cxa_is_pointer_type on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"___cxa_can_catch")||(Object.defineProperty(u.ready,"___cxa_can_catch",{configurable:!0,get(){y("You are getting ___cxa_can_catch on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"___cxa_can_catch",{configurable:!0,set(){y("You are setting ___cxa_can_catch on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"_saveSetjmp")||(Object.defineProperty(u.ready,"_saveSetjmp",{configurable:!0,get(){y("You are getting _saveSetjmp on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"_saveSetjmp",{configurable:!0,set(){y("You are setting _saveSetjmp on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"_memalign")||(Object.defineProperty(u.ready,"_memalign",{configurable:!0,get(){y("You are getting _memalign on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"_memalign",{configurable:!0,set(){y("You are setting _memalign on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"_emscripten_main_thread_process_queued_calls")||(Object.defineProperty(u.ready,"_emscripten_main_thread_process_queued_calls",{configurable:!0,get(){y("You are getting _emscripten_main_thread_process_queued_calls on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"_emscripten_main_thread_process_queued_calls",{configurable:!0,set(){y("You are setting _emscripten_main_thread_process_queued_calls on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"_emscripten_webgl_make_context_current")||(Object.defineProperty(u.ready,"_emscripten_webgl_make_context_current",{configurable:!0,get(){y("You are getting _emscripten_webgl_make_context_current on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"_emscripten_webgl_make_context_current",{configurable:!0,set(){y("You are setting _emscripten_webgl_make_context_current on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"_emscripten_webgl_get_current_context")||(Object.defineProperty(u.ready,"_emscripten_webgl_get_current_context",{configurable:!0,get(){y("You are getting _emscripten_webgl_get_current_context on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"_emscripten_webgl_get_current_context",{configurable:!0,set(){y("You are setting _emscripten_webgl_get_current_context on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"__get_tzname")||(Object.defineProperty(u.ready,"__get_tzname",{configurable:!0,get(){y("You are getting __get_tzname on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"__get_tzname",{configurable:!0,set(){y("You are setting __get_tzname on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"__get_daylight")||(Object.defineProperty(u.ready,"__get_daylight",{configurable:!0,get(){y("You are getting __get_daylight on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"__get_daylight",{configurable:!0,set(){y("You are setting __get_daylight on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"__get_timezone")||(Object.defineProperty(u.ready,"__get_timezone",{configurable:!0,get(){y("You are getting __get_timezone on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"__get_timezone",{configurable:!0,set(){y("You are setting __get_timezone on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"_emscripten_builtin_malloc")||(Object.defineProperty(u.ready,"_emscripten_builtin_malloc",{configurable:!0,get(){y("You are getting _emscripten_builtin_malloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"_emscripten_builtin_malloc",{configurable:!0,set(){y("You are setting _emscripten_builtin_malloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"_emscripten_builtin_free")||(Object.defineProperty(u.ready,"_emscripten_builtin_free",{configurable:!0,get(){y("You are getting _emscripten_builtin_free on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"_emscripten_builtin_free",{configurable:!0,set(){y("You are setting _emscripten_builtin_free on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"_emscripten_builtin_memalign")||(Object.defineProperty(u.ready,"_emscripten_builtin_memalign",{configurable:!0,get(){y("You are getting _emscripten_builtin_memalign on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"_emscripten_builtin_memalign",{configurable:!0,set(){y("You are setting _emscripten_builtin_memalign on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"___getTypeName")||(Object.defineProperty(u.ready,"___getTypeName",{configurable:!0,get(){y("You are getting ___getTypeName on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"___getTypeName",{configurable:!0,set(){y("You are setting ___getTypeName on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"___embind_register_native_and_builtin_types")||(Object.defineProperty(u.ready,"___embind_register_native_and_builtin_types",{configurable:!0,get(){y("You are getting ___embind_register_native_and_builtin_types on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"___embind_register_native_and_builtin_types",{configurable:!0,set(){y("You are setting ___embind_register_native_and_builtin_types on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(u.ready,"onRuntimeInitialized")||(Object.defineProperty(u.ready,"onRuntimeInitialized",{configurable:!0,get(){y("You are getting onRuntimeInitialized on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(u.ready,"onRuntimeInitialized",{configurable:!0,set(){y("You are setting onRuntimeInitialized on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}));let _t={},It;for(It in u)u.hasOwnProperty(It)&&(_t[It]=u[It]);let Ht="./this.program",dt=function(o,s){throw s},ir=typeof window=="object",Oe=typeof importScripts=="function",Ur=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",nl=!ir&&!Ur&&!Oe;if(u.ENVIRONMENT)throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -s ENVIRONMENT=web or -s ENVIRONMENT=node)");let Ir="";function ii(o){return u.locateFile?u.locateFile(o,Ir):Ir+o}let Fr,Gt,vi;if(ir||Oe){if(Oe?Ir=self.location.href:typeof document<"u"&&document.currentScript&&(Ir=document.currentScript.src),ge&&(Ir=ge),Ir.indexOf("blob:")!==0?Ir=Ir.substr(0,Ir.lastIndexOf("/")+1):Ir="",!(typeof window=="object"||typeof importScripts=="function"))throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");Fr=function(o){let s=new XMLHttpRequest;return s.open("GET",o,!1),s.send(null),s.responseText},Gt=function(o,s,l){let h=new XMLHttpRequest;h.open("GET",o,!0),h.responseType="arraybuffer",h.onload=function(){if(h.status==200||h.status==0&&h.response){s(h.response);return}l()},h.onerror=l,h.send(null)}}else throw new Error("environment detection error");let xt=u.print||console.log.bind(console),Pe=u.printErr||console.warn.bind(console);for(It in _t)_t.hasOwnProperty(It)&&(u[It]=_t[It]);_t=null,u.arguments&&u.arguments,Object.getOwnPropertyDescriptor(u,"arguments")||Object.defineProperty(u,"arguments",{configurable:!0,get(){y("Module.arguments has been replaced with plain arguments_ (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),u.thisProgram&&(Ht=u.thisProgram),Object.getOwnPropertyDescriptor(u,"thisProgram")||Object.defineProperty(u,"thisProgram",{configurable:!0,get(){y("Module.thisProgram has been replaced with plain thisProgram (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),u.quit&&(dt=u.quit),Object.getOwnPropertyDescriptor(u,"quit")||Object.defineProperty(u,"quit",{configurable:!0,get(){y("Module.quit has been replaced with plain quit_ (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),q(typeof u.memoryInitializerPrefixURL>"u","Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead"),q(typeof u.pthreadMainPrefixURL>"u","Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead"),q(typeof u.cdInitializerPrefixURL>"u","Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead"),q(typeof u.filePackagePrefixURL>"u","Module.filePackagePrefixURL option was removed, use Module.locateFile instead"),q(typeof u.read>"u","Module.read option was removed (modify read_ in JS)"),q(typeof u.readAsync>"u","Module.readAsync option was removed (modify readAsync in JS)"),q(typeof u.readBinary>"u","Module.readBinary option was removed (modify readBinary in JS)"),q(typeof u.setWindowTitle>"u","Module.setWindowTitle option was removed (modify setWindowTitle in JS)"),q(typeof u.TOTAL_MEMORY>"u","Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY"),Object.getOwnPropertyDescriptor(u,"read")||Object.defineProperty(u,"read",{configurable:!0,get(){y("Module.read has been replaced with plain read_ (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),Object.getOwnPropertyDescriptor(u,"readAsync")||Object.defineProperty(u,"readAsync",{configurable:!0,get(){y("Module.readAsync has been replaced with plain readAsync (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),Object.getOwnPropertyDescriptor(u,"readBinary")||Object.defineProperty(u,"readBinary",{configurable:!0,get(){y("Module.readBinary has been replaced with plain readBinary (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),Object.getOwnPropertyDescriptor(u,"setWindowTitle")||Object.defineProperty(u,"setWindowTitle",{configurable:!0,get(){y("Module.setWindowTitle has been replaced with plain setWindowTitle (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),q(!nl,"shell environment detected but not enabled at build time.  Add 'shell' to `-s ENVIRONMENT` to enable.");function Ge(o){Ge.shown||(Ge.shown={}),Ge.shown[o]||(Ge.shown[o]=1,Pe(o))}let As=0,Dr=function(o){As=o},ni=function(){return As};u.wasmBinary&&u.wasmBinary,Object.getOwnPropertyDescriptor(u,"wasmBinary")||Object.defineProperty(u,"wasmBinary",{configurable:!0,get(){y("Module.wasmBinary has been replaced with plain wasmBinary (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}});let wa=u.noExitRuntime||!0;Object.getOwnPropertyDescriptor(u,"noExitRuntime")||Object.defineProperty(u,"noExitRuntime",{configurable:!0,get(){y("Module.noExitRuntime has been replaced with plain noExitRuntime (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),typeof WebAssembly!="object"&&y("no native wasm support detected");let Hi,nr=!1,Ri;function q(o,s){o||y(`Assertion failed: ${s}`)}let Gi=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Yi(o,s,l){let h=s+l,p=s;for(;o[p]&&!(p>=h);)++p;if(p-s>16&&o.subarray&&Gi)return Gi.decode(o.subarray(s,p));let m="";for(;s<p;){let _=o[s++];if(!(_&128)){m+=String.fromCharCode(_);continue}let C=o[s++]&63;if((_&224)==192){m+=String.fromCharCode((_&31)<<6|C);continue}let R=o[s++]&63;if((_&240)==224?_=(_&15)<<12|C<<6|R:((_&248)!=240&&Ge(`Invalid UTF-8 leading byte 0x${_.toString(16)} encountered when deserializing a UTF-8 string in wasm memory to a JS string!`),_=(_&7)<<18|C<<12|R<<6|o[s++]&63),_<65536)m+=String.fromCharCode(_);else{let D=_-65536;m+=String.fromCharCode(55296|D>>10,56320|D&1023)}}return m}function ur(o,s){return o?Yi(pt,o,s):""}function to(o,s,l,h){if(!(h>0))return 0;let p=l,m=l+h-1;for(let _=0;_<o.length;++_){let C=o.charCodeAt(_);if(C>=55296&&C<=57343){let R=o.charCodeAt(++_);C=65536+((C&1023)<<10)|R&1023}if(C<=127){if(l>=m)break;s[l++]=C}else if(C<=2047){if(l+1>=m)break;s[l++]=192|C>>6,s[l++]=128|C&63}else if(C<=65535){if(l+2>=m)break;s[l++]=224|C>>12,s[l++]=128|C>>6&63,s[l++]=128|C&63}else{if(l+3>=m)break;C>=2097152&&Ge(`Invalid Unicode code point 0x${C.toString(16)} encountered when serializing a JS string to a UTF-8 string in wasm memory! (Valid unicode code points should be in range 0-0x1FFFFF).`),s[l++]=240|C>>18,s[l++]=128|C>>12&63,s[l++]=128|C>>6&63,s[l++]=128|C&63}}return s[l]=0,l-p}function Cr(o,s,l){return q(typeof l=="number","stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),to(o,pt,s,l)}function Or(o){let s=0;for(let l=0;l<o.length;++l){let h=o.charCodeAt(l);h>=55296&&h<=57343&&(h=65536+((h&1023)<<10)|o.charCodeAt(++l)&1023),h<=127?++s:h<=2047?s+=2:h<=65535?s+=3:s+=4}return s}let hs=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function gs(o,s){q(o%2==0,"Pointer passed to UTF16ToString must be aligned to two bytes!");let l=o,h=l>>1,p=h+s/2;for(;!(h>=p)&&si[h];)++h;if(l=h<<1,l-o>32&&hs)return hs.decode(pt.subarray(o,l));let m="";for(let _=0;!(_>=s/2);++_){let C=oi[o+_*2>>1];if(C==0)break;m+=String.fromCharCode(C)}return m}function ro(o,s,l){if(q(s%2==0,"Pointer passed to stringToUTF16 must be aligned to two bytes!"),q(typeof l=="number","stringToUTF16(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),l===void 0&&(l=2147483647),l<2)return 0;l-=2;let h=s,p=l<o.length*2?l/2:o.length;for(let m=0;m<p;++m){let _=o.charCodeAt(m);oi[s>>1]=_,s+=2}return oi[s>>1]=0,s-h}function Vr(o){return o.length*2}function io(o,s){q(o%4==0,"Pointer passed to UTF32ToString must be aligned to four bytes!");let l=0,h="";for(;!(l>=s/4);){let p=M[o+l*4>>2];if(p==0)break;if(++l,p>=65536){let m=p-65536;h+=String.fromCharCode(55296|m>>10,56320|m&1023)}else h+=String.fromCharCode(p)}return h}function ol(o,s,l){if(q(s%4==0,"Pointer passed to stringToUTF32 must be aligned to four bytes!"),q(typeof l=="number","stringToUTF32(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),l===void 0&&(l=2147483647),l<4)return 0;let h=s,p=h+l-4;for(let m=0;m<o.length;++m){let _=o.charCodeAt(m);if(_>=55296&&_<=57343){let C=o.charCodeAt(++m);_=65536+((_&1023)<<10)|C&1023}if(M[s>>2]=_,s+=4,s+4>p)break}return M[s>>2]=0,s-h}function no(o){let s=0;for(let l=0;l<o.length;++l){let h=o.charCodeAt(l);h>=55296&&h<=57343&&++l,s+=4}return s}function or(o){let s=Or(o)+1,l=Nn(s);return l&&to(o,ft,l,s),l}function sl(o,s){q(o.length>=0,"writeArrayToMemory array must have a length (should be an array or typed array)"),ft.set(o,s)}function al(o,s,l){for(let h=0;h<o.length;++h)q(o.charCodeAt(h)===o.charCodeAt(h)&255),ft[s++>>0]=o.charCodeAt(h);l||(ft[s>>0]=0)}function Bt(o,s){return o%s>0&&(o+=s-o%s),o}let En,ft,pt,oi,si,M,ct,wt,oo;function so(o){En=o,u.HEAP8=ft=new Int8Array(o),u.HEAP16=oi=new Int16Array(o),u.HEAP32=M=new Int32Array(o),u.HEAPU8=pt=new Uint8Array(o),u.HEAPU16=si=new Uint16Array(o),u.HEAPU32=ct=new Uint32Array(o),u.HEAPF32=wt=new Float32Array(o),u.HEAPF64=oo=new Float64Array(o)}let Ut=5242880;u.TOTAL_STACK&&q(Ut===u.TOTAL_STACK,"the stack size can no longer be determined at runtime");let jr=u.INITIAL_MEMORY||16777216;Object.getOwnPropertyDescriptor(u,"INITIAL_MEMORY")||Object.defineProperty(u,"INITIAL_MEMORY",{configurable:!0,get(){y("Module.INITIAL_MEMORY has been replaced with plain INITIAL_MEMORY (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}}),q(jr>=Ut,`INITIAL_MEMORY should be larger than TOTAL_STACK, was ${jr}! (TOTAL_STACK=${Ut})`),q(typeof Int32Array<"u"&&typeof Float64Array<"u"&&Int32Array.prototype.subarray!==void 0&&Int32Array.prototype.set!==void 0,"JS engine does not provide full typed array support"),q(!u.wasmMemory,"Use of `wasmMemory` detected.  Use -s IMPORTED_MEMORY to define wasmMemory externally"),q(jr==16777216,"Detected runtime INITIAL_MEMORY setting.  Use -s IMPORTED_MEMORY to define wasmMemory dynamically");let ce;function Wi(){let o=jl();q((o&3)==0),ct[(o>>2)+1]=34821223,ct[(o>>2)+2]=2310721022,M[0]=1668509029}function yr(){if(nr)return;let o=jl(),s=ct[(o>>2)+1],l=ct[(o>>2)+2];(s!=34821223||l!=2310721022)&&y(`Stack overflow! Stack cookie has been overwritten, expected hex dwords 0x89BACDFE and 0x2135467, but received 0x${l.toString(16)} ${s.toString(16)}`),M[0]!==1668509029&&y("Runtime error: The application has corrupted its heap memory area (address zero)!")}(function(){let o=new Int16Array(1),s=new Int8Array(o.buffer);if(o[0]=25459,s[0]!==115||s[1]!==99)throw"Runtime error: expected the system to be little-endian! (Run with -s SUPPORT_BIG_ENDIAN=1 to bypass)"})();let Fe=[],ao=[],_n=[],kr=!1,Da=!1,Hr=0;function Br(){return wa||Hr>0}function Ji(){if(u.preRun)for(typeof u.preRun=="function"&&(u.preRun=[u.preRun]);u.preRun.length;)co(u.preRun.shift());_s(Fe)}function ps(){yr(),q(!kr),kr=!0,!u.noFSInit&&!I.init.initialized&&I.init(),I.ignorePermissions=!1,_s(ao)}function ms(){yr(),Da=!0}function lt(){if(yr(),u.postRun)for(typeof u.postRun=="function"&&(u.postRun=[u.postRun]);u.postRun.length;)Oa(u.postRun.shift());_s(_n)}function co(o){Fe.unshift(o)}function lo(o){ao.unshift(o)}function Oa(o){_n.unshift(o)}q(Math.imul,"This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),q(Math.fround,"This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),q(Math.clz32,"This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),q(Math.trunc,"This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");let Je=0,Gr=null,In=null,Ct={};function Ki(o){let s=o;for(;;){if(!Ct[o])return o;o=s+Math.random()}}function Xi(o){Je++,u.monitorRunDependencies&&u.monitorRunDependencies(Je),o?(q(!Ct[o]),Ct[o]=1,Gr===null&&typeof setInterval<"u"&&(Gr=setInterval(()=>{if(nr){clearInterval(Gr),Gr=null;return}let s=!1;for(let l in Ct)s||(s=!0,Pe("still waiting on run dependencies:")),Pe(`dependency: ${l}`);s&&Pe("(end of list)")},1e4))):Pe("warning: run dependency added without ID")}function Yr(o){if(Je--,u.monitorRunDependencies&&u.monitorRunDependencies(Je),o?(q(Ct[o]),delete Ct[o]):Pe("warning: run dependency removed without ID"),Je==0&&(Gr!==null&&(clearInterval(Gr),Gr=null),In)){let s=In;In=null,s()}}u.preloadedImages={},u.preloadedAudios={};function y(o){u.onAbort&&u.onAbort(o),o+="",Pe(o),nr=!0,Ri=1,o=`abort(${o}) at ${Is()}`;let s=new WebAssembly.RuntimeError(o);throw we(s),s}let ka="data:application/octet-stream;base64,";function At(o){return o.startsWith(ka)}function Me(o,s){return function(){let l=o,h=s;return s||(h=u.asm),q(kr,`native function \`${l}\` called before runtime initialization`),q(!Da,`native function \`${l}\` called after runtime exit (use NO_EXIT_RUNTIME to keep it alive after main() exits)`),h[o]||q(h[o],`exported native function \`${l}\` not found`),h[o].apply(null,arguments)}}let Ft;Ft="selfie_segmentation_solution_simd_wasm_bin.wasm",At(Ft)||(Ft=ii(Ft));function Cn(){let o={env:Vs,wasi_snapshot_preview1:Vs};function s(p,m){let{exports:_}=p;u.asm=_,Hi=u.asm.memory,q(Hi,"memory not found in wasm exports"),so(Hi.buffer),ce=u.asm.__indirect_function_table,q(ce,"table not found in wasm exports"),lo(u.asm.__wasm_call_ctors),Yr("wasm-instantiate")}Xi("wasm-instantiate");let l=u;function h(p){q(u===l,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?"),l=null,s(p)}if(u.instantiateWasm)try{return u.instantiateWasm(o,s)}catch(p){return Pe(`Module.instantiateWasm callback failed with error: ${p}`),!1}return u.loadWasm(Ft,o).then(h).catch(we),{}}let yt,sr,yn={460656(){let o=!0;if(o){let s=kl;if(typeof s!="function"){typeof console<"u"&&console.error('Expected Emscripten global function "findCanvasEventTarget" not found. WebGL context creation may fail.');return}kl=function(l){if(l==0){if(u&&u.canvas)return u.canvas;if(u&&u.canvasCssSelector)return s(u.canvasCssSelector);typeof console<"u"&&console.warn("Module properties canvas and canvasCssSelector not found during WebGL context creation.")}return s(l)},o=!1}},461441(){return typeof wasmOffsetConverter<"u"}};function uo(){return typeof wasmOffsetConverter<"u"}function bi(o,s){if(j.mainLoop.timingMode=o,j.mainLoop.timingValue=s,!j.mainLoop.func)return Pe("emscripten_set_main_loop_timing: Cannot set timing mode for main loop since a main loop does not exist! Call emscripten_set_main_loop first to set one up."),1;if(j.mainLoop.running||(j.mainLoop.running=!0),o==0)j.mainLoop.scheduler=function(){let l=Math.max(0,j.mainLoop.tickStartTime+s-ai())|0;setTimeout(j.mainLoop.runner,l)},j.mainLoop.method="timeout";else if(o==1)j.mainLoop.scheduler=function(){j.requestAnimationFrame(j.mainLoop.runner)},j.mainLoop.method="rAF";else if(o==2){if(typeof setImmediate>"u"){let l=[],h="setimmediate",p=function(m){(m.data===h||m.data.target===h)&&(m.stopPropagation(),l.shift()())};addEventListener("message",p,!0),setImmediate=function(m){l.push(m),Oe?(u.setImmediates===void 0&&(u.setImmediates=[]),u.setImmediates.push(m),postMessage({target:h})):postMessage(h,"*")}}j.mainLoop.scheduler=function(){setImmediate(j.mainLoop.runner)},j.mainLoop.method="immediate"}return 0}let ai;Ur?ai=function(){let o=process.hrtime();return o[0]*1e3+o[1]/1e6}:ai=function(){return performance.now()};function Tn(o){_A(o)}function ht(){if(!Br())try{Tn(Ri)}catch(o){if(o instanceof cc)return;throw o}}function fs(o,s,l,h,p){q(!j.mainLoop.func,"emscripten_set_main_loop: there can only be one main loop function at once: call emscripten_cancel_main_loop to cancel the previous one before setting a new one with different parameters."),j.mainLoop.func=o,j.mainLoop.arg=h;let m=j.mainLoop.currentlyRunningMainloop;function _(){return m<j.mainLoop.currentlyRunningMainloop?(ht(),!1):!0}if(j.mainLoop.running=!1,j.mainLoop.runner=function(){if(!nr){if(j.mainLoop.queue.length>0){let C=Date.now(),R=j.mainLoop.queue.shift();if(R.func(R.arg),j.mainLoop.remainingBlockers){let D=j.mainLoop.remainingBlockers,P=D%1==0?D-1:Math.floor(D);R.counted?j.mainLoop.remainingBlockers=P:(P=P+.5,j.mainLoop.remainingBlockers=(8*D+P)/9)}if(xt(`main loop blocker "${R.name}" took ${Date.now()-C} ms`),j.mainLoop.updateStatus(),!_())return;setTimeout(j.mainLoop.runner,0);return}if(_()){if(j.mainLoop.currentFrameNumber=j.mainLoop.currentFrameNumber+1|0,j.mainLoop.timingMode==1&&j.mainLoop.timingValue>1&&j.mainLoop.currentFrameNumber%j.mainLoop.timingValue!=0){j.mainLoop.scheduler();return}j.mainLoop.timingMode==0&&(j.mainLoop.tickStartTime=ai()),Q.newRenderingFrameStarted(),typeof Q<"u"&&Q.currentContext&&!Q.currentContextIsProxied&&!Q.currentContext.attributes.explicitSwapControl&&Q.currentContext.GLctx.commit&&Q.currentContext.GLctx.commit(),j.mainLoop.method==="timeout"&&u.ctx&&(Ge("Looks like you are rendering without using requestAnimationFrame for the main loop. You should use 0 for the frame rate in emscripten_set_main_loop in order to use requestAnimationFrame, as that can greatly improve your frame rates!"),j.mainLoop.method=""),j.mainLoop.runIter(o),yr(),_()&&(typeof SDL=="object"&&SDL.audio&&SDL.audio.queueNewAudioData&&SDL.audio.queueNewAudioData(),j.mainLoop.scheduler())}}},p||(s&&s>0?bi(0,1e3/s):bi(1,1),j.mainLoop.scheduler()),l)throw"unwind"}function Es(o,s){if(nr){Pe("user callback triggered after application aborted.  Ignoring.");return}if(s){o();return}try{o()}catch(l){if(l instanceof cc)return;if(l!=="unwind")throw l&&typeof l=="object"&&l.stack&&Pe(`exception thrown: ${[l,l.stack]}`),l}}function Wr(o,s){return setTimeout(()=>{Es(o)},s)}var j={mainLoop:{running:!1,scheduler:null,method:"",currentlyRunningMainloop:0,func:null,arg:0,timingMode:0,timingValue:0,currentFrameNumber:0,queue:[],pause(){j.mainLoop.scheduler=null,j.mainLoop.currentlyRunningMainloop++},resume(){j.mainLoop.currentlyRunningMainloop++;let{timingMode:o}=j.mainLoop,{timingValue:s}=j.mainLoop,{func:l}=j.mainLoop;j.mainLoop.func=null,fs(l,0,!1,j.mainLoop.arg,!0),bi(o,s),j.mainLoop.scheduler()},updateStatus(){if(u.setStatus){let o=u.statusMessage||"Please wait...",s=j.mainLoop.remainingBlockers,l=j.mainLoop.expectedBlockers;s?s<l?u.setStatus(`${o} (${l-s}/${l})`):u.setStatus(o):u.setStatus("")}},runIter(o){nr||u.preMainLoop&&u.preMainLoop()===!1||(Es(o),u.postMainLoop&&u.postMainLoop())}},isFullscreen:!1,pointerLock:!1,moduleContextCreatedCallbacks:[],workers:[],init(){if(u.preloadPlugins||(u.preloadPlugins=[]),j.initted)return;j.initted=!0;try{new Blob,j.hasBlobConstructor=!0}catch{j.hasBlobConstructor=!1,xt("warning: no blob constructor, cannot create blobs with mimetypes")}j.BlobBuilder=typeof MozBlobBuilder<"u"?MozBlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:j.hasBlobConstructor?null:xt("warning: no BlobBuilder"),j.URLObject=typeof window<"u"?window.URL?window.URL:window.webkitURL:void 0,!u.noImageDecoding&&typeof j.URLObject>"u"&&(xt("warning: Browser does not support creating object URLs. Built-in browser image decoding will not be available."),u.noImageDecoding=!0);let o={};o.canHandle=function(l){return!u.noImageDecoding&&/\.(jpg|jpeg|png|bmp)$/i.test(l)},o.handle=function(l,h,p,m){let _=null;if(j.hasBlobConstructor)try{_=new Blob([l],{type:j.getMimetype(h)}),_.size!==l.length&&(_=new Blob([new Uint8Array(l).buffer],{type:j.getMimetype(h)}))}catch(D){Ge(`Blob constructor present but fails: ${D}; falling back to blob builder`)}if(!_){let D=new j.BlobBuilder;D.append(new Uint8Array(l).buffer),_=D.getBlob()}let C=j.URLObject.createObjectURL(_);q(typeof C=="string","createObjectURL must return a url as a string");let R=new Image;R.onload=function(){q(R.complete,`Image ${h} could not be decoded`);let D=document.createElement("canvas");D.width=R.width,D.height=R.height,D.getContext("2d").drawImage(R,0,0),u.preloadedImages[h]=D,j.URLObject.revokeObjectURL(C),p&&p(l)},R.onerror=function(D){xt(`Image ${C} could not be decoded`),m&&m()},R.src=C},u.preloadPlugins.push(o);let s={};s.canHandle=function(l){return!u.noAudioDecoding&&l.substr(-4)in{".ogg":1,".wav":1,".mp3":1}},s.handle=function(l,h,p,m){let _=!1;function C(P){_||(_=!0,u.preloadedAudios[h]=P,p&&p(l))}function R(){_||(_=!0,u.preloadedAudios[h]=new Audio,m&&m())}if(j.hasBlobConstructor){try{var D=new Blob([l],{type:j.getMimetype(h)})}catch{return R()}let P=j.URLObject.createObjectURL(D);q(typeof P=="string","createObjectURL must return a url as a string");let U=new Audio;U.addEventListener("canplaythrough",()=>{C(U)},!1),U.onerror=function(V){if(_)return;xt(`warning: browser could not fully decode audio ${h}, trying slower base64 approach`);function re(ie){let fe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",be="=",Se="",z=0,ne=0;for(let st=0;st<ie.length;st++)for(z=z<<8|ie[st],ne+=8;ne>=6;){let et=z>>ne-6&63;ne-=6,Se+=fe[et]}return ne==2?(Se+=fe[(z&3)<<4],Se+=be+be):ne==4&&(Se+=fe[(z&15)<<2],Se+=be),Se}U.src=`data:audio/x-${h.substr(-3)};base64,${re(l)}`,C(U)},U.src=P,Wr(()=>{C(U)},1e4)}else return R()},u.preloadPlugins.push(s)},createContext(o,s,l,h){if(s&&u.ctx&&o==u.canvas)return u.ctx;let p,m;if(s){let _={antialias:!1,alpha:!1,majorVersion:typeof WebGL2RenderingContext<"u"?2:1};if(h)for(let C in h)_[C]=h[C];typeof Q<"u"&&(m=Q.createContext(o,_),m&&(p=Q.getContext(m).GLctx))}else p=o.getContext("2d");return p?(l&&(s||q(typeof H>"u","cannot set in module if GLctx is used, but we are a non-GL context that would replace it"),u.ctx=p,s&&Q.makeContextCurrent(m),u.useWebGL=s,j.moduleContextCreatedCallbacks.forEach(_=>{_()}),j.init()),p):null},destroyContext(o,s,l){},fullscreenHandlersInstalled:!1,lockPointer:void 0,resizeCanvas:void 0,requestFullscreen(o,s){j.lockPointer=o,j.resizeCanvas=s,typeof j.lockPointer>"u"&&(j.lockPointer=!0),typeof j.resizeCanvas>"u"&&(j.resizeCanvas=!1);let{canvas:l}=u;j.fullscreenHandlersInstalled||(j.fullscreenHandlersInstalled=!0);let h=document.createElement("div");l.parentNode.insertBefore(h,l),h.appendChild(l),h.requestFullscreen=h.requestFullscreen||h.mozRequestFullScreen||h.msRequestFullscreen||(h.webkitRequestFullscreen?function(){h.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}:null)||(h.webkitRequestFullScreen?function(){h.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}:null),h.requestFullscreen()},requestFullScreen(){y("Module.requestFullScreen has been replaced by Module.requestFullscreen (without a capital S)")},exitFullscreen(){return!1},nextRAF:0,fakeRequestAnimationFrame(o){let s=Date.now();if(j.nextRAF===0)j.nextRAF=s+1e3/60;else for(;s+2>=j.nextRAF;)j.nextRAF+=1e3/60;let l=Math.max(j.nextRAF-s,0);setTimeout(o,l)},requestAnimationFrame(o){if(typeof requestAnimationFrame=="function"){requestAnimationFrame(o);return}let s=j.fakeRequestAnimationFrame;s(o)},safeSetTimeout(o){return Wr(o)},safeRequestAnimationFrame(o){return j.requestAnimationFrame(()=>{Es(o)})},getMimetype(o){return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",bmp:"image/bmp",ogg:"audio/ogg",wav:"audio/wav",mp3:"audio/mpeg"}[o.substr(o.lastIndexOf(".")+1)]},getUserMedia(o){window.getUserMedia||(window.getUserMedia=navigator.getUserMedia||navigator.mozGetUserMedia),window.getUserMedia(o)},getMovementX(o){return o.movementX||o.mozMovementX||o.webkitMovementX||0},getMovementY(o){return o.movementY||o.mozMovementY||o.webkitMovementY||0},getMouseWheelDelta(o){let s=0;switch(o.type){case"DOMMouseScroll":s=o.detail/3;break;case"mousewheel":s=o.wheelDelta/120;break;case"wheel":switch(s=o.deltaY,o.deltaMode){case 0:s/=100;break;case 1:s/=3;break;case 2:s*=80;break;default:throw`unrecognized mouse wheel delta mode: ${o.deltaMode}`}break;default:throw`unrecognized mouse wheel event: ${o.type}`}return s},mouseX:0,mouseY:0,mouseMovementX:0,mouseMovementY:0,touches:{},lastTouches:{},calculateMouseEvent(o){{let s=u.canvas.getBoundingClientRect(),l=u.canvas.width,h=u.canvas.height,p=typeof window.scrollX<"u"?window.scrollX:window.pageXOffset,m=typeof window.scrollY<"u"?window.scrollY:window.pageYOffset;if(q(typeof p<"u"&&typeof m<"u","Unable to retrieve scroll position, mouse positions likely broken."),o.type==="touchstart"||o.type==="touchend"||o.type==="touchmove"){let{touch:R}=o;if(R===void 0)return;let D=R.pageX-(p+s.left),P=R.pageY-(m+s.top);D=D*(l/s.width),P=P*(h/s.height);let U={x:D,y:P};if(o.type==="touchstart")j.lastTouches[R.identifier]=U,j.touches[R.identifier]=U;else if(o.type==="touchend"||o.type==="touchmove"){let V=j.touches[R.identifier];V||(V=U),j.lastTouches[R.identifier]=V,j.touches[R.identifier]=U}return}let _=o.pageX-(p+s.left),C=o.pageY-(m+s.top);_=_*(l/s.width),C=C*(h/s.height),j.mouseMovementX=_-j.mouseX,j.mouseMovementY=C-j.mouseY,j.mouseX=_,j.mouseY=C}},resizeListeners:[],updateResizeListeners(){let{canvas:o}=u;j.resizeListeners.forEach(s=>{s(o.width,o.height)})},setCanvasSize(o,s,l){let{canvas:h}=u;j.updateCanvasDimensions(h,o,s),l||j.updateResizeListeners()},windowedWidth:0,windowedHeight:0,setFullscreenCanvasSize(){if(typeof SDL<"u"){let o=ct[SDL.screen>>2];o=o|8388608,M[SDL.screen>>2]=o}j.updateCanvasDimensions(u.canvas),j.updateResizeListeners()},setWindowedCanvasSize(){if(typeof SDL<"u"){let o=ct[SDL.screen>>2];o=o&-8388609,M[SDL.screen>>2]=o}j.updateCanvasDimensions(u.canvas),j.updateResizeListeners()},updateCanvasDimensions(o,s,l){s&&l?(o.widthNative=s,o.heightNative=l):(s=o.widthNative,l=o.heightNative);let h=s,p=l;if(u.forcedAspectRatio&&u.forcedAspectRatio>0&&(h/p<u.forcedAspectRatio?h=Math.round(p*u.forcedAspectRatio):p=Math.round(h/u.forcedAspectRatio)),(document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement)===o.parentNode&&typeof screen<"u"){let m=Math.min(screen.width/h,screen.height/p);h=Math.round(h*m),p=Math.round(p*m)}j.resizeCanvas?(o.width!=h&&(o.width=h),o.height!=p&&(o.height=p),typeof o.style<"u"&&(o.style.removeProperty("width"),o.style.removeProperty("height"))):(o.width!=s&&(o.width=s),o.height!=l&&(o.height=l),typeof o.style<"u"&&(h!=s||p!=l?(o.style.setProperty("width",`${h}px`,"important"),o.style.setProperty("height",`${p}px`,"important")):(o.style.removeProperty("width"),o.style.removeProperty("height"))))}};function _s(o){for(;o.length>0;){let s=o.shift();if(typeof s=="function"){s(u);continue}let{func:l}=s;typeof l=="number"?s.arg===void 0?ce.get(l)():ce.get(l)(s.arg):l(s.arg===void 0?null:s.arg)}}function cl(o){return Ge("warning: build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling"),o}function Ba(o){let s=/\b_Z[\w\d_]+/g;return o.replace(s,l=>{let h=cl(l);return l===h?l:`${h} [${l}]`})}function Ao(){let o=new Error;if(!o.stack){try{throw new Error}catch(s){o=s}if(!o.stack)return"(no stack trace available)"}return o.stack.toString()}function Is(){let o=Ao();return u.extraStackTrace&&(o+=`
${u.extraStackTrace()}`),Ba(o)}function ho(o){return Nn(o+16)+16}function zi(o,s){}function Sn(o){this.excPtr=o,this.ptr=o-16,this.set_type=function(s){M[this.ptr+4>>2]=s},this.get_type=function(){return M[this.ptr+4>>2]},this.set_destructor=function(s){M[this.ptr+8>>2]=s},this.get_destructor=function(){return M[this.ptr+8>>2]},this.set_refcount=function(s){M[this.ptr>>2]=s},this.set_caught=function(s){s=s?1:0,ft[this.ptr+12>>0]=s},this.get_caught=function(){return ft[this.ptr+12>>0]!=0},this.set_rethrown=function(s){s=s?1:0,ft[this.ptr+13>>0]=s},this.get_rethrown=function(){return ft[this.ptr+13>>0]!=0},this.init=function(s,l){this.set_type(s),this.set_destructor(l),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){let s=M[this.ptr>>2];M[this.ptr>>2]=s+1},this.release_ref=function(){let s=M[this.ptr>>2];return M[this.ptr>>2]=s-1,q(s>0),s===1}}function wi(o){this.free=function(){pi(this.ptr),this.ptr=0},this.set_base_ptr=function(s){M[this.ptr>>2]=s},this.get_base_ptr=function(){return M[this.ptr>>2]},this.set_adjusted_ptr=function(s){M[this.ptr+4>>2]=s},this.get_adjusted_ptr_addr=function(){return this.ptr+4},this.get_adjusted_ptr=function(){return M[this.ptr+4>>2]},this.get_exception_ptr=function(){if(tm(this.get_exception_info().get_type()))return M[this.get_base_ptr()>>2];let s=this.get_adjusted_ptr();return s!==0?s:this.get_base_ptr()},this.get_exception_info=function(){return new Sn(this.get_base_ptr())},o===void 0?(this.ptr=Nn(8),this.set_adjusted_ptr(0)):this.ptr=o}let qi=[];function Ar(o){o.add_ref()}let Cs=0;function ll(o){let s=new wi(o),l=s.get_exception_info();return l.get_caught()||(l.set_caught(!0),Cs--),l.set_rethrown(!1),qi.push(s),Ar(l),s.get_exception_ptr()}let Dt=0;function go(o){try{return pi(new Sn(o).ptr)}catch(s){Pe(`exception during cxa_free_exception: ${s}`)}}function po(o){if(o.release_ref()&&!o.get_rethrown()){let s=o.get_destructor();s&&ce.get(s)(o.excPtr),go(o.excPtr)}}function mo(){Ie(0),q(qi.length>0);let o=qi.pop();po(o.get_exception_info()),o.free(),Dt=0}function vn(o){let s=new wi(o),l=s.get_base_ptr();throw Dt||(Dt=l),s.free(),`${l} - Exception catching is disabled, this exception cannot be caught. Compile with -s NO_DISABLE_EXCEPTION_CATCHING or -s EXCEPTION_CATCHING_ALLOWED=[..] to catch.`}function dl(){let o=Dt;if(!o)return Dr(0),0;let s=new Sn(o).get_type(),l=new wi;if(l.set_base_ptr(o),l.set_adjusted_ptr(o),!s)return Dr(0),l.ptr|0;let h=Array.prototype.slice.call(arguments);for(let p=0;p<h.length;p++){let m=h[p];if(m===0||m===s)break;if(ac(m,s,l.get_adjusted_ptr_addr()))return Dr(m),l.ptr|0}return Dr(s),l.ptr|0}function ys(){let o=Dt;if(!o)return Dr(0),0;let s=new Sn(o).get_type(),l=new wi;if(l.set_base_ptr(o),l.set_adjusted_ptr(o),!s)return Dr(0),l.ptr|0;let h=Array.prototype.slice.call(arguments);for(let p=0;p<h.length;p++){let m=h[p];if(m===0||m===s)break;if(ac(m,s,l.get_adjusted_ptr_addr()))return Dr(m),l.ptr|0}return Dr(s),l.ptr|0}function fo(){let o=qi.pop();o||y("no exception to throw");let s=o.get_exception_info(),l=o.get_base_ptr();throw s.get_rethrown()?o.free():(qi.push(o),s.set_rethrown(!0),s.set_caught(!1),Cs++),Dt=l,`${l} - Exception catching is disabled, this exception cannot be caught. Compile with -s NO_DISABLE_EXCEPTION_CATCHING or -s EXCEPTION_CATCHING_ALLOWED=[..] to catch.`}function ul(o,s){}function Na(o,s,l){throw new Sn(o).init(s,l),Dt=o,Cs++,`${o} - Exception catching is disabled, this exception cannot be caught. Compile with -s NO_DISABLE_EXCEPTION_CATCHING or -s EXCEPTION_CATCHING_ALLOWED=[..] to catch.`}function Pa(o){return M[Zp()>>2]=o,o}var rt={splitPath(o){return/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(o).slice(1)},normalizeArray(o,s){let l=0;for(let h=o.length-1;h>=0;h--){let p=o[h];p==="."?o.splice(h,1):p===".."?(o.splice(h,1),l++):l&&(o.splice(h,1),l--)}if(s)for(;l;l--)o.unshift("..");return o},normalize(o){let s=o.charAt(0)==="/",l=o.substr(-1)==="/";return o=rt.normalizeArray(o.split("/").filter(h=>!!h),!s).join("/"),!o&&!s&&(o="."),o&&l&&(o+="/"),(s?"/":"")+o},dirname(o){let s=rt.splitPath(o),l=s[0],h=s[1];return!l&&!h?".":(h&&(h=h.substr(0,h.length-1)),l+h)},basename(o){if(o==="/")return"/";o=rt.normalize(o),o=o.replace(/\/$/,"");let s=o.lastIndexOf("/");return s===-1?o:o.substr(s+1)},extname(o){return rt.splitPath(o)[3]},join(){let o=Array.prototype.slice.call(arguments,0);return rt.normalize(o.join("/"))},join2(o,s){return rt.normalize(`${o}/${s}`)}};function Ts(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){let o=new Uint8Array(1);return function(){return crypto.getRandomValues(o),o[0]}}if(Ur)try{let o=Nx("crypto");return function(){return o.randomBytes(1)[0]}}catch{}return function(){y("no cryptographic support found for randomDevice. consider polyfilling it if you want to use something insecure like Math.random(), e.g. put this in a --pre-js: var crypto = { getRandomValues: function(array) { for (var i = 0; i < array.length; i++) array[i] = (Math.random()*256)|0 } };")}}var Nr={resolve(){let o="",s=!1;for(let l=arguments.length-1;l>=-1&&!s;l--){let h=l>=0?arguments[l]:I.cwd();if(typeof h!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!h)return"";o=`${h}/${o}`,s=h.charAt(0)==="/"}return o=rt.normalizeArray(o.split("/").filter(l=>!!l),!s).join("/"),(s?"/":"")+o||"."},relative(o,s){o=Nr.resolve(o).substr(1),s=Nr.resolve(s).substr(1);function l(D){let P=0;for(;P<D.length&&D[P]==="";P++);let U=D.length-1;for(;U>=0&&D[U]==="";U--);return P>U?[]:D.slice(P,U-P+1)}let h=l(o.split("/")),p=l(s.split("/")),m=Math.min(h.length,p.length),_=m;for(var C=0;C<m;C++)if(h[C]!==p[C]){_=C;break}let R=[];for(var C=_;C<h.length;C++)R.push("..");return R=R.concat(p.slice(_)),R.join("/")}},ci={ttys:[],init(){},shutdown(){},register(o,s){ci.ttys[o]={input:[],output:[],ops:s},I.registerDevice(o,ci.stream_ops)},stream_ops:{open(o){let s=ci.ttys[o.node.rdev];if(!s)throw new I.ErrnoError(43);o.tty=s,o.seekable=!1},close(o){o.tty.ops.flush(o.tty)},flush(o){o.tty.ops.flush(o.tty)},read(o,s,l,h,p){if(!o.tty||!o.tty.ops.get_char)throw new I.ErrnoError(60);let m=0;for(let C=0;C<h;C++){var _;try{_=o.tty.ops.get_char(o.tty)}catch{throw new I.ErrnoError(29)}if(_===void 0&&m===0)throw new I.ErrnoError(6);if(_==null)break;m++,s[l+C]=_}return m&&(o.node.timestamp=Date.now()),m},write(o,s,l,h,p){if(!o.tty||!o.tty.ops.put_char)throw new I.ErrnoError(60);try{for(var m=0;m<h;m++)o.tty.ops.put_char(o.tty,s[l+m])}catch{throw new I.ErrnoError(29)}return h&&(o.node.timestamp=Date.now()),m}},default_tty_ops:{get_char(o){if(!o.input.length){let s=null;if(Ur){let l=Buffer.alloc(256),h=0;try{h=vi.readSync(process.stdin.fd,l,0,256,null)}catch(p){if(p.toString().includes("EOF"))h=0;else throw p}h>0?s=l.slice(0,h).toString("utf-8"):s=null}else typeof window<"u"&&typeof window.prompt=="function"?(s=window.prompt("Input: "),s!==null&&(s+=`
`)):typeof readline=="function"&&(s=readline(),s!==null&&(s+=`
`));if(!s)return null;o.input=sc(s,!0)}return o.input.shift()},put_char(o,s){s===null||s===10?(xt(Yi(o.output,0)),o.output=[]):s!=0&&o.output.push(s)},flush(o){o.output&&o.output.length>0&&(xt(Yi(o.output,0)),o.output=[])}},default_tty1_ops:{put_char(o,s){s===null||s===10?(Pe(Yi(o.output,0)),o.output=[]):s!=0&&o.output.push(s)},flush(o){o.output&&o.output.length>0&&(Pe(Yi(o.output,0)),o.output=[])}}};function $i(o,s){pt.fill(0,o,o+s)}function Jr(o,s){return q(s,"alignment argument is required"),Math.ceil(o/s)*s}function Eo(o){o=Jr(o,65536);let s=rm(65536,o);return s?($i(s,o),s):0}var ke={ops_table:null,mount(o){return ke.createNode(null,"/",16895,0)},createNode(o,s,l,h){if(I.isBlkdev(l)||I.isFIFO(l))throw new I.ErrnoError(63);ke.ops_table||(ke.ops_table={dir:{node:{getattr:ke.node_ops.getattr,setattr:ke.node_ops.setattr,lookup:ke.node_ops.lookup,mknod:ke.node_ops.mknod,rename:ke.node_ops.rename,unlink:ke.node_ops.unlink,rmdir:ke.node_ops.rmdir,readdir:ke.node_ops.readdir,symlink:ke.node_ops.symlink},stream:{llseek:ke.stream_ops.llseek}},file:{node:{getattr:ke.node_ops.getattr,setattr:ke.node_ops.setattr},stream:{llseek:ke.stream_ops.llseek,read:ke.stream_ops.read,write:ke.stream_ops.write,allocate:ke.stream_ops.allocate,mmap:ke.stream_ops.mmap,msync:ke.stream_ops.msync}},link:{node:{getattr:ke.node_ops.getattr,setattr:ke.node_ops.setattr,readlink:ke.node_ops.readlink},stream:{}},chrdev:{node:{getattr:ke.node_ops.getattr,setattr:ke.node_ops.setattr},stream:I.chrdev_stream_ops}});let p=I.createNode(o,s,l,h);return I.isDir(p.mode)?(p.node_ops=ke.ops_table.dir.node,p.stream_ops=ke.ops_table.dir.stream,p.contents={}):I.isFile(p.mode)?(p.node_ops=ke.ops_table.file.node,p.stream_ops=ke.ops_table.file.stream,p.usedBytes=0,p.contents=null):I.isLink(p.mode)?(p.node_ops=ke.ops_table.link.node,p.stream_ops=ke.ops_table.link.stream):I.isChrdev(p.mode)&&(p.node_ops=ke.ops_table.chrdev.node,p.stream_ops=ke.ops_table.chrdev.stream),p.timestamp=Date.now(),o&&(o.contents[s]=p,o.timestamp=p.timestamp),p},getFileDataAsTypedArray(o){return o.contents?o.contents.subarray?o.contents.subarray(0,o.usedBytes):new Uint8Array(o.contents):new Uint8Array(0)},expandFileStorage(o,s){let l=o.contents?o.contents.length:0;if(l>=s)return;let h=1024*1024;s=Math.max(s,l*(l<h?2:1.125)>>>0),l!=0&&(s=Math.max(s,256));let p=o.contents;o.contents=new Uint8Array(s),o.usedBytes>0&&o.contents.set(p.subarray(0,o.usedBytes),0)},resizeFileStorage(o,s){if(o.usedBytes!=s)if(s==0)o.contents=null,o.usedBytes=0;else{let l=o.contents;o.contents=new Uint8Array(s),l&&o.contents.set(l.subarray(0,Math.min(s,o.usedBytes))),o.usedBytes=s}},node_ops:{getattr(o){let s={};return s.dev=I.isChrdev(o.mode)?o.id:1,s.ino=o.id,s.mode=o.mode,s.nlink=1,s.uid=0,s.gid=0,s.rdev=o.rdev,I.isDir(o.mode)?s.size=4096:I.isFile(o.mode)?s.size=o.usedBytes:I.isLink(o.mode)?s.size=o.link.length:s.size=0,s.atime=new Date(o.timestamp),s.mtime=new Date(o.timestamp),s.ctime=new Date(o.timestamp),s.blksize=4096,s.blocks=Math.ceil(s.size/s.blksize),s},setattr(o,s){s.mode!==void 0&&(o.mode=s.mode),s.timestamp!==void 0&&(o.timestamp=s.timestamp),s.size!==void 0&&ke.resizeFileStorage(o,s.size)},lookup(o,s){throw I.genericErrors[44]},mknod(o,s,l,h){return ke.createNode(o,s,l,h)},rename(o,s,l){if(I.isDir(o.mode)){let h;try{h=I.lookupNode(s,l)}catch{}if(h)for(let p in h.contents)throw new I.ErrnoError(55)}delete o.parent.contents[o.name],o.parent.timestamp=Date.now(),o.name=l,s.contents[l]=o,s.timestamp=o.parent.timestamp,o.parent=s},unlink(o,s){delete o.contents[s],o.timestamp=Date.now()},rmdir(o,s){let l=I.lookupNode(o,s);for(let h in l.contents)throw new I.ErrnoError(55);delete o.contents[s],o.timestamp=Date.now()},readdir(o){let s=[".",".."];for(let l in o.contents)o.contents.hasOwnProperty(l)&&s.push(l);return s},symlink(o,s,l){let h=ke.createNode(o,s,41471,0);return h.link=l,h},readlink(o){if(!I.isLink(o.mode))throw new I.ErrnoError(28);return o.link}},stream_ops:{read(o,s,l,h,p){let{contents:m}=o.node;if(p>=o.node.usedBytes)return 0;let _=Math.min(o.node.usedBytes-p,h);if(q(_>=0),_>8&&m.subarray)s.set(m.subarray(p,p+_),l);else for(let C=0;C<_;C++)s[l+C]=m[p+C];return _},write(o,s,l,h,p,m){if(q(!(s instanceof ArrayBuffer)),s.buffer===ft.buffer&&(m=!1),!h)return 0;let{node:_}=o;if(_.timestamp=Date.now(),s.subarray&&(!_.contents||_.contents.subarray)){if(m)return q(p===0,"canOwn must imply no weird position inside the file"),_.contents=s.subarray(l,l+h),_.usedBytes=h,h;if(_.usedBytes===0&&p===0)return _.contents=s.slice(l,l+h),_.usedBytes=h,h;if(p+h<=_.usedBytes)return _.contents.set(s.subarray(l,l+h),p),h}if(ke.expandFileStorage(_,p+h),_.contents.subarray&&s.subarray)_.contents.set(s.subarray(l,l+h),p);else for(let C=0;C<h;C++)_.contents[p+C]=s[l+C];return _.usedBytes=Math.max(_.usedBytes,p+h),h},llseek(o,s,l){let h=s;if(l===1?h+=o.position:l===2&&I.isFile(o.node.mode)&&(h+=o.node.usedBytes),h<0)throw new I.ErrnoError(28);return h},allocate(o,s,l){ke.expandFileStorage(o.node,s+l),o.node.usedBytes=Math.max(o.node.usedBytes,s+l)},mmap(o,s,l,h,p,m){if(s!==0)throw new I.ErrnoError(28);if(!I.isFile(o.node.mode))throw new I.ErrnoError(43);let _,C,{contents:R}=o.node;if(!(m&2)&&R.buffer===En)C=!1,_=R.byteOffset;else{if((h>0||h+l<R.length)&&(R.subarray?R=R.subarray(h,h+l):R=Array.prototype.slice.call(R,h,h+l)),C=!0,_=Eo(l),!_)throw new I.ErrnoError(48);ft.set(R,_)}return{ptr:_,allocated:C}},msync(o,s,l,h,p){if(!I.isFile(o.node.mode))throw new I.ErrnoError(43);return p&2||ke.stream_ops.write(o,s,0,h,l,!1),0}}};function _o(o,s,l,h){let p=h?"":Ki(`al ${o}`);Gt(o,m=>{q(m,`Loading data file "${o}" failed (no arrayBuffer).`),s(new Uint8Array(m)),p&&Yr(p)},m=>{if(l)l();else throw`Loading data file "${o}" failed.`}),p&&Xi(p)}let Kr={0:"Success",1:"Arg list too long",2:"Permission denied",3:"Address already in use",4:"Address not available",5:"Address family not supported by protocol family",6:"No more processes",7:"Socket already connected",8:"Bad file number",9:"Trying to read unreadable message",10:"Mount device busy",11:"Operation canceled",12:"No children",13:"Connection aborted",14:"Connection refused",15:"Connection reset by peer",16:"File locking deadlock error",17:"Destination address required",18:"Math arg out of domain of func",19:"Quota exceeded",20:"File exists",21:"Bad address",22:"File too large",23:"Host is unreachable",24:"Identifier removed",25:"Illegal byte sequence",26:"Connection already in progress",27:"Interrupted system call",28:"Invalid argument",29:"I/O error",30:"Socket is already connected",31:"Is a directory",32:"Too many symbolic links",33:"Too many open files",34:"Too many links",35:"Message too long",36:"Multihop attempted",37:"File or path name too long",38:"Network interface is not configured",39:"Connection reset by network",40:"Network is unreachable",41:"Too many open files in system",42:"No buffer space available",43:"No such device",44:"No such file or directory",45:"Exec format error",46:"No record locks available",47:"The link has been severed",48:"Not enough core",49:"No message of desired type",50:"Protocol not available",51:"No space left on device",52:"Function not implemented",53:"Socket is not connected",54:"Not a directory",55:"Directory not empty",56:"State not recoverable",57:"Socket operation on non-socket",59:"Not a typewriter",60:"No such device or address",61:"Value too large for defined data type",62:"Previous owner died",63:"Not super-user",64:"Broken pipe",65:"Protocol error",66:"Unknown protocol",67:"Protocol wrong type for socket",68:"Math result not representable",69:"Read only file system",70:"Illegal seek",71:"No such process",72:"Stale file handle",73:"Connection timed out",74:"Text file busy",75:"Cross-device link",100:"Device not a stream",101:"Bad font file fmt",102:"Invalid slot",103:"Invalid request code",104:"No anode",105:"Block device required",106:"Channel number out of range",107:"Level 3 halted",108:"Level 3 reset",109:"Link number out of range",110:"Protocol driver not attached",111:"No CSI structure available",112:"Level 2 halted",113:"Invalid exchange",114:"Invalid request descriptor",115:"Exchange full",116:"No data (for no delay io)",117:"Timer expired",118:"Out of streams resources",119:"Machine is not on the network",120:"Package not installed",121:"The object is remote",122:"Advertise error",123:"Srmount error",124:"Communication error on send",125:"Cross mount point (not really error)",126:"Given log. name not unique",127:"f.d. invalid for this operation",128:"Remote address changed",129:"Can   access a needed shared lib",130:"Accessing a corrupted shared lib",131:".lib section in a.out corrupted",132:"Attempting to link in too many libs",133:"Attempting to exec a shared library",135:"Streams pipe error",136:"Too many users",137:"Socket type not supported",138:"Not supported",139:"Protocol family not supported",140:"Can't send after socket shutdown",141:"Too many references",142:"Host is down",148:"No medium (in tape drive)",156:"Level 2 not synchronized"},Ma={EPERM:63,ENOENT:44,ESRCH:71,EINTR:27,EIO:29,ENXIO:60,E2BIG:1,ENOEXEC:45,EBADF:8,ECHILD:12,EAGAIN:6,EWOULDBLOCK:6,ENOMEM:48,EACCES:2,EFAULT:21,ENOTBLK:105,EBUSY:10,EEXIST:20,EXDEV:75,ENODEV:43,ENOTDIR:54,EISDIR:31,EINVAL:28,ENFILE:41,EMFILE:33,ENOTTY:59,ETXTBSY:74,EFBIG:22,ENOSPC:51,ESPIPE:70,EROFS:69,EMLINK:34,EPIPE:64,EDOM:18,ERANGE:68,ENOMSG:49,EIDRM:24,ECHRNG:106,EL2NSYNC:156,EL3HLT:107,EL3RST:108,ELNRNG:109,EUNATCH:110,ENOCSI:111,EL2HLT:112,EDEADLK:16,ENOLCK:46,EBADE:113,EBADR:114,EXFULL:115,ENOANO:104,EBADRQC:103,EBADSLT:102,EDEADLOCK:16,EBFONT:101,ENOSTR:100,ENODATA:116,ETIME:117,ENOSR:118,ENONET:119,ENOPKG:120,EREMOTE:121,ENOLINK:47,EADV:122,ESRMNT:123,ECOMM:124,EPROTO:65,EMULTIHOP:36,EDOTDOT:125,EBADMSG:9,ENOTUNIQ:126,EBADFD:127,EREMCHG:128,ELIBACC:129,ELIBBAD:130,ELIBSCN:131,ELIBMAX:132,ELIBEXEC:133,ENOSYS:52,ENOTEMPTY:55,ENAMETOOLONG:37,ELOOP:32,EOPNOTSUPP:138,EPFNOSUPPORT:139,ECONNRESET:15,ENOBUFS:42,EAFNOSUPPORT:5,EPROTOTYPE:67,ENOTSOCK:57,ENOPROTOOPT:50,ESHUTDOWN:140,ECONNREFUSED:14,EADDRINUSE:3,ECONNABORTED:13,ENETUNREACH:40,ENETDOWN:38,ETIMEDOUT:73,EHOSTDOWN:142,EHOSTUNREACH:23,EINPROGRESS:26,EALREADY:7,EDESTADDRREQ:17,EMSGSIZE:35,EPROTONOSUPPORT:66,ESOCKTNOSUPPORT:137,EADDRNOTAVAIL:4,ENETRESET:39,EISCONN:30,ENOTCONN:53,ETOOMANYREFS:141,EUSERS:136,EDQUOT:19,ESTALE:72,ENOTSUP:138,ENOMEDIUM:148,EILSEQ:25,EOVERFLOW:61,ECANCELED:11,ENOTRECOVERABLE:56,EOWNERDEAD:62,ESTRPIPE:135};var I={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,trackingDelegate:{},tracking:{openFlags:{READ:1,WRITE:2}},ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath(o,s){if(o=Nr.resolve(I.cwd(),o),s=s||{},!o)return{path:"",node:null};let l={follow_mount:!0,recurse_count:0};for(let _ in l)s[_]===void 0&&(s[_]=l[_]);if(s.recurse_count>8)throw new I.ErrnoError(32);let h=rt.normalizeArray(o.split("/").filter(_=>!!_),!1),p=I.root,m="/";for(let _=0;_<h.length;_++){let C=_===h.length-1;if(C&&s.parent)break;if(p=I.lookupNode(p,h[_]),m=rt.join2(m,h[_]),I.isMountpoint(p)&&(!C||C&&s.follow_mount)&&(p=p.mounted.root),!C||s.follow){let R=0;for(;I.isLink(p.mode);){let D=I.readlink(m);if(m=Nr.resolve(rt.dirname(m),D),p=I.lookupPath(m,{recurse_count:s.recurse_count}).node,R++>40)throw new I.ErrnoError(32)}}}return{path:m,node:p}},getPath(o){let s;for(;;){if(I.isRoot(o)){let l=o.mount.mountpoint;return s?l[l.length-1]!=="/"?`${l}/${s}`:l+s:l}s=s?`${o.name}/${s}`:o.name,o=o.parent}},hashName(o,s){let l=0;for(let h=0;h<s.length;h++)l=(l<<5)-l+s.charCodeAt(h)|0;return(o+l>>>0)%I.nameTable.length},hashAddNode(o){let s=I.hashName(o.parent.id,o.name);o.name_next=I.nameTable[s],I.nameTable[s]=o},hashRemoveNode(o){let s=I.hashName(o.parent.id,o.name);if(I.nameTable[s]===o)I.nameTable[s]=o.name_next;else{let l=I.nameTable[s];for(;l;){if(l.name_next===o){l.name_next=o.name_next;break}l=l.name_next}}},lookupNode(o,s){let l=I.mayLookup(o);if(l)throw new I.ErrnoError(l,o);let h=I.hashName(o.id,s);for(let p=I.nameTable[h];p;p=p.name_next){let m=p.name;if(p.parent.id===o.id&&m===s)return p}return I.lookup(o,s)},createNode(o,s,l,h){q(typeof o=="object");let p=new I.FSNode(o,s,l,h);return I.hashAddNode(p),p},destroyNode(o){I.hashRemoveNode(o)},isRoot(o){return o===o.parent},isMountpoint(o){return!!o.mounted},isFile(o){return(o&61440)===32768},isDir(o){return(o&61440)===16384},isLink(o){return(o&61440)===40960},isChrdev(o){return(o&61440)===8192},isBlkdev(o){return(o&61440)===24576},isFIFO(o){return(o&61440)===4096},isSocket(o){return(o&49152)===49152},flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags(o){let s=I.flagModes[o];if(typeof s>"u")throw new Error(`Unknown file open mode: ${o}`);return s},flagsToPermissionString(o){let s=["r","w","rw"][o&3];return o&512&&(s+="w"),s},nodePermissions(o,s){return I.ignorePermissions?0:s.includes("r")&&!(o.mode&292)||s.includes("w")&&!(o.mode&146)||s.includes("x")&&!(o.mode&73)?2:0},mayLookup(o){return I.nodePermissions(o,"x")||(o.node_ops.lookup?0:2)},mayCreate(o,s){try{let l=I.lookupNode(o,s);return 20}catch{}return I.nodePermissions(o,"wx")},mayDelete(o,s,l){let h;try{h=I.lookupNode(o,s)}catch(m){return m.errno}let p=I.nodePermissions(o,"wx");if(p)return p;if(l){if(!I.isDir(h.mode))return 54;if(I.isRoot(h)||I.getPath(h)===I.cwd())return 10}else if(I.isDir(h.mode))return 31;return 0},mayOpen(o,s){return o?I.isLink(o.mode)?32:I.isDir(o.mode)&&(I.flagsToPermissionString(s)!=="r"||s&512)?31:I.nodePermissions(o,I.flagsToPermissionString(s)):44},MAX_OPEN_FDS:4096,nextfd(o,s){o=o||0,s=s||I.MAX_OPEN_FDS;for(let l=o;l<=s;l++)if(!I.streams[l])return l;throw new I.ErrnoError(33)},getStream(o){return I.streams[o]},createStream(o,s,l){I.FSStream||(I.FSStream=function(){},I.FSStream.prototype={object:{get(){return this.node},set(m){this.node=m}},isRead:{get(){return(this.flags&2097155)!==1}},isWrite:{get(){return(this.flags&2097155)!==0}},isAppend:{get(){return this.flags&1024}}});let h=new I.FSStream;for(let m in o)h[m]=o[m];o=h;let p=I.nextfd(s,l);return o.fd=p,I.streams[p]=o,o},closeStream(o){I.streams[o]=null},chrdev_stream_ops:{open(o){let s=I.getDevice(o.node.rdev);o.stream_ops=s.stream_ops,o.stream_ops.open&&o.stream_ops.open(o)},llseek(){throw new I.ErrnoError(70)}},major(o){return o>>8},minor(o){return o&255},makedev(o,s){return o<<8|s},registerDevice(o,s){I.devices[o]={stream_ops:s}},getDevice(o){return I.devices[o]},getMounts(o){let s=[],l=[o];for(;l.length;){let h=l.pop();s.push(h),l.push.apply(l,h.mounts)}return s},syncfs(o,s){typeof o=="function"&&(s=o,o=!1),I.syncFSRequests++,I.syncFSRequests>1&&Pe(`warning: ${I.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);let l=I.getMounts(I.root.mount),h=0;function p(_){return q(I.syncFSRequests>0),I.syncFSRequests--,s(_)}function m(_){if(_)return m.errored?void 0:(m.errored=!0,p(_));++h>=l.length&&p(null)}l.forEach(_=>{if(!_.type.syncfs)return m(null);_.type.syncfs(_,o,m)})},mount(o,s,l){if(typeof o=="string")throw o;let h=l==="/",p=!l,m;if(h&&I.root)throw new I.ErrnoError(10);if(!h&&!p){let R=I.lookupPath(l,{follow_mount:!1});if(l=R.path,m=R.node,I.isMountpoint(m))throw new I.ErrnoError(10);if(!I.isDir(m.mode))throw new I.ErrnoError(54)}let _={type:o,opts:s,mountpoint:l,mounts:[]},C=o.mount(_);return C.mount=_,_.root=C,h?I.root=C:m&&(m.mounted=_,m.mount&&m.mount.mounts.push(_)),C},unmount(o){let s=I.lookupPath(o,{follow_mount:!1});if(!I.isMountpoint(s.node))throw new I.ErrnoError(28);let{node:l}=s,h=l.mounted,p=I.getMounts(h);Object.keys(I.nameTable).forEach(_=>{let C=I.nameTable[_];for(;C;){let R=C.name_next;p.includes(C.mount)&&I.destroyNode(C),C=R}}),l.mounted=null;let m=l.mount.mounts.indexOf(h);q(m!==-1),l.mount.mounts.splice(m,1)},lookup(o,s){return o.node_ops.lookup(o,s)},mknod(o,s,l){let h=I.lookupPath(o,{parent:!0}).node,p=rt.basename(o);if(!p||p==="."||p==="..")throw new I.ErrnoError(28);let m=I.mayCreate(h,p);if(m)throw new I.ErrnoError(m);if(!h.node_ops.mknod)throw new I.ErrnoError(63);return h.node_ops.mknod(h,p,s,l)},create(o,s){return s=s!==void 0?s:438,s&=4095,s|=32768,I.mknod(o,s,0)},mkdir(o,s){return s=s!==void 0?s:511,s&=1023,s|=16384,I.mknod(o,s,0)},mkdirTree(o,s){let l=o.split("/"),h="";for(let p=0;p<l.length;++p)if(l[p]){h+=`/${l[p]}`;try{I.mkdir(h,s)}catch(m){if(m.errno!=20)throw m}}},mkdev(o,s,l){return typeof l>"u"&&(l=s,s=438),s|=8192,I.mknod(o,s,l)},symlink(o,s){if(!Nr.resolve(o))throw new I.ErrnoError(44);let l=I.lookupPath(s,{parent:!0}).node;if(!l)throw new I.ErrnoError(44);let h=rt.basename(s),p=I.mayCreate(l,h);if(p)throw new I.ErrnoError(p);if(!l.node_ops.symlink)throw new I.ErrnoError(63);return l.node_ops.symlink(l,h,o)},rename(o,s){let l=rt.dirname(o),h=rt.dirname(s),p=rt.basename(o),m=rt.basename(s),_,C,R;if(_=I.lookupPath(o,{parent:!0}),C=_.node,_=I.lookupPath(s,{parent:!0}),R=_.node,!C||!R)throw new I.ErrnoError(44);if(C.mount!==R.mount)throw new I.ErrnoError(75);let D=I.lookupNode(C,p),P=Nr.relative(o,h);if(P.charAt(0)!==".")throw new I.ErrnoError(28);if(P=Nr.relative(s,l),P.charAt(0)!==".")throw new I.ErrnoError(55);let U;try{U=I.lookupNode(R,m)}catch{}if(D===U)return;let V=I.isDir(D.mode),re=I.mayDelete(C,p,V);if(re)throw new I.ErrnoError(re);if(re=U?I.mayDelete(R,m,V):I.mayCreate(R,m),re)throw new I.ErrnoError(re);if(!C.node_ops.rename)throw new I.ErrnoError(63);if(I.isMountpoint(D)||U&&I.isMountpoint(U))throw new I.ErrnoError(10);if(R!==C&&(re=I.nodePermissions(C,"w"),re))throw new I.ErrnoError(re);try{I.trackingDelegate.willMovePath&&I.trackingDelegate.willMovePath(o,s)}catch(ie){Pe(`FS.trackingDelegate['willMovePath']('${o}', '${s}') threw an exception: ${ie.message}`)}I.hashRemoveNode(D);try{C.node_ops.rename(D,R,m)}catch(ie){throw ie}finally{I.hashAddNode(D)}try{I.trackingDelegate.onMovePath&&I.trackingDelegate.onMovePath(o,s)}catch(ie){Pe(`FS.trackingDelegate['onMovePath']('${o}', '${s}') threw an exception: ${ie.message}`)}},rmdir(o){let s=I.lookupPath(o,{parent:!0}).node,l=rt.basename(o),h=I.lookupNode(s,l),p=I.mayDelete(s,l,!0);if(p)throw new I.ErrnoError(p);if(!s.node_ops.rmdir)throw new I.ErrnoError(63);if(I.isMountpoint(h))throw new I.ErrnoError(10);try{I.trackingDelegate.willDeletePath&&I.trackingDelegate.willDeletePath(o)}catch(m){Pe(`FS.trackingDelegate['willDeletePath']('${o}') threw an exception: ${m.message}`)}s.node_ops.rmdir(s,l),I.destroyNode(h);try{I.trackingDelegate.onDeletePath&&I.trackingDelegate.onDeletePath(o)}catch(m){Pe(`FS.trackingDelegate['onDeletePath']('${o}') threw an exception: ${m.message}`)}},readdir(o){let s=I.lookupPath(o,{follow:!0}),{node:l}=s;if(!l.node_ops.readdir)throw new I.ErrnoError(54);return l.node_ops.readdir(l)},unlink(o){let s=I.lookupPath(o,{parent:!0}).node,l=rt.basename(o),h=I.lookupNode(s,l),p=I.mayDelete(s,l,!1);if(p)throw new I.ErrnoError(p);if(!s.node_ops.unlink)throw new I.ErrnoError(63);if(I.isMountpoint(h))throw new I.ErrnoError(10);try{I.trackingDelegate.willDeletePath&&I.trackingDelegate.willDeletePath(o)}catch(m){Pe(`FS.trackingDelegate['willDeletePath']('${o}') threw an exception: ${m.message}`)}s.node_ops.unlink(s,l),I.destroyNode(h);try{I.trackingDelegate.onDeletePath&&I.trackingDelegate.onDeletePath(o)}catch(m){Pe(`FS.trackingDelegate['onDeletePath']('${o}') threw an exception: ${m.message}`)}},readlink(o){let s=I.lookupPath(o).node;if(!s)throw new I.ErrnoError(44);if(!s.node_ops.readlink)throw new I.ErrnoError(28);return Nr.resolve(I.getPath(s.parent),s.node_ops.readlink(s))},stat(o,s){let l=I.lookupPath(o,{follow:!s}),{node:h}=l;if(!h)throw new I.ErrnoError(44);if(!h.node_ops.getattr)throw new I.ErrnoError(63);return h.node_ops.getattr(h)},lstat(o){return I.stat(o,!0)},chmod(o,s,l){let h;if(typeof o=="string"?h=I.lookupPath(o,{follow:!l}).node:h=o,!h.node_ops.setattr)throw new I.ErrnoError(63);h.node_ops.setattr(h,{mode:s&4095|h.mode&-4096,timestamp:Date.now()})},lchmod(o,s){I.chmod(o,s,!0)},fchmod(o,s){let l=I.getStream(o);if(!l)throw new I.ErrnoError(8);I.chmod(l.node,s)},chown(o,s,l,h){let p;if(typeof o=="string"?p=I.lookupPath(o,{follow:!h}).node:p=o,!p.node_ops.setattr)throw new I.ErrnoError(63);p.node_ops.setattr(p,{timestamp:Date.now()})},lchown(o,s,l){I.chown(o,s,l,!0)},fchown(o,s,l){let h=I.getStream(o);if(!h)throw new I.ErrnoError(8);I.chown(h.node,s,l)},truncate(o,s){if(s<0)throw new I.ErrnoError(28);let l;if(typeof o=="string"?l=I.lookupPath(o,{follow:!0}).node:l=o,!l.node_ops.setattr)throw new I.ErrnoError(63);if(I.isDir(l.mode))throw new I.ErrnoError(31);if(!I.isFile(l.mode))throw new I.ErrnoError(28);let h=I.nodePermissions(l,"w");if(h)throw new I.ErrnoError(h);l.node_ops.setattr(l,{size:s,timestamp:Date.now()})},ftruncate(o,s){let l=I.getStream(o);if(!l)throw new I.ErrnoError(8);if(!(l.flags&2097155))throw new I.ErrnoError(28);I.truncate(l.node,s)},utime(o,s,l){let h=I.lookupPath(o,{follow:!0}),{node:p}=h;p.node_ops.setattr(p,{timestamp:Math.max(s,l)})},open(o,s,l,h,p){if(o==="")throw new I.ErrnoError(44);s=typeof s=="string"?I.modeStringToFlags(s):s,l=typeof l>"u"?438:l,s&64?l=l&4095|32768:l=0;let m;if(typeof o=="object")m=o;else{o=rt.normalize(o);try{m=I.lookupPath(o,{follow:!(s&131072)}).node}catch{}}let _=!1;if(s&64)if(m){if(s&128)throw new I.ErrnoError(20)}else m=I.mknod(o,l,0),_=!0;if(!m)throw new I.ErrnoError(44);if(I.isChrdev(m.mode)&&(s&=-513),s&65536&&!I.isDir(m.mode))throw new I.ErrnoError(54);if(!_){let R=I.mayOpen(m,s);if(R)throw new I.ErrnoError(R)}s&512&&I.truncate(m,0),s&=-131713;let C=I.createStream({node:m,path:I.getPath(m),flags:s,seekable:!0,position:0,stream_ops:m.stream_ops,ungotten:[],error:!1},h,p);C.stream_ops.open&&C.stream_ops.open(C),u.logReadFiles&&!(s&1)&&(I.readFiles||(I.readFiles={}),o in I.readFiles||(I.readFiles[o]=1,Pe(`FS.trackingDelegate error on read file: ${o}`)));try{if(I.trackingDelegate.onOpenFile){let R=0;(s&2097155)!==1&&(R|=I.tracking.openFlags.READ),s&2097155&&(R|=I.tracking.openFlags.WRITE),I.trackingDelegate.onOpenFile(o,R)}}catch(R){Pe(`FS.trackingDelegate['onOpenFile']('${o}', flags) threw an exception: ${R.message}`)}return C},close(o){if(I.isClosed(o))throw new I.ErrnoError(8);o.getdents&&(o.getdents=null);try{o.stream_ops.close&&o.stream_ops.close(o)}catch(s){throw s}finally{I.closeStream(o.fd)}o.fd=null},isClosed(o){return o.fd===null},llseek(o,s,l){if(I.isClosed(o))throw new I.ErrnoError(8);if(!o.seekable||!o.stream_ops.llseek)throw new I.ErrnoError(70);if(l!=0&&l!=1&&l!=2)throw new I.ErrnoError(28);return o.position=o.stream_ops.llseek(o,s,l),o.ungotten=[],o.position},read(o,s,l,h,p){if(h<0||p<0)throw new I.ErrnoError(28);if(I.isClosed(o))throw new I.ErrnoError(8);if((o.flags&2097155)===1)throw new I.ErrnoError(8);if(I.isDir(o.node.mode))throw new I.ErrnoError(31);if(!o.stream_ops.read)throw new I.ErrnoError(28);let m=typeof p<"u";if(!m)p=o.position;else if(!o.seekable)throw new I.ErrnoError(70);let _=o.stream_ops.read(o,s,l,h,p);return m||(o.position+=_),_},write(o,s,l,h,p,m){if(h<0||p<0)throw new I.ErrnoError(28);if(I.isClosed(o))throw new I.ErrnoError(8);if(!(o.flags&2097155))throw new I.ErrnoError(8);if(I.isDir(o.node.mode))throw new I.ErrnoError(31);if(!o.stream_ops.write)throw new I.ErrnoError(28);o.seekable&&o.flags&1024&&I.llseek(o,0,2);let _=typeof p<"u";if(!_)p=o.position;else if(!o.seekable)throw new I.ErrnoError(70);let C=o.stream_ops.write(o,s,l,h,p,m);_||(o.position+=C);try{o.path&&I.trackingDelegate.onWriteToFile&&I.trackingDelegate.onWriteToFile(o.path)}catch(R){Pe(`FS.trackingDelegate['onWriteToFile']('${o.path}') threw an exception: ${R.message}`)}return C},allocate(o,s,l){if(I.isClosed(o))throw new I.ErrnoError(8);if(s<0||l<=0)throw new I.ErrnoError(28);if(!(o.flags&2097155))throw new I.ErrnoError(8);if(!I.isFile(o.node.mode)&&!I.isDir(o.node.mode))throw new I.ErrnoError(43);if(!o.stream_ops.allocate)throw new I.ErrnoError(138);o.stream_ops.allocate(o,s,l)},mmap(o,s,l,h,p,m){if(p&2&&!(m&2)&&(o.flags&2097155)!==2)throw new I.ErrnoError(2);if((o.flags&2097155)===1)throw new I.ErrnoError(2);if(!o.stream_ops.mmap)throw new I.ErrnoError(43);return o.stream_ops.mmap(o,s,l,h,p,m)},msync(o,s,l,h,p){return!o||!o.stream_ops.msync?0:o.stream_ops.msync(o,s,l,h,p)},munmap(o){return 0},ioctl(o,s,l){if(!o.stream_ops.ioctl)throw new I.ErrnoError(59);return o.stream_ops.ioctl(o,s,l)},readFile(o,s){if(s=s||{},s.flags=s.flags||0,s.encoding=s.encoding||"binary",s.encoding!=="utf8"&&s.encoding!=="binary")throw new Error(`Invalid encoding type "${s.encoding}"`);let l,h=I.open(o,s.flags),p=I.stat(o).size,m=new Uint8Array(p);return I.read(h,m,0,p,0),s.encoding==="utf8"?l=Yi(m,0):s.encoding==="binary"&&(l=m),I.close(h),l},writeFile(o,s,l){l=l||{},l.flags=l.flags||577;let h=I.open(o,l.flags,l.mode);if(typeof s=="string"){let p=new Uint8Array(Or(s)+1),m=to(s,p,0,p.length);I.write(h,p,0,m,void 0,l.canOwn)}else if(ArrayBuffer.isView(s))I.write(h,s,0,s.byteLength,void 0,l.canOwn);else throw new Error("Unsupported data type");I.close(h)},cwd(){return I.currentPath},chdir(o){let s=I.lookupPath(o,{follow:!0});if(s.node===null)throw new I.ErrnoError(44);if(!I.isDir(s.node.mode))throw new I.ErrnoError(54);let l=I.nodePermissions(s.node,"x");if(l)throw new I.ErrnoError(l);I.currentPath=s.path},createDefaultDirectories(){I.mkdir("/tmp"),I.mkdir("/home"),I.mkdir("/home/web_user")},createDefaultDevices(){I.mkdir("/dev"),I.registerDevice(I.makedev(1,3),{read(){return 0},write(s,l,h,p,m){return p}}),I.mkdev("/dev/null",I.makedev(1,3)),ci.register(I.makedev(5,0),ci.default_tty_ops),ci.register(I.makedev(6,0),ci.default_tty1_ops),I.mkdev("/dev/tty",I.makedev(5,0)),I.mkdev("/dev/tty1",I.makedev(6,0));let o=Ts();I.createDevice("/dev","random",o),I.createDevice("/dev","urandom",o),I.mkdir("/dev/shm"),I.mkdir("/dev/shm/tmp")},createSpecialDirectories(){I.mkdir("/proc");let o=I.mkdir("/proc/self");I.mkdir("/proc/self/fd"),I.mount({mount(){let s=I.createNode(o,"fd",16895,73);return s.node_ops={lookup(l,h){let p=+h,m=I.getStream(p);if(!m)throw new I.ErrnoError(8);let _={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink(){return m.path}}};return _.parent=_,_}},s}},{},"/proc/self/fd")},createStandardStreams(){u.stdin?I.createDevice("/dev","stdin",u.stdin):I.symlink("/dev/tty","/dev/stdin"),u.stdout?I.createDevice("/dev","stdout",null,u.stdout):I.symlink("/dev/tty","/dev/stdout"),u.stderr?I.createDevice("/dev","stderr",null,u.stderr):I.symlink("/dev/tty1","/dev/stderr");let o=I.open("/dev/stdin",0),s=I.open("/dev/stdout",1),l=I.open("/dev/stderr",1);q(o.fd===0,`invalid handle for stdin (${o.fd})`),q(s.fd===1,`invalid handle for stdout (${s.fd})`),q(l.fd===2,`invalid handle for stderr (${l.fd})`)},ensureErrnoError(){I.ErrnoError||(I.ErrnoError=function(o,s){this.node=s,this.setErrno=function(l){this.errno=l;for(let h in Ma)if(Ma[h]===l){this.code=h;break}},this.setErrno(o),this.message=Kr[o],this.stack&&(Object.defineProperty(this,"stack",{value:new Error().stack,writable:!0}),this.stack=Ba(this.stack))},I.ErrnoError.prototype=new Error,I.ErrnoError.prototype.constructor=I.ErrnoError,[44].forEach(o=>{I.genericErrors[o]=new I.ErrnoError(o),I.genericErrors[o].stack="<generic error, no stack>"}))},staticInit(){I.ensureErrnoError(),I.nameTable=new Array(4096),I.mount(ke,{},"/"),I.createDefaultDirectories(),I.createDefaultDevices(),I.createSpecialDirectories(),I.filesystems={MEMFS:ke}},init(o,s,l){q(!I.init.initialized,"FS.init was previously called. If you want to initialize later with custom parameters, remove any earlier calls (note that one is automatically added to the generated code)"),I.init.initialized=!0,I.ensureErrnoError(),u.stdin=o||u.stdin,u.stdout=s||u.stdout,u.stderr=l||u.stderr,I.createStandardStreams()},quit(){I.init.initialized=!1;let o=u._fflush;o&&o(0);for(let s=0;s<I.streams.length;s++){let l=I.streams[s];l&&I.close(l)}},getMode(o,s){let l=0;return o&&(l|=365),s&&(l|=146),l},findObject(o,s){let l=I.analyzePath(o,s);return l.exists?l.object:null},analyzePath(o,s){try{var l=I.lookupPath(o,{follow:!s});o=l.path}catch{}let h={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var l=I.lookupPath(o,{parent:!0});h.parentExists=!0,h.parentPath=l.path,h.parentObject=l.node,h.name=rt.basename(o),l=I.lookupPath(o,{follow:!s}),h.exists=!0,h.path=l.path,h.object=l.node,h.name=l.node.name,h.isRoot=l.path==="/"}catch(p){h.error=p.errno}return h},createPath(o,s,l,h){o=typeof o=="string"?o:I.getPath(o);let p=s.split("/").reverse();for(;p.length;){let _=p.pop();if(_){var m=rt.join2(o,_);try{I.mkdir(m)}catch{}o=m}}return m},createFile(o,s,l,h,p){let m=rt.join2(typeof o=="string"?o:I.getPath(o),s),_=I.getMode(h,p);return I.create(m,_)},createDataFile(o,s,l,h,p,m){let _=s?rt.join2(typeof o=="string"?o:I.getPath(o),s):o,C=I.getMode(h,p),R=I.create(_,C);if(l){if(typeof l=="string"){let P=new Array(l.length);for(let U=0,V=l.length;U<V;++U)P[U]=l.charCodeAt(U);l=P}I.chmod(R,C|146);let D=I.open(R,577);I.write(D,l,0,l.length,0,m),I.close(D),I.chmod(R,C)}return R},createDevice(o,s,l,h){let p=rt.join2(typeof o=="string"?o:I.getPath(o),s),m=I.getMode(!!l,!!h);I.createDevice.major||(I.createDevice.major=64);let _=I.makedev(I.createDevice.major++,0);return I.registerDevice(_,{open(C){C.seekable=!1},close(C){h&&h.buffer&&h.buffer.length&&h(10)},read(C,R,D,P,U){let V=0;for(let ie=0;ie<P;ie++){var re;try{re=l()}catch{throw new I.ErrnoError(29)}if(re===void 0&&V===0)throw new I.ErrnoError(6);if(re==null)break;V++,R[D+ie]=re}return V&&(C.node.timestamp=Date.now()),V},write(C,R,D,P,U){for(var V=0;V<P;V++)try{h(R[D+V])}catch{throw new I.ErrnoError(29)}return P&&(C.node.timestamp=Date.now()),V}}),I.mkdev(p,m,_)},forceLoadFile(o){if(o.isDevice||o.isFolder||o.link||o.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(Fr)try{o.contents=sc(Fr(o.url),!0),o.usedBytes=o.contents.length}catch{throw new I.ErrnoError(29)}else throw new Error("Cannot load without read() or XMLHttpRequest.")},createLazyFile(o,s,l,h,p){function m(){this.lengthKnown=!1,this.chunks=[]}if(m.prototype.get=function(D){if(D>this.length-1||D<0)return;let P=D%this.chunkSize,U=D/this.chunkSize|0;return this.getter(U)[P]},m.prototype.setDataGetter=function(D){this.getter=D},m.prototype.cacheLength=function(){let D=new XMLHttpRequest;if(D.open("HEAD",l,!1),D.send(null),!(D.status>=200&&D.status<300||D.status===304))throw new Error(`Couldn't load ${l}. Status: ${D.status}`);let P=Number(D.getResponseHeader("Content-length")),U,V=(U=D.getResponseHeader("Accept-Ranges"))&&U==="bytes",re=(U=D.getResponseHeader("Content-Encoding"))&&U==="gzip",ie=1024*1024;V||(ie=P);let fe=function(Se,z){if(Se>z)throw new Error(`invalid range (${Se}, ${z}) or no bytes requested!`);if(z>P-1)throw new Error(`only ${P} bytes available! programmer error!`);let ne=new XMLHttpRequest;if(ne.open("GET",l,!1),P!==ie&&ne.setRequestHeader("Range",`bytes=${Se}-${z}`),typeof Uint8Array<"u"&&(ne.responseType="arraybuffer"),ne.overrideMimeType&&ne.overrideMimeType("text/plain; charset=x-user-defined"),ne.send(null),!(ne.status>=200&&ne.status<300||ne.status===304))throw new Error(`Couldn't load ${l}. Status: ${ne.status}`);return ne.response!==void 0?new Uint8Array(ne.response||[]):sc(ne.responseText||"",!0)},be=this;be.setDataGetter(Se=>{let z=Se*ie,ne=(Se+1)*ie-1;if(ne=Math.min(ne,P-1),typeof be.chunks[Se]>"u"&&(be.chunks[Se]=fe(z,ne)),typeof be.chunks[Se]>"u")throw new Error("doXHR failed!");return be.chunks[Se]}),(re||!P)&&(ie=P=1,P=this.getter(0).length,ie=P,xt("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=P,this._chunkSize=ie,this.lengthKnown=!0},typeof XMLHttpRequest<"u"){if(!Oe)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";let D=new m;Object.defineProperties(D,{length:{get(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var _={isDevice:!1,contents:D}}else var _={isDevice:!1,url:l};let C=I.createFile(o,s,_,h,p);_.contents?C.contents=_.contents:_.url&&(C.contents=null,C.url=_.url),Object.defineProperties(C,{usedBytes:{get(){return this.contents.length}}});let R={};return Object.keys(C.stream_ops).forEach(D=>{let P=C.stream_ops[D];R[D]=function(){return I.forceLoadFile(C),P.apply(null,arguments)}}),R.read=function(D,P,U,V,re){I.forceLoadFile(C);let{contents:ie}=D.node;if(re>=ie.length)return 0;let fe=Math.min(ie.length-re,V);if(q(fe>=0),ie.slice)for(var be=0;be<fe;be++)P[U+be]=ie[re+be];else for(var be=0;be<fe;be++)P[U+be]=ie.get(re+be);return fe},C.stream_ops=R,C},createPreloadedFile(o,s,l,h,p,m,_,C,R,D){j.init();let P=s?Nr.resolve(rt.join2(o,s)):o,U=Ki(`cp ${P}`);function V(re){function ie(be){D&&D(),C||I.createDataFile(o,s,be,h,p,R),m&&m(),Yr(U)}let fe=!1;u.preloadPlugins.forEach(be=>{fe||be.canHandle(P)&&(be.handle(re,P,ie,()=>{_&&_(),Yr(U)}),fe=!0)}),fe||ie(re)}Xi(U),typeof l=="string"?_o(l,re=>{V(re)},_):V(l)},indexedDB(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},DB_NAME(){return`EM_FS_${window.location.pathname}`},DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB(o,s,l){s=s||function(){},l=l||function(){};let h=I.indexedDB();try{var p=h.open(I.DB_NAME(),I.DB_VERSION)}catch(m){return l(m)}p.onupgradeneeded=function(){xt("creating db"),p.result.createObjectStore(I.DB_STORE_NAME)},p.onsuccess=function(){let m=p.result.transaction([I.DB_STORE_NAME],"readwrite"),_=m.objectStore(I.DB_STORE_NAME),C=0,R=0,D=o.length;function P(){R==0?s():l()}o.forEach(U=>{let V=_.put(I.analyzePath(U).object.contents,U);V.onsuccess=function(){C++,C+R==D&&P()},V.onerror=function(){R++,C+R==D&&P()}}),m.onerror=l},p.onerror=l},loadFilesFromDB(o,s,l){s=s||function(){},l=l||function(){};let h=I.indexedDB();try{var p=h.open(I.DB_NAME(),I.DB_VERSION)}catch(m){return l(m)}p.onupgradeneeded=l,p.onsuccess=function(){let m=p.result;try{var _=m.transaction([I.DB_STORE_NAME],"readonly")}catch(V){l(V);return}let C=_.objectStore(I.DB_STORE_NAME),R=0,D=0,P=o.length;function U(){D==0?s():l()}o.forEach(V=>{let re=C.get(V);re.onsuccess=function(){I.analyzePath(V).exists&&I.unlink(V),I.createDataFile(rt.dirname(V),rt.basename(V),re.result,!0,!0,!0),R++,R+D==P&&U()},re.onerror=function(){D++,R+D==P&&U()}}),_.onerror=l},p.onerror=l},absolutePath(){y("FS.absolutePath has been removed; use PATH_FS.resolve instead")},createFolder(){y("FS.createFolder has been removed; use FS.mkdir instead")},createLink(){y("FS.createLink has been removed; use FS.symlink instead")},joinPath(){y("FS.joinPath has been removed; use PATH.join instead")},mmapAlloc(){y("FS.mmapAlloc has been replaced by the top level function mmapAlloc")},standardizePath(){y("FS.standardizePath has been removed; use PATH.normalize instead")}},at={mappings:{},DEFAULT_POLLMASK:5,umask:511,calculateAt(o,s,l){if(s[0]==="/")return s;let h;if(o===-100)h=I.cwd();else{let p=I.getStream(o);if(!p)throw new I.ErrnoError(8);h=p.path}if(s.length==0){if(!l)throw new I.ErrnoError(44);return h}return rt.join2(h,s)},doStat(o,s,l){try{var h=o(s)}catch(p){if(p&&p.node&&rt.normalize(s)!==rt.normalize(I.getPath(p.node)))return-54;throw p}return M[l>>2]=h.dev,M[l+4>>2]=0,M[l+8>>2]=h.ino,M[l+12>>2]=h.mode,M[l+16>>2]=h.nlink,M[l+20>>2]=h.uid,M[l+24>>2]=h.gid,M[l+28>>2]=h.rdev,M[l+32>>2]=0,sr=[h.size>>>0,(yt=h.size,+Math.abs(yt)>=1?yt>0?(Math.min(+Math.floor(yt/4294967296),4294967295)|0)>>>0:~~+Math.ceil((yt-+(~~yt>>>0))/4294967296)>>>0:0)],M[l+40>>2]=sr[0],M[l+44>>2]=sr[1],M[l+48>>2]=4096,M[l+52>>2]=h.blocks,M[l+56>>2]=h.atime.getTime()/1e3|0,M[l+60>>2]=0,M[l+64>>2]=h.mtime.getTime()/1e3|0,M[l+68>>2]=0,M[l+72>>2]=h.ctime.getTime()/1e3|0,M[l+76>>2]=0,sr=[h.ino>>>0,(yt=h.ino,+Math.abs(yt)>=1?yt>0?(Math.min(+Math.floor(yt/4294967296),4294967295)|0)>>>0:~~+Math.ceil((yt-+(~~yt>>>0))/4294967296)>>>0:0)],M[l+80>>2]=sr[0],M[l+84>>2]=sr[1],0},doMsync(o,s,l,h,p){let m=pt.slice(o,o+l);I.msync(s,m,p,l,h)},doMkdir(o,s){return o=rt.normalize(o),o[o.length-1]==="/"&&(o=o.substr(0,o.length-1)),I.mkdir(o,s,0),0},doMknod(o,s,l){switch(s&61440){case 32768:case 8192:case 24576:case 4096:case 49152:break;default:return-28}return I.mknod(o,s,l),0},doReadlink(o,s,l){if(l<=0)return-28;let h=I.readlink(o),p=Math.min(l,Or(h)),m=ft[s+p];return Cr(h,s,l+1),ft[s+p]=m,p},doAccess(o,s){if(s&-8)return-28;let l;if(l=I.lookupPath(o,{follow:!0}).node,!l)return-44;let h="";return s&4&&(h+="r"),s&2&&(h+="w"),s&1&&(h+="x"),h&&I.nodePermissions(l,h)?-2:0},doDup(o,s,l){let h=I.getStream(l);return h&&I.close(h),I.open(o,s,0,l,l).fd},doReadv(o,s,l,h){let p=0;for(let m=0;m<l;m++){let _=M[s+m*8>>2],C=M[s+(m*8+4)>>2],R=I.read(o,ft,_,C,h);if(R<0)return-1;if(p+=R,R<C)break}return p},doWritev(o,s,l,h){let p=0;for(let m=0;m<l;m++){let _=M[s+m*8>>2],C=M[s+(m*8+4)>>2],R=I.write(o,ft,_,C,h);if(R<0)return-1;p+=R}return p},varargs:void 0,get(){return q(at.varargs!=null),at.varargs+=4,M[at.varargs-4>>2]},getStr(o){return ur(o)},getStreamFromFD(o){let s=I.getStream(o);if(!s)throw new I.ErrnoError(8);return s},get64(o,s){return o>=0?q(s===0):q(s===-1),o}};function Ss(o,s,l){at.varargs=l;try{let p=at.getStreamFromFD(o);switch(s){case 0:{var h=at.get();if(h<0)return-28;let m;return m=I.open(p.path,p.flags,0,h),m.fd}case 1:case 2:return 0;case 3:return p.flags;case 4:{var h=at.get();return p.flags|=h,0}case 12:{var h=at.get();let _=0;return oi[h+_>>1]=2,0}case 13:case 14:return 0;case 16:case 8:return-28;case 9:return Pa(28),-1;default:return-28}}catch(p){return(typeof I>"u"||!(p instanceof I.ErrnoError))&&y(p),-p.errno}}function vs(o,s,l){at.varargs=l;try{let p=at.getStreamFromFD(o);switch(s){case 21509:case 21505:return p.tty?0:-59;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return p.tty?0:-59;case 21519:{if(!p.tty)return-59;var h=at.get();return M[h>>2]=0,0}case 21520:return p.tty?-28:-59;case 21531:{var h=at.get();return I.ioctl(p,s,h)}case 21523:return p.tty?0:-59;case 21524:return p.tty?0:-59;default:y(`bad ioctl syscall ${s}`)}}catch(p){return(typeof I>"u"||!(p instanceof I.ErrnoError))&&y(p),-p.errno}}function Rs(o,s,l,h,p,m){m<<=12;let _,C=!1;if(h&16&&o%65536!==0)return-28;if(h&32){if(_=Eo(s),!_)return-48;C=!0}else{let R=I.getStream(p);if(!R)return-8;let D=I.mmap(R,o,s,m,l,h);_=D.ptr,C=D.allocated}return at.mappings[_]={malloc:_,len:s,allocated:C,fd:p,prot:l,flags:h,offset:m},_}function Al(o,s,l,h,p,m){try{return Rs(o,s,l,h,p,m)}catch(_){return(typeof I>"u"||!(_ instanceof I.ErrnoError))&&y(_),-_.errno}}function hl(o,s,l){at.varargs=l;try{let h=at.getStr(o),p=l?at.get():0;return I.open(h,s,p).fd}catch(h){return(typeof I>"u"||!(h instanceof I.ErrnoError))&&y(h),-h.errno}}function gl(o,s){try{return o=at.getStr(o),at.doStat(I.stat,o,s)}catch(l){return(typeof I>"u"||!(l instanceof I.ErrnoError))&&y(l),-l.errno}}let pl=48,li=57;function Rn(o){if(o===void 0)return"_unknown";o=o.replace(/[^a-zA-Z0-9_]/g,"$");let s=o.charCodeAt(0);return s>=pl&&s<=li?`_${o}`:o}function Io(o,s){return o=Rn(o),new Function("body",`return function ${o}() {
    "use strict";    return body.apply(this, arguments);
};
`)(s)}let bs=[],Yt=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function La(){let o=0;for(let s=5;s<Yt.length;++s)Yt[s]!==void 0&&++o;return o}function ml(){for(let o=5;o<Yt.length;++o)if(Yt[o]!==void 0)return Yt[o];return null}function Di(){u.count_emval_handles=La,u.get_first_emval=ml}function Co(o){switch(o){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{let s=bs.length?bs.pop():Yt.length;return Yt[s]={refcount:1,value:o},s}}}function ar(o,s){let l=Io(s,function(h){this.name=s,this.message=h;let{stack:p}=new Error(h);p!==void 0&&(this.stack=`${this.toString()}
${p.replace(/^Error(:[^\n]*)?\n/,"")}`)});return l.prototype=Object.create(o.prototype),l.prototype.constructor=l,l.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},l}let Qa;function fl(){let o=new Array(256);for(let s=0;s<256;++s)o[s]=String.fromCharCode(s);xa=o}var xa=void 0;function Tt(o){let s="",l=o;for(;pt[l];)s+=xa[pt[l++]];return s}function Ua(){return Object.keys(Pr).length}function bn(){let o=[];for(let s in Pr)Pr.hasOwnProperty(s)&&o.push(Pr[s]);return o}let di=[];function ws(){for(;di.length;){let o=di.pop();o.$$.deleteScheduled=!1,o.delete()}}let wn;function El(o){wn=o,di.length&&wn&&wn(ws)}function yo(){u.getInheritedInstanceCount=Ua,u.getLiveInheritedInstances=bn,u.flushPendingDeletes=ws,u.setDelayFunction=El}var Pr={};let ui;function Le(o){throw new ui(o)}function Ds(o,s){for(s===void 0&&Le("ptr should not be undefined");o.baseClass;)s=o.upcast(s),o=o.baseClass;return s}function Fa(o,s,l){s=Ds(o,s),Pr.hasOwnProperty(s)?Le(`Tried to register registered instance: ${s}`):Pr[s]=l}function Va(o){return o||Le(`Cannot use deleted val. handle = ${o}`),Yt[o].value}let Oi={};function ja(o){let s=tn(o),l=Tt(s);return pi(s),l}function Os(o,s){let l=Oi[o];return l===void 0&&Le(`${s} has unknown type ${ja(o)}`),l}function _l(o,s){s=Ds(o,s),Pr.hasOwnProperty(s)?delete Pr[s]:Le(`Tried to unregister unregistered instance: ${s}`)}function To(o){}let Zt=!1;function So(o){o.smartPtr?o.smartPtrType.rawDestructor(o.smartPtr):o.ptrType.registeredClass.rawDestructor(o.ptr)}function ks(o){o.count.value-=1,o.count.value===0&&So(o)}function Wt(o){return typeof FinalizationGroup>"u"?(Wt=function(s){return s},o):(Zt=new FinalizationGroup(s=>{for(let l=s.next();!l.done;l=s.next()){let h=l.value;h.ptr?ks(h):console.warn(`object already deleted: ${h.ptr}`)}}),Wt=function(s){return Zt.register(s,s.$$,s.$$),s},To=function(s){Zt.unregister(s.$$)},Wt(o))}function vo(o,s,l){o=Tt(o),s=Os(s,"wrapper"),l=Va(l);let h=[].slice,{registeredClass:p}=s,m=p.instancePrototype,{baseClass:_}=p,C=_.instancePrototype,R=p.baseClass.constructor,D=Io(o,function(){p.baseClass.pureVirtualFunctions.forEach(P=>{if(this[P]===C[P])throw new Qa(`Pure virtual function ${P} must be implemented in JavaScript`)}),Object.defineProperty(this,"__parent",{value:m}),this.__construct.apply(this,h.call(arguments))});m.__construct=function(){this===m&&Le("Pass correct 'this' to __construct");let P=R.implement.apply(void 0,[this].concat(h.call(arguments)));To(P);let{$$:U}=P;P.notifyOnDestruction(),U.preservePointerOnDelete=!0,Object.defineProperties(this,{$$:{value:U}}),Wt(this),Fa(p,U.ptr,this)},m.__destruct=function(){this===m&&Le("Pass correct 'this' to __destruct"),To(this),_l(p,this.$$.ptr)},D.prototype=Object.create(m);for(let P in l)D.prototype[P]=l[P];return Co(D)}let ki={};function Ro(o){for(;o.length;){let s=o.pop();o.pop()(s)}}function v(o){return this.fromWireType(ct[o>>2])}let S={},B={},L;function J(o){throw new L(o)}function ee(o,s,l){o.forEach(C=>{B[C]=s});function h(C){let R=l(C);R.length!==o.length&&J("Mismatched type converter count");for(let D=0;D<o.length;++D)Ae(o[D],R[D])}let p=new Array(s.length),m=[],_=0;s.forEach((C,R)=>{Oi.hasOwnProperty(C)?p[R]=Oi[C]:(m.push(C),S.hasOwnProperty(C)||(S[C]=[]),S[C].push(()=>{p[R]=Oi[C],++_,_===m.length&&h(p)}))}),m.length===0&&h(p)}function oe(o){let s=ki[o];delete ki[o];let{rawConstructor:l}=s,{rawDestructor:h}=s,p=s.fields,m=p.map(_=>_.getterReturnType).concat(p.map(_=>_.setterArgumentType));ee([o],m,_=>{let C={};return p.forEach((R,D)=>{let{fieldName:P}=R,U=_[D],{getter:V}=R,{getterContext:re}=R,ie=_[D+p.length],{setter:fe}=R,{setterContext:be}=R;C[P]={read(Se){return U.fromWireType(V(re,Se))},write(Se,z){let ne=[];fe(be,Se,ie.toWireType(ne,z)),Ro(ne)}}}),[{name:s.name,fromWireType(R){let D={};for(let P in C)D[P]=C[P].read(R);return h(R),D},toWireType(R,D){for(var P in C)if(!(P in D))throw new TypeError(`Missing field:  "${P}"`);let U=l();for(P in C)C[P].write(U,D[P]);return R!==null&&R.push(h,U),U},argPackAdvance:8,readValueFromPointer:v,destructorFunction:h}]})}function $(o,s,l,h,p){}function ue(o){switch(o){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError(`Unknown type size: ${o}`)}}function Ae(o,s,l){if(l=l||{},!("argPackAdvance"in s))throw new TypeError("registerType registeredInstance requires argPackAdvance");let{name:h}=s;if(o||Le(`type "${h}" must have a positive integer typeid pointer`),Oi.hasOwnProperty(o)){if(l.ignoreDuplicateRegistrations)return;Le(`Cannot register type '${h}' twice`)}if(Oi[o]=s,delete B[o],S.hasOwnProperty(o)){let p=S[o];delete S[o],p.forEach(m=>{m()})}}function he(o,s,l,h,p){let m=ue(l);s=Tt(s),Ae(o,{name:s,fromWireType(_){return!!_},toWireType(_,C){return C?h:p},argPackAdvance:8,readValueFromPointer(_){let C;if(l===1)C=ft;else if(l===2)C=oi;else if(l===4)C=M;else throw new TypeError(`Unknown boolean type size: ${s}`);return this.fromWireType(C[_>>m])},destructorFunction:null})}function Ye(o){if(!(this instanceof Ot)||!(o instanceof Ot))return!1;let s=this.$$.ptrType.registeredClass,l=this.$$.ptr,h=o.$$.ptrType.registeredClass,p=o.$$.ptr;for(;s.baseClass;)l=s.upcast(l),s=s.baseClass;for(;h.baseClass;)p=h.upcast(p),h=h.baseClass;return s===h&&l===p}function ot(o){return{count:o.count,deleteScheduled:o.deleteScheduled,preservePointerOnDelete:o.preservePointerOnDelete,ptr:o.ptr,ptrType:o.ptrType,smartPtr:o.smartPtr,smartPtrType:o.smartPtrType}}function nt(o){function s(l){return l.$$.ptrType.registeredClass.name}Le(`${s(o)} instance already deleted`)}function Nt(){if(this.$$.ptr||nt(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;let o=Wt(Object.create(Object.getPrototypeOf(this),{$$:{value:ot(this.$$)}}));return o.$$.count.value+=1,o.$$.deleteScheduled=!1,o}function cr(){this.$$.ptr||nt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Le("Object already scheduled for deletion"),To(this),ks(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Jt(){return!this.$$.ptr}function Pt(){return this.$$.ptr||nt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Le("Object already scheduled for deletion"),di.push(this),di.length===1&&wn&&wn(ws),this.$$.deleteScheduled=!0,this}function hr(){Ot.prototype.isAliasOf=Ye,Ot.prototype.clone=Nt,Ot.prototype.delete=cr,Ot.prototype.isDeleted=Jt,Ot.prototype.deleteLater=Pt}function Ot(){}let er={};function tr(o,s,l){if(o[s].overloadTable===void 0){let h=o[s];o[s]=function(){return o[s].overloadTable.hasOwnProperty(arguments.length)||Le(`Function '${l}' called with an invalid number of arguments (${arguments.length}) - expects one of (${o[s].overloadTable})!`),o[s].overloadTable[arguments.length].apply(this,arguments)},o[s].overloadTable=[],o[s].overloadTable[h.argCount]=h}}function Dn(o,s,l){u.hasOwnProperty(o)?((l===void 0||u[o].overloadTable!==void 0&&u[o].overloadTable[l]!==void 0)&&Le(`Cannot register public name '${o}' twice`),tr(u,o,o),u.hasOwnProperty(l)&&Le(`Cannot register multiple overloads of a function with the same number of arguments (${l})!`),u[o].overloadTable[l]=s):(u[o]=s,l!==void 0&&(u[o].numArguments=l))}function Bs(o,s,l,h,p,m,_,C){this.name=o,this.constructor=s,this.instancePrototype=l,this.rawDestructor=h,this.baseClass=p,this.getActualType=m,this.upcast=_,this.downcast=C,this.pureVirtualFunctions=[]}function Zi(o,s,l){for(;s!==l;)s.upcast||Le(`Expected null or instance of ${l.name}, got an instance of ${s.name}`),o=s.upcast(o),s=s.baseClass;return o}function Bi(o,s){if(s===null)return this.isReference&&Le(`null is not a valid ${this.name}`),0;s.$$||Le(`Cannot pass "${wo(s)}" as a ${this.name}`),s.$$.ptr||Le(`Cannot pass deleted object as a pointer of type ${this.name}`);let l=s.$$.ptrType.registeredClass;return Zi(s.$$.ptr,l,this.registeredClass)}function _g(o,s){let l;if(s===null)return this.isReference&&Le(`null is not a valid ${this.name}`),this.isSmartPointer?(l=this.rawConstructor(),o!==null&&o.push(this.rawDestructor,l),l):0;s.$$||Le(`Cannot pass "${wo(s)}" as a ${this.name}`),s.$$.ptr||Le(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.isConst&&s.$$.ptrType.isConst&&Le(`Cannot convert argument of type ${s.$$.smartPtrType?s.$$.smartPtrType.name:s.$$.ptrType.name} to parameter type ${this.name}`);let h=s.$$.ptrType.registeredClass;if(l=Zi(s.$$.ptr,h,this.registeredClass),this.isSmartPointer)switch(s.$$.smartPtr===void 0&&Le("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:s.$$.smartPtrType===this?l=s.$$.smartPtr:Le(`Cannot convert argument of type ${s.$$.smartPtrType?s.$$.smartPtrType.name:s.$$.ptrType.name} to parameter type ${this.name}`);break;case 1:l=s.$$.smartPtr;break;case 2:if(s.$$.smartPtrType===this)l=s.$$.smartPtr;else{let p=s.clone();l=this.rawShare(l,Co(()=>{p.delete()})),o!==null&&o.push(this.rawDestructor,l)}break;default:Le("Unsupporting sharing policy")}return l}function Ig(o,s){if(s===null)return this.isReference&&Le(`null is not a valid ${this.name}`),0;s.$$||Le(`Cannot pass "${wo(s)}" as a ${this.name}`),s.$$.ptr||Le(`Cannot pass deleted object as a pointer of type ${this.name}`),s.$$.ptrType.isConst&&Le(`Cannot convert argument of type ${s.$$.ptrType.name} to parameter type ${this.name}`);let l=s.$$.ptrType.registeredClass;return Zi(s.$$.ptr,l,this.registeredClass)}function Ai(o){return this.rawGetPointee&&(o=this.rawGetPointee(o)),o}function Cg(o){this.rawDestructor&&this.rawDestructor(o)}function mu(o){o!==null&&o.delete()}function fu(o,s,l){if(s===l)return o;if(l.baseClass===void 0)return null;let h=fu(o,s,l.baseClass);return h===null?null:l.downcast(h)}function yg(o,s){return s=Ds(o,s),Pr[s]}function bo(o,s){(!s.ptrType||!s.ptr)&&J("makeClassHandle requires ptr and ptrType");let l=!!s.smartPtrType,h=!!s.smartPtr;return l!==h&&J("Both smartPtrType and smartPtr must be specified"),s.count={value:1},Wt(Object.create(o,{$$:{value:s}}))}function Il(o){let s=this.getPointee(o);if(!s)return this.destructor(o),null;let l=yg(this.registeredClass,s);if(l!==void 0){if(l.$$.count.value===0)return l.$$.ptr=s,l.$$.smartPtr=o,l.clone();let R=l.clone();return this.destructor(o),R}function h(){return this.isSmartPointer?bo(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:s,smartPtrType:this,smartPtr:o}):bo(this.registeredClass.instancePrototype,{ptrType:this,ptr:o})}let p=this.registeredClass.getActualType(s),m=er[p];if(!m)return h.call(this);let _;this.isConst?_=m.constPointerType:_=m.pointerType;let C=fu(s,this.registeredClass,_.registeredClass);return C===null?h.call(this):this.isSmartPointer?bo(_.registeredClass.instancePrototype,{ptrType:_,ptr:C,smartPtrType:this,smartPtr:o}):bo(_.registeredClass.instancePrototype,{ptrType:_,ptr:C})}function Tg(){Ni.prototype.getPointee=Ai,Ni.prototype.destructor=Cg,Ni.prototype.argPackAdvance=8,Ni.prototype.readValueFromPointer=v,Ni.prototype.deleteObject=mu,Ni.prototype.fromWireType=Il}function Ni(o,s,l,h,p,m,_,C,R,D,P){this.name=o,this.registeredClass=s,this.isReference=l,this.isConst=h,this.isSmartPointer=p,this.pointeeType=m,this.sharingPolicy=_,this.rawGetPointee=C,this.rawConstructor=R,this.rawShare=D,this.rawDestructor=P,!p&&s.baseClass===void 0?h?(this.toWireType=Bi,this.destructorFunction=null):(this.toWireType=Ig,this.destructorFunction=null):this.toWireType=_g}function Cl(o,s,l){u.hasOwnProperty(o)||J("Replacing nonexistant public symbol"),u[o].overloadTable!==void 0&&l!==void 0?u[o].overloadTable[l]=s:(u[o]=s,u[o].argCount=l)}function yl(o,s,l){q(`dynCall_${o}`in u,`bad function pointer type - no table for sig '${o}'`),l&&l.length?q(l.length===o.substring(1).replace(/j/g,"--").length):q(o.length==1);let h=u[`dynCall_${o}`];return l&&l.length?h.apply(null,[s].concat(l)):h.call(null,s)}function Sg(o,s,l){return o.includes("j")?yl(o,s,l):(q(ce.get(s),`missing table entry in dynCall: ${s}`),ce.get(s).apply(null,l))}function hi(o,s){q(o.includes("j"),"getDynCaller should only be called with i64 sigs");let l=[];return function(){l.length=arguments.length;for(let h=0;h<arguments.length;h++)l[h]=arguments[h];return Sg(o,s,l)}}function Mt(o,s){o=Tt(o);function l(){return o.includes("j")?hi(o,s):ce.get(s)}let h=l();return typeof h!="function"&&Le(`unknown function pointer with signature ${o}: ${s}`),h}let rr;function Xr(o,s){let l=[],h={};function p(m){if(!h[m]&&!Oi[m]){if(B[m]){B[m].forEach(p);return}l.push(m),h[m]=!0}}throw s.forEach(p),new rr(`${o}: ${l.map(ja).join([", "])}`)}function Tl(o,s,l,h,p,m,_,C,R,D,P,U,V){P=Tt(P),m=Mt(p,m),C&&(C=Mt(_,C)),D&&(D=Mt(R,D)),V=Mt(U,V);let re=Rn(P);Dn(re,()=>{Xr(`Cannot construct ${P} due to unbound types`,[h])}),ee([o,s,l],h?[h]:[],ie=>{ie=ie[0];let fe,be;h?(fe=ie.registeredClass,be=fe.instancePrototype):be=Ot.prototype;let Se=Io(re,function(){if(Object.getPrototypeOf(this)!==z)throw new ui(`Use 'new' to construct ${P}`);if(ne.constructor_body===void 0)throw new ui(`${P} has no accessible constructor`);let Sr=ne.constructor_body[arguments.length];if(Sr===void 0)throw new ui(`Tried to invoke ctor of ${P} with invalid number of parameters (${arguments.length}) - expected (${Object.keys(ne.constructor_body).toString()}) parameters instead!`);return Sr.apply(this,arguments)});var z=Object.create(be,{constructor:{value:Se}});Se.prototype=z;var ne=new Bs(P,Se,z,V,fe,m,C,D);let st=new Ni(P,ne,!0,!1,!1),et=new Ni(`${P}*`,ne,!1,!1,!1),gr=new Ni(`${P} const*`,ne,!1,!0,!1);return er[o]={pointerType:et,constPointerType:gr},Cl(re,Se),[st,et,gr]})}function Sl(o,s){if(!(o instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof o} which is not a function`);let l=Io(o.name||"unknownFunctionName",()=>{});l.prototype=o.prototype;let h=new l,p=o.apply(h,s);return p instanceof Object?p:h}function Ns(o,s,l,h,p){let m=s.length;m<2&&Le("argTypes array size mismatch! Must at least get return value and 'this' types!");let _=s[1]!==null&&l!==null,C=!1;for(var R=1;R<s.length;++R)if(s[R]!==null&&s[R].destructorFunction===void 0){C=!0;break}let D=s[0].name!=="void",P="",U="";for(var R=0;R<m-2;++R)P+=`${R!==0?", ":""}arg${R}`,U+=`${R!==0?", ":""}arg${R}Wired`;let V=`return function ${Rn(o)}(${P}) {
if (arguments.length !== ${m-2}) {
throwBindingError('function ${o} called with ' + arguments.length + ' arguments, expected ${m-2} args!');
}
`;C&&(V+=`var destructors = [];
`);let re=C?"destructors":"null",ie=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],fe=[Le,h,p,Ro,s[0],s[1]];_&&(V+=`var thisWired = classParam.toWireType(${re}, this);
`);for(var R=0;R<m-2;++R)V+=`var arg${R}Wired = argType${R}.toWireType(${re}, arg${R}); // ${s[R+2].name}
`,ie.push(`argType${R}`),fe.push(s[R+2]);if(_&&(U=`thisWired${U.length>0?", ":""}${U}`),V+=`${D?"var rv = ":""}invoker(fn${U.length>0?", ":""}${U});
`,C)V+=`runDestructors(destructors);
`;else for(var R=_?1:2;R<s.length;++R){let Se=R===1?"thisWired":`arg${R-2}Wired`;s[R].destructorFunction!==null&&(V+=`${Se}_dtor(${Se}); // ${s[R].name}
`,ie.push(`${Se}_dtor`),fe.push(s[R].destructorFunction))}return D&&(V+=`var ret = retType.fromWireType(rv);
return ret;
`),V+=`}
`,ie.push(V),Sl(Function,ie).apply(null,fe)}function Ha(o,s){let l=[];for(let h=0;h<o;h++)l.push(M[(s>>2)+h]);return l}function vg(o,s,l,h,p,m,_){let C=Ha(l,h);s=Tt(s),m=Mt(p,m),ee([],[o],R=>{R=R[0];let D=`${R.name}.${s}`;function P(){Xr(`Cannot call ${D} due to unbound types`,C)}s.startsWith("@@")&&(s=Symbol[s.substring(2)]);let U=R.registeredClass.constructor;return U[s]===void 0?(P.argCount=l-1,U[s]=P):(tr(U,s,D),U[s].overloadTable[l-1]=P),ee([],C,V=>{let re=[V[0],null].concat(V.slice(1)),ie=Ns(D,re,null,m,_);return U[s].overloadTable===void 0?(ie.argCount=l-1,U[s]=ie):U[s].overloadTable[l-1]=ie,[]}),[]})}function Rg(o,s,l,h,p,m){q(s>0);let _=Ha(s,l);p=Mt(h,p),ee([],[o],C=>{C=C[0];let R=`constructor ${C.name}`;if(C.registeredClass.constructor_body===void 0&&(C.registeredClass.constructor_body=[]),C.registeredClass.constructor_body[s-1]!==void 0)throw new ui(`Cannot register multiple constructors with identical number of parameters (${s-1}) for class '${C.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return C.registeredClass.constructor_body[s-1]=function(){Xr(`Cannot construct ${C.name} due to unbound types`,_)},ee([],_,D=>(D.splice(1,0,null),C.registeredClass.constructor_body[s-1]=Ns(R,D,null,p,m),[])),[]})}function bg(o,s,l,h,p,m,_,C){let R=Ha(l,h);s=Tt(s),m=Mt(p,m),ee([],[o],D=>{D=D[0];let P=`${D.name}.${s}`;s.startsWith("@@")&&(s=Symbol[s.substring(2)]),C&&D.registeredClass.pureVirtualFunctions.push(s);function U(){Xr(`Cannot call ${P} due to unbound types`,R)}let V=D.registeredClass.instancePrototype,re=V[s];return re===void 0||re.overloadTable===void 0&&re.className!==D.name&&re.argCount===l-2?(U.argCount=l-2,U.className=D.name,V[s]=U):(tr(V,s,P),V[s].overloadTable[l-2]=U),ee([],R,ie=>{let fe=Ns(P,ie,D,m,_);return V[s].overloadTable===void 0?(fe.argCount=l-2,V[s]=fe):V[s].overloadTable[l-2]=fe,[]}),[]})}function Eu(o,s,l){return o instanceof Object||Le(`${l} with invalid "this": ${o}`),o instanceof s.registeredClass.constructor||Le(`${l} incompatible with "this" of type ${o.constructor.name}`),o.$$.ptr||Le(`cannot call emscripten binding method ${l} on deleted object`),Zi(o.$$.ptr,o.$$.ptrType.registeredClass,s.registeredClass)}function wg(o,s,l,h,p,m,_,C,R,D){s=Tt(s),p=Mt(h,p),ee([],[o],P=>{P=P[0];let U=`${P.name}.${s}`,V={get(){Xr(`Cannot access ${U} due to unbound types`,[l,_])},enumerable:!0,configurable:!0};return R?V.set=function(){Xr(`Cannot access ${U} due to unbound types`,[l,_])}:V.set=function(re){Le(`${U} is a read-only property`)},Object.defineProperty(P.registeredClass.instancePrototype,s,V),ee([],R?[l,_]:[l],re=>{let ie=re[0],fe={get(){let be=Eu(this,P,`${U} getter`);return ie.fromWireType(p(m,be))},enumerable:!0};if(R){R=Mt(C,R);let be=re[1];fe.set=function(Se){let z=Eu(this,P,`${U} setter`),ne=[];R(D,z,be.toWireType(ne,Se)),Ro(ne)}}return Object.defineProperty(P.registeredClass.instancePrototype,s,fe),[]}),[]})}function _u(o){o>4&&--Yt[o].refcount===0&&(Yt[o]=void 0,bs.push(o))}function Dg(o,s){s=Tt(s),Ae(o,{name:s,fromWireType(l){let h=Yt[l].value;return _u(l),h},toWireType(l,h){return Co(h)},argPackAdvance:8,readValueFromPointer:v,destructorFunction:null})}function wo(o){if(o===null)return"null";let s=typeof o;return s==="object"||s==="array"||s==="function"?o.toString():`${o}`}function Iu(o,s){switch(s){case 2:return function(l){return this.fromWireType(wt[l>>2])};case 3:return function(l){return this.fromWireType(oo[l>>3])};default:throw new TypeError(`Unknown float type: ${o}`)}}function Ga(o,s,l){let h=ue(l);s=Tt(s),Ae(o,{name:s,fromWireType(p){return p},toWireType(p,m){if(typeof m!="number"&&typeof m!="boolean")throw new TypeError(`Cannot convert "${wo(m)}" to ${this.name}`);return m},argPackAdvance:8,readValueFromPointer:Iu(s,h),destructorFunction:null})}function Og(o,s,l,h,p,m){let _=Ha(s,l);o=Tt(o),p=Mt(h,p),Dn(o,()=>{Xr(`Cannot call ${o} due to unbound types`,_)},s-1),ee([],_,C=>{let R=[C[0],null].concat(C.slice(1));return Cl(o,Ns(o,R,null,p,m),s-1),[]})}function vl(o,s,l){switch(s){case 0:return l?function(h){return ft[h]}:function(h){return pt[h]};case 1:return l?function(h){return oi[h>>1]}:function(h){return si[h>>1]};case 2:return l?function(h){return M[h>>2]}:function(h){return ct[h>>2]};default:throw new TypeError(`Unknown integer type: ${o}`)}}function kg(o,s,l,h,p){s=Tt(s),p===-1&&(p=4294967295);let m=ue(l),_=function(R){return R};if(h===0){let R=32-8*l;_=function(D){return D<<R>>>R}}let C=s.includes("unsigned");Ae(o,{name:s,fromWireType:_,toWireType(R,D){if(typeof D!="number"&&typeof D!="boolean")throw new TypeError(`Cannot convert "${wo(D)}" to ${this.name}`);if(D<h||D>p)throw new TypeError(`Passing a number "${wo(D)}" from JS side to C/C++ side to an argument of type "${s}", which is outside the valid range [${h}, ${p}]!`);return C?D>>>0:D|0},argPackAdvance:8,readValueFromPointer:vl(s,m,h!==0),destructorFunction:null})}function Cu(o,s,l){let h=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][s];function p(m){m=m>>2;let _=ct,C=_[m],R=_[m+1];return new h(En,R,C)}l=Tt(l),Ae(o,{name:l,fromWireType:p,argPackAdvance:8,readValueFromPointer:p},{ignoreDuplicateRegistrations:!0})}function Bg(o,s){s=Tt(s);let l=s==="std::string";Ae(o,{name:s,fromWireType(h){let p=ct[h>>2],m;if(l){let C=h+4;for(var _=0;_<=p;++_){let R=h+4+_;if(_==p||pt[R]==0){let D=R-C,P=ur(C,D);m===void 0?m=P:(m+=String.fromCharCode(0),m+=P),C=R+1}}}else{let C=new Array(p);for(var _=0;_<p;++_)C[_]=String.fromCharCode(pt[h+4+_]);m=C.join("")}return pi(h),m},toWireType(h,p){p instanceof ArrayBuffer&&(p=new Uint8Array(p));let m,_=typeof p=="string";_||p instanceof Uint8Array||p instanceof Uint8ClampedArray||p instanceof Int8Array||Le("Cannot pass non-string to std::string"),l&&_?m=function(){return Or(p)}:m=function(){return p.length};let C=m(),R=Nn(4+C+1);if(ct[R>>2]=C,l&&_)Cr(p,R+4,C+1);else if(_)for(var D=0;D<C;++D){let P=p.charCodeAt(D);P>255&&(pi(R),Le("String has UTF-16 code units that do not fit in 8 bits")),pt[R+4+D]=P}else for(var D=0;D<C;++D)pt[R+4+D]=p[D];return h!==null&&h.push(pi,R),R},argPackAdvance:8,readValueFromPointer:v,destructorFunction(h){pi(h)}})}function Rl(o,s,l){l=Tt(l);let h,p,m,_,C;s===2?(h=gs,p=ro,_=Vr,m=function(){return si},C=1):s===4&&(h=io,p=ol,_=no,m=function(){return ct},C=2),Ae(o,{name:l,fromWireType(R){let D=ct[R>>2],P=m(),U,V=R+4;for(let re=0;re<=D;++re){let ie=R+4+re*s;if(re==D||P[ie>>C]==0){let fe=ie-V,be=h(V,fe);U===void 0?U=be:(U+=String.fromCharCode(0),U+=be),V=ie+s}}return pi(R),U},toWireType(R,D){typeof D!="string"&&Le(`Cannot pass non-string to C++ string type ${l}`);let P=_(D),U=Nn(4+P+s);return ct[U>>2]=P>>C,p(D,U+4,P+s),R!==null&&R.push(pi,U),U},argPackAdvance:8,readValueFromPointer:v,destructorFunction(R){pi(R)}})}function Ps(o,s,l,h,p,m){ki[o]={name:Tt(s),rawConstructor:Mt(l,h),rawDestructor:Mt(p,m),fields:[]}}function Ng(o,s,l,h,p,m,_,C,R,D){ki[o].fields.push({fieldName:Tt(s),getterReturnType:l,getter:Mt(h,p),getterContext:m,setterArgumentType:_,setter:Mt(C,R),setterContext:D})}function bl(o,s){s=Tt(s),Ae(o,{isVoid:!0,name:s,argPackAdvance:0,fromWireType(){},toWireType(l,h){}})}let Pg={};function wl(o){let s=Pg[o];return s===void 0?Tt(o):s}let Ms=[];function Mg(o,s,l,h){o=Ms[o],s=Va(s),l=wl(l),o(s,l,null,h)}function Lg(o){let s=Ms.length;return Ms.push(o),s}function Ya(o,s){let l=new Array(o);for(let h=0;h<o;++h)l[h]=Os(M[(s>>2)+h],`parameter ${h}`);return l}function Dl(o,s){let l=Ya(o,s),h=l[0],p=`${h.name}_$${l.slice(1).map(V=>V.name).join("_")}$`,m=["retType"],_=[h],C="";for(var R=0;R<o-1;++R)C+=`${R!==0?", ":""}arg${R}`,m.push(`argType${R}`),_.push(l[1+R]);let D=`return function ${Rn(`methodCaller_${p}`)}(handle, name, destructors, args) {
`,P=0;for(var R=0;R<o-1;++R)D+=`    var arg${R} = argType${R}.readValueFromPointer(args${P?`+${P}`:""});
`,P+=l[R+1].argPackAdvance;D+=`    var rv = handle[name](${C});
`;for(var R=0;R<o-1;++R)l[R+1].deleteObject&&(D+=`    argType${R}.deleteObject(arg${R});
`);h.isVoid||(D+=`    return retType.toWireType(destructors, rv);
`),D+=`};
`,m.push(D);let U=Sl(Function,m).apply(null,_);return Lg(U)}function Qg(o){o>4&&(Yt[o].refcount+=1)}function xg(o,s){o=Os(o,"_emval_take_value");let l=o.readValueFromPointer(s);return Co(l)}function Ug(){y()}let Fg=!0;function yu(o,s){let l;if(o===0)l=Date.now();else if((o===1||o===4)&&Fg)l=ai();else return Pa(28),-1;return M[s>>2]=l/1e3|0,M[s+4>>2]=l%1e3*1e3*1e3|0,0}function Wa(o,s){y("To use dlopen, you need to use Emscripten's linking support, see https://github.com/emscripten-core/emscripten/wiki/Linking")}function Vg(o,s){y("To use dlopen, you need to use Emscripten's linking support, see https://github.com/emscripten-core/emscripten/wiki/Linking")}let Ja=[];function jg(o,s){q(Array.isArray(Ja)),q(s%16==0),Ja.length=0;let l;for(s>>=2;l=pt[o++];){q(l===100||l===102||l===105);let h=l<105;h&&s&1&&s++,Ja.push(h?oo[s++>>1]:M[s]),++s}return Ja}function Hg(o,s,l){let h=jg(s,l);return yn.hasOwnProperty(o)||y(`No EM_ASM constant found at address ${o}`),yn[o].apply(null,h)}function Gg(){return 2147483648}function Yg(o,s,l){pt.copyWithin(o,s,s+l)}function Wg(o){y("Cannot use emscripten_pc_get_function without -s USE_OFFSET_CONVERTER")}function Jg(o){try{return Hi.grow(o-En.byteLength+65535>>>16),so(Hi.buffer),1}catch(s){Pe(`emscripten_realloc_buffer: Attempted to grow heap from ${En.byteLength} bytes to ${o} bytes, but got error: ${s}`)}}function Kg(o){let s=pt.length;o=o>>>0,q(o>s);let l=2147483648;if(o>l)return Pe(`Cannot enlarge memory, asked to go up to ${o} bytes, but the limit is ${l} bytes!`),!1;for(let p=1;p<=4;p*=2){let m=s*(1+.2/p);m=Math.min(m,o+100663296);var h=Math.min(l,Bt(Math.max(o,m),65536));if(Jg(h))return!0}return Pe(`Failed to grow the heap from ${s} bytes to ${h} bytes, not enough memory!`),!1}function Ka(o){y("Cannot use emscripten_generate_pc (needed by __builtin_return_address) without -s USE_OFFSET_CONVERTER")}let Kt={};function Do(o){o.forEach(s=>{let l=Ka();l&&(Kt[l]=s)})}function Xg(){let o=new Error().stack.split(`
`);return o[0]=="Error"&&o.shift(),Do(o),Kt.last_addr=Ka(o[2]),Kt.last_stack=o,Kt.last_addr}function zg(o,s,l){let h;Kt.last_addr==o?h=Kt.last_stack:(h=new Error().stack.split(`
`),h[0]=="Error"&&h.shift(),Do(h));let p=2;for(;h[p]&&Ka(h[p])!=o;)++p;for(var m=0;m<l&&h[m+p];++m)M[s+m*4>>2]=Ka(h[m+p]);return m}function Ol(o){let s=ai();for(;ai()-s<o;);}function On(o){let s=o.getExtension("ANGLE_instanced_arrays");if(s)return o.vertexAttribDivisor=function(l,h){s.vertexAttribDivisorANGLE(l,h)},o.drawArraysInstanced=function(l,h,p,m){s.drawArraysInstancedANGLE(l,h,p,m)},o.drawElementsInstanced=function(l,h,p,m,_){s.drawElementsInstancedANGLE(l,h,p,m,_)},1}function Tu(o){let s=o.getExtension("OES_vertex_array_object");if(s)return o.createVertexArray=function(){return s.createVertexArrayOES()},o.deleteVertexArray=function(l){s.deleteVertexArrayOES(l)},o.bindVertexArray=function(l){s.bindVertexArrayOES(l)},o.isVertexArray=function(l){return s.isVertexArrayOES(l)},1}function Su(o){let s=o.getExtension("WEBGL_draw_buffers");if(s)return o.drawBuffers=function(l,h){s.drawBuffersWEBGL(l,h)},1}function qg(o){return!!(o.dibvbi=o.getExtension("WEBGL_draw_instanced_base_vertex_base_instance"))}function $g(o){return!!(o.mdibvbi=o.getExtension("WEBGL_multi_draw_instanced_base_vertex_base_instance"))}function Zg(o){return!!(o.multiDrawWebgl=o.getExtension("WEBGL_multi_draw"))}var Q={counter:1,buffers:[],mappedBuffers:{},programs:[],framebuffers:[],renderbuffers:[],textures:[],shaders:[],vaos:[],contexts:[],offscreenCanvases:{},queries:[],samplers:[],transformFeedbacks:[],syncs:[],byteSizeByTypeRoot:5120,byteSizeByType:[1,1,2,2,4,4,4,2,3,4,8],stringCache:{},stringiCache:{},unpackAlignment:4,recordError:function(o){Q.lastError||(Q.lastError=o)},getNewId(o){let s=Q.counter++;for(let l=o.length;l<s;l++)o[l]=null;return s},MAX_TEMP_BUFFER_SIZE:2097152,numTempVertexBuffersPerSize:64,log2ceilLookup(o){return 32-Math.clz32(o===0?0:o-1)},generateTempBuffers(o,s){let l=Q.log2ceilLookup(Q.MAX_TEMP_BUFFER_SIZE);s.tempVertexBufferCounters1=[],s.tempVertexBufferCounters2=[],s.tempVertexBufferCounters1.length=s.tempVertexBufferCounters2.length=l+1,s.tempVertexBuffers1=[],s.tempVertexBuffers2=[],s.tempVertexBuffers1.length=s.tempVertexBuffers2.length=l+1,s.tempIndexBuffers=[],s.tempIndexBuffers.length=l+1;for(var h=0;h<=l;++h){s.tempIndexBuffers[h]=null,s.tempVertexBufferCounters1[h]=s.tempVertexBufferCounters2[h]=0;let p=Q.numTempVertexBuffersPerSize;s.tempVertexBuffers1[h]=[],s.tempVertexBuffers2[h]=[];let m=s.tempVertexBuffers1[h],_=s.tempVertexBuffers2[h];m.length=_.length=p;for(let C=0;C<p;++C)m[C]=_[C]=null}if(o){s.tempQuadIndexBuffer=H.createBuffer(),s.GLctx.bindBuffer(34963,s.tempQuadIndexBuffer);let p=Q.MAX_TEMP_BUFFER_SIZE>>1,m=new Uint16Array(p);var h=0;let C=0;for(;m[h++]=C,!(h>=p||(m[h++]=C+1,h>=p)||(m[h++]=C+2,h>=p)||(m[h++]=C,h>=p)||(m[h++]=C+2,h>=p)||(m[h++]=C+3,h>=p));)C+=4;s.GLctx.bufferData(34963,m,35044),s.GLctx.bindBuffer(34963,null)}},getTempVertexBuffer:function(o){let s=Q.log2ceilLookup(o),l=Q.currentContext.tempVertexBuffers1[s],h=Q.currentContext.tempVertexBufferCounters1[s];Q.currentContext.tempVertexBufferCounters1[s]=Q.currentContext.tempVertexBufferCounters1[s]+1&Q.numTempVertexBuffersPerSize-1;let p=l[h];if(p)return p;let m=H.getParameter(34964);return l[h]=H.createBuffer(),H.bindBuffer(34962,l[h]),H.bufferData(34962,1<<s,35048),H.bindBuffer(34962,m),l[h]},getTempIndexBuffer:function(o){let s=Q.log2ceilLookup(o),l=Q.currentContext.tempIndexBuffers[s];if(l)return l;let h=H.getParameter(34965);return Q.currentContext.tempIndexBuffers[s]=H.createBuffer(),H.bindBuffer(34963,Q.currentContext.tempIndexBuffers[s]),H.bufferData(34963,1<<s,35048),H.bindBuffer(34963,h),Q.currentContext.tempIndexBuffers[s]},newRenderingFrameStarted:function(){if(!Q.currentContext)return;let o=Q.currentContext.tempVertexBuffers1;Q.currentContext.tempVertexBuffers1=Q.currentContext.tempVertexBuffers2,Q.currentContext.tempVertexBuffers2=o,o=Q.currentContext.tempVertexBufferCounters1,Q.currentContext.tempVertexBufferCounters1=Q.currentContext.tempVertexBufferCounters2,Q.currentContext.tempVertexBufferCounters2=o;let s=Q.log2ceilLookup(Q.MAX_TEMP_BUFFER_SIZE);for(let l=0;l<=s;++l)Q.currentContext.tempVertexBufferCounters1[l]=0},getSource(o,s,l,h){let p="";for(let m=0;m<s;++m){let _=h?M[h+m*4>>2]:-1;p+=ur(M[l+m*4>>2],_<0?void 0:_)}return p},calcBufLength:function(o,s,l,h){if(l>0)return h*l;let p=Q.byteSizeByType[s-Q.byteSizeByTypeRoot];return o*p*h},usedTempBuffers:[],preDrawHandleClientVertexAttribBindings:function(o){Q.resetBufferBinding=!1;for(let s=0;s<Q.currentContext.maxVertexAttribs;++s){let l=Q.currentContext.clientBuffers[s];if(!l.clientside||!l.enabled)continue;Q.resetBufferBinding=!0;let h=Q.calcBufLength(l.size,l.type,l.stride,o),p=Q.getTempVertexBuffer(h);H.bindBuffer(34962,p),H.bufferSubData(34962,0,pt.subarray(l.ptr,l.ptr+h)),l.vertexAttribPointerAdaptor.call(H,s,l.size,l.type,l.normalized,l.stride,0)}},postDrawHandleClientVertexAttribBindings:function(){Q.resetBufferBinding&&H.bindBuffer(34962,Q.buffers[H.currentArrayBufferBinding])},createContext(o,s){s.renderViaOffscreenBackBuffer&&(s.preserveDrawingBuffer=!0),o.getContextSafariWebGL2Fixed||(o.getContextSafariWebGL2Fixed=o.getContext,o.getContext=function(h,p){let m=o.getContextSafariWebGL2Fixed(h,p);return h=="webgl"==m instanceof WebGLRenderingContext?m:null});let l=s.majorVersion>1?o.getContext("webgl2",s):o.getContext("webgl",s);return l?Q.registerContext(l,s):0},enableOffscreenFramebufferAttributes(o){o.renderViaOffscreenBackBuffer=!0,o.preserveDrawingBuffer=!0},createOffscreenFramebuffer(o){let s=o.GLctx,l=s.createFramebuffer();if(s.bindFramebuffer(36160,l),o.defaultFbo=l,o.defaultFboForbidBlitFramebuffer=!1,s.getContextAttributes().antialias)o.defaultFboForbidBlitFramebuffer=!0;else{let P=navigator.userAgent.toLowerCase().match(/firefox\/(\d\d)/);if(P!=null){let U=P[1];o.defaultFboForbidBlitFramebuffer=U<67}}o.defaultColorTarget=s.createTexture(),o.defaultDepthTarget=s.createRenderbuffer(),Q.resizeOffscreenFramebuffer(o),s.bindTexture(3553,o.defaultColorTarget),s.texParameteri(3553,10241,9728),s.texParameteri(3553,10240,9728),s.texParameteri(3553,10242,33071),s.texParameteri(3553,10243,33071),s.texImage2D(3553,0,6408,s.canvas.width,s.canvas.height,0,6408,5121,null),s.framebufferTexture2D(36160,36064,3553,o.defaultColorTarget,0),s.bindTexture(3553,null),s.createRenderbuffer(),s.bindRenderbuffer(36161,o.defaultDepthTarget),s.renderbufferStorage(36161,33189,s.canvas.width,s.canvas.height),s.framebufferRenderbuffer(36160,36096,36161,o.defaultDepthTarget),s.bindRenderbuffer(36161,null);let h=[-1,-1,-1,1,1,-1,1,1],p=s.createBuffer();s.bindBuffer(34962,p),s.bufferData(34962,new Float32Array(h),35044),s.bindBuffer(34962,null),o.blitVB=p;let m="attribute vec2 pos;varying lowp vec2 tex;void main() { tex = pos * 0.5 + vec2(0.5,0.5); gl_Position = vec4(pos, 0.0, 1.0); }",_=s.createShader(35633);s.shaderSource(_,m),s.compileShader(_);let C="varying lowp vec2 tex;uniform sampler2D sampler;void main() { gl_FragColor = texture2D(sampler, tex); }",R=s.createShader(35632);s.shaderSource(R,C),s.compileShader(R);let D=s.createProgram();s.attachShader(D,_),s.attachShader(D,R),s.linkProgram(D),o.blitProgram=D,o.blitPosLoc=s.getAttribLocation(D,"pos"),s.useProgram(D),s.uniform1i(s.getUniformLocation(D,"sampler"),0),s.useProgram(null),o.defaultVao=void 0,s.createVertexArray&&(o.defaultVao=s.createVertexArray(),s.bindVertexArray(o.defaultVao),s.enableVertexAttribArray(o.blitPosLoc),s.bindVertexArray(null))},resizeOffscreenFramebuffer(o){let s=o.GLctx;if(o.defaultColorTarget){let l=s.getParameter(32873);s.bindTexture(3553,o.defaultColorTarget),s.texImage2D(3553,0,6408,s.drawingBufferWidth,s.drawingBufferHeight,0,6408,5121,null),s.bindTexture(3553,l)}if(o.defaultDepthTarget){let l=s.getParameter(36007);s.bindRenderbuffer(36161,o.defaultDepthTarget),s.renderbufferStorage(36161,33189,s.drawingBufferWidth,s.drawingBufferHeight),s.bindRenderbuffer(36161,l)}},blitOffscreenFramebuffer(o){let s=o.GLctx,l=s.getParameter(3089);l&&s.disable(3089);let h=s.getParameter(36006);if(s.blitFramebuffer&&!o.defaultFboForbidBlitFramebuffer)s.bindFramebuffer(36008,o.defaultFbo),s.bindFramebuffer(36009,null),s.blitFramebuffer(0,0,s.canvas.width,s.canvas.height,0,0,s.canvas.width,s.canvas.height,16384,9728);else{let _=function(){s.vertexAttribPointer(o.blitPosLoc,2,5126,!1,0,0),s.drawArrays(5,0,4)};s.bindFramebuffer(36160,null);let C=s.getParameter(35725);s.useProgram(o.blitProgram);let R=s.getParameter(34964);s.bindBuffer(34962,o.blitVB);let D=s.getParameter(34016);s.activeTexture(33984);let P=s.getParameter(32873);s.bindTexture(3553,o.defaultColorTarget);let U=s.getParameter(3042);U&&s.disable(3042);let V=s.getParameter(2884);V&&s.disable(2884);let re=s.getParameter(2929);re&&s.disable(2929);let ie=s.getParameter(2960);if(ie&&s.disable(2960),o.defaultVao){let fe=s.getParameter(34229);s.bindVertexArray(o.defaultVao),_(),s.bindVertexArray(fe)}else{let fe={buffer:s.getVertexAttrib(o.blitPosLoc,34975),size:s.getVertexAttrib(o.blitPosLoc,34339),stride:s.getVertexAttrib(o.blitPosLoc,34340),type:s.getVertexAttrib(o.blitPosLoc,34341),normalized:s.getVertexAttrib(o.blitPosLoc,34922),pointer:s.getVertexAttribOffset(o.blitPosLoc,34373)},be=s.getParameter(34921),Se=[];for(var p=0;p<be;++p){var m=s.getVertexAttrib(p,34338);let z=p==o.blitPosLoc;m&&!z&&s.disableVertexAttribArray(p),!m&&z&&s.enableVertexAttribArray(p),Se[p]=m}_();for(var p=0;p<be;++p){var m=Se[p];let st=p==o.blitPosLoc;m&&!st&&s.enableVertexAttribArray(p),!m&&st&&s.disableVertexAttribArray(p)}s.bindBuffer(34962,fe.buffer),s.vertexAttribPointer(o.blitPosLoc,fe.size,fe.type,fe.normalized,fe.stride,fe.offset)}ie&&s.enable(2960),re&&s.enable(2929),V&&s.enable(2884),U&&s.enable(3042),s.bindTexture(3553,P),s.activeTexture(D),s.bindBuffer(34962,R),s.useProgram(C)}s.bindFramebuffer(36160,h),l&&s.enable(3089)},registerContext(o,s){let l=Q.getNewId(Q.contexts),h={handle:l,attributes:s,version:s.majorVersion,GLctx:o};o.canvas&&(o.canvas.GLctxObject=h),Q.contexts[l]=h,(typeof s.enableExtensionsByDefault>"u"||s.enableExtensionsByDefault)&&Q.initExtensions(h),h.maxVertexAttribs=h.GLctx.getParameter(34921),h.clientBuffers=[];for(let p=0;p<h.maxVertexAttribs;p++)h.clientBuffers[p]={enabled:!1,clientside:!1,size:0,type:0,normalized:0,stride:0,ptr:0,vertexAttribPointerAdaptor:null};return Q.generateTempBuffers(!1,h),s.renderViaOffscreenBackBuffer&&Q.createOffscreenFramebuffer(h),l},makeContextCurrent(o){return Q.currentContext=Q.contexts[o],u.ctx=H=Q.currentContext&&Q.currentContext.GLctx,!(o&&!H)},getContext(o){return Q.contexts[o]},deleteContext(o){Q.currentContext===Q.contexts[o]&&(Q.currentContext=null),typeof We=="object"&&We.removeAllHandlersOnTarget(Q.contexts[o].GLctx.canvas),Q.contexts[o]&&Q.contexts[o].GLctx.canvas&&(Q.contexts[o].GLctx.canvas.GLctxObject=void 0),Q.contexts[o]=null},initExtensions(o){if(o||(o=Q.currentContext),o.initExtensionsDone)return;o.initExtensionsDone=!0;let{GLctx:s}=o;On(s),Tu(s),Su(s),qg(s),$g(s),o.version>=2&&(s.disjointTimerQueryExt=s.getExtension("EXT_disjoint_timer_query_webgl2")),(o.version<2||!s.disjointTimerQueryExt)&&(s.disjointTimerQueryExt=s.getExtension("EXT_disjoint_timer_query")),Zg(s),(s.getSupportedExtensions()||[]).forEach(l=>{!l.includes("lose_context")&&!l.includes("debug")&&s.getExtension(l)})}},We={inEventHandler:0,removeAllEventListeners(){for(let o=We.eventHandlers.length-1;o>=0;--o)We._removeHandler(o);We.eventHandlers=[],We.deferredCalls=[]},registerRemoveEventListeners(){We.removeEventListenersRegistered||(We.removeEventListenersRegistered=!0)},deferredCalls:[],deferCall(o,s,l){function h(p,m){if(p.length!=m.length)return!1;for(let _ in p)if(p[_]!=m[_])return!1;return!0}for(let p in We.deferredCalls){let m=We.deferredCalls[p];if(m.targetFunction==o&&h(m.argsList,l))return}We.deferredCalls.push({targetFunction:o,precedence:s,argsList:l}),We.deferredCalls.sort((p,m)=>p.precedence<m.precedence)},removeDeferredCalls(o){for(let s=0;s<We.deferredCalls.length;++s)We.deferredCalls[s].targetFunction==o&&(We.deferredCalls.splice(s,1),--s)},canPerformEventHandlerRequests(){return We.inEventHandler&&We.currentEventHandler.allowsDeferredCalls},runDeferredCalls(){if(We.canPerformEventHandlerRequests())for(let o=0;o<We.deferredCalls.length;++o){let s=We.deferredCalls[o];We.deferredCalls.splice(o,1),--o,s.targetFunction.apply(null,s.argsList)}},eventHandlers:[],removeAllHandlersOnTarget(o,s){for(let l=0;l<We.eventHandlers.length;++l)We.eventHandlers[l].target==o&&(!s||s==We.eventHandlers[l].eventTypeString)&&We._removeHandler(l--)},_removeHandler(o){let s=We.eventHandlers[o];s.target.removeEventListener(s.eventTypeString,s.eventListenerFunc,s.useCapture),We.eventHandlers.splice(o,1)},registerOrRemoveHandler(o){let s=function(l){++We.inEventHandler,We.currentEventHandler=o,We.runDeferredCalls(),o.handlerFunc(l),We.runDeferredCalls(),--We.inEventHandler};if(o.callbackfunc)o.eventListenerFunc=s,o.target.addEventListener(o.eventTypeString,s,o.useCapture),We.eventHandlers.push(o),We.registerRemoveEventListeners();else for(let l=0;l<We.eventHandlers.length;++l)We.eventHandlers[l].target==o.target&&We.eventHandlers[l].eventTypeString==o.eventTypeString&&We._removeHandler(l--)},getNodeNameForTarget(o){return o?o==window?"#window":o==screen?"#screen":o&&o.nodeName?o.nodeName:"":""},fullscreenEnabled(){return document.fullscreenEnabled||document.webkitFullscreenEnabled}};let vu=["default","low-power","high-performance"],Ru=[0,typeof document<"u"?document:0,typeof window<"u"?window:0];function ep(o){Ge("Rules for selecting event targets in HTML5 API are changing: instead of using document.getElementById() that only can refer to elements by their DOM ID, new event target selection mechanism uses the more flexible function document.querySelector() that can look up element names, classes, and complex CSS selectors. Build with -s DISABLE_DEPRECATED_FIND_EVENT_TARGET_BEHAVIOR=1 to change to the new lookup rules. See https://github.com/emscripten-core/emscripten/pull/7977 for more details.");try{return!o||(typeof o=="number"&&(o=Ru[o]||ur(o)),o==="#window")?window:o==="#document"?document:o==="#screen"?screen:o==="#canvas"?u.canvas:typeof o=="string"?document.getElementById(o):o}catch{return null}}function kl(o){return typeof o=="number"&&(o=ur(o)),!o||o==="#canvas"?typeof Q<"u"&&Q.offscreenCanvases.canvas?Q.offscreenCanvases.canvas:u.canvas:typeof Q<"u"&&Q.offscreenCanvases[o]?Q.offscreenCanvases[o]:ep(o)}function tp(o,s){q(s);let l=s>>2,h=M[l+6],p={alpha:!!M[l+0],depth:!!M[l+1],stencil:!!M[l+2],antialias:!!M[l+3],premultipliedAlpha:!!M[l+4],preserveDrawingBuffer:!!M[l+5],powerPreference:vu[h],failIfMajorPerformanceCaveat:!!M[l+7],majorVersion:M[l+8],minorVersion:M[l+9],enableExtensionsByDefault:M[l+10],explicitSwapControl:M[l+11],proxyContextToMainThread:M[l+12],renderViaOffscreenBackBuffer:M[l+13]},m=kl(o);if(!m)return 0;if(m.offscreenCanvas&&(m=m.offscreenCanvas),p.explicitSwapControl&&(m.transferControlToOffscreen||typeof OffscreenCanvas<"u"&&m instanceof OffscreenCanvas||p.renderViaOffscreenBackBuffer||(p.renderViaOffscreenBackBuffer=!0),m.transferControlToOffscreen)){if(!m.controlTransferredOffscreen)Q.offscreenCanvases[m.id]={canvas:m.transferControlToOffscreen(),canvasSharedPtr:Nn(12),id:m.id},m.controlTransferredOffscreen=!0;else if(!Q.offscreenCanvases[m.id])return 0;m=Q.offscreenCanvases[m.id]}return Q.createContext(m,p)}function bu(o,s){return tp(o,s)}function rp(){return Q.currentContext?Q.currentContext.handle:0}function wu(){return rp()}u._emscripten_webgl_get_current_context=wu;function Du(o){return Q.makeContextCurrent(o)?0:-5}u._emscripten_webgl_make_context_current=Du;function Ls(o){Q.currentContext==o&&(Q.currentContext=0),Q.deleteContext(o)}function ip(o,s){if(!s)return-5;if(o=Q.contexts[o],!o)return-3;let l=o.GLctx;if(!l)return-3;l=l.getContextAttributes(),M[s>>2]=l.alpha,M[s+4>>2]=l.depth,M[s+8>>2]=l.stencil,M[s+12>>2]=l.antialias,M[s+16>>2]=l.premultipliedAlpha,M[s+20>>2]=l.preserveDrawingBuffer;let h=l.powerPreference&&vu.indexOf(l.powerPreference);return M[s+24>>2]=h,M[s+28>>2]=l.failIfMajorPerformanceCaveat,M[s+32>>2]=o.version,M[s+36>>2]=0,M[s+40>>2]=o.attributes.enableExtensionsByDefault,0}function np(o){q(o);let s=o>>2;for(let l=0;l<14;++l)M[s+l]=0;M[s+0]=M[s+1]=M[s+3]=M[s+4]=M[s+8]=M[s+10]=1}let Bl={};function op(){return Ht||"./this.program"}function kn(){if(!kn.strings){let s={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:`${(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")}.UTF-8`,_:op()};for(var o in Bl)Bl[o]===void 0?delete s[o]:s[o]=Bl[o];let l=[];for(var o in s)l.push(`${o}=${s[o]}`);kn.strings=l}return kn.strings}function Nl(o,s){let l=0;return kn().forEach((h,p)=>{let m=s+l;M[o+p*4>>2]=m,al(h,m),l+=h.length+1}),0}function sp(o,s){let l=kn();M[o>>2]=l.length;let h=0;return l.forEach(p=>{h+=p.length+1}),M[s>>2]=h,0}function ap(o){try{let s=at.getStreamFromFD(o);return I.close(s),0}catch(s){return(typeof I>"u"||!(s instanceof I.ErrnoError))&&y(s),s.errno}}function cp(o,s,l,h){try{let p=at.getStreamFromFD(o),m=at.doReadv(p,s,l);return M[h>>2]=m,0}catch(p){return(typeof I>"u"||!(p instanceof I.ErrnoError))&&y(p),p.errno}}function lp(o,s,l,h,p){try{let m=at.getStreamFromFD(o),_=l*4294967296+(s>>>0),C=9007199254740992;return _<=-C||_>=C?-61:(I.llseek(m,_,h),sr=[m.position>>>0,(yt=m.position,+Math.abs(yt)>=1?yt>0?(Math.min(+Math.floor(yt/4294967296),4294967295)|0)>>>0:~~+Math.ceil((yt-+(~~yt>>>0))/4294967296)>>>0:0)],M[p>>2]=sr[0],M[p+4>>2]=sr[1],m.getdents&&_===0&&h===0&&(m.getdents=null),0)}catch(m){return(typeof I>"u"||!(m instanceof I.ErrnoError))&&y(m),m.errno}}function dp(o,s,l,h){try{let p=at.getStreamFromFD(o),m=at.doWritev(p,s,l);return M[h>>2]=m,0}catch(p){return(typeof I>"u"||!(p instanceof I.ErrnoError))&&y(p),p.errno}}function up(){return ni()}function gt(o,s){gt.randomDevice||(gt.randomDevice=Ts());for(let l=0;l<s;l++)ft[o+l>>0]=gt.randomDevice();return 0}function Ap(o){H.activeTexture(o)}function hp(o,s){H.attachShader(Q.programs[o],Q.shaders[s])}function gp(o,s,l){H.bindAttribLocation(Q.programs[o],s,ur(l))}function pp(o,s){o==34962?H.currentArrayBufferBinding=s:o==34963&&(H.currentElementArrayBufferBinding=s),o==35051?H.currentPixelPackBufferBinding=s:o==35052&&(H.currentPixelUnpackBufferBinding=s),H.bindBuffer(o,Q.buffers[s])}function mp(o,s,l){H.bindBufferBase(o,s,Q.buffers[l])}function Ou(o,s){H.bindFramebuffer(o,s?Q.framebuffers[s]:Q.currentContext.defaultFbo)}function Pl(o,s){H.bindTexture(o,Q.textures[s])}function fp(o){H.bindVertexArray(Q.vaos[o]);let s=H.getParameter(34965);H.currentElementArrayBufferBinding=s?s.name|0:0}function Xa(o,s,l,h){Q.currentContext.version>=2?l?H.bufferData(o,pt,h,l,s):H.bufferData(o,s,h):H.bufferData(o,l?pt.subarray(l,l+s):s,h)}function Ep(o,s){return q(s===(s|0)),(o>>>0)+s*4294967296}function _p(o,s,l,h){return H.clientWaitSync(Q.syncs[o],s,Ep(l,h))}function Ip(o){H.compileShader(Q.shaders[o])}function ku(){let o=Q.getNewId(Q.programs),s=H.createProgram();return s.name=o,s.maxUniformLength=s.maxAttributeLength=s.maxUniformBlockNameLength=0,s.uniformIdCounter=1,Q.programs[o]=s,o}function Cp(o){let s=Q.getNewId(Q.shaders);return Q.shaders[s]=H.createShader(o),s}function Ml(o,s){for(let l=0;l<o;l++){let h=M[s+l*4>>2],p=Q.buffers[h];p&&(H.deleteBuffer(p),p.name=0,Q.buffers[h]=null,h==H.currentArrayBufferBinding&&(H.currentArrayBufferBinding=0),h==H.currentElementArrayBufferBinding&&(H.currentElementArrayBufferBinding=0),h==H.currentPixelPackBufferBinding&&(H.currentPixelPackBufferBinding=0),h==H.currentPixelUnpackBufferBinding&&(H.currentPixelUnpackBufferBinding=0))}}function Bu(o,s){for(let l=0;l<o;++l){let h=M[s+l*4>>2],p=Q.framebuffers[h];p&&(H.deleteFramebuffer(p),p.name=0,Q.framebuffers[h]=null)}}function yp(o){if(!o)return;let s=Q.programs[o];if(!s){Q.recordError(1281);return}H.deleteProgram(s),s.name=0,Q.programs[o]=null}function Ll(o){if(!o)return;let s=Q.shaders[o];if(!s){Q.recordError(1281);return}H.deleteShader(s),Q.shaders[o]=null}function Tp(o){if(!o)return;let s=Q.syncs[o];if(!s){Q.recordError(1281);return}H.deleteSync(s),s.name=0,Q.syncs[o]=null}function Sp(o,s){for(let l=0;l<o;l++){let h=M[s+l*4>>2],p=Q.textures[h];p&&(H.deleteTexture(p),p.name=0,Q.textures[h]=null)}}function Nu(o,s){for(let l=0;l<o;l++){let h=M[s+l*4>>2];H.deleteVertexArray(Q.vaos[h]),Q.vaos[h]=null}}function Oo(o){H.disable(o)}function vp(o){let s=Q.currentContext.clientBuffers[o];s.enabled=!1,H.disableVertexAttribArray(o)}function Rp(o,s,l){Q.preDrawHandleClientVertexAttribBindings(s+l),H.drawArrays(o,s,l),Q.postDrawHandleClientVertexAttribBindings()}let Pu=[];function bp(o,s){let l=Pu[o];for(let h=0;h<o;h++)l[h]=M[s+h*4>>2];H.drawBuffers(l)}function wp(o){let s=Q.currentContext.clientBuffers[o];s.enabled=!0,H.enableVertexAttribArray(o)}function Dp(o,s){let l=H.fenceSync(o,s);if(l){let h=Q.getNewId(Q.syncs);return l.name=h,Q.syncs[h]=l,h}return 0}function Mu(){H.finish()}function Op(){H.flush()}function kp(o,s,l,h,p){H.framebufferTexture2D(o,s,l,Q.textures[h],p)}function Bp(o,s,l,h,p){H.framebufferTextureLayer(o,s,Q.textures[l],h,p)}function za(o,s,l,h){for(let p=0;p<o;p++){let m=H[l](),_=m&&Q.getNewId(h);m?(m.name=_,h[_]=m):Q.recordError(1282),M[s+p*4>>2]=_}}function Np(o,s){za(o,s,"createBuffer",Q.buffers)}function Pp(o,s){za(o,s,"createFramebuffer",Q.framebuffers)}function Mp(o,s){za(o,s,"createTexture",Q.textures)}function Lp(o,s){za(o,s,"createVertexArray",Q.vaos)}function ko(o,s){return H.getAttribLocation(Q.programs[o],ur(s))}function Qp(){let o=H.getError()||Q.lastError;return Q.lastError=0,o}function xp(o){return ct[o>>2]+M[o+4>>2]*4294967296}function Up(o){return ct[o>>2]+ct[o+4>>2]*4294967296}function Fp(o,s){ct[o>>2]=s,ct[o+4>>2]=(s-ct[o>>2])/4294967296;let l=s>=0?Up(o):xp(o);l!=s&&Ge(`writeI53ToI64() out of range: serialized JS Number ${s} to Wasm heap as bytes lo=0x${ct[o>>2].toString(16)}, hi=0x${ct[o+4>>2].toString(16)}, which deserializes back to ${l} instead!`)}function Lu(o,s,l){if(!s){Q.recordError(1281);return}let h;switch(o){case 36346:h=1;break;case 36344:l!=0&&l!=1&&Q.recordError(1280);return;case 34814:case 36345:h=0;break;case 34466:var p=H.getParameter(34467);h=p?p.length:0;break;case 33309:if(Q.currentContext.version<2){Q.recordError(1282);return}var m=H.getSupportedExtensions()||[];h=2*m.length;break;case 33307:case 33308:if(Q.currentContext.version<2){Q.recordError(1280);return}h=o==33307?3:0;break}if(h===void 0){let _=H.getParameter(o);switch(typeof _){case"number":h=_;break;case"boolean":h=_?1:0;break;case"string":Q.recordError(1280);return;case"object":if(_===null)switch(o){case 34964:case 35725:case 34965:case 36006:case 36007:case 32873:case 34229:case 36662:case 36663:case 35053:case 35055:case 36010:case 35097:case 35869:case 32874:case 36389:case 35983:case 35368:case 34068:{h=0;break}default:{Q.recordError(1280);return}}else if(_ instanceof Float32Array||_ instanceof Uint32Array||_ instanceof Int32Array||_ instanceof Array){for(let C=0;C<_.length;++C)switch(l){case 0:M[s+C*4>>2]=_[C];break;case 2:wt[s+C*4>>2]=_[C];break;case 4:ft[s+C>>0]=_[C]?1:0;break}return}else try{h=_.name|0}catch(C){Q.recordError(1280),Pe(`GL_INVALID_ENUM in glGet${l}v: Unknown object returned from WebGL getParameter(${o})! (error: ${C})`);return}break;default:Q.recordError(1280),Pe(`GL_INVALID_ENUM in glGet${l}v: Native code calling glGet${l}v(${o}) and it returns ${_} of type ${typeof _}!`);return}}switch(l){case 1:Fp(s,h);break;case 0:M[s>>2]=h;break;case 2:wt[s>>2]=h;break;case 4:ft[s>>0]=h?1:0;break}}function Qu(o,s){Lu(o,s,0)}function qa(o){let s=Or(o)+1,l=Nn(s);return Cr(o,l,s),l}function Vp(o){let s=Q.stringCache[o];if(!s){switch(o){case 7939:var l=H.getSupportedExtensions()||[];l=l.concat(l.map(R=>`GL_${R}`)),s=qa(l.join(" "));break;case 7936:case 7937:case 37445:case 37446:var h=H.getParameter(o);h||Q.recordError(1280),s=h&&qa(h);break;case 7938:var p=H.getParameter(7938);Q.currentContext.version>=2?p=`OpenGL ES 3.0 (${p})`:p=`OpenGL ES 2.0 (${p})`,s=qa(p);break;case 35724:var m=H.getParameter(35724),_=/^WebGL GLSL ES ([0-9]\.[0-9][0-9]?)(?:$| .*)/,C=m.match(_);C!==null&&(C[1].length==3&&(C[1]=`${C[1]}0`),m=`OpenGL ES GLSL ES ${C[1]} (${m})`),s=qa(m);break;default:Q.recordError(1280)}Q.stringCache[o]=s}return s}function Ql(o,s){return H.getUniformBlockIndex(Q.programs[o],ur(s))}function jp(o){return parseInt(o)}function xu(o){return o.slice(-1)=="]"&&o.lastIndexOf("[")}function Hp(o){let{uniformLocsById:s}=o,{uniformSizeAndIdsByName:l}=o,h,p;if(!s)for(o.uniformLocsById=s={},o.uniformArrayNamesById={},h=0;h<H.getProgramParameter(o,35718);++h){let m=H.getActiveUniform(o,h),_=m.name,C=m.size,R=xu(_),D=R>0?_.slice(0,R):_,P=o.uniformIdCounter;for(o.uniformIdCounter+=C,l[D]=[C,P],p=0;p<C;++p)s[P]=p,o.uniformArrayNamesById[P++]=D}}function Uu(o,s){if(s=ur(s),o=Q.programs[o]){Hp(o);let{uniformLocsById:l}=o,h=0,p=s,m=xu(s);m>0&&(h=jp(s.slice(m+1))>>>0,p=s.slice(0,m));let _=o.uniformSizeAndIdsByName[p];if(_&&h<_[0]&&(h+=_[1],l[h]=l[h]||H.getUniformLocation(o,s)))return h}else Q.recordError(1281);return-1}function $a(o){o=Q.programs[o],H.linkProgram(o),o.uniformLocsById=0,o.uniformSizeAndIdsByName={}}function Qs(o,s){o==3317&&(Q.unpackAlignment=s),H.pixelStorei(o,s)}function Fu(o,s,l,h){function p(C,R){return C+R-1&-R}let m=o*l,_=p(m,h);return s*_}function xs(o){return{5:3,6:4,8:2,29502:3,29504:4,26917:2,26918:2,29846:3,29847:4}[o-6402]||1}function Bo(o){return o-=5120,o==0?ft:o==1?pt:o==2?oi:o==4?M:o==6?wt:o==5||o==28922||o==28520||o==30779||o==30782?ct:si}function Us(o){return 31-Math.clz32(o.BYTES_PER_ELEMENT)}function Za(o,s,l,h,p,m){let _=Bo(o),C=Us(_),R=1<<C,D=xs(s)*R,P=Fu(l,h,D,Q.unpackAlignment);return _.subarray(p>>C,p+P>>C)}function Vu(o,s,l,h,p,m,_){if(Q.currentContext.version>=2){if(H.currentPixelPackBufferBinding)H.readPixels(o,s,l,h,p,m,_);else{let R=Bo(m);H.readPixels(o,s,l,h,p,m,R,_>>Us(R))}return}let C=Za(m,p,l,h,_);if(!C){Q.recordError(1280);return}H.readPixels(o,s,l,h,p,m,C)}function Gp(o,s,l,h){let p=Q.getSource(o,s,l,h);H.shaderSource(Q.shaders[o],p)}function xl(o,s,l,h,p,m,_,C,R){if(Q.currentContext.version>=2){if(H.currentPixelUnpackBufferBinding)H.texImage2D(o,s,l,h,p,m,_,C,R);else if(R){let D=Bo(C);H.texImage2D(o,s,l,h,p,m,_,C,D,R>>Us(D))}else H.texImage2D(o,s,l,h,p,m,_,C,null);return}H.texImage2D(o,s,l,h,p,m,_,C,R?Za(C,_,h,p,R):null)}function ju(o,s,l){let h=wt[l>>2];H.texParameterf(o,s,h)}function Hu(o,s,l){H.texParameteri(o,s,l)}function Yp(o,s,l,h,p){H.texStorage2D(o,s,l,h,p)}function Wp(o,s,l,h,p,m){H.texStorage3D(o,s,l,h,p,m)}function Gu(o,s,l,h,p,m,_,C,R){if(Q.currentContext.version>=2){if(H.currentPixelUnpackBufferBinding)H.texSubImage2D(o,s,l,h,p,m,_,C,R);else if(R){let P=Bo(C);H.texSubImage2D(o,s,l,h,p,m,_,C,P,R>>Us(P))}else H.texSubImage2D(o,s,l,h,p,m,_,C,null);return}let D=null;R&&(D=Za(C,_,p,m,R)),H.texSubImage2D(o,s,l,h,p,m,_,C,D)}function Jp(o,s,l,h,p,m,_,C,R,D,P){if(H.currentPixelUnpackBufferBinding)H.texSubImage3D(o,s,l,h,p,m,_,C,R,D,P);else if(P){let U=Bo(D);H.texSubImage3D(o,s,l,h,p,m,_,C,R,D,U,P>>Us(U))}else H.texSubImage3D(o,s,l,h,p,m,_,C,R,D,null)}function zr(o){let s=H.currentProgram;if(s){let l=s.uniformLocsById[o];return typeof l=="number"&&(s.uniformLocsById[o]=l=H.getUniformLocation(s,s.uniformArrayNamesById[o]+(l>0?`[${l}]`:""))),l}Q.recordError(1282)}function Kp(o,s){H.uniform1f(zr(o),s)}function Xp(o,s){H.uniform1i(zr(o),s)}let ec=[];function Yu(o,s,l){if(Q.currentContext.version>=2){H.uniform2fv(zr(o),wt,l>>2,s*2);return}if(s<=144){var h=ec[2*s-1];for(let m=0;m<2*s;m+=2)h[m]=wt[l+4*m>>2],h[m+1]=wt[l+(4*m+4)>>2]}else var h=wt.subarray(l>>2,l+s*8>>2);H.uniform2fv(zr(o),h)}function Wu(o,s,l){if(Q.currentContext.version>=2){H.uniform4fv(zr(o),wt,l>>2,s*4);return}if(s<=72){var h=ec[4*s-1];let m=wt;l>>=2;for(let _=0;_<4*s;_+=4){let C=l+_;h[_]=m[C],h[_+1]=m[C+1],h[_+2]=m[C+2],h[_+3]=m[C+3]}}else var h=wt.subarray(l>>2,l+s*16>>2);H.uniform4fv(zr(o),h)}let tc=[];function Ju(o,s,l){if(Q.currentContext.version>=2){H.uniform4iv(zr(o),M,l>>2,s*4);return}if(s<=72){var h=tc[4*s-1];for(let m=0;m<4*s;m+=4)h[m]=M[l+4*m>>2],h[m+1]=M[l+(4*m+4)>>2],h[m+2]=M[l+(4*m+8)>>2],h[m+3]=M[l+(4*m+12)>>2]}else var h=M.subarray(l>>2,l+s*16>>2);H.uniform4iv(zr(o),h)}function Ku(o,s,l){o=Q.programs[o],H.uniformBlockBinding(o,s,l)}function Xu(o,s,l,h){if(Q.currentContext.version>=2){H.uniformMatrix4fv(zr(o),!!l,wt,h>>2,s*16);return}if(s<=18){var p=ec[16*s-1];let _=wt;h>>=2;for(let C=0;C<16*s;C+=16){let R=h+C;p[C]=_[R],p[C+1]=_[R+1],p[C+2]=_[R+2],p[C+3]=_[R+3],p[C+4]=_[R+4],p[C+5]=_[R+5],p[C+6]=_[R+6],p[C+7]=_[R+7],p[C+8]=_[R+8],p[C+9]=_[R+9],p[C+10]=_[R+10],p[C+11]=_[R+11],p[C+12]=_[R+12],p[C+13]=_[R+13],p[C+14]=_[R+14],p[C+15]=_[R+15]}}else var p=wt.subarray(h>>2,h+s*64>>2);H.uniformMatrix4fv(zr(o),!!l,p)}function zu(o){o=Q.programs[o],H.useProgram(o),H.currentProgram=o}function zp(o,s,l,h,p,m){let _=Q.currentContext.clientBuffers[o];if(!H.currentArrayBufferBinding){_.size=s,_.type=l,_.normalized=h,_.stride=p,_.ptr=m,_.clientside=!0,_.vertexAttribPointerAdaptor=function(C,R,D,P,U,V){this.vertexAttribPointer(C,R,D,P,U,V)};return}_.clientside=!1,H.vertexAttribPointer(o,s,l,!!h,p,m)}function Fs(o,s,l,h){H.viewport(o,s,l,h)}function No(o,s){let l=new Date(M[o>>2]*1e3);M[s>>2]=l.getUTCSeconds(),M[s+4>>2]=l.getUTCMinutes(),M[s+8>>2]=l.getUTCHours(),M[s+12>>2]=l.getUTCDate(),M[s+16>>2]=l.getUTCMonth(),M[s+20>>2]=l.getUTCFullYear()-1900,M[s+24>>2]=l.getUTCDay(),M[s+36>>2]=0,M[s+32>>2]=0;let h=Date.UTC(l.getUTCFullYear(),0,1,0,0,0,0),p=(l.getTime()-h)/(1e3*60*60*24)|0;return M[s+28>>2]=p,No.GMTString||(No.GMTString=or("GMT")),M[s+40>>2]=No.GMTString,s}function qu(o){return o}function Po(){if(Po.called)return;Po.called=!0;let o=new Date().getFullYear(),s=new Date(o,0,1),l=new Date(o,6,1),h=s.getTimezoneOffset(),p=l.getTimezoneOffset(),m=Math.max(h,p);M[em()>>2]=m*60,M[rA()>>2]=+(h!=p);function _(U){let V=U.toTimeString().match(/\(([A-Za-z ]+)\)$/);return V?V[1]:"GMT"}let C=_(s),R=_(l),D=or(C),P=or(R);p<h?(M[js()>>2]=D,M[js()+4>>2]=P):(M[js()>>2]=P,M[js()+4>>2]=D)}function $u(o,s){Po();let l=new Date(M[o>>2]*1e3);M[s>>2]=l.getSeconds(),M[s+4>>2]=l.getMinutes(),M[s+8>>2]=l.getHours(),M[s+12>>2]=l.getDate(),M[s+16>>2]=l.getMonth(),M[s+20>>2]=l.getFullYear()-1900,M[s+24>>2]=l.getDay();let h=new Date(l.getFullYear(),0,1),p=(l.getTime()-h.getTime())/(1e3*60*60*24)|0;M[s+28>>2]=p,M[s+36>>2]=-(l.getTimezoneOffset()*60);let m=new Date(l.getFullYear(),6,1).getTimezoneOffset(),_=h.getTimezoneOffset(),C=(m!=_&&l.getTimezoneOffset()==Math.min(_,m))|0;M[s+32>>2]=C;let R=M[js()+(C?4:0)>>2];return M[s+40>>2]=R,s}function Ul(o){Po();let s=new Date(M[o+20>>2]+1900,M[o+16>>2],M[o+12>>2],M[o+8>>2],M[o+4>>2],M[o>>2],0),l=M[o+32>>2],h=s.getTimezoneOffset(),p=new Date(s.getFullYear(),0,1),m=new Date(s.getFullYear(),6,1).getTimezoneOffset(),_=p.getTimezoneOffset(),C=Math.min(_,m);if(l<0)M[o+32>>2]=+(m!=_&&C==h);else if(l>0!=(C==h)){let D=Math.max(_,m),P=l>0?C:D;s.setTime(s.getTime()+(P-h)*6e4)}M[o+24>>2]=s.getDay();let R=(s.getTime()-p.getTime())/(1e3*60*60*24)|0;return M[o+28>>2]=R,M[o>>2]=s.getSeconds(),M[o+4>>2]=s.getMinutes(),M[o+8>>2]=s.getHours(),M[o+12>>2]=s.getDate(),M[o+16>>2]=s.getMonth(),s.getTime()/1e3|0}function Zu(o){$l(o)}function Fl(o){Dr(o)}function en(o){return o%4===0&&(o%100!==0||o%400===0)}function rc(o,s){let l=0;for(let h=0;h<=s;l+=o[h++]);return l}let ic=[31,29,31,30,31,30,31,31,30,31,30,31],gi=[31,28,31,30,31,30,31,31,30,31,30,31];function nc(o,s){let l=new Date(o.getTime());for(;s>0;){let h=en(l.getFullYear()),p=l.getMonth(),m=(h?ic:gi)[p];if(s>m-l.getDate())s-=m-l.getDate()+1,l.setDate(1),p<11?l.setMonth(p+1):(l.setMonth(0),l.setFullYear(l.getFullYear()+1));else return l.setDate(l.getDate()+s),l}return l}function eA(o,s,l,h){let p=M[h+40>>2],m={tm_sec:M[h>>2],tm_min:M[h+4>>2],tm_hour:M[h+8>>2],tm_mday:M[h+12>>2],tm_mon:M[h+16>>2],tm_year:M[h+20>>2],tm_wday:M[h+24>>2],tm_yday:M[h+28>>2],tm_isdst:M[h+32>>2],tm_gmtoff:M[h+36>>2],tm_zone:p?ur(p):""},_=ur(l),C={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var R in C)_=_.replace(new RegExp(R,"g"),C[R]);let D=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],P=["January","February","March","April","May","June","July","August","September","October","November","December"];function U(z,ne,st){let et=typeof z=="number"?z.toString():z||"";for(;et.length<ne;)et=st[0]+et;return et}function V(z,ne){return U(z,ne,"0")}function re(z,ne){function st(gr){return gr<0?-1:gr>0?1:0}let et;return(et=st(z.getFullYear()-ne.getFullYear()))===0&&(et=st(z.getMonth()-ne.getMonth()))===0&&(et=st(z.getDate()-ne.getDate())),et}function ie(z){switch(z.getDay()){case 0:return new Date(z.getFullYear()-1,11,29);case 1:return z;case 2:return new Date(z.getFullYear(),0,3);case 3:return new Date(z.getFullYear(),0,2);case 4:return new Date(z.getFullYear(),0,1);case 5:return new Date(z.getFullYear()-1,11,31);case 6:return new Date(z.getFullYear()-1,11,30)}}function fe(z){let ne=nc(new Date(z.tm_year+1900,0,1),z.tm_yday),st=new Date(ne.getFullYear(),0,4),et=new Date(ne.getFullYear()+1,0,4),gr=ie(st),Sr=ie(et);return re(gr,ne)<=0?re(Sr,ne)<=0?ne.getFullYear()+1:ne.getFullYear():ne.getFullYear()-1}let be={"%a"(z){return D[z.tm_wday].substring(0,3)},"%A"(z){return D[z.tm_wday]},"%b"(z){return P[z.tm_mon].substring(0,3)},"%B"(z){return P[z.tm_mon]},"%C"(z){let ne=z.tm_year+1900;return V(ne/100|0,2)},"%d"(z){return V(z.tm_mday,2)},"%e"(z){return U(z.tm_mday,2," ")},"%g"(z){return fe(z).toString().substring(2)},"%G"(z){return fe(z)},"%H"(z){return V(z.tm_hour,2)},"%I"(z){let ne=z.tm_hour;return ne==0?ne=12:ne>12&&(ne-=12),V(ne,2)},"%j"(z){return V(z.tm_mday+rc(en(z.tm_year+1900)?ic:gi,z.tm_mon-1),3)},"%m"(z){return V(z.tm_mon+1,2)},"%M"(z){return V(z.tm_min,2)},"%n"(){return`
`},"%p"(z){return z.tm_hour>=0&&z.tm_hour<12?"AM":"PM"},"%S"(z){return V(z.tm_sec,2)},"%t"(){return"	"},"%u"(z){return z.tm_wday||7},"%U"(z){let ne=new Date(z.tm_year+1900,0,1),st=ne.getDay()===0?ne:nc(ne,7-ne.getDay()),et=new Date(z.tm_year+1900,z.tm_mon,z.tm_mday);if(re(st,et)<0){let gr=rc(en(et.getFullYear())?ic:gi,et.getMonth()-1)-31,Sr=31-st.getDate()+gr+et.getDate();return V(Math.ceil(Sr/7),2)}return re(st,ne)===0?"01":"00"},"%V"(z){let ne=new Date(z.tm_year+1900,0,4),st=new Date(z.tm_year+1901,0,4),et=ie(ne),gr=ie(st),Sr=nc(new Date(z.tm_year+1900,0,1),z.tm_yday);if(re(Sr,et)<0)return"53";if(re(gr,Sr)<=0)return"01";let Lo;return et.getFullYear()<z.tm_year+1900?Lo=z.tm_yday+32-et.getDate():Lo=z.tm_yday+1-et.getDate(),V(Math.ceil(Lo/7),2)},"%w"(z){return z.tm_wday},"%W"(z){let ne=new Date(z.tm_year,0,1),st=ne.getDay()===1?ne:nc(ne,ne.getDay()===0?1:7-ne.getDay()+1),et=new Date(z.tm_year+1900,z.tm_mon,z.tm_mday);if(re(st,et)<0){let gr=rc(en(et.getFullYear())?ic:gi,et.getMonth()-1)-31,Sr=31-st.getDate()+gr+et.getDate();return V(Math.ceil(Sr/7),2)}return re(st,ne)===0?"01":"00"},"%y"(z){return(z.tm_year+1900).toString().substring(2)},"%Y"(z){return z.tm_year+1900},"%z"(z){let ne=z.tm_gmtoff,st=ne>=0;return ne=Math.abs(ne)/60,ne=ne/60*100+ne%60,(st?"+":"-")+`0000${ne}`.slice(-4)},"%Z"(z){return z.tm_zone},"%%"(){return"%"}};for(var R in be)_.includes(R)&&(_=_.replace(new RegExp(R,"g"),be[R](m)));let Se=sc(_,!1);return Se.length>s?0:(sl(Se,o),Se.length-1)}function qp(o,s,l,h){return eA(o,s,l,h)}u.requestFullscreen=function(o,s){j.requestFullscreen(o,s)},u.requestFullScreen=function(){j.requestFullScreen()},u.requestAnimationFrame=function(o){j.requestAnimationFrame(o)},u.setCanvasSize=function(o,s,l){j.setCanvasSize(o,s,l)},u.pauseMainLoop=function(){j.mainLoop.pause()},u.resumeMainLoop=function(){j.mainLoop.resume()},u.getUserMedia=function(){j.getUserMedia()},u.createContext=function(o,s,l,h){return j.createContext(o,s,l,h)};let Vl=function(o,s,l,h){o||(o=this),this.parent=o,this.mount=o.mount,this.mounted=null,this.id=I.nextInode++,this.name=s,this.mode=l,this.node_ops={},this.stream_ops={},this.rdev=h},Bn=365,oc=146;Object.defineProperties(Vl.prototype,{read:{get(){return(this.mode&Bn)===Bn},set(o){o?this.mode|=Bn:this.mode&=~Bn}},write:{get(){return(this.mode&oc)===oc},set(o){o?this.mode|=oc:this.mode&=~oc}},isFolder:{get(){return I.isDir(this.mode)}},isDevice:{get(){return I.isChrdev(this.mode)}}}),I.FSNode=Vl,I.staticInit(),u.FS_createPath=I.createPath,u.FS_createDataFile=I.createDataFile,u.FS_createPreloadedFile=I.createPreloadedFile,u.FS_createLazyFile=I.createLazyFile,u.FS_createDevice=I.createDevice,u.FS_unlink=I.unlink,Di(),Qa=u.PureVirtualError=ar(Error,"PureVirtualError"),fl(),yo(),ui=u.BindingError=ar(Error,"BindingError"),L=u.InternalError=ar(Error,"InternalError"),hr(),Tg(),rr=u.UnboundTypeError=ar(Error,"UnboundTypeError");let H;for(var Xt=0;Xt<32;++Xt)Pu.push(new Array(Xt));let tA=new Float32Array(288);for(var Xt=0;Xt<288;++Xt)ec[Xt]=tA.subarray(0,Xt+1);let $p=new Int32Array(288);for(var Xt=0;Xt<288;++Xt)tc[Xt]=$p.subarray(0,Xt+1);function sc(o,s,l){let h=l>0?l:Or(o)+1,p=new Array(h),m=to(o,p,0,p.length);return s&&(p.length=m),p}var Vs={HaveOffsetConverter:uo,__cxa_allocate_exception:ho,__cxa_atexit:zi,__cxa_begin_catch:ll,__cxa_end_catch:mo,__cxa_find_matching_catch_2:dl,__cxa_find_matching_catch_3:ys,__cxa_free_exception:go,__cxa_rethrow:fo,__cxa_thread_atexit:ul,__cxa_throw:Na,__resumeException:vn,__sys_fcntl64:Ss,__sys_ioctl:vs,__sys_mmap2:Al,__sys_open:hl,__sys_stat64:gl,_embind_create_inheriting_constructor:vo,_embind_finalize_value_object:oe,_embind_register_bigint:$,_embind_register_bool:he,_embind_register_class:Tl,_embind_register_class_class_function:vg,_embind_register_class_constructor:Rg,_embind_register_class_function:bg,_embind_register_class_property:wg,_embind_register_emval:Dg,_embind_register_float:Ga,_embind_register_function:Og,_embind_register_integer:kg,_embind_register_memory_view:Cu,_embind_register_std_string:Bg,_embind_register_std_wstring:Rl,_embind_register_value_object:Ps,_embind_register_value_object_field:Ng,_embind_register_void:bl,_emval_call_void_method:Mg,_emval_decref:_u,_emval_get_method_caller:Dl,_emval_incref:Qg,_emval_take_value:xg,abort:Ug,clock_gettime:yu,dlopen:Wa,dlsym:Vg,emscripten_asm_const_int:Hg,emscripten_get_heap_max:Gg,emscripten_memcpy_big:Yg,emscripten_pc_get_function:Wg,emscripten_resize_heap:Kg,emscripten_stack_snapshot:Xg,emscripten_stack_unwind_buffer:zg,emscripten_thread_sleep:Ol,emscripten_webgl_create_context:bu,emscripten_webgl_destroy_context:Ls,emscripten_webgl_get_context_attributes:ip,emscripten_webgl_get_current_context:wu,emscripten_webgl_init_context_attributes:np,emscripten_webgl_make_context_current:Du,environ_get:Nl,environ_sizes_get:sp,exit:Tn,fd_close:ap,fd_read:cp,fd_seek:lp,fd_write:dp,getTempRet0:up,getentropy:gt,glActiveTexture:Ap,glAttachShader:hp,glBindAttribLocation:gp,glBindBuffer:pp,glBindBufferBase:mp,glBindFramebuffer:Ou,glBindTexture:Pl,glBindVertexArray:fp,glBufferData:Xa,glClientWaitSync:_p,glCompileShader:Ip,glCreateProgram:ku,glCreateShader:Cp,glDeleteBuffers:Ml,glDeleteFramebuffers:Bu,glDeleteProgram:yp,glDeleteShader:Ll,glDeleteSync:Tp,glDeleteTextures:Sp,glDeleteVertexArrays:Nu,glDisable:Oo,glDisableVertexAttribArray:vp,glDrawArrays:Rp,glDrawBuffers:bp,glEnableVertexAttribArray:wp,glFenceSync:Dp,glFinish:Mu,glFlush:Op,glFramebufferTexture2D:kp,glFramebufferTextureLayer:Bp,glGenBuffers:Np,glGenFramebuffers:Pp,glGenTextures:Mp,glGenVertexArrays:Lp,glGetAttribLocation:ko,glGetError:Qp,glGetIntegerv:Qu,glGetString:Vp,glGetUniformBlockIndex:Ql,glGetUniformLocation:Uu,glLinkProgram:$a,glPixelStorei:Qs,glReadPixels:Vu,glShaderSource:Gp,glTexImage2D:xl,glTexParameterfv:ju,glTexParameteri:Hu,glTexStorage2D:Yp,glTexStorage3D:Wp,glTexSubImage2D:Gu,glTexSubImage3D:Jp,glUniform1f:Kp,glUniform1i:Xp,glUniform2fv:Yu,glUniform4fv:Wu,glUniform4iv:Ju,glUniformBlockBinding:Ku,glUniformMatrix4fv:Xu,glUseProgram:zu,glVertexAttribPointer:zp,glViewport:Fs,gmtime_r:No,invoke_diii:dm,invoke_i:gm,invoke_ii:nm,invoke_iii:Gs,invoke_iiii:um,invoke_iiiii:Yl,invoke_iiiiii:lA,invoke_iiiiiii:oA,invoke_iiiiiiiddi:Xl,invoke_iiiiiiii:uA,invoke_iiiiiiiii:Wl,invoke_v:Hl,invoke_vdiii:zl,invoke_vi:nA,invoke_vididdii:ym,invoke_vidii:Jl,invoke_vii:im,invoke_viid:Hs,invoke_viidi:Rm,invoke_viididii:mm,invoke_viii:om,invoke_viiid:Tm,invoke_viiidd:cA,invoke_viiiddi:hm,invoke_viiidi:rn,invoke_viiii:cm,invoke_viiiid:vm,invoke_viiiidi:pm,invoke_viiiidid:fA,invoke_viiiidiidiiiiiii:Cm,invoke_viiiifiifiiiiiii:mA,invoke_viiiii:Mo,invoke_viiiiid:fm,invoke_viiiiif:gA,invoke_viiiiii:sA,invoke_viiiiiid:Em,invoke_viiiiiif:pA,invoke_viiiiiii:aA,invoke_viiiiiiiddi:Sm,invoke_viiiiiiidiiii:_m,invoke_viiiiiiifiiii:Im,invoke_viiiiiiii:sm,invoke_viiiiiiiidd:Tr,invoke_viiiiiiiidf:AA,invoke_viiiiiiiii:am,invoke_viiiiiiiiidd:Ys,invoke_viiiiiiiiiddi:Am,invoke_viiiiiiiiii:Gl,invoke_viiiiiiiiiiddi:Kl,invoke_viiiiiiiiiii:lm,invoke_viiiiiiiiiiii:hA,invoke_viiiiiiiiiiiii:dA,llvm_eh_typeid_for:qu,localtime_r:$u,mktime:Ul,proc_exit:Zu,setTempRet0:Fl,strftime:eA,strftime_l:qp};Cn(),u.___wasm_call_ctors=Me("__wasm_call_ctors");var pi=u._free=Me("free"),Nn=u._malloc=Me("malloc"),Zp=u.___errno_location=Me("__errno_location");u._fflush=Me("fflush");var tn=u.___getTypeName=Me("__getTypeName");u.___embind_register_native_and_builtin_types=Me("__embind_register_native_and_builtin_types"),u._emscripten_main_thread_process_queued_calls=Me("emscripten_main_thread_process_queued_calls");var jl=u._emscripten_stack_get_end=function(){return(jl=u._emscripten_stack_get_end=u.asm.emscripten_stack_get_end).apply(null,arguments)},js=u.__get_tzname=Me("_get_tzname"),rA=u.__get_daylight=Me("_get_daylight"),em=u.__get_timezone=Me("_get_timezone"),ye=u.stackSave=Me("stackSave"),Ce=u.stackRestore=Me("stackRestore");u.stackAlloc=Me("stackAlloc");var iA=u._emscripten_stack_init=function(){return(iA=u._emscripten_stack_init=u.asm.emscripten_stack_init).apply(null,arguments)};u._emscripten_stack_get_free=function(){return(u._emscripten_stack_get_free=u.asm.emscripten_stack_get_free).apply(null,arguments)},u._saveSetjmp=Me("saveSetjmp");var Ie=u._setThrew=Me("setThrew"),ac=u.___cxa_can_catch=Me("__cxa_can_catch"),tm=u.___cxa_is_pointer_type=Me("__cxa_is_pointer_type"),rm=u._memalign=Me("memalign");u._emscripten_builtin_malloc=Me("emscripten_builtin_malloc"),u._emscripten_builtin_free=Me("emscripten_builtin_free"),u._emscripten_builtin_memalign=Me("emscripten_builtin_memalign"),u.dynCall_jii=Me("dynCall_jii"),u.dynCall_viji=Me("dynCall_viji"),u.dynCall_jjj=Me("dynCall_jjj"),u.dynCall_iiiijj=Me("dynCall_iiiijj"),u.dynCall_viijj=Me("dynCall_viijj"),u.dynCall_viiijjjj=Me("dynCall_viiijjjj"),u.dynCall_ji=Me("dynCall_ji"),u.dynCall_vij=Me("dynCall_vij"),u.dynCall_viijii=Me("dynCall_viijii"),u.dynCall_vj=Me("dynCall_vj"),u.dynCall_viij=Me("dynCall_viij"),u.dynCall_viiiiij=Me("dynCall_viiiiij"),u.dynCall_iijjiiii=Me("dynCall_iijjiiii"),u.dynCall_jiji=Me("dynCall_jiji"),u.dynCall_iiiiij=Me("dynCall_iiiiij"),u.dynCall_iiiiijj=Me("dynCall_iiiiijj"),u.dynCall_iiiiiijj=Me("dynCall_iiiiiijj");function Hs(o,s,l,h){let p=ye();try{ce.get(o)(s,l,h)}catch(m){if(Ce(p),m!==m+0&&m!=="longjmp")throw m;Ie(1,0)}}function nA(o,s){let l=ye();try{ce.get(o)(s)}catch(h){if(Ce(l),h!==h+0&&h!=="longjmp")throw h;Ie(1,0)}}function Gs(o,s,l){let h=ye();try{return ce.get(o)(s,l)}catch(p){if(Ce(h),p!==p+0&&p!=="longjmp")throw p;Ie(1,0)}}function Mo(o,s,l,h,p,m){let _=ye();try{ce.get(o)(s,l,h,p,m)}catch(C){if(Ce(_),C!==C+0&&C!=="longjmp")throw C;Ie(1,0)}}function oA(o,s,l,h,p,m,_){let C=ye();try{return ce.get(o)(s,l,h,p,m,_)}catch(R){if(Ce(C),R!==R+0&&R!=="longjmp")throw R;Ie(1,0)}}function Hl(o){let s=ye();try{ce.get(o)()}catch(l){if(Ce(s),l!==l+0&&l!=="longjmp")throw l;Ie(1,0)}}function Gl(o,s,l,h,p,m,_,C,R,D,P){let U=ye();try{ce.get(o)(s,l,h,p,m,_,C,R,D,P)}catch(V){if(Ce(U),V!==V+0&&V!=="longjmp")throw V;Ie(1,0)}}function im(o,s,l){let h=ye();try{ce.get(o)(s,l)}catch(p){if(Ce(h),p!==p+0&&p!=="longjmp")throw p;Ie(1,0)}}function nm(o,s){let l=ye();try{return ce.get(o)(s)}catch(h){if(Ce(l),h!==h+0&&h!=="longjmp")throw h;Ie(1,0)}}function om(o,s,l,h){let p=ye();try{ce.get(o)(s,l,h)}catch(m){if(Ce(p),m!==m+0&&m!=="longjmp")throw m;Ie(1,0)}}function sA(o,s,l,h,p,m,_){let C=ye();try{ce.get(o)(s,l,h,p,m,_)}catch(R){if(Ce(C),R!==R+0&&R!=="longjmp")throw R;Ie(1,0)}}function aA(o,s,l,h,p,m,_,C){let R=ye();try{ce.get(o)(s,l,h,p,m,_,C)}catch(D){if(Ce(R),D!==D+0&&D!=="longjmp")throw D;Ie(1,0)}}function sm(o,s,l,h,p,m,_,C,R){let D=ye();try{ce.get(o)(s,l,h,p,m,_,C,R)}catch(P){if(Ce(D),P!==P+0&&P!=="longjmp")throw P;Ie(1,0)}}function am(o,s,l,h,p,m,_,C,R,D){let P=ye();try{ce.get(o)(s,l,h,p,m,_,C,R,D)}catch(U){if(Ce(P),U!==U+0&&U!=="longjmp")throw U;Ie(1,0)}}function cm(o,s,l,h,p){let m=ye();try{ce.get(o)(s,l,h,p)}catch(_){if(Ce(m),_!==_+0&&_!=="longjmp")throw _;Ie(1,0)}}function Yl(o,s,l,h,p){let m=ye();try{return ce.get(o)(s,l,h,p)}catch(_){if(Ce(m),_!==_+0&&_!=="longjmp")throw _;Ie(1,0)}}function lm(o,s,l,h,p,m,_,C,R,D,P,U){let V=ye();try{ce.get(o)(s,l,h,p,m,_,C,R,D,P,U)}catch(re){if(Ce(V),re!==re+0&&re!=="longjmp")throw re;Ie(1,0)}}function cA(o,s,l,h,p,m){let _=ye();try{ce.get(o)(s,l,h,p,m)}catch(C){if(Ce(_),C!==C+0&&C!=="longjmp")throw C;Ie(1,0)}}function lA(o,s,l,h,p,m){let _=ye();try{return ce.get(o)(s,l,h,p,m)}catch(C){if(Ce(_),C!==C+0&&C!=="longjmp")throw C;Ie(1,0)}}function dA(o,s,l,h,p,m,_,C,R,D,P,U,V,re){let ie=ye();try{ce.get(o)(s,l,h,p,m,_,C,R,D,P,U,V,re)}catch(fe){if(Ce(ie),fe!==fe+0&&fe!=="longjmp")throw fe;Ie(1,0)}}function uA(o,s,l,h,p,m,_,C){let R=ye();try{return ce.get(o)(s,l,h,p,m,_,C)}catch(D){if(Ce(R),D!==D+0&&D!=="longjmp")throw D;Ie(1,0)}}function dm(o,s,l,h){let p=ye();try{return ce.get(o)(s,l,h)}catch(m){if(Ce(p),m!==m+0&&m!=="longjmp")throw m;Ie(1,0)}}function um(o,s,l,h){let p=ye();try{return ce.get(o)(s,l,h)}catch(m){if(Ce(p),m!==m+0&&m!=="longjmp")throw m;Ie(1,0)}}function Ys(o,s,l,h,p,m,_,C,R,D,P,U){let V=ye();try{ce.get(o)(s,l,h,p,m,_,C,R,D,P,U)}catch(re){if(Ce(V),re!==re+0&&re!=="longjmp")throw re;Ie(1,0)}}function Am(o,s,l,h,p,m,_,C,R,D,P,U,V){let re=ye();try{ce.get(o)(s,l,h,p,m,_,C,R,D,P,U,V)}catch(ie){if(Ce(re),ie!==ie+0&&ie!=="longjmp")throw ie;Ie(1,0)}}function hm(o,s,l,h,p,m,_){let C=ye();try{ce.get(o)(s,l,h,p,m,_)}catch(R){if(Ce(C),R!==R+0&&R!=="longjmp")throw R;Ie(1,0)}}function gm(o){let s=ye();try{return ce.get(o)()}catch(l){if(Ce(s),l!==l+0&&l!=="longjmp")throw l;Ie(1,0)}}function rn(o,s,l,h,p,m){let _=ye();try{ce.get(o)(s,l,h,p,m)}catch(C){if(Ce(_),C!==C+0&&C!=="longjmp")throw C;Ie(1,0)}}function pm(o,s,l,h,p,m,_){let C=ye();try{ce.get(o)(s,l,h,p,m,_)}catch(R){if(Ce(C),R!==R+0&&R!=="longjmp")throw R;Ie(1,0)}}function mm(o,s,l,h,p,m,_,C){let R=ye();try{ce.get(o)(s,l,h,p,m,_,C)}catch(D){if(Ce(R),D!==D+0&&D!=="longjmp")throw D;Ie(1,0)}}function Wl(o,s,l,h,p,m,_,C,R){let D=ye();try{return ce.get(o)(s,l,h,p,m,_,C,R)}catch(P){if(Ce(D),P!==P+0&&P!=="longjmp")throw P;Ie(1,0)}}function AA(o,s,l,h,p,m,_,C,R,D,P){let U=ye();try{ce.get(o)(s,l,h,p,m,_,C,R,D,P)}catch(V){if(Ce(U),V!==V+0&&V!=="longjmp")throw V;Ie(1,0)}}function Tr(o,s,l,h,p,m,_,C,R,D,P){let U=ye();try{ce.get(o)(s,l,h,p,m,_,C,R,D,P)}catch(V){if(Ce(U),V!==V+0&&V!=="longjmp")throw V;Ie(1,0)}}function fm(o,s,l,h,p,m,_){let C=ye();try{ce.get(o)(s,l,h,p,m,_)}catch(R){if(Ce(C),R!==R+0&&R!=="longjmp")throw R;Ie(1,0)}}function Em(o,s,l,h,p,m,_,C){let R=ye();try{ce.get(o)(s,l,h,p,m,_,C)}catch(D){if(Ce(R),D!==D+0&&D!=="longjmp")throw D;Ie(1,0)}}function hA(o,s,l,h,p,m,_,C,R,D,P,U,V){let re=ye();try{ce.get(o)(s,l,h,p,m,_,C,R,D,P,U,V)}catch(ie){if(Ce(re),ie!==ie+0&&ie!=="longjmp")throw ie;Ie(1,0)}}function _m(o,s,l,h,p,m,_,C,R,D,P,U,V){let re=ye();try{ce.get(o)(s,l,h,p,m,_,C,R,D,P,U,V)}catch(ie){if(Ce(re),ie!==ie+0&&ie!=="longjmp")throw ie;Ie(1,0)}}function gA(o,s,l,h,p,m,_){let C=ye();try{ce.get(o)(s,l,h,p,m,_)}catch(R){if(Ce(C),R!==R+0&&R!=="longjmp")throw R;Ie(1,0)}}function pA(o,s,l,h,p,m,_,C){let R=ye();try{ce.get(o)(s,l,h,p,m,_,C)}catch(D){if(Ce(R),D!==D+0&&D!=="longjmp")throw D;Ie(1,0)}}function Im(o,s,l,h,p,m,_,C,R,D,P,U,V){let re=ye();try{ce.get(o)(s,l,h,p,m,_,C,R,D,P,U,V)}catch(ie){if(Ce(re),ie!==ie+0&&ie!=="longjmp")throw ie;Ie(1,0)}}function mA(o,s,l,h,p,m,_,C,R,D,P,U,V,re,ie,fe){let be=ye();try{ce.get(o)(s,l,h,p,m,_,C,R,D,P,U,V,re,ie,fe)}catch(Se){if(Ce(be),Se!==Se+0&&Se!=="longjmp")throw Se;Ie(1,0)}}function Cm(o,s,l,h,p,m,_,C,R,D,P,U,V,re,ie,fe){let be=ye();try{ce.get(o)(s,l,h,p,m,_,C,R,D,P,U,V,re,ie,fe)}catch(Se){if(Ce(be),Se!==Se+0&&Se!=="longjmp")throw Se;Ie(1,0)}}function ym(o,s,l,h,p,m,_,C){let R=ye();try{ce.get(o)(s,l,h,p,m,_,C)}catch(D){if(Ce(R),D!==D+0&&D!=="longjmp")throw D;Ie(1,0)}}function Tm(o,s,l,h,p){let m=ye();try{ce.get(o)(s,l,h,p)}catch(_){if(Ce(m),_!==_+0&&_!=="longjmp")throw _;Ie(1,0)}}function Jl(o,s,l,h,p){let m=ye();try{ce.get(o)(s,l,h,p)}catch(_){if(Ce(m),_!==_+0&&_!=="longjmp")throw _;Ie(1,0)}}function Kl(o,s,l,h,p,m,_,C,R,D,P,U,V,re){let ie=ye();try{ce.get(o)(s,l,h,p,m,_,C,R,D,P,U,V,re)}catch(fe){if(Ce(ie),fe!==fe+0&&fe!=="longjmp")throw fe;Ie(1,0)}}function Sm(o,s,l,h,p,m,_,C,R,D,P){let U=ye();try{ce.get(o)(s,l,h,p,m,_,C,R,D,P)}catch(V){if(Ce(U),V!==V+0&&V!=="longjmp")throw V;Ie(1,0)}}function Xl(o,s,l,h,p,m,_,C,R,D){let P=ye();try{return ce.get(o)(s,l,h,p,m,_,C,R,D)}catch(U){if(Ce(P),U!==U+0&&U!=="longjmp")throw U;Ie(1,0)}}function vm(o,s,l,h,p,m){let _=ye();try{ce.get(o)(s,l,h,p,m)}catch(C){if(Ce(_),C!==C+0&&C!=="longjmp")throw C;Ie(1,0)}}function fA(o,s,l,h,p,m,_,C){let R=ye();try{ce.get(o)(s,l,h,p,m,_,C)}catch(D){if(Ce(R),D!==D+0&&D!=="longjmp")throw D;Ie(1,0)}}function Rm(o,s,l,h,p){let m=ye();try{ce.get(o)(s,l,h,p)}catch(_){if(Ce(m),_!==_+0&&_!=="longjmp")throw _;Ie(1,0)}}function zl(o,s,l,h,p){let m=ye();try{ce.get(o)(s,l,h,p)}catch(_){if(Ce(m),_!==_+0&&_!=="longjmp")throw _;Ie(1,0)}}Object.getOwnPropertyDescriptor(u,"intArrayFromString")||(u.intArrayFromString=function(){y("'intArrayFromString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"intArrayToString")||(u.intArrayToString=function(){y("'intArrayToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"ccall")||(u.ccall=function(){y("'ccall' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"cwrap")||(u.cwrap=function(){y("'cwrap' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"setValue")||(u.setValue=function(){y("'setValue' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"getValue")||(u.getValue=function(){y("'getValue' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"allocate")||(u.allocate=function(){y("'allocate' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"UTF8ArrayToString")||(u.UTF8ArrayToString=function(){y("'UTF8ArrayToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"UTF8ToString")||(u.UTF8ToString=function(){y("'UTF8ToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"stringToUTF8Array")||(u.stringToUTF8Array=function(){y("'stringToUTF8Array' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"stringToUTF8")||(u.stringToUTF8=function(){y("'stringToUTF8' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"lengthBytesUTF8")||(u.lengthBytesUTF8=function(){y("'lengthBytesUTF8' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"stackTrace")||(u.stackTrace=function(){y("'stackTrace' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"addOnPreRun")||(u.addOnPreRun=function(){y("'addOnPreRun' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"addOnInit")||(u.addOnInit=function(){y("'addOnInit' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"addOnPreMain")||(u.addOnPreMain=function(){y("'addOnPreMain' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"addOnExit")||(u.addOnExit=function(){y("'addOnExit' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"addOnPostRun")||(u.addOnPostRun=function(){y("'addOnPostRun' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"writeStringToMemory")||(u.writeStringToMemory=function(){y("'writeStringToMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"writeArrayToMemory")||(u.writeArrayToMemory=function(){y("'writeArrayToMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"writeAsciiToMemory")||(u.writeAsciiToMemory=function(){y("'writeAsciiToMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),u.addRunDependency=Xi,u.removeRunDependency=Yr,Object.getOwnPropertyDescriptor(u,"FS_createFolder")||(u.FS_createFolder=function(){y("'FS_createFolder' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),u.FS_createPath=I.createPath,u.FS_createDataFile=I.createDataFile,u.FS_createPreloadedFile=I.createPreloadedFile,u.FS_createLazyFile=I.createLazyFile,Object.getOwnPropertyDescriptor(u,"FS_createLink")||(u.FS_createLink=function(){y("'FS_createLink' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),u.FS_createDevice=I.createDevice,u.FS_unlink=I.unlink,Object.getOwnPropertyDescriptor(u,"getLEB")||(u.getLEB=function(){y("'getLEB' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"getFunctionTables")||(u.getFunctionTables=function(){y("'getFunctionTables' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"alignFunctionTables")||(u.alignFunctionTables=function(){y("'alignFunctionTables' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registerFunctions")||(u.registerFunctions=function(){y("'registerFunctions' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"addFunction")||(u.addFunction=function(){y("'addFunction' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"removeFunction")||(u.removeFunction=function(){y("'removeFunction' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"getFuncWrapper")||(u.getFuncWrapper=function(){y("'getFuncWrapper' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"prettyPrint")||(u.prettyPrint=function(){y("'prettyPrint' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"dynCall")||(u.dynCall=function(){y("'dynCall' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"getCompilerSetting")||(u.getCompilerSetting=function(){y("'getCompilerSetting' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"print")||(u.print=function(){y("'print' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"printErr")||(u.printErr=function(){y("'printErr' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"getTempRet0")||(u.getTempRet0=function(){y("'getTempRet0' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"setTempRet0")||(u.setTempRet0=function(){y("'setTempRet0' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"callMain")||(u.callMain=function(){y("'callMain' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"abort")||(u.abort=function(){y("'abort' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"keepRuntimeAlive")||(u.keepRuntimeAlive=function(){y("'keepRuntimeAlive' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"zeroMemory")||(u.zeroMemory=function(){y("'zeroMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"stringToNewUTF8")||(u.stringToNewUTF8=function(){y("'stringToNewUTF8' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"setFileTime")||(u.setFileTime=function(){y("'setFileTime' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"emscripten_realloc_buffer")||(u.emscripten_realloc_buffer=function(){y("'emscripten_realloc_buffer' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"ENV")||(u.ENV=function(){y("'ENV' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"ERRNO_CODES")||(u.ERRNO_CODES=function(){y("'ERRNO_CODES' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"ERRNO_MESSAGES")||(u.ERRNO_MESSAGES=function(){y("'ERRNO_MESSAGES' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"setErrNo")||(u.setErrNo=function(){y("'setErrNo' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"inetPton4")||(u.inetPton4=function(){y("'inetPton4' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"inetNtop4")||(u.inetNtop4=function(){y("'inetNtop4' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"inetPton6")||(u.inetPton6=function(){y("'inetPton6' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"inetNtop6")||(u.inetNtop6=function(){y("'inetNtop6' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"readSockaddr")||(u.readSockaddr=function(){y("'readSockaddr' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"writeSockaddr")||(u.writeSockaddr=function(){y("'writeSockaddr' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"DNS")||(u.DNS=function(){y("'DNS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"getHostByName")||(u.getHostByName=function(){y("'getHostByName' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"GAI_ERRNO_MESSAGES")||(u.GAI_ERRNO_MESSAGES=function(){y("'GAI_ERRNO_MESSAGES' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"Protocols")||(u.Protocols=function(){y("'Protocols' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"Sockets")||(u.Sockets=function(){y("'Sockets' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"getRandomDevice")||(u.getRandomDevice=function(){y("'getRandomDevice' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"traverseStack")||(u.traverseStack=function(){y("'traverseStack' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"UNWIND_CACHE")||(u.UNWIND_CACHE=function(){y("'UNWIND_CACHE' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"withBuiltinMalloc")||(u.withBuiltinMalloc=function(){y("'withBuiltinMalloc' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"readAsmConstArgsArray")||(u.readAsmConstArgsArray=function(){y("'readAsmConstArgsArray' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"readAsmConstArgs")||(u.readAsmConstArgs=function(){y("'readAsmConstArgs' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"mainThreadEM_ASM")||(u.mainThreadEM_ASM=function(){y("'mainThreadEM_ASM' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"jstoi_q")||(u.jstoi_q=function(){y("'jstoi_q' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"jstoi_s")||(u.jstoi_s=function(){y("'jstoi_s' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"getExecutableName")||(u.getExecutableName=function(){y("'getExecutableName' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"listenOnce")||(u.listenOnce=function(){y("'listenOnce' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"autoResumeAudioContext")||(u.autoResumeAudioContext=function(){y("'autoResumeAudioContext' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"dynCallLegacy")||(u.dynCallLegacy=function(){y("'dynCallLegacy' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"getDynCaller")||(u.getDynCaller=function(){y("'getDynCaller' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"dynCall")||(u.dynCall=function(){y("'dynCall' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"callRuntimeCallbacks")||(u.callRuntimeCallbacks=function(){y("'callRuntimeCallbacks' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"runtimeKeepalivePush")||(u.runtimeKeepalivePush=function(){y("'runtimeKeepalivePush' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"runtimeKeepalivePop")||(u.runtimeKeepalivePop=function(){y("'runtimeKeepalivePop' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"callUserCallback")||(u.callUserCallback=function(){y("'callUserCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"maybeExit")||(u.maybeExit=function(){y("'maybeExit' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"safeSetTimeout")||(u.safeSetTimeout=function(){y("'safeSetTimeout' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"asmjsMangle")||(u.asmjsMangle=function(){y("'asmjsMangle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"asyncLoad")||(u.asyncLoad=function(){y("'asyncLoad' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"alignMemory")||(u.alignMemory=function(){y("'alignMemory' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"mmapAlloc")||(u.mmapAlloc=function(){y("'mmapAlloc' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"reallyNegative")||(u.reallyNegative=function(){y("'reallyNegative' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"unSign")||(u.unSign=function(){y("'unSign' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"reSign")||(u.reSign=function(){y("'reSign' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"formatString")||(u.formatString=function(){y("'formatString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"PATH")||(u.PATH=function(){y("'PATH' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"PATH_FS")||(u.PATH_FS=function(){y("'PATH_FS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"SYSCALLS")||(u.SYSCALLS=function(){y("'SYSCALLS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"syscallMmap2")||(u.syscallMmap2=function(){y("'syscallMmap2' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"syscallMunmap")||(u.syscallMunmap=function(){y("'syscallMunmap' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"getSocketFromFD")||(u.getSocketFromFD=function(){y("'getSocketFromFD' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"getSocketAddress")||(u.getSocketAddress=function(){y("'getSocketAddress' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"JSEvents")||(u.JSEvents=function(){y("'JSEvents' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registerKeyEventCallback")||(u.registerKeyEventCallback=function(){y("'registerKeyEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"specialHTMLTargets")||(u.specialHTMLTargets=function(){y("'specialHTMLTargets' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"findEventTarget")||(u.findEventTarget=function(){y("'findEventTarget' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"findCanvasEventTarget")||(u.findCanvasEventTarget=function(){y("'findCanvasEventTarget' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"getBoundingClientRect")||(u.getBoundingClientRect=function(){y("'getBoundingClientRect' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"fillMouseEventData")||(u.fillMouseEventData=function(){y("'fillMouseEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registerMouseEventCallback")||(u.registerMouseEventCallback=function(){y("'registerMouseEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registerWheelEventCallback")||(u.registerWheelEventCallback=function(){y("'registerWheelEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registerUiEventCallback")||(u.registerUiEventCallback=function(){y("'registerUiEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registerFocusEventCallback")||(u.registerFocusEventCallback=function(){y("'registerFocusEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"fillDeviceOrientationEventData")||(u.fillDeviceOrientationEventData=function(){y("'fillDeviceOrientationEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registerDeviceOrientationEventCallback")||(u.registerDeviceOrientationEventCallback=function(){y("'registerDeviceOrientationEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"fillDeviceMotionEventData")||(u.fillDeviceMotionEventData=function(){y("'fillDeviceMotionEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registerDeviceMotionEventCallback")||(u.registerDeviceMotionEventCallback=function(){y("'registerDeviceMotionEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"screenOrientation")||(u.screenOrientation=function(){y("'screenOrientation' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"fillOrientationChangeEventData")||(u.fillOrientationChangeEventData=function(){y("'fillOrientationChangeEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registerOrientationChangeEventCallback")||(u.registerOrientationChangeEventCallback=function(){y("'registerOrientationChangeEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"fillFullscreenChangeEventData")||(u.fillFullscreenChangeEventData=function(){y("'fillFullscreenChangeEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registerFullscreenChangeEventCallback")||(u.registerFullscreenChangeEventCallback=function(){y("'registerFullscreenChangeEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registerRestoreOldStyle")||(u.registerRestoreOldStyle=function(){y("'registerRestoreOldStyle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"hideEverythingExceptGivenElement")||(u.hideEverythingExceptGivenElement=function(){y("'hideEverythingExceptGivenElement' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"restoreHiddenElements")||(u.restoreHiddenElements=function(){y("'restoreHiddenElements' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"setLetterbox")||(u.setLetterbox=function(){y("'setLetterbox' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"currentFullscreenStrategy")||(u.currentFullscreenStrategy=function(){y("'currentFullscreenStrategy' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"restoreOldWindowedStyle")||(u.restoreOldWindowedStyle=function(){y("'restoreOldWindowedStyle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"softFullscreenResizeWebGLRenderTarget")||(u.softFullscreenResizeWebGLRenderTarget=function(){y("'softFullscreenResizeWebGLRenderTarget' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"doRequestFullscreen")||(u.doRequestFullscreen=function(){y("'doRequestFullscreen' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"fillPointerlockChangeEventData")||(u.fillPointerlockChangeEventData=function(){y("'fillPointerlockChangeEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registerPointerlockChangeEventCallback")||(u.registerPointerlockChangeEventCallback=function(){y("'registerPointerlockChangeEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registerPointerlockErrorEventCallback")||(u.registerPointerlockErrorEventCallback=function(){y("'registerPointerlockErrorEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"requestPointerLock")||(u.requestPointerLock=function(){y("'requestPointerLock' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"fillVisibilityChangeEventData")||(u.fillVisibilityChangeEventData=function(){y("'fillVisibilityChangeEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registerVisibilityChangeEventCallback")||(u.registerVisibilityChangeEventCallback=function(){y("'registerVisibilityChangeEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registerTouchEventCallback")||(u.registerTouchEventCallback=function(){y("'registerTouchEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"fillGamepadEventData")||(u.fillGamepadEventData=function(){y("'fillGamepadEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registerGamepadEventCallback")||(u.registerGamepadEventCallback=function(){y("'registerGamepadEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registerBeforeUnloadEventCallback")||(u.registerBeforeUnloadEventCallback=function(){y("'registerBeforeUnloadEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"fillBatteryEventData")||(u.fillBatteryEventData=function(){y("'fillBatteryEventData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"battery")||(u.battery=function(){y("'battery' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registerBatteryEventCallback")||(u.registerBatteryEventCallback=function(){y("'registerBatteryEventCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"setCanvasElementSize")||(u.setCanvasElementSize=function(){y("'setCanvasElementSize' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"getCanvasElementSize")||(u.getCanvasElementSize=function(){y("'getCanvasElementSize' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"polyfillSetImmediate")||(u.polyfillSetImmediate=function(){y("'polyfillSetImmediate' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"demangle")||(u.demangle=function(){y("'demangle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"demangleAll")||(u.demangleAll=function(){y("'demangleAll' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"jsStackTrace")||(u.jsStackTrace=function(){y("'jsStackTrace' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"stackTrace")||(u.stackTrace=function(){y("'stackTrace' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"getEnvStrings")||(u.getEnvStrings=function(){y("'getEnvStrings' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"checkWasiClock")||(u.checkWasiClock=function(){y("'checkWasiClock' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"writeI53ToI64")||(u.writeI53ToI64=function(){y("'writeI53ToI64' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"writeI53ToI64Clamped")||(u.writeI53ToI64Clamped=function(){y("'writeI53ToI64Clamped' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"writeI53ToI64Signaling")||(u.writeI53ToI64Signaling=function(){y("'writeI53ToI64Signaling' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"writeI53ToU64Clamped")||(u.writeI53ToU64Clamped=function(){y("'writeI53ToU64Clamped' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"writeI53ToU64Signaling")||(u.writeI53ToU64Signaling=function(){y("'writeI53ToU64Signaling' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"readI53FromI64")||(u.readI53FromI64=function(){y("'readI53FromI64' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"readI53FromU64")||(u.readI53FromU64=function(){y("'readI53FromU64' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"convertI32PairToI53")||(u.convertI32PairToI53=function(){y("'convertI32PairToI53' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"convertU32PairToI53")||(u.convertU32PairToI53=function(){y("'convertU32PairToI53' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"uncaughtExceptionCount")||(u.uncaughtExceptionCount=function(){y("'uncaughtExceptionCount' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"exceptionLast")||(u.exceptionLast=function(){y("'exceptionLast' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"exceptionCaught")||(u.exceptionCaught=function(){y("'exceptionCaught' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"ExceptionInfo")||(u.ExceptionInfo=function(){y("'ExceptionInfo' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"CatchInfo")||(u.CatchInfo=function(){y("'CatchInfo' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"exception_addRef")||(u.exception_addRef=function(){y("'exception_addRef' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"exception_decRef")||(u.exception_decRef=function(){y("'exception_decRef' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"Browser")||(u.Browser=function(){y("'Browser' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"funcWrappers")||(u.funcWrappers=function(){y("'funcWrappers' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"getFuncWrapper")||(u.getFuncWrapper=function(){y("'getFuncWrapper' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"setMainLoop")||(u.setMainLoop=function(){y("'setMainLoop' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"wget")||(u.wget=function(){y("'wget' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"FS")||(u.FS=function(){y("'FS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"MEMFS")||(u.MEMFS=function(){y("'MEMFS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"TTY")||(u.TTY=function(){y("'TTY' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"PIPEFS")||(u.PIPEFS=function(){y("'PIPEFS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"SOCKFS")||(u.SOCKFS=function(){y("'SOCKFS' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"_setNetworkCallback")||(u._setNetworkCallback=function(){y("'_setNetworkCallback' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"tempFixedLengthArray")||(u.tempFixedLengthArray=function(){y("'tempFixedLengthArray' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"miniTempWebGLFloatBuffers")||(u.miniTempWebGLFloatBuffers=function(){y("'miniTempWebGLFloatBuffers' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"heapObjectForWebGLType")||(u.heapObjectForWebGLType=function(){y("'heapObjectForWebGLType' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"heapAccessShiftForWebGLHeap")||(u.heapAccessShiftForWebGLHeap=function(){y("'heapAccessShiftForWebGLHeap' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),u.GL=Q,Object.getOwnPropertyDescriptor(u,"emscriptenWebGLGet")||(u.emscriptenWebGLGet=function(){y("'emscriptenWebGLGet' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"computeUnpackAlignedImageSize")||(u.computeUnpackAlignedImageSize=function(){y("'computeUnpackAlignedImageSize' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"emscriptenWebGLGetTexPixelData")||(u.emscriptenWebGLGetTexPixelData=function(){y("'emscriptenWebGLGetTexPixelData' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"emscriptenWebGLGetUniform")||(u.emscriptenWebGLGetUniform=function(){y("'emscriptenWebGLGetUniform' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"webglGetUniformLocation")||(u.webglGetUniformLocation=function(){y("'webglGetUniformLocation' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"webglPrepareUniformLocationsBeforeFirstUse")||(u.webglPrepareUniformLocationsBeforeFirstUse=function(){y("'webglPrepareUniformLocationsBeforeFirstUse' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"webglGetLeftBracePos")||(u.webglGetLeftBracePos=function(){y("'webglGetLeftBracePos' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"emscriptenWebGLGetVertexAttrib")||(u.emscriptenWebGLGetVertexAttrib=function(){y("'emscriptenWebGLGetVertexAttrib' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"emscriptenWebGLGetBufferBinding")||(u.emscriptenWebGLGetBufferBinding=function(){y("'emscriptenWebGLGetBufferBinding' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"emscriptenWebGLValidateMapBufferTarget")||(u.emscriptenWebGLValidateMapBufferTarget=function(){y("'emscriptenWebGLValidateMapBufferTarget' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"writeGLArray")||(u.writeGLArray=function(){y("'writeGLArray' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"AL")||(u.AL=function(){y("'AL' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"SDL_unicode")||(u.SDL_unicode=function(){y("'SDL_unicode' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"SDL_ttfContext")||(u.SDL_ttfContext=function(){y("'SDL_ttfContext' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"SDL_audio")||(u.SDL_audio=function(){y("'SDL_audio' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"SDL")||(u.SDL=function(){y("'SDL' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"SDL_gfx")||(u.SDL_gfx=function(){y("'SDL_gfx' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"GLUT")||(u.GLUT=function(){y("'GLUT' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"EGL")||(u.EGL=function(){y("'EGL' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"GLFW_Window")||(u.GLFW_Window=function(){y("'GLFW_Window' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"GLFW")||(u.GLFW=function(){y("'GLFW' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"GLEW")||(u.GLEW=function(){y("'GLEW' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"IDBStore")||(u.IDBStore=function(){y("'IDBStore' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"runAndAbortIfError")||(u.runAndAbortIfError=function(){y("'runAndAbortIfError' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"emval_handle_array")||(u.emval_handle_array=function(){y("'emval_handle_array' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"emval_free_list")||(u.emval_free_list=function(){y("'emval_free_list' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"emval_symbols")||(u.emval_symbols=function(){y("'emval_symbols' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"init_emval")||(u.init_emval=function(){y("'init_emval' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"count_emval_handles")||(u.count_emval_handles=function(){y("'count_emval_handles' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"get_first_emval")||(u.get_first_emval=function(){y("'get_first_emval' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"getStringOrSymbol")||(u.getStringOrSymbol=function(){y("'getStringOrSymbol' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"requireHandle")||(u.requireHandle=function(){y("'requireHandle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"emval_newers")||(u.emval_newers=function(){y("'emval_newers' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"craftEmvalAllocator")||(u.craftEmvalAllocator=function(){y("'craftEmvalAllocator' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"emval_get_global")||(u.emval_get_global=function(){y("'emval_get_global' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"emval_methodCallers")||(u.emval_methodCallers=function(){y("'emval_methodCallers' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"InternalError")||(u.InternalError=function(){y("'InternalError' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"BindingError")||(u.BindingError=function(){y("'BindingError' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"UnboundTypeError")||(u.UnboundTypeError=function(){y("'UnboundTypeError' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"PureVirtualError")||(u.PureVirtualError=function(){y("'PureVirtualError' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"init_embind")||(u.init_embind=function(){y("'init_embind' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"throwInternalError")||(u.throwInternalError=function(){y("'throwInternalError' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"throwBindingError")||(u.throwBindingError=function(){y("'throwBindingError' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"throwUnboundTypeError")||(u.throwUnboundTypeError=function(){y("'throwUnboundTypeError' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"ensureOverloadTable")||(u.ensureOverloadTable=function(){y("'ensureOverloadTable' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"exposePublicSymbol")||(u.exposePublicSymbol=function(){y("'exposePublicSymbol' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"replacePublicSymbol")||(u.replacePublicSymbol=function(){y("'replacePublicSymbol' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"extendError")||(u.extendError=function(){y("'extendError' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"createNamedFunction")||(u.createNamedFunction=function(){y("'createNamedFunction' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registeredInstances")||(u.registeredInstances=function(){y("'registeredInstances' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"getBasestPointer")||(u.getBasestPointer=function(){y("'getBasestPointer' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registerInheritedInstance")||(u.registerInheritedInstance=function(){y("'registerInheritedInstance' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"unregisterInheritedInstance")||(u.unregisterInheritedInstance=function(){y("'unregisterInheritedInstance' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"getInheritedInstance")||(u.getInheritedInstance=function(){y("'getInheritedInstance' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"getInheritedInstanceCount")||(u.getInheritedInstanceCount=function(){y("'getInheritedInstanceCount' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"getLiveInheritedInstances")||(u.getLiveInheritedInstances=function(){y("'getLiveInheritedInstances' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registeredTypes")||(u.registeredTypes=function(){y("'registeredTypes' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"awaitingDependencies")||(u.awaitingDependencies=function(){y("'awaitingDependencies' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"typeDependencies")||(u.typeDependencies=function(){y("'typeDependencies' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registeredPointers")||(u.registeredPointers=function(){y("'registeredPointers' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"registerType")||(u.registerType=function(){y("'registerType' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"whenDependentTypesAreResolved")||(u.whenDependentTypesAreResolved=function(){y("'whenDependentTypesAreResolved' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"embind_charCodes")||(u.embind_charCodes=function(){y("'embind_charCodes' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"embind_init_charCodes")||(u.embind_init_charCodes=function(){y("'embind_init_charCodes' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"readLatin1String")||(u.readLatin1String=function(){y("'readLatin1String' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"getTypeName")||(u.getTypeName=function(){y("'getTypeName' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"heap32VectorToArray")||(u.heap32VectorToArray=function(){y("'heap32VectorToArray' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"requireRegisteredType")||(u.requireRegisteredType=function(){y("'requireRegisteredType' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"getShiftFromSize")||(u.getShiftFromSize=function(){y("'getShiftFromSize' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"integerReadValueFromPointer")||(u.integerReadValueFromPointer=function(){y("'integerReadValueFromPointer' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"enumReadValueFromPointer")||(u.enumReadValueFromPointer=function(){y("'enumReadValueFromPointer' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"floatReadValueFromPointer")||(u.floatReadValueFromPointer=function(){y("'floatReadValueFromPointer' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"simpleReadValueFromPointer")||(u.simpleReadValueFromPointer=function(){y("'simpleReadValueFromPointer' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"runDestructors")||(u.runDestructors=function(){y("'runDestructors' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"new_")||(u.new_=function(){y("'new_' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"craftInvokerFunction")||(u.craftInvokerFunction=function(){y("'craftInvokerFunction' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"embind__requireFunction")||(u.embind__requireFunction=function(){y("'embind__requireFunction' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"tupleRegistrations")||(u.tupleRegistrations=function(){y("'tupleRegistrations' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"structRegistrations")||(u.structRegistrations=function(){y("'structRegistrations' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"genericPointerToWireType")||(u.genericPointerToWireType=function(){y("'genericPointerToWireType' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"constNoSmartPtrRawPointerToWireType")||(u.constNoSmartPtrRawPointerToWireType=function(){y("'constNoSmartPtrRawPointerToWireType' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"nonConstNoSmartPtrRawPointerToWireType")||(u.nonConstNoSmartPtrRawPointerToWireType=function(){y("'nonConstNoSmartPtrRawPointerToWireType' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"init_RegisteredPointer")||(u.init_RegisteredPointer=function(){y("'init_RegisteredPointer' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"RegisteredPointer")||(u.RegisteredPointer=function(){y("'RegisteredPointer' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"RegisteredPointer_getPointee")||(u.RegisteredPointer_getPointee=function(){y("'RegisteredPointer_getPointee' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"RegisteredPointer_destructor")||(u.RegisteredPointer_destructor=function(){y("'RegisteredPointer_destructor' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"RegisteredPointer_deleteObject")||(u.RegisteredPointer_deleteObject=function(){y("'RegisteredPointer_deleteObject' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"RegisteredPointer_fromWireType")||(u.RegisteredPointer_fromWireType=function(){y("'RegisteredPointer_fromWireType' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"runDestructor")||(u.runDestructor=function(){y("'runDestructor' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"releaseClassHandle")||(u.releaseClassHandle=function(){y("'releaseClassHandle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"finalizationGroup")||(u.finalizationGroup=function(){y("'finalizationGroup' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"detachFinalizer_deps")||(u.detachFinalizer_deps=function(){y("'detachFinalizer_deps' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"detachFinalizer")||(u.detachFinalizer=function(){y("'detachFinalizer' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"attachFinalizer")||(u.attachFinalizer=function(){y("'attachFinalizer' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"makeClassHandle")||(u.makeClassHandle=function(){y("'makeClassHandle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"init_ClassHandle")||(u.init_ClassHandle=function(){y("'init_ClassHandle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"ClassHandle")||(u.ClassHandle=function(){y("'ClassHandle' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"ClassHandle_isAliasOf")||(u.ClassHandle_isAliasOf=function(){y("'ClassHandle_isAliasOf' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"throwInstanceAlreadyDeleted")||(u.throwInstanceAlreadyDeleted=function(){y("'throwInstanceAlreadyDeleted' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"ClassHandle_clone")||(u.ClassHandle_clone=function(){y("'ClassHandle_clone' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"ClassHandle_delete")||(u.ClassHandle_delete=function(){y("'ClassHandle_delete' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"deletionQueue")||(u.deletionQueue=function(){y("'deletionQueue' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"ClassHandle_isDeleted")||(u.ClassHandle_isDeleted=function(){y("'ClassHandle_isDeleted' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"ClassHandle_deleteLater")||(u.ClassHandle_deleteLater=function(){y("'ClassHandle_deleteLater' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"flushPendingDeletes")||(u.flushPendingDeletes=function(){y("'flushPendingDeletes' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"delayFunction")||(u.delayFunction=function(){y("'delayFunction' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"setDelayFunction")||(u.setDelayFunction=function(){y("'setDelayFunction' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"RegisteredClass")||(u.RegisteredClass=function(){y("'RegisteredClass' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"shallowCopyInternalPointer")||(u.shallowCopyInternalPointer=function(){y("'shallowCopyInternalPointer' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"downcastPointer")||(u.downcastPointer=function(){y("'downcastPointer' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"upcastPointer")||(u.upcastPointer=function(){y("'upcastPointer' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"validateThis")||(u.validateThis=function(){y("'validateThis' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"char_0")||(u.char_0=function(){y("'char_0' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"char_9")||(u.char_9=function(){y("'char_9' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"makeLegalFunctionName")||(u.makeLegalFunctionName=function(){y("'makeLegalFunctionName' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"emscriptenWebGLGetIndexed")||(u.emscriptenWebGLGetIndexed=function(){y("'emscriptenWebGLGetIndexed' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"warnOnce")||(u.warnOnce=function(){y("'warnOnce' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"stackSave")||(u.stackSave=function(){y("'stackSave' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"stackRestore")||(u.stackRestore=function(){y("'stackRestore' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"stackAlloc")||(u.stackAlloc=function(){y("'stackAlloc' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"AsciiToString")||(u.AsciiToString=function(){y("'AsciiToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"stringToAscii")||(u.stringToAscii=function(){y("'stringToAscii' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"UTF16ToString")||(u.UTF16ToString=function(){y("'UTF16ToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"stringToUTF16")||(u.stringToUTF16=function(){y("'stringToUTF16' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"lengthBytesUTF16")||(u.lengthBytesUTF16=function(){y("'lengthBytesUTF16' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"UTF32ToString")||(u.UTF32ToString=function(){y("'UTF32ToString' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"stringToUTF32")||(u.stringToUTF32=function(){y("'stringToUTF32' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"lengthBytesUTF32")||(u.lengthBytesUTF32=function(){y("'lengthBytesUTF32' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"allocateUTF8")||(u.allocateUTF8=function(){y("'allocateUTF8' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),Object.getOwnPropertyDescriptor(u,"allocateUTF8OnStack")||(u.allocateUTF8OnStack=function(){y("'allocateUTF8OnStack' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}),u.writeStackCookie=Wi,u.checkStackCookie=yr,Object.getOwnPropertyDescriptor(u,"ALLOC_NORMAL")||Object.defineProperty(u,"ALLOC_NORMAL",{configurable:!0,get(){y("'ALLOC_NORMAL' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),Object.getOwnPropertyDescriptor(u,"ALLOC_STACK")||Object.defineProperty(u,"ALLOC_STACK",{configurable:!0,get(){y("'ALLOC_STACK' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)")}});let nn;function cc(o){this.name="ExitStatus",this.message=`Program terminated with exit(${o})`,this.status=o}In=function o(){nn||Ws(),nn||(In=o)};function ql(){iA(),Wi()}function Ws(o){if(Je>0||(ql(),Ji(),Je>0))return;function s(){nn||(nn=!0,u.calledRun=!0,!nr&&(ps(),Z(u),u.onRuntimeInitialized&&u.onRuntimeInitialized(),q(!u._main,'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]'),lt()))}u.setStatus?(u.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>{u.setStatus("")},1),s()},1)):s(),yr()}u.run=Ws;function EA(){let o=xt,s=Pe,l=!1;xt=Pe=function(h){l=!0};try{let h=u._fflush;h&&h(0),["stdout","stderr"].forEach(p=>{let m=I.analyzePath(`/dev/${p}`);if(!m)return;let _=m.object,{rdev:C}=_,R=ci.ttys[C];R&&R.output&&R.output.length&&(l=!0)})}catch{}xt=o,Pe=s,l&&Ge("stdio streams had content in them that was not flushed. you should set EXIT_RUNTIME to 1 (see the FAQ), or make sure to emit a newline when you printf etc.")}function _A(o,s){if(Ri=o,EA(),Br()){if(!s){let l=`program exited (with status: ${o}), but EXIT_RUNTIME is not set, so halting execution but not exiting the runtime or preventing further async execution (build with EXIT_RUNTIME=1, if you want a true shutdown)`;we(l),Pe(l)}}else ms();$l(o)}function $l(o){Ri=o,Br()||(u.onExit&&u.onExit(o),nr=!0),dt(o,new cc(o))}if(u.preInit)for(typeof u.preInit=="function"&&(u.preInit=[u.preInit]);u.preInit.length>0;)u.preInit.pop()();return Ws(),de.ready}}(),Fx=Ux,Vx={},jx=(()=>{var ge=Vx.url;return function(de={}){var u,Z=Object.assign({},de),we,_t,It=new Promise((v,S)=>{we=v,_t=S}),Ht=Object.assign({},Z),dt="";typeof document<"u"&&document.currentScript&&(dt=document.currentScript.src),ge&&(dt=ge),dt.startsWith("blob:")?dt="":dt=dt.substr(0,dt.replace(/[?#].*/,"").lastIndexOf("/")+1),Z.print||console.log.bind(console);var ir=Z.printErr||console.error.bind(console);Object.assign(Z,Ht),Ht=null,Z.arguments&&Z.arguments,Z.thisProgram&&Z.thisProgram,Z.quit&&Z.quit;var Oe;Z.wasmBinary&&(Oe=Z.wasmBinary);function Ur(v){for(var S=atob(v),B=new Uint8Array(S.length),L=0;L<S.length;++L)B[L]=S.charCodeAt(L);return B}function nl(v){if(io(v))return Ur(v.slice(Vr.length))}var Ir,ii=!1,Fr,Gt,vi,xt,Pe,Ge,As,Dr;function ni(){var v=Ir.buffer;Z.HEAP8=Fr=new Int8Array(v),Z.HEAP16=vi=new Int16Array(v),Z.HEAPU8=Gt=new Uint8Array(v),Z.HEAPU16=xt=new Uint16Array(v),Z.HEAP32=Pe=new Int32Array(v),Z.HEAPU32=Ge=new Uint32Array(v),Z.HEAPF32=As=new Float32Array(v),Z.HEAPF64=Dr=new Float64Array(v)}var wa=[],Hi=[],nr=[];function Ri(){if(Z.preRun)for(typeof Z.preRun=="function"&&(Z.preRun=[Z.preRun]);Z.preRun.length;)Yi(Z.preRun.shift());pt(wa)}function q(){pt(Hi)}function Gi(){if(Z.postRun)for(typeof Z.postRun=="function"&&(Z.postRun=[Z.postRun]);Z.postRun.length;)to(Z.postRun.shift());pt(nr)}function Yi(v){wa.unshift(v)}function ur(v){Hi.unshift(v)}function to(v){nr.unshift(v)}var Cr=0,Or=null;function hs(v){var S;Cr++,(S=Z.monitorRunDependencies)==null||S.call(Z,Cr)}function gs(v){var S;if(Cr--,(S=Z.monitorRunDependencies)==null||S.call(Z,Cr),Cr==0&&Or){var B=Or;Or=null,B()}}function ro(v){var S;(S=Z.onAbort)==null||S.call(Z,v),v="Aborted("+v+")",ir(v),ii=!0,v+=". Build with -sASSERTIONS for more info.";var B=new WebAssembly.RuntimeError(v);throw _t(B),B}var Vr="data:application/octet-stream;base64,",io=v=>v.startsWith(Vr);function ol(){var v="data:application/octet-stream;base64,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BSQAAkAgAiADTA0AIARBgMAEcQ0AIAUgASACIANrIgNBgAIgA0GAAkkiARsQIxogAUUEQANAIAAgBUGAAhAcIANBgAJrIgNB/wFLDQALCyAAIAUgAxAcCyAFQYACaiQAC+UDAQV/IwBBEGsiAyQAIAMgACgCACIEQQhrKAIAIgI2AgwgAyAAIAJqNgIEIAMgBEEEaygCADYCCCADKAIIIgQgAUEAEB0hAiADKAIEIQUCQCACBEAgAygCDCEAIwBBQGoiASQAIAFBQGskAEEAIAUgABshAgwBCyMAQUBqIgIkACAAIAVOBEAgAkIANwIcIAJCADcCJCACQgA3AiwgAkIANwIUIAJBADYCECACIAE2AgwgAiAENgIEIAJBADYCPCACQoGAgICAgICAATcCNCACIAA2AgggBCACQQRqIAUgBUEBQQAgBCgCACgCFBEJACAAQQAgAigCHBshBgsgAkFAayQAIAYiAg0AIwBBQGoiAiQAIAJBADYCECACQezIADYCDCACIAA2AgggAiABNgIEQQAhACACQRRqQQBBJxAjGiACQQA2AjwgAkEBOgA7IAQgAkEEaiAFQQFBACAEKAIAKAIYEQgAAkACQAJAIAIoAigOAgABAgsgAigCGEEAIAIoAiRBAUYbQQAgAigCIEEBRhtBACACKAIsQQFGGyEADAELIAIoAhxBAUcEQCACKAIsDQEgAigCIEEBRw0BIAIoAiRBAUcNAQsgAigCFCEACyACQUBrJAAgACECCyADQRBqJAAgAgu0AQEFfyMAQRBrIgYkACAGQQRqIgIQQSMAQRBrIgUkAAJ/IAItAAtBB3YEQCACKAIEDAELIAItAAtB/wBxCyEEA0ACQAJ/IAItAAtBB3YEQCACKAIADAELIAILIQMgBSABOQMAIAICfyADIARBAWogBRBHIgNBAE4EQCADIARNDQIgAwwBCyAEQQF0QQFyCyIEECwMAQsLIAIgAxAsIAAgAhBAIAVBEGokACACEEQgBkEQaiQAC4AEAQN/IAJBgARPBEAgACABIAIQESAADwsgACACaiEDAkAgACABc0EDcUUEQAJAIABBA3FFBEAgACECDAELIAJFBEAgACECDAELIAAhAgNAIAIgAS0AADoAACABQQFqIQEgAkEBaiICQQNxRQ0BIAIgA0kNAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgACADQQRrIgRLBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsLACABIAIgABBFGgvyAgICfwF+AkAgAkUNACAAIAE6AAAgACACaiIDQQFrIAE6AAAgAkEDSQ0AIAAgAToAAiAAIAE6AAEgA0EDayABOgAAIANBAmsgAToAACACQQdJDQAgACABOgADIANBBGsgAToAACACQQlJDQAgAEEAIABrQQNxIgRqIgMgAUH/AXFBgYKECGwiATYCACADIAIgBGtBfHEiBGoiAkEEayABNgIAIARBCUkNACADIAE2AgggAyABNgIEIAJBCGsgATYCACACQQxrIAE2AgAgBEEZSQ0AIAMgATYCGCADIAE2AhQgAyABNgIQIAMgATYCDCACQRBrIAE2AgAgAkEUayABNgIAIAJBGGsgATYCACACQRxrIAE2AgAgBCADQQRxQRhyIgRrIgJBIEkNACABrUKBgICAEH4hBSADIARqIQEDQCABIAU3AxggASAFNwMQIAEgBTcDCCABIAU3AwAgAUEgaiEBIAJBIGsiAkEfSw0ACwsgAAsSACABQQF0QYDHAGpBAiAAEEULBQAQaQALiAECAX4FfwJAIABCgICAgBBUBEAgACECDAELA0AgAUEBayIBIAAgAEIKgCICQgp+fadBMHI6AAAgAEL/////nwFWIQYgAiEAIAYNAAsLIAJCAFIEQCACpyEDA0AgAUEBayIBIAMgA0EKbiIEQQps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IAAoAghBgICAgHhyNgIIIARBEGokAAwBCxAlAAsgACABNgIECyABAn8gAC0AC0EHdgRAIAAoAgAMAQsgAAsiAmogBRBDIAAgASAFaiIAEDAgBkEAOgAPIAAgAmogBi0ADzoAAAsgBkEQaiQADwsCfyAALQALQQd2BEAgACgCAAwBCyAACyEEIwBBEGsiAiQAAn8gAC0AC0EHdgRAIAAoAgQMAQsgAC0ACwsaIAAgARAwIAJBADoADyABIARqIAItAA86AAAgAkEQaiQACz0BAX8jAEEQayICJAAgAkEAOgAPA0AgAQRAIAAgAi0ADzoAACABQQFrIQEgAEEBaiEADAELCyACQRBqJAALGgAgAC0AC0EHdgRAIAAoAggaIAAoAgAQGAsL5gEBBX8jAEEQayIFJAAjAEEgayIDJAAjAEEQayIEJAAgBCAANgIMIAQgACABajYCCCADIAQoAgw2AhggAyAEKAIINgIcIARBEGokACADKAIYIQQgAygCHCEGIwBBEGsiASQAIAEgBjYCDCACIAQgBiAEayIEEDUgASACIARqNgIIIAMgASgCDDYCECADIAEoAgg2AhQgAUEQaiQAIAMgACADKAIQIABrajYCDCADIAIgAygCFCACa2o2AgggBSADKAIMNgIIIAUgAygCCDYCDCADQSBqJAAgBSgCDCEHIAVBEGokACAHC/MCAQV/IwBBEGsiByQAIAIgAUF/c0H3////B2pNBEACfyAALQALQQd2BEAgACgCAAwBCyAACyEIIAdBBGoiCSABQfP///8DSQR/IAcgAUEBdDYCDCAHIAEgAmo2AgQjAEEQayICJAAgCSgCACAHQQxqIgooAgBJIQsgAkEQaiQAIAogCSALGygCACICQQtPBH8gAkEIakF4cSICIAJBAWsiAiACQQtGGwVBCgtBAWoFQff///8HCxAvIAcoAgQhAiAHKAIIGiAEBEAgAiAIIAQQIgsgBQRAIAIgBGogBiAFECILIAMgBGshBiADIARHBEAgAiAEaiAFaiAEIAhqIAYQIgsgAUEKRwRAIAgQGAsgACACNgIAIAAgACgCCEGAgICAeHEgBygCCEH/////B3FyNgIIIAAgACgCCEGAgICAeHI2AgggACAEIAVqIAZqIgA2AgQgB0EAOgAMIAAgAmogBy0ADDoAACAHQRBqJAAPCxAlAAvHAwEFfyMAQRBrIgUkACAFIAI2AgwjAEGgAWsiAyQAIAMgACADQZ4BaiABGyIENgKUASADIAFBAWsiAEEAIAAgAU0bNgKYASADQQBBkAEQIyIAQX82AkwgAEEbNgIkIABBfzYCUCAAIABBnwFqNgIsIAAgAEGUAWo2AlQgBEEAOgAAQQAhAyMAQdABayIBJAAgASACNgLMASABQaABaiICQQBBKBAjGiABIAEoAswBNgLIAQJAQQAgAUHIAWogAUHQAGogAhBMQQBIBEBBfyECDAELIAAoAkxBAEghByAAIAAoAgAiBkFfcTYCAAJ/AkACQCAAKAIwRQRAIABB0AA2AjAgAEEANgIcIABCADcDECAAKAIsIQMgACABNgIsDAELIAAoAhANAQtBfyAAEE8NARoLIAAgAUHIAWogAUHQAGogAUGgAWoQTAshAiADBEAgAEEAQQAgACgCJBEDABogAEEANgIwIAAgAzYCLCAAQQA2AhwgACgCFCEDIABCADcDECACQX8gAxshAgsgACAAKAIAIgMgBkEgcXI2AgBBfyACIANBIHEbIQIgBw0ACyABQdABaiQAIABBoAFqJAAgBUEQaiQAIAILngUCBn4EfyABIAEoAgBBB2pBeHEiAUEQajYCACAAIQsgASkDACEDIAEpAwghByMAQSBrIggkACAHQv///////z+DIQQCfiAHQjCIQv//AYMiBaciCkGB+ABrQf0PTQRAIARCBIYgA0I8iIQhAiAKQYD4AGutIQUCQCADQv//////////D4MiA0KBgICAgICAgAhaBEAgAkIBfCECDAELIANCgICAgICAgIAIUg0AIAJCAYMgAnwhAgtCACACIAJC/////////wdWIgAbIQIgAK0gBXwMAQsCQCADIASEUA0AIAVC//8BUg0AIARCBIYgA0I8iIRCgICAgICAgASEIQJC/w8MAQtC/w8gCkH+hwFLDQAaQgBBgPgAQYH4ACAFUCIBGyIAIAprIglB8ABKDQAaIAMhAiAEIARCgICAgICAwACEIAEbIgYhBAJAQYABIAlrIgFBwABxBEAgAyABQUBqrYYhBEIAIQIMAQsgAUUNACAEIAGtIgWGIAJBwAAgAWutiIQhBCACIAWGIQILIAggAjcDECAIIAQ3AxgCQCAJQcAAcQRAIAYgCUFAaq2IIQNCACEGDAELIAlF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AgQgAEHM0AA2AgAgAkEQaiQAC2ACAX8BfCMAQRBrIgIkACACQQA2AgwgASgCBEGszAAgAkEMahAJIQMgAigCDCIBBEAgARABCyAAAn8gA5lEAAAAAAAA4EFjBEAgA6oMAQtBgICAgHgLNgI8IAJBEGokAAs3AQF/IwBBEGsiAiQAIAIgASgCPDYCCCAAQazMACACQQhqEAg2AgQgAEHM0AA2AgAgAkEQaiQACwvGRhAAQYAIC5Qic2V0QmVhdXR5AC0rICAgMFgweAAtMFgrMFggMFgtMHgrMHggMHgAdW5zaWduZWQgc2hvcnQAdW5zaWduZWQgaW50AGluaXQAZmxvYXQAdWludDY0X3QAYmx1clJhZGl1cwB2ZWN0b3IAbWlycm9yAGF0dGFjaFNoYWRlcgBkZWxldGVTaGFkZXIAY3JlYXRlU2hhZGVyAGNvbXBpbGVTaGFkZXIAdW5zaWduZWQgY2hhcgBzdGQ6OmV4Y2VwdGlvbgBuYW4AbGlua1Byb2dyYW0AZGVsZXRlUHJvZ3JhbQBjcmVhdGVQcm9ncmFtAGJvb2wAc2V0V2F0ZXJNYXJrAHN0b3BXYXRlck1hcmsAdW5zaWduZWQgbG9uZwBzdGQ6OndzdHJpbmcAYmFzaWNfc3RyaW5nAHN0ZDo6c3RyaW5nAHN0ZDo6dTE2c3RyaW5nAHN0ZDo6dTMyc3RyaW5nAGluZgAlZgBjbG9zZQBkb3VibGUAdmJNb2RlAHNoYWRlclNvdXJjZQB2b2lkAHNhbXBsZUNvbG9yICs9IHRleHR1cmUoZnJhbWUsIGJsdXJDb29yZGluYXRlc1sATkFOAElORgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzxzaG9ydD4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8dW5zaWduZWQgc2hvcnQ+AGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PGludD4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8dW5zaWduZWQgaW50PgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzxmbG9hdD4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8dWludDhfdD4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8aW50OF90PgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzx1aW50MTZfdD4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8aW50MTZfdD4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8dWludDY0X3Q+AGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PGludDY0X3Q+AGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PHVpbnQzMl90PgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzxpbnQzMl90PgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzxjaGFyPgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzx1bnNpZ25lZCBjaGFyPgBzdGQ6OmJhc2ljX3N0cmluZzx1bnNpZ25lZCBjaGFyPgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzxzaWduZWQgY2hhcj4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8bG9uZz4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8dW5zaWduZWQgbG9uZz4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8ZG91YmxlPgB2ZWMyIGMgPSB2X3RleENvb3JkOwB2ZWMyIGMgPSB2ZWMyKDEuMCAtIHZfdGV4Q29vcmQueCwgdl90ZXhDb29yZC55KTsAQWxsSW4xAC4ALjAsAC4wKSpvKSoAKG51bGwpACkqby55KTsgICAgdmVjMiBjb29yZDIgPSB2ZWMyKGZsb2F0KAAgICAgYyA9IHZlYzIodl90ZXhDb29yZC54LCAxLjAgLSB2X3RleENvb3JkLnkpOyAgICB2ZWMyIGNvb3JkMSA9IHZlYzIoZmxvYXQoACksIChjLnkgLWNvb3JkMS55KSAvIG8ueSAvIGZsb2F0KAApKm8ueSk7ICAgIGlmIChjLnggPiBjb29yZDEueCAmJiBjLnggPCBjb29yZDIueCAmJiBjLnkgPiBjb29yZDEueSAmJiBjLnkgPCBjb29yZDIueSkgeyAgICAgIHZlYzQgd2F0ZXJDb2xvciA9IHRleHR1cmUod2F0ZXJNYXJrLCB2ZWMyKChjLnggLSBjb29yZDEueCkgIC8gby54IC8gZmxvYXQoACkgKiBvLngsIGZsb2F0KAApOyAgICAgdmVjMyBzbW9vdGhDb2xvciA9IG91dENvbG9yLnJnYiArIChvdXRDb2xvci5yZ2ItdmVjMyhoaWdoUGFzcykpKmFscGhhKjAuMTsgICAgIHNtb290aENvbG9yID0gY2xhbXAocG93KHNtb290aENvbG9yLCB2ZWMzKAApOyAgICBuZXdDb2xvci5yZ2IgPSB2ZWMzKG5ld0NvbG9yLnJnYiArIHZlYzMoAGcrPUcoYyx2ZWMyKAAgICAgdmVjMiBvZmZzZXQgPSB2ZWMyKABdID0gdl90ZXhDb29yZC54eSArIG9mZnNldCAqIHZlYzIoADsgACkpLCB2ZWMzKDAuMCksIHZlYzMoMS4wKSk7ICAgIHZlYzMgc2NyZWVuID0gdmVjMygxLjApIC0gKHZlYzMoMS4wKS1zbW9vdGhDb2xvcikgKiAodmVjMygxLjApLW91dENvbG9yLnJnYik7ICAgICB2ZWMzIGxpZ2h0ZW4gPSBtYXgoc21vb3RoQ29sb3IsIG91dENvbG9yLnJnYik7ICAgICB2ZWMzIHNvZnRMaWdodCA9IDIuMCAqIG91dENvbG9yLnJnYipzbW9vdGhDb2xvciArIG91dENvbG9yLnJnYipvdXRDb2xvci5yZ2IgLSAyLjAgKiBvdXRDb2xvci5yZ2Iqb3V0Q29sb3IucmdiICogc21vb3RoQ29sb3I7ICAgICB2ZWM0IG5ld0NvbG9yID0gb3V0Q29sb3I7ICAgICBuZXdDb2xvci5yZ2IgPSBtaXgobWl4KG1peChuZXdDb2xvci5yZ2IsIHNjcmVlbiwgYWxwaGEpLCBsaWdodGVuLCBhbHBoYSksIHNvZnRMaWdodCwgACk7ICAgIGNvbnN0IG1hdDMgc2F0dXJhdGVNYXRyaXggPSBtYXQzKDEuMTEwMiwtMC4wNTk4LC0wLjA2MSwtMC4wNzc0LDEuMDgyNiwtMC4xMTg2LC0wLjAyMjgsLTAuMDIyOCwxLjE3NzIpOyAgICB2ZWMzIHNhdENvbG9yID0gbmV3Q29sb3IucmdiICogc2F0dXJhdGVNYXRyaXg7ICAgIG5ld0NvbG9yLnJnYiA9IG1peChuZXdDb2xvci5yZ2IsIHNhdENvbG9yLCAAICAgIHNhbXBsZUNvbG9yID0gc2FtcGxlQ29sb3IgLyA2Mi4wOyAgICAgZmxvYXQgaGlnaFBhc3MgPSBvdXRDb2xvci5nIC0gc2FtcGxlQ29sb3IgKyAwLjU7ICAgICBmb3IoaW50IGkgPSAwOyBpIDwgNTsgaSsrKSB7ICAgICAgIGlmIChoaWdoUGFzcyA8PSAwLjUpIHsgICAgICAgICBoaWdoUGFzcyA9IGhpZ2hQYXNzICogaGlnaFBhc3MgKiAyLjA7ICAgICAgIH0gZWxzZSB7ICAgICAgICAgaGlnaFBhc3MgPSAxLjAgLSAoKDEuMCAtIGhpZ2hQYXNzKSooMS4wIC0gaGlnaFBhc3MpICogMi4wKTsgICAgICAgfSAgICAgfSAgICAgY29uc3QgaGlnaHAgdmVjMyBXID0gdmVjMygwLjI5OSwwLjU4NywwLjExNCk7ICAgIGZsb2F0IGx1bWluYW5jZSA9IGRvdChvdXRDb2xvci5yZ2IsIFcpOyAgICAgZmxvYXQgYWxwaGEgPSBwb3cobHVtaW5hbmNlLCAAXSkuZyAqIAApKTsgICAgb3V0Q29sb3IgPSBtaXgob3V0Q29sb3IsIG5ld0NvbG9yLCAxLjApOyAgIAApKSk7ICAgICAgb3V0Q29sb3IgPSBtaXgob3V0Q29sb3Isd2F0ZXJDb2xvciwgIHdhdGVyQ29sb3IuYSk7ICAgIH0gICAgACk7ICAgIHZlYzIgYmx1ckNvb3JkaW5hdGVzWzI0XTsgICAgACAgICBmbG9hdCBzYW1wbGVDb2xvciA9IG91dENvbG9yLmcgKiAyMi4wOyAgICAgACN2ZXJzaW9uIDMwMCBlcwogICAgcHJlY2lzaW9uIGhpZ2hwIGZsb2F0OwogICAgdW5pZm9ybSBzYW1wbGVyMkQgZnJhbWU7CiAgICB1bmlmb3JtIHNhbXBsZXIyRCBtYXNrOwogICAgdW5pZm9ybSBzYW1wbGVyMkQgYmc7CiAgICB1bmlmb3JtIHNhbXBsZXIyRCB3YXRlck1hcms7CiAgICB1bmlmb3JtIHNhbXBsZXIyRCBsYXN0TWFzazsKICAgIGluIHZlYzIgdl90ZXhDb29yZDsKICAgIG91dCB2ZWM0IG91dENvbG9yOwogICAgdmVjNCBHKHZlYzIgYyx2ZWMyIHMpewogICAgICByZXR1cm4gdGV4dHVyZShmcmFtZSx0ZXh0dXJlKG1hc2ssYytzKS5hPjAuMz9jOmMrcyk7CiAgICB9CiAgICB2b2lkIG1haW4oKSB7CiAgICAgIAAKICAgIHZlYzQgZyA9IHZlYzQoMC4wKTsKICAgIAAKICAgICAgYy55ID0gMS4wIC0gYy55OwogICAgICB2ZWM0IHNyY19jb2xvciA9IHRleHR1cmUoZnJhbWUsIGMpOwogICAgICBmbG9hdCBhID0gdGV4dHVyZShtYXNrLCBjKS5hOwogICAgICBhID0gYTwwLjU/Mi4wKmEqYToxLjAtMi4wKigxLjAtYSkqKDEuMC1hKTsKICAgICAgLy8gZmxvYXQgYTIgPSB0ZXh0dXJlKGxhc3RNYXNrLCBjKS5hOwogICAgICAvLyBhMiA9IGEyPDAuNT8yLjAqYTIqYTI6MS4wLTIuMCooMS4wLWEyKSooMS4wLWEyKTsKICAgICAgLy8gZmxvYXQgZGVsdGEgPSBhIC0gYTI7CiAgICAgIC8vIGlmIChkZWx0YSA8IDAuMjUgJiYgZGVsdGEgPiAtMC4yNSkKICAgICAgLy8gewogICAgICAvLyAgICAgYSA9IGEgKyAwLjUqZGVsdGE7CiAgICAgIC8vIH0KICAgICAgCiAgICAgIHZlYzIgbyA9IDEuMCAvIHZlYzIodGV4dHVyZVNpemUoZnJhbWUsIDApKTsKICAgIAAKICAgICAgb3V0Q29sb3IgPSBnOwogIAAjdmVyc2lvbiAzMDAgZXMKaW4gdmVjMiBhX3Bvc2l0aW9uOwppbiB2ZWMyIGFfdGV4Q29vcmQ7Cm91dCB2ZWMyIHZfdGV4Q29vcmQ7CnZvaWQgbWFpbigpIHsKICBnbF9Qb3NpdGlvbiA9IHZlYzQoYV9wb3NpdGlvbi54LCBhX3Bvc2l0aW9uLnksIDAsIDEpOwogIHZfdGV4Q29vcmQgPSBhX3RleENvb3JkOwp9CgBvdXRDb2xvciA9IHNyY19jb2xvcjsKAG91dENvbG9yID0gbWl4KHRleHR1cmUoYmcsIGMpLHNyY19jb2xvcixhKTsKAG91dENvbG9yID0gbWl4KHZlYzQoMC4wLDEuMCwwLjAsMS4wKSxzcmNfY29sb3IsYSk7CgA2QWxsSW4xAJAmAABwFAAAUDZBbGxJbjEAAAAAFCcAAIAUAAAAAAAAeBQAAFBLNkFsbEluMQAAABQnAACcFAAAAQAAAHgUAABwcAB2AHZwAIwUAADcFAAATjEwZW1zY3JpcHRlbjN2YWxFAACQJgAAyBQAAHBwcAB2cHBwAAAAAMwlAACMFAAAgCYAAIAmAACAJgAAgCYAAIAmAAB2cHBkZGRkZABBoCoLyAjMJQAAjBQAAIAmAACAJgAAgCYAAIAmAAB2cHBkZGRkAMwlAACMFAAAdnBwAMwlAADcFAAA3BQAAIwUAADcFAAALCYAAMwlAADcFAAAsBUAAE5TdDNfXzIxMmJhc2ljX3N0cmluZ0ljTlNfMTFjaGFyX3RyYWl0c0ljRUVOU185YWxsb2NhdG9ySWNFRUVFAACQJgAAcBUAANwUAADMJQAA3BQAANwUAABOU3QzX18yMTJiYXNpY19zdHJpbmdJaE5TXzExY2hhcl90cmFpdHNJaEVFTlNfOWFsbG9jYXRvckloRUVFRQAAkCYAAMgVAABOU3QzX18yMTJiYXNpY19zdHJpbmdJd05TXzExY2hhcl90cmFpdHNJd0VFTlNfOWFsbG9jYXRvckl3RUVFRQAAkCYAABAWAABOU3QzX18yMTJiYXNpY19zdHJpbmdJRHNOU18xMWNoYXJfdHJhaXRzSURzRUVOU185YWxsb2NhdG9ySURzRUVFRQAAAJAmAABYFgAATlN0M19fMjEyYmFzaWNfc3RyaW5nSURpTlNfMTFjaGFyX3RyYWl0c0lEaUVFTlNfOWFsbG9jYXRvcklEaUVFRUUAAACQJgAApBYAAE4xMGVtc2NyaXB0ZW4xMW1lbW9yeV92aWV3SWNFRQAAkCYAAPAWAABOMTBlbXNjcmlwdGVuMTFtZW1vcnlfdmlld0lhRUUAAJAmAAAYFwAATjEwZW1zY3JpcHRlbjExbWVtb3J5X3ZpZXdJaEVFAACQJgAAQBcAAE4xMGVtc2NyaXB0ZW4xMW1lbW9yeV92aWV3SXNFRQAAkCYAAGgXAABOMTBlbXNjcmlwdGVuMTFtZW1vcnlfdmlld0l0RUUAAJAmAACQFwAATjEwZW1zY3JpcHRlbjExbWVtb3J5X3ZpZXdJaUVFAACQJgAAuBcAAE4xMGVtc2NyaXB0ZW4xMW1lbW9yeV92aWV3SWpFRQAAkCYAAOAXAABOMTBlbXNjcmlwdGVuMTFtZW1vcnlfdmlld0lsRUUAAJAmAAAIGAAATjEwZW1zY3JpcHRlbjExbWVtb3J5X3ZpZXdJbUVFAACQJgAAMBgAAE4xMGVtc2NyaXB0ZW4x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";return v}var no;function or(v){if(v==no&&Oe)return new Uint8Array(Oe);var S=nl(v);if(S)return S;throw"both async and sync fetching of the wasm failed"}function sl(v){return Promise.resolve().then(()=>or(v))}function al(v,S,B){return sl(v).then(L=>WebAssembly.instantiate(L,S)).then(B,L=>{ir(`failed to asynchronously prepare wasm: ${L}`),ro(L)})}function Bt(v,S,B,L){return al(S,B,L)}function En(){return{a:To}}function ft(){var v=En();function S(L,J){return Zt=L.exports,Ir=Zt.y,ni(),qi=Zt.B,ur(Zt.z),gs(),Zt}hs();function B(L){S(L.instance)}if(Z.instantiateWasm)try{return Z.instantiateWasm(v,S)}catch(L){ir(`Module.instantiateWasm callback failed with error: ${L}`),_t(L)}return no||(no=ol()),Bt(Oe,no,v,B).catch(_t),{}}var pt=v=>{for(;v.length>0;)v.shift()(Z)};Z.noExitRuntime;class oi{constructor(S){this.excPtr=S,this.ptr=S-24}set_type(S){Ge[this.ptr+4>>2]=S}get_type(){return Ge[this.ptr+4>>2]}set_destructor(S){Ge[this.ptr+8>>2]=S}get_destructor(){return Ge[this.ptr+8>>2]}set_caught(S){S=S?1:0,Fr[this.ptr+12]=S}get_caught(){return Fr[this.ptr+12]!=0}set_rethrown(S){S=S?1:0,Fr[this.ptr+13]=S}get_rethrown(){return Fr[this.ptr+13]!=0}init(S,B){this.set_adjusted_ptr(0),this.set_type(S),this.set_destructor(B)}set_adjusted_ptr(S){Ge[this.ptr+16>>2]=S}get_adjusted_ptr(){return Ge[this.ptr+16>>2]}get_exception_ptr(){var S=vo(this.get_type());if(S)return Ge[this.excPtr>>2];var B=this.get_adjusted_ptr();return B!==0?B:this.excPtr}}var si=0,M=(v,S,B)=>{var L=new oi(v);throw L.init(S,B),si=v,si},ct=()=>{ro("")},wt=(v,S,B,L,J)=>{},oo=()=>{for(var v=new Array(256),S=0;S<256;++S)v[S]=String.fromCharCode(S);so=v},so,Ut=v=>{for(var S="",B=v;Gt[B];)S+=so[Gt[B++]];return S},jr={},ce={},Wi={},yr,Fe=v=>{throw new yr(v)},ao,_n=v=>{throw new ao(v)},kr=(v,S,B)=>{v.forEach(function($){Wi[$]=S});function L($){var ue=B($);ue.length!==v.length&&_n("Mismatched type converter count");for(var Ae=0;Ae<v.length;++Ae)Hr(v[Ae],ue[Ae])}var J=new Array(S.length),ee=[],oe=0;S.forEach(($,ue)=>{ce.hasOwnProperty($)?J[ue]=ce[$]:(ee.push($),jr.hasOwnProperty($)||(jr[$]=[]),jr[$].push(()=>{J[ue]=ce[$],++oe,oe===ee.length&&L(J)}))}),ee.length===0&&L(J)};function Da(v,S,B={}){var L=S.name;if(v||Fe(`type "${L}" must have a positive integer typeid pointer`),ce.hasOwnProperty(v)){if(B.ignoreDuplicateRegistrations)return;Fe(`Cannot register type '${L}' twice`)}if(ce[v]=S,delete Wi[v],jr.hasOwnProperty(v)){var J=jr[v];delete jr[v],J.forEach(ee=>ee())}}function Hr(v,S,B={}){if(!("argPackAdvance"in S))throw new TypeError("registerType registeredInstance requires argPackAdvance");return Da(v,S,B)}var Br=8,Ji=(v,S,B,L)=>{S=Ut(S),Hr(v,{name:S,fromWireType:function(J){return!!J},toWireType:function(J,ee){return ee?B:L},argPackAdvance:Br,readValueFromPointer:function(J){return this.fromWireType(Gt[J])},destructorFunction:null})},ps=v=>({count:v.count,deleteScheduled:v.deleteScheduled,preservePointerOnDelete:v.preservePointerOnDelete,ptr:v.ptr,ptrType:v.ptrType,smartPtr:v.smartPtr,smartPtrType:v.smartPtrType}),ms=v=>{function S(B){return B.$$.ptrType.registeredClass.name}Fe(S(v)+" instance already deleted")},lt=!1,co=v=>{},lo=v=>{v.smartPtr?v.smartPtrType.rawDestructor(v.smartPtr):v.ptrType.registeredClass.rawDestructor(v.ptr)},Oa=v=>{v.count.value-=1;var S=v.count.value===0;S&&lo(v)},Je=(v,S,B)=>{if(S===B)return v;if(B.baseClass===void 0)return null;var L=Je(v,S,B.baseClass);return L===null?null:B.downcast(L)},Gr={},In=()=>Object.keys(At).length,Ct=()=>{var v=[];for(var S in At)At.hasOwnProperty(S)&&v.push(At[S]);return v},Ki=[],Xi=()=>{for(;Ki.length;){var v=Ki.pop();v.$$.deleteScheduled=!1,v.delete()}},Yr,y=v=>{Yr=v,Ki.length&&Yr&&Yr(Xi)},ka=()=>{Z.getInheritedInstanceCount=In,Z.getLiveInheritedInstances=Ct,Z.flushPendingDeletes=Xi,Z.setDelayFunction=y},At={},Me=(v,S)=>{for(S===void 0&&Fe("ptr should not be undefined");v.baseClass;)S=v.upcast(S),v=v.baseClass;return S},Ft=(v,S)=>(S=Me(v,S),At[S]),Cn=(v,S)=>{(!S.ptrType||!S.ptr)&&_n("makeClassHandle requires ptr and ptrType");var B=!!S.smartPtrType,L=!!S.smartPtr;return B!==L&&_n("Both smartPtrType and smartPtr must be specified"),S.count={value:1},sr(Object.create(v,{$$:{value:S,writable:!0}}))};function yt(v){var S=this.getPointee(v);if(!S)return this.destructor(v),null;var B=Ft(this.registeredClass,S);if(B!==void 0){if(B.$$.count.value===0)return B.$$.ptr=S,B.$$.smartPtr=v,B.clone();var L=B.clone();return this.destructor(v),L}function J(){return this.isSmartPointer?Cn(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:S,smartPtrType:this,smartPtr:v}):Cn(this.registeredClass.instancePrototype,{ptrType:this,ptr:v})}var ee=this.registeredClass.getActualType(S),oe=Gr[ee];if(!oe)return J.call(this);var $;this.isConst?$=oe.constPointerType:$=oe.pointerType;var ue=Je(S,this.registeredClass,$.registeredClass);return ue===null?J.call(this):this.isSmartPointer?Cn($.registeredClass.instancePrototype,{ptrType:$,ptr:ue,smartPtrType:this,smartPtr:v}):Cn($.registeredClass.instancePrototype,{ptrType:$,ptr:ue})}var sr=v=>typeof FinalizationRegistry>"u"?(sr=S=>S,v):(lt=new FinalizationRegistry(S=>{Oa(S.$$)}),sr=S=>{var B=S.$$,L=!!B.smartPtr;if(L){var J={$$:B};lt.register(S,J,S)}return S},co=S=>lt.unregister(S),sr(v)),yn=()=>{Object.assign(uo.prototype,{isAliasOf(v){if(!(this instanceof uo)||!(v instanceof uo))return!1;var S=this.$$.ptrType.registeredClass,B=this.$$.ptr;v.$$=v.$$;for(var L=v.$$.ptrType.registeredClass,J=v.$$.ptr;S.baseClass;)B=S.upcast(B),S=S.baseClass;for(;L.baseClass;)J=L.upcast(J),L=L.baseClass;return S===L&&B===J},clone(){if(this.$$.ptr||ms(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var v=sr(Object.create(Object.getPrototypeOf(this),{$$:{value:ps(this.$$)}}));return v.$$.count.value+=1,v.$$.deleteScheduled=!1,v},delete(){this.$$.ptr||ms(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Fe("Object already scheduled for deletion"),co(this),Oa(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},isDeleted(){return!this.$$.ptr},deleteLater(){return this.$$.ptr||ms(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Fe("Object already scheduled for deletion"),Ki.push(this),Ki.length===1&&Yr&&Yr(Xi),this.$$.deleteScheduled=!0,this}})};function uo(){}var bi=(v,S)=>Object.defineProperty(S,"name",{value:v}),ai=(v,S,B)=>{if(v[S].overloadTable===void 0){var L=v[S];v[S]=function(...J){return v[S].overloadTable.hasOwnProperty(J.length)||Fe(`Function '${B}' called with an invalid number of arguments (${J.length}) - expects one of (${v[S].overloadTable})!`),v[S].overloadTable[J.length].apply(this,J)},v[S].overloadTable=[],v[S].overloadTable[L.argCount]=L}},Tn=(v,S,B)=>{Z.hasOwnProperty(v)?((B===void 0||Z[v].overloadTable!==void 0&&Z[v].overloadTable[B]!==void 0)&&Fe(`Cannot register public name '${v}' twice`),ai(Z,v,v),Z.hasOwnProperty(B)&&Fe(`Cannot register multiple overloads of a function with the same number of arguments (${B})!`),Z[v].overloadTable[B]=S):(Z[v]=S,B!==void 0&&(Z[v].numArguments=B))},ht=48,fs=57,Es=v=>{if(v===void 0)return"_unknown";v=v.replace(/[^a-zA-Z0-9_]/g,"$");var S=v.charCodeAt(0);return S>=ht&&S<=fs?`_${v}`:v};function Wr(v,S,B,L,J,ee,oe,$){this.name=v,this.constructor=S,this.instancePrototype=B,this.rawDestructor=L,this.baseClass=J,this.getActualType=ee,this.upcast=oe,this.downcast=$,this.pureVirtualFunctions=[]}var j=(v,S,B)=>{for(;S!==B;)S.upcast||Fe(`Expected null or instance of ${B.name}, got an instance of ${S.name}`),v=S.upcast(v),S=S.baseClass;return v};function _s(v,S){if(S===null)return this.isReference&&Fe(`null is not a valid ${this.name}`),0;S.$$||Fe(`Cannot pass "${at(S)}" as a ${this.name}`),S.$$.ptr||Fe(`Cannot pass deleted object as a pointer of type ${this.name}`);var B=S.$$.ptrType.registeredClass,L=j(S.$$.ptr,B,this.registeredClass);return L}function cl(v,S){var B;if(S===null)return this.isReference&&Fe(`null is not a valid ${this.name}`),this.isSmartPointer?(B=this.rawConstructor(),v!==null&&v.push(this.rawDestructor,B),B):0;(!S||!S.$$)&&Fe(`Cannot pass "${at(S)}" as a ${this.name}`),S.$$.ptr||Fe(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.isConst&&S.$$.ptrType.isConst&&Fe(`Cannot convert argument of type ${S.$$.smartPtrType?S.$$.smartPtrType.name:S.$$.ptrType.name} to parameter type ${this.name}`);var L=S.$$.ptrType.registeredClass;if(B=j(S.$$.ptr,L,this.registeredClass),this.isSmartPointer)switch(S.$$.smartPtr===void 0&&Fe("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:S.$$.smartPtrType===this?B=S.$$.smartPtr:Fe(`Cannot convert argument of type ${S.$$.smartPtrType?S.$$.smartPtrType.name:S.$$.ptrType.name} to parameter type ${this.name}`);break;case 1:B=S.$$.smartPtr;break;case 2:if(S.$$.smartPtrType===this)B=S.$$.smartPtr;else{var J=S.clone();B=this.rawShare(B,Kr.toHandle(()=>J.delete())),v!==null&&v.push(this.rawDestructor,B)}break;default:Fe("Unsupporting sharing policy")}return B}function Ba(v,S){if(S===null)return this.isReference&&Fe(`null is not a valid ${this.name}`),0;S.$$||Fe(`Cannot pass "${at(S)}" as a ${this.name}`),S.$$.ptr||Fe(`Cannot pass deleted object as a pointer of type ${this.name}`),S.$$.ptrType.isConst&&Fe(`Cannot convert argument of type ${S.$$.ptrType.name} to parameter type ${this.name}`);var B=S.$$.ptrType.registeredClass,L=j(S.$$.ptr,B,this.registeredClass);return L}function Ao(v){return this.fromWireType(Ge[v>>2])}var Is=()=>{Object.assign(ho.prototype,{getPointee(v){return this.rawGetPointee&&(v=this.rawGetPointee(v)),v},destructor(v){var S;(S=this.rawDestructor)==null||S.call(this,v)},argPackAdvance:Br,readValueFromPointer:Ao,fromWireType:yt})};function ho(v,S,B,L,J,ee,oe,$,ue,Ae,he){this.name=v,this.registeredClass=S,this.isReference=B,this.isConst=L,this.isSmartPointer=J,this.pointeeType=ee,this.sharingPolicy=oe,this.rawGetPointee=$,this.rawConstructor=ue,this.rawShare=Ae,this.rawDestructor=he,!J&&S.baseClass===void 0?L?(this.toWireType=_s,this.destructorFunction=null):(this.toWireType=Ba,this.destructorFunction=null):this.toWireType=cl}var zi=(v,S,B)=>{Z.hasOwnProperty(v)||_n("Replacing nonexistent public symbol"),Z[v].overloadTable!==void 0&&B!==void 0?Z[v].overloadTable[B]=S:(Z[v]=S,Z[v].argCount=B)},Sn=(v,S,B)=>{v=v.replace(/p/g,"i");var L=Z["dynCall_"+v];return L(S,...B)},wi=[],qi,Ar=v=>{var S=wi[v];return S||(v>=wi.length&&(wi.length=v+1),wi[v]=S=qi.get(v)),S},Cs=(v,S,B=[])=>{if(v.includes("j"))return Sn(v,S,B);var L=Ar(S)(...B);return L},ll=(v,S)=>(...B)=>Cs(v,S,B),Dt=(v,S)=>{v=Ut(v);function B(){return v.includes("j")?ll(v,S):Ar(S)}var L=B();return typeof L!="function"&&Fe(`unknown function pointer with signature ${v}: ${S}`),L},go=(v,S)=>{var B=bi(S,function(L){this.name=S,this.message=L;var J=new Error(L).stack;J!==void 0&&(this.stack=this.toString()+`
`+J.replace(/^Error(:[^\n]*)?\n/,""))});return B.prototype=Object.create(v.prototype),B.prototype.constructor=B,B.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},B},po,mo=v=>{var S=ks(v),B=Ut(S);return Wt(S),B},vn=(v,S)=>{var B=[],L={};function J(ee){if(!L[ee]&&!ce[ee]){if(Wi[ee]){Wi[ee].forEach(J);return}B.push(ee),L[ee]=!0}}throw S.forEach(J),new po(`${v}: `+B.map(mo).join([", "]))},dl=(v,S,B,L,J,ee,oe,$,ue,Ae,he,Ye,ot)=>{he=Ut(he),ee=Dt(J,ee),$&&($=Dt(oe,$)),Ae&&(Ae=Dt(ue,Ae)),ot=Dt(Ye,ot);var nt=Es(he);Tn(nt,function(){vn(`Cannot construct ${he} due to unbound types`,[L])}),kr([v,S,B],L?[L]:[],Nt=>{var cr;Nt=Nt[0];var Jt,Pt;L?(Jt=Nt.registeredClass,Pt=Jt.instancePrototype):Pt=uo.prototype;var hr=bi(he,function(...Zi){if(Object.getPrototypeOf(this)!==Ot)throw new yr("Use 'new' to construct "+he);if(er.constructor_body===void 0)throw new yr(he+" has no accessible constructor");var Bi=er.constructor_body[Zi.length];if(Bi===void 0)throw new yr(`Tried to invoke ctor of ${he} with invalid number of parameters (${Zi.length}) - expected (${Object.keys(er.constructor_body).toString()}) parameters instead!`);return Bi.apply(this,Zi)}),Ot=Object.create(Pt,{constructor:{value:hr}});hr.prototype=Ot;var er=new Wr(he,hr,Ot,ot,Jt,ee,$,Ae);er.baseClass&&((cr=er.baseClass).__derivedClasses!=null||(cr.__derivedClasses=[]),er.baseClass.__derivedClasses.push(er));var tr=new ho(he,er,!0,!1,!1),Dn=new ho(he+"*",er,!1,!1,!1),Bs=new ho(he+" const*",er,!1,!0,!1);return Gr[v]={pointerType:Dn,constPointerType:Bs},zi(nt,hr),[tr,Dn,Bs]})},ys=(v,S)=>{for(var B=[],L=0;L<v;L++)B.push(Ge[S+L*4>>2]);return B},fo=v=>{for(;v.length;){var S=v.pop(),B=v.pop();B(S)}};function ul(v){for(var S=1;S<v.length;++S)if(v[S]!==null&&v[S].destructorFunction===void 0)return!0;return!1}function Na(v,S,B,L,J,ee){var oe=S.length;oe<2&&Fe("argTypes array size mismatch! Must at least get return value and 'this' types!");var $=S[1]!==null&&B!==null,ue=ul(S),Ae=S[0].name!=="void",he=oe-2,Ye=new Array(he),ot=[],nt=[],Nt=function(...cr){cr.length!==he&&Fe(`function ${v} called with ${cr.length} arguments, expected ${he}`),nt.length=0;var Jt;ot.length=$?2:1,ot[0]=J,$&&(Jt=S[1].toWireType(nt,this),ot[1]=Jt);for(var Pt=0;Pt<he;++Pt)Ye[Pt]=S[Pt+2].toWireType(nt,cr[Pt]),ot.push(Ye[Pt]);var hr=L(...ot);function Ot(er){if(ue)fo(nt);else for(var tr=$?1:2;tr<S.length;tr++){var Dn=tr===1?Jt:Ye[tr-2];S[tr].destructorFunction!==null&&S[tr].destructorFunction(Dn)}if(Ae)return S[0].fromWireType(er)}return Ot(hr)};return bi(v,Nt)}var Pa=(v,S,B,L,J,ee)=>{var oe=ys(S,B);J=Dt(L,J),kr([],[v],$=>{$=$[0];var ue=`constructor ${$.name}`;if($.registeredClass.constructor_body===void 0&&($.registeredClass.constructor_body=[]),$.registeredClass.constructor_body[S-1]!==void 0)throw new yr(`Cannot register multiple constructors with identical number of parameters (${S-1}) for class '${$.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return $.registeredClass.constructor_body[S-1]=()=>{vn(`Cannot construct ${$.name} due to unbound types`,oe)},kr([],oe,Ae=>(Ae.splice(1,0,null),$.registeredClass.constructor_body[S-1]=Na(ue,Ae,null,J,ee),[])),[]})},rt=v=>{v=v.trim();let S=v.indexOf("(");return S!==-1?v.substr(0,S):v},Ts=(v,S,B,L,J,ee,oe,$,ue)=>{var Ae=ys(B,L);S=Ut(S),S=rt(S),ee=Dt(J,ee),kr([],[v],he=>{he=he[0];var Ye=`${he.name}.${S}`;S.startsWith("@@")&&(S=Symbol[S.substring(2)]),$&&he.registeredClass.pureVirtualFunctions.push(S);function ot(){vn(`Cannot call ${Ye} due to unbound types`,Ae)}var nt=he.registeredClass.instancePrototype,Nt=nt[S];return Nt===void 0||Nt.overloadTable===void 0&&Nt.className!==he.name&&Nt.argCount===B-2?(ot.argCount=B-2,ot.className=he.name,nt[S]=ot):(ai(nt,S,Ye),nt[S].overloadTable[B-2]=ot),kr([],Ae,cr=>{var Jt=Na(Ye,cr,he,ee,oe);return nt[S].overloadTable===void 0?(Jt.argCount=B-2,nt[S]=Jt):nt[S].overloadTable[B-2]=Jt,[]}),[]})},Nr=(v,S,B)=>(v instanceof Object||Fe(`${B} with invalid "this": ${v}`),v instanceof S.registeredClass.constructor||Fe(`${B} incompatible with "this" of type ${v.constructor.name}`),v.$$.ptr||Fe(`cannot call emscripten binding method ${B} on deleted object`),j(v.$$.ptr,v.$$.ptrType.registeredClass,S.registeredClass)),ci=(v,S,B,L,J,ee,oe,$,ue,Ae)=>{S=Ut(S),J=Dt(L,J),kr([],[v],he=>{he=he[0];var Ye=`${he.name}.${S}`,ot={get(){vn(`Cannot access ${Ye} due to unbound types`,[B,oe])},enumerable:!0,configurable:!0};return ue?ot.set=()=>vn(`Cannot access ${Ye} due to unbound types`,[B,oe]):ot.set=nt=>Fe(Ye+" is a read-only property"),Object.defineProperty(he.registeredClass.instancePrototype,S,ot),kr([],ue?[B,oe]:[B],nt=>{var Nt=nt[0],cr={get(){var Pt=Nr(this,he,Ye+" getter");return Nt.fromWireType(J(ee,Pt))},enumerable:!0};if(ue){ue=Dt($,ue);var Jt=nt[1];cr.set=function(Pt){var hr=Nr(this,he,Ye+" setter"),Ot=[];ue(Ae,hr,Jt.toWireType(Ot,Pt)),fo(Ot)}}return Object.defineProperty(he.registeredClass.instancePrototype,S,cr),[]}),[]})},$i=[],Jr=[],Eo=v=>{v>9&&--Jr[v+1]===0&&(Jr[v]=void 0,$i.push(v))},ke=()=>Jr.length/2-5-$i.length,_o=()=>{Jr.push(0,1,void 0,1,null,1,!0,1,!1,1),Z.count_emval_handles=ke},Kr={toValue:v=>(v||Fe("Cannot use deleted val. handle = "+v),Jr[v]),toHandle:v=>{switch(v){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:{let S=$i.pop()||Jr.length;return Jr[S]=v,Jr[S+1]=1,S}}}},Ma={name:"emscripten::val",fromWireType:v=>{var S=Kr.toValue(v);return Eo(v),S},toWireType:(v,S)=>Kr.toHandle(S),argPackAdvance:Br,readValueFromPointer:Ao,destructorFunction:null},I=v=>Hr(v,Ma),at=v=>{if(v===null)return"null";var S=typeof v;return S==="object"||S==="array"||S==="function"?v.toString():""+v},Ss=(v,S)=>{switch(S){case 4:return function(B){return this.fromWireType(As[B>>2])};case 8:return function(B){return this.fromWireType(Dr[B>>3])};default:throw new TypeError(`invalid float width (${S}): ${v}`)}},vs=(v,S,B)=>{S=Ut(S),Hr(v,{name:S,fromWireType:L=>L,toWireType:(L,J)=>J,argPackAdvance:Br,readValueFromPointer:Ss(S,B),destructorFunction:null})},Rs=(v,S,B)=>{switch(S){case 1:return B?L=>Fr[L]:L=>Gt[L];case 2:return B?L=>vi[L>>1]:L=>xt[L>>1];case 4:return B?L=>Pe[L>>2]:L=>Ge[L>>2];default:throw new TypeError(`invalid integer width (${S}): ${v}`)}},Al=(v,S,B,L,J)=>{S=Ut(S);var ee=he=>he;if(L===0){var oe=32-8*B;ee=he=>he<<oe>>>oe}var $=S.includes("unsigned"),ue=(he,Ye)=>{},Ae;$?Ae=function(he,Ye){return ue(Ye,this.name),Ye>>>0}:Ae=function(he,Ye){return ue(Ye,this.name),Ye},Hr(v,{name:S,fromWireType:ee,toWireType:Ae,argPackAdvance:Br,readValueFromPointer:Rs(S,B,L!==0),destructorFunction:null})},hl=(v,S,B)=>{var L=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],J=L[S];function ee(oe){var $=Ge[oe>>2],ue=Ge[oe+4>>2];return new J(Fr.buffer,ue,$)}B=Ut(B),Hr(v,{name:B,fromWireType:ee,argPackAdvance:Br,readValueFromPointer:ee},{ignoreDuplicateRegistrations:!0})},gl=(v,S,B,L)=>{if(!(L>0))return 0;for(var J=B,ee=B+L-1,oe=0;oe<v.length;++oe){var $=v.charCodeAt(oe);if($>=55296&&$<=57343){var ue=v.charCodeAt(++oe);$=65536+(($&1023)<<10)|ue&1023}if($<=127){if(B>=ee)break;S[B++]=$}else if($<=2047){if(B+1>=ee)break;S[B++]=192|$>>6,S[B++]=128|$&63}else if($<=65535){if(B+2>=ee)break;S[B++]=224|$>>12,S[B++]=128|$>>6&63,S[B++]=128|$&63}else{if(B+3>=ee)break;S[B++]=240|$>>18,S[B++]=128|$>>12&63,S[B++]=128|$>>6&63,S[B++]=128|$&63}}return S[B]=0,B-J},pl=(v,S,B)=>gl(v,Gt,S,B),li=v=>{for(var S=0,B=0;B<v.length;++B){var L=v.charCodeAt(B);L<=127?S++:L<=2047?S+=2:L>=55296&&L<=57343?(S+=4,++B):S+=3}return S},Rn=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Io=(v,S,B)=>{for(var L=S+B,J=S;v[J]&&!(J>=L);)++J;if(J-S>16&&v.buffer&&Rn)return Rn.decode(v.subarray(S,J));for(var ee="";S<J;){var oe=v[S++];if(!(oe&128)){ee+=String.fromCharCode(oe);continue}var $=v[S++]&63;if((oe&224)==192){ee+=String.fromCharCode((oe&31)<<6|$);continue}var ue=v[S++]&63;if((oe&240)==224?oe=(oe&15)<<12|$<<6|ue:oe=(oe&7)<<18|$<<12|ue<<6|v[S++]&63,oe<65536)ee+=String.fromCharCode(oe);else{var Ae=oe-65536;ee+=String.fromCharCode(55296|Ae>>10,56320|Ae&1023)}}return ee},bs=(v,S)=>v?Io(Gt,v,S):"",Yt=(v,S)=>{S=Ut(S);var B=S==="std::string";Hr(v,{name:S,fromWireType(L){var J=Ge[L>>2],ee=L+4,oe;if(B)for(var $=ee,ue=0;ue<=J;++ue){var Ae=ee+ue;if(ue==J||Gt[Ae]==0){var he=Ae-$,Ye=bs($,he);oe===void 0?oe=Ye:(oe+=String.fromCharCode(0),oe+=Ye),$=Ae+1}}else{for(var ot=new Array(J),ue=0;ue<J;++ue)ot[ue]=String.fromCharCode(Gt[ee+ue]);oe=ot.join("")}return Wt(L),oe},toWireType(L,J){J instanceof ArrayBuffer&&(J=new Uint8Array(J));var ee,oe=typeof J=="string";oe||J instanceof Uint8Array||J instanceof Uint8ClampedArray||J instanceof Int8Array||Fe("Cannot pass non-string to std::string"),B&&oe?ee=li(J):ee=J.length;var $=So(4+ee+1),ue=$+4;if(Ge[$>>2]=ee,B&&oe)pl(J,ue,ee+1);else if(oe)for(var Ae=0;Ae<ee;++Ae){var he=J.charCodeAt(Ae);he>255&&(Wt(ue),Fe("String has UTF-16 code units that do not fit in 8 bits")),Gt[ue+Ae]=he}else for(var Ae=0;Ae<ee;++Ae)Gt[ue+Ae]=J[Ae];return L!==null&&L.push(Wt,$),$},argPackAdvance:Br,readValueFromPointer:Ao,destructorFunction(L){Wt(L)}})},La=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,ml=(v,S)=>{for(var B=v,L=B>>1,J=L+S/2;!(L>=J)&&xt[L];)++L;if(B=L<<1,B-v>32&&La)return La.decode(Gt.subarray(v,B));for(var ee="",oe=0;!(oe>=S/2);++oe){var $=vi[v+oe*2>>1];if($==0)break;ee+=String.fromCharCode($)}return ee},Di=(v,S,B)=>{if(B!=null||(B=2147483647),B<2)return 0;B-=2;for(var L=S,J=B<v.length*2?B/2:v.length,ee=0;ee<J;++ee){var oe=v.charCodeAt(ee);vi[S>>1]=oe,S+=2}return vi[S>>1]=0,S-L},Co=v=>v.length*2,ar=(v,S)=>{for(var B=0,L="";!(B>=S/4);){var J=Pe[v+B*4>>2];if(J==0)break;if(++B,J>=65536){var ee=J-65536;L+=String.fromCharCode(55296|ee>>10,56320|ee&1023)}else L+=String.fromCharCode(J)}return L},Qa=(v,S,B)=>{if(B!=null||(B=2147483647),B<4)return 0;for(var L=S,J=L+B-4,ee=0;ee<v.length;++ee){var oe=v.charCodeAt(ee);if(oe>=55296&&oe<=57343){var $=v.charCodeAt(++ee);oe=65536+((oe&1023)<<10)|$&1023}if(Pe[S>>2]=oe,S+=4,S+4>J)break}return Pe[S>>2]=0,S-L},fl=v=>{for(var S=0,B=0;B<v.length;++B){var L=v.charCodeAt(B);L>=55296&&L<=57343&&++B,S+=4}return S},xa=(v,S,B)=>{B=Ut(B);var L,J,ee,oe;S===2?(L=ml,J=Di,oe=Co,ee=$=>xt[$>>1]):S===4&&(L=ar,J=Qa,oe=fl,ee=$=>Ge[$>>2]),Hr(v,{name:B,fromWireType:$=>{for(var ue=Ge[$>>2],Ae,he=$+4,Ye=0;Ye<=ue;++Ye){var ot=$+4+Ye*S;if(Ye==ue||ee(ot)==0){var nt=ot-he,Nt=L(he,nt);Ae===void 0?Ae=Nt:(Ae+=String.fromCharCode(0),Ae+=Nt),he=ot+S}}return Wt($),Ae},toWireType:($,ue)=>{typeof ue!="string"&&Fe(`Cannot pass non-string to C++ string type ${B}`);var Ae=oe(ue),he=So(4+Ae+S);return Ge[he>>2]=Ae/S,J(ue,he+4,Ae+S),$!==null&&$.push(Wt,he),he},argPackAdvance:Br,readValueFromPointer:Ao,destructorFunction($){Wt($)}})},Tt=(v,S)=>{S=Ut(S),Hr(v,{isVoid:!0,name:S,argPackAdvance:0,fromWireType:()=>{},toWireType:(B,L)=>{}})},Ua=(v,S,B)=>Gt.copyWithin(v,S,S+B),bn=(v,S)=>{var B=ce[v];return B===void 0&&Fe(`${S} has unknown type ${mo(v)}`),B},di=(v,S,B)=>{var L=[],J=v.toWireType(L,B);return L.length&&(Ge[S>>2]=Kr.toHandle(L)),J},ws=(v,S,B)=>(v=Kr.toValue(v),S=bn(S,"emval::as"),di(S,B,v)),wn={},El=v=>{var S=wn[v];return S===void 0?Ut(v):S},yo=[],Pr=(v,S,B,L,J)=>(v=yo[v],S=Kr.toValue(S),B=El(B),v(S,S[B],L,J)),ui=v=>{var S=yo.length;return yo.push(v),S},Le=(v,S)=>{for(var B=new Array(v),L=0;L<v;++L)B[L]=bn(Ge[S+L*4>>2],"parameter "+L);return B},Ds=Reflect.construct,Fa=(v,S,B)=>{var L=Le(v,S),J=L.shift();v--;var ee=new Array(v),oe=(ue,Ae,he,Ye)=>{for(var ot=0,nt=0;nt<v;++nt)ee[nt]=L[nt].readValueFromPointer(Ye+ot),ot+=L[nt].argPackAdvance;var Nt=B===1?Ds(Ae,ee):Ae.apply(ue,ee);return di(J,he,Nt)},$=`methodCaller<(${L.map(ue=>ue.name).join(", ")}) => ${J.name}>`;return ui(bi($,oe))},Va=v=>{v>9&&(Jr[v+1]+=1)},Oi=v=>{var S=Kr.toValue(v);fo(S),Eo(v)},ja=(v,S)=>{v=bn(v,"_emval_take_value");var B=v.readValueFromPointer(S);return Kr.toHandle(B)},Os=v=>{ro("OOM")},_l=v=>{Gt.length,Os()};oo(),yr=Z.BindingError=class extends Error{constructor(v){super(v),this.name="BindingError"}},ao=Z.InternalError=class extends Error{constructor(v){super(v),this.name="InternalError"}},yn(),ka(),Is(),po=Z.UnboundTypeError=go(Error,"UnboundTypeError"),_o();var To={v:M,p:ct,o:wt,t:Ji,x:dl,w:Pa,h:Ts,k:ci,s:I,n:vs,g:Al,a:hl,m:Yt,l:xa,u:Tt,r:Ua,j:ws,e:Pr,c:Eo,f:Fa,d:Va,b:Oi,i:ja,q:_l},Zt=ft(),So=v=>(So=Zt.A)(v),ks=v=>(ks=Zt.C)(v),Wt=v=>(Wt=Zt.D)(v),vo=v=>(vo=Zt.E)(v);Z._vertexShaderSource=10192;var ki;Or=function v(){ki||Ro(),ki||(Or=v)};function Ro(){if(Cr>0||(Ri(),Cr>0))return;function v(){ki||(ki=!0,Z.calledRun=!0,!ii&&(q(),we(Z),Z.onRuntimeInitialized&&Z.onRuntimeInitialized(),Gi()))}Z.setStatus?(Z.setStatus("Running..."),setTimeout(function(){setTimeout(function(){Z.setStatus("")},1),v()},1)):v()}if(Z.preInit)for(typeof Z.preInit=="function"&&(Z.preInit=[Z.preInit]);Z.preInit.length>0;)Z.preInit.pop()();return Ro(),u=It,u}})(),Hx=jx,Gx=class{constructor(ge,de){_r(this,"canvas"),_r(this,"locateFile"),_r(this,"_glName"),_r(this,"_solutionWasm"),_r(this,"ctx"),_r(this,"fileDownloader"),_r(this,"pl",{onResults:u=>this.onResults(u.get(0).glName)}),this.locateFile=u=>`${ge}/${u}`,this.fileDownloader=de}bindTexture(){var ge;(ge=this.ctx)==null||ge.activeTexture(this.ctx.TEXTURE0),this.bindTexture2d(this._glName)}async initialize(){this._solutionWasm=new this.SolutionWasm;let ge=new this.StringList;ge.push_back("segmentation_mask");let de=this.PacketListener.implement(this.pl);return this._solutionWasm.attachMultiListener(ge,de),ge.delete(),this._solutionWasm.loadGraph(await this.fileDownloader.download(this.locateFile("selfie_segmentation.binarypb"),{type:"arraybuffer"})),this}setCanvas(ge){this.canvas=ge,this.createContext(ge,!0,!0,{}),this._glName=this.createTexture()}fetchResponse(ge){return this.fileDownloader.downloadWithFetch(ge,"fetch-response")}loadWasm(ge,de){return this.fileDownloader.loadWasm(ge,de)}async changeModel(ge="selfie_segmentation_landscape.tflite"){ge=typeof ge=="string"?await this.fileDownloader.download(this.locateFile(ge),{type:"arraybuffer"}):ge,this._solutionWasm.overrideFile("third_party/mediapipe/modules/selfie_segmentation/selfie_segmentation_landscape.tflite",ge);let de=new this.GraphOptionChangeRequestList;de.push_back({calculatorIndex:1,calculatorName:"",calculatorType:"GlScalerCalculator",fieldName:"flip_horizontal",valueBoolean:!1,valueNumber:0,valueString:""}),de.push_back({calculatorIndex:0,calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelSelection",fieldName:"int_value",valueBoolean:!1,valueNumber:1,valueString:""}),de.push_back({calculatorIndex:0,calculatorType:"InferenceCalculator",calculatorName:"",fieldName:"use_cpu_inference",valueBoolean:!1,valueNumber:0,valueString:""}),this._solutionWasm.changeOptions(de)}send(ge,de){let u=new this.PacketDataList;u.pushTexture2d({stream:"input_frames_gpu",timestamp:performance.now()*1e3,glName:this._glName,width:ge,height:de}),this._solutionWasm.send(u),u.delete()}close(){var ge,de,u;(ge=this.canvas)==null||delete ge.getContext,delete this.readyPromiseResolve,delete this.readyPromiseReject,this.pl.onResults=null,delete this.onResults,(de=this.deleteTexture)==null||de.call(this,this._glName),(u=this._solutionWasm)==null||u.delete();for(let Z of Object.keys(this))delete this[Z]}},Eg=0,mb=class fb{constructor(de){this.core=de,_r(this,"seq"),_r(this,"_core"),_r(this,"log"),_r(this,"preLoadPromise"),_r(this,"startResolve"),_r(this,"startReject"),_r(this,"mediaPipeSolutions"),_r(this,"assetsPath"),Eg=Eg+1,this.seq=Eg,this._core=de,this.log=de.log.createChild({id:`${this.getAlias()}${Eg}`}),this.log.info("created"),de.assetsPath&&(this.preLoadPromise=this.preload(de.assetsPath))}async preload(de="https://web.sdk.qcloud.com/trtc/webrtc/v5/assets/"){try{this._core.room.videoManager.Wasm||(this._core.room.videoManager.Wasm=await Hx()),this.assetsPath=`${de}/selfie_segmentation/`;let u=new Gx(this.assetsPath,this._core.fileDownloader);this.mediaPipeSolutions=await Fx(u),await this.mediaPipeSolutions.initialize(),await this._core.room.videoManager.initVirtualBackground(this.mediaPipeSolutions)}catch(u){let{RtcError:Z,ErrorCode:we}=this._core.errorModule;throw new Z({code:we.INVALID_OPERATION,message:`VirtualBackground preload error, please check your assetsPath. detail: ${u}`})}}getName(){return fb.Name}getAlias(){return"vb"}getValidateRule(de){switch(de){case"start":return Lx(this._core);case"update":return Qx(this._core);case"stop":return xx(this._core)}}getGroup(){return"vb"}async start(de){let{type:u="blur",src:Z,blurLevel:we=3}=de,{auth:_t,sign:It,timestamp:Ht}=await Px({sdkAppId:de.sdkAppId,userId:de.userId,userSig:de.userSig,core:this._core});if(!_t){let{RtcError:dt,ErrorCode:ir,ErrorCodeDictionary:Oe}=this._core.errorModule;throw new dt({code:ir.SERVER_ERROR,extraCode:Oe.NEED_TO_BUY,messageParams:{value:"Virtual Background",url:"https://cloud.tencent.com/document/product/647/85386"}})}return this.preLoadPromise||(this.preLoadPromise=this.preload(this._core.assetsPath)),await this.preLoadPromise,this.core.room.videoManager.setVirtualBackground({type:u,imageUrl:Z,blurLevel:we})}async update(de){let{type:u,src:Z}=de;return this.core.room.videoManager.setVirtualBackground({type:u,imageUrl:Z,blurLevel:de.blurLevel})}async stop(){return this.core.room.videoManager.setVirtualBackground()}};_r(mb,"Name","VirtualBackground");var Eb=mb,Yx=Eb;const Wx=Object.freeze(Object.defineProperty({__proto__:null,VirtualBackground:Eb,default:Yx},Symbol.toStringTag,{value:"Module"})),Xx=vx(Wx);export{Xx as a,Kx as r};
