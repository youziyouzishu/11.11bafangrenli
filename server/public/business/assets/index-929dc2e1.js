import{q as i,o as s,r as Z,R as j,W as tt,z as k,Q as et,_ as nt}from"./@tencentcloud-25a17c42.js";import"./adapter-vue-20243c9c.js";import at from"./Icon-fec85db6.js";import{d as it}from"./down-icon-9d19ec5a.js";import{e as st}from"./right-icon-312a665a.js";import X from"./index-d7431b6d.js";import{a as ot}from"./env-6b0ecdb8.js";import{d as rt,r as _,b as ut,aU as ct,aW as lt,aY as dt,aV as u,o as c,c as l,F as D,aj as O,a as m,G as w,aw as T,u as x,a9 as A}from"./@vue-25170201.js";import"./tim-upload-plugin-5e9dfffb.js";import"./tim-profanity-filter-plugin-23d0f338.js";import"./vue-04189d9a.js";import"./marked-7f3c3653.js";import"./trtc-cloud-js-sdk-ca6139e0.js";import"./trtc-sdk-v5-8c3e4b7a.js";import"./pinia-1182f1fa.js";import"./mitt-f7ef348c.js";import"./interactjs-c534f49a.js";import"./rtc-detect-1f468b1b.js";import"./index-15293322.js";import"./index-c056fc46.js";import"./index-ebb29dde.js";import"./index-9521edcb.js";const pt=["onClick"],ft={class:"tui-contact-list-item-header-left"},Ct={class:"tui-contact-list-item-header-right"},vt={key:0,class:"tui-contact-list-item-header-right-unread"},Lt=["onClick"],ht={key:1,class:"tui-contact-list"},_t={key:0,class:"tui-contact-search-list"},mt={class:"tui-contact-search-list-title"},It=["onClick"],St={key:0,class:"tui-contact-search-list-default"},gt=rt({__name:"index",setup(Ut){const L=_(""),o=_({}),f=_({friendApplicationList:{key:"friendApplicationList",title:"新的联系人",list:[],unreadCount:0},blackList:{key:"blackList",title:"黑名单",list:[]},groupList:{key:"groupList",title:"我的群聊",list:[]},friendList:{key:"friendList",title:"我的好友",list:[]}}),g=_(!1),v=_(),M=_(!1),E=_(),Y=ut(()=>{var t,r,n,a;return!((r=(t=v==null?void 0:v.value)==null?void 0:t.user)!=null&&r.list[0])&&!((a=(n=v==null?void 0:v.value)==null?void 0:n.group)!=null&&a.list[0])});ct(()=>{i.watch(s.APP,{enabledCustomerServicePlugin:b}),i.watch(s.GRP,{groupList:F}),i.watch(s.USER,{userBlacklist:N,displayOnlineStatus:P,userStatusList:R}),i.watch(s.FRIEND,{friendList:B,friendApplicationList:z,friendApplicationUnreadCount:$}),i.watch(s.CUSTOM,{currentContactSearchingStatus:W,currentContactSearchResult:V,currentContactListKey:Q,currentContactInfo:q})}),lt(()=>{i.unwatch(s.APP,{enabledCustomerServicePlugin:b}),i.unwatch(s.GRP,{groupList:F}),i.unwatch(s.USER,{userBlacklist:N,displayOnlineStatus:P,userStatusList:R}),i.unwatch(s.FRIEND,{friendList:B,friendApplicationList:z,friendApplicationUnreadCount:$}),i.unwatch(s.CUSTOM,{currentContactSearchingStatus:W,currentContactSearchResult:V,currentContactListKey:Q,currentContactInfo:q})});function H(t){L.value===t?(L.value="",o.value={},i.update(s.CUSTOM,"currentContactListKey",""),i.update(s.CUSTOM,"currentContactInfo",{})):(L.value=t,i.update(s.CUSTOM,"currentContactListKey",t),t==="friendApplicationList"&&et.setFriendApplicationRead())}function K(t){var r,n,a,e,d,p,I,y;if(o.value=t,g.value){let h;(r=o.value)!=null&&r.userID?h=(e=(a=(n=f.value)==null?void 0:n.friendList)==null?void 0:a.list)==null?void 0:e.find(C=>{var S;return(C==null?void 0:C.userID)===((S=o.value)==null?void 0:S.userID)}):(d=o.value)!=null&&d.groupID&&(h=(y=(I=(p=f.value)==null?void 0:p.groupList)==null?void 0:I.list)==null?void 0:y.find(C=>{var S;return(C==null?void 0:C.groupID)===((S=o.value)==null?void 0:S.groupID)})),h&&(o.value=h)}i.update(s.CUSTOM,"currentContactInfo",o.value)}function P(t){M.value=t}function R(t){(t==null?void 0:t.size)>0&&(E.value=Object.fromEntries(t==null?void 0:t.entries()))}function b(t){if(!t)return;const r=Z.TUIContact.EXTENSION.CONTACT_LIST.EXT_ID,a=j.getExtensionList(r).find(e=>{const{name:d,accountList:p=[]}=e.data||{};return d==="customer"&&p.length>0});if(a){const{data:e,text:d}=a,{accountList:p}=e||{};tt.getUserProfile({userIDList:p}).then(I=>{if(I.data.length>0){const y={title:d,list:I.data.map((h,C)=>({...h,renderKey:G("customerList",h,C),infoKeyList:[],btnKeyList:["enterC2CConversation"]})),key:"customerList"};f.value={...f.value,customerList:y}}}).catch(()=>{})}}function F(t){U("groupList",t)}function N(t){U("blackList",t)}function $(t){f.value.friendApplicationList.unreadCount=t}function B(t){U("friendList",t)}function z(t){U("friendApplicationList",t)}function U(t,r){f.value[t].list=r,f.value[t].list.map((n,a)=>n.renderKey=G(t,n,a)),J(f.value[t].list,t)}function J(t,r){var n,a;!((n=o.value)!=null&&n.userID)&&!((a=o.value)!=null&&a.groupID)||(r===L.value||g.value)&&(o.value=(t==null?void 0:t.find(e=>{var d,p;return(e==null?void 0:e.groupID)&&(e==null?void 0:e.groupID)===((d=o.value)==null?void 0:d.groupID)||(e==null?void 0:e.userID)&&(e==null?void 0:e.userID)===((p=o.value)==null?void 0:p.userID)}))||{},i.update(s.CUSTOM,"currentContactInfo",o.value))}function G(t,r,n){return`${t}-${r.userID||r.groupID||"index"+n}`}function V(t){v.value=t}function W(t){g.value=t,i.update(s.CUSTOM,"currentContactInfo",{}),i.update(s.CUSTOM,"currentContactListKey","")}function q(t){o.value=t}function Q(t){L.value=t}return dt("userOnlineStatusMap",E),(t,r)=>u(g)?(c(),l("ul",ht,[(c(!0),l(D,null,O(u(v),(n,a)=>(c(),l("li",{key:a,class:"tui-contact-list-item"},[n.list[0]?(c(),l("div",_t,[m("div",mt,T(u(k).t(`TUIContact.${n.label}`)),1),(c(!0),l(D,null,O(n.list,(e,d)=>(c(),l("div",{key:d,class:A(["tui-contact-search-list-item",["selected"]]),onClick:p=>K(e)},[w(X,{item:e,displayOnlineStatus:!1},null,8,["item"])],8,It))),128))])):x("",!0)]))),128)),u(Y)?(c(),l("div",St,T(u(k).t("TUIContact.无搜索结果")),1)):x("",!0)])):(c(),l("ul",{key:0,class:A(["tui-contact-list",!u(ot)&&"tui-contact-list-h5"])},[(c(!0),l(D,null,O(u(f),(n,a)=>(c(),l("li",{key:a,class:"tui-contact-list-item"},[m("header",{class:"tui-contact-list-item-header",onClick:e=>H(a)},[m("div",ft,[w(at,{file:u(L)===a?u(it):u(st),width:"16px",height:"16px"},null,8,["file"]),m("div",null,T(u(k).t(`TUIContact.${n.title}`)),1)]),m("div",Ct,[n.unreadCount?(c(),l("span",vt,T(n.unreadCount),1)):x("",!0)])],8,pt),m("ul",{class:A(["tui-contact-list-item-main",u(L)===a?"":"hidden"])},[(c(!0),l(D,null,O(n.list,e=>(c(),l("li",{key:e.renderKey,class:A(["tui-contact-list-item-main-item",["selected"]]),onClick:d=>K(e)},[w(X,{item:e,displayOnlineStatus:u(M)&&a==="friendList"},null,8,["item","displayOnlineStatus"])],8,Lt))),128))],2)]))),128))],2))}});const qt=nt(gt,[["__scopeId","data-v-b494aa22"]]);export{qt as default};
