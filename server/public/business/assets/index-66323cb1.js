import{B as M,q as d,o as f,Z as I,i as n,z as N,_ as z}from"./@tencentcloud-25a17c42.js";import"./adapter-vue-20243c9c.js";import{i as E,a as g}from"./env-6b0ecdb8.js";import F from"./index-28e12cb3.js";import{d as H,r as o,w as R,o as h,t as Z,aM as j,a as c,a9 as A,aV as u,c as k,aw as S,u as K,F as W,aj as Y}from"./@vue-25170201.js";import"./tim-upload-plugin-5e9dfffb.js";import"./tim-profanity-filter-plugin-23d0f338.js";import"./vue-04189d9a.js";import"./marked-7f3c3653.js";import"./trtc-cloud-js-sdk-ca6139e0.js";import"./trtc-sdk-v5-8c3e4b7a.js";import"./pinia-1182f1fa.js";import"./mitt-f7ef348c.js";import"./interactjs-c534f49a.js";import"./rtc-detect-1f468b1b.js";const $={ref:"dialog",class:"member-list"},J={key:0,class:"member-list-title"},Q={class:"title"},X={class:"member-list-box"},ee=["onClick"],te=["src"],se={class:"member-list-box-body-name"},ae=H({__name:"index",emits:["onAtListOpen","insertAt"],setup(oe,{expose:B,emit:G}){const x=G,s=o(),w=o(),m=o(!1),i=o(),_=o(),a=o(),b=o(!1),p=o({left:0,top:0}),L=o(0),r=o(""),O={userID:M.TYPES.MSG_AT_ALL,nick:"所有人",isAll:!0,avatar:"https://web.sdk.qcloud.com/im/assets/images/at.svg"};d.watch(f.CONV,{currentConversationID:e=>{var l,t;if(e!==r.value)if(r.value=e,i.value=[],_.value=[],a.value=[],b.value=!1,d.update(f.CUSTOM,"memberList",i.value),(l=r==null?void 0:r.value)!=null&&l.startsWith("GROUP")){b.value=!0;const v=(t=r==null?void 0:r.value)==null?void 0:t.substring(5);I.switchGroup(v)}else I.switchGroup("")}}),d.watch(f.GRP,{currentGroupMemberList:e=>{i.value=e,_.value=[O,...i.value],a.value=_.value,d.update(f.CUSTOM,"memberList",i.value)}});const y=e=>{b.value&&(m.value=e,m.value&&x("onAtListOpen"))},P=e=>{p.value=e},T=e=>{var l,t;L.value=e,(t=(l=w.value)==null?void 0:l[L.value])==null||t.scrollIntoView(!1)},U=e=>{a.value=e};n.toggleAtList=y,n.handleAtListPosition=P,n.setCurrentSelectIndex=T,n.setShowMemberList=U,B({toggleAtList:y}),R(()=>[p.value,s==null?void 0:s.value],()=>{var e;E||!(s!=null&&s.value)||!((e=s==null?void 0:s.value)!=null&&e.style)||(s.value.style.left=p.value.left+"px",s.value.style.top=p.value.top-s.value.clientHeight+"px")});const C=()=>{m.value=!1,a.value=_.value,p.value={left:0,top:0}},V=e=>{var l;if(g&&n.selectItem)n.selectItem(e);else if((l=a==null?void 0:a.value)!=null&&l.length){const t=a==null?void 0:a.value[e];x("insertAt",{id:t==null?void 0:t.userID,label:(t==null?void 0:t.nick)||(t==null?void 0:t.userID)})}C()},q=e=>(e==null?void 0:e.avatar)||"https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png",D=e=>e!=null&&e.nick?e==null?void 0:e.nick:e==null?void 0:e.userID;return(e,l)=>(h(),Z(F,{show:u(m),onOnClose:C},{default:j(()=>[c("div",{ref_key:"MessageInputAt",ref:s,class:A([u(g)?"message-input-at":"message-input-at-h5"])},[c("div",$,[u(g)?K("",!0):(h(),k("header",J,[c("span",Q,S(u(N).t("TUIChat.选择提醒的人")),1)])),c("ul",X,[(h(!0),k(W,null,Y(u(a),(t,v)=>(h(),k("li",{key:v,ref_for:!0,ref_key:"memberListItems",ref:w,class:A(["member-list-box-body",[v===u(L)&&"selected"]]),onClick:le=>V(v)},[c("img",{class:"member-list-box-body-avatar",src:q(t)},null,8,te),c("span",se,S(D(t)),1)],10,ee))),128))])],512)],2)]),_:1},8,["show"]))}});const ke=z(ae,[["__scopeId","data-v-f07ce405"]]);export{ke as default};
