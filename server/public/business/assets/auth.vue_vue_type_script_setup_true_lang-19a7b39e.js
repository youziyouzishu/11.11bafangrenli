import{D as P,V as q,B as G,E as H,C as I,J}from"./element-plus-64da2267.js";import{a as Q}from"./role-f64bc859.js";import{P as U}from"./index-e34f0d65.js";import{Q as X}from"./index-7638d9aa.js";import{m as Z}from"./menu-b06496af.js";import{d as j,b0 as f,r,aZ as z,o as k,c as W,G as o,aM as d,aO as Y,t as $,aV as c,a as y,aX as ee,b2 as x}from"./@vue-25170201.js";const te={class:"edit-popup"},ie=j({__name:"auth",emits:["success","close"],setup(ae,{expose:C,emit:b}){const _=b,l=f(),h=f(),u=f(),g=r(!1),i=r(!0),m=r(!1),v=r([]),p=r([]),s=z({id:"",name:"",desc:"",sort:0,menu_id:[]}),E={name:[{required:!0,message:"请输入名称",trigger:["blur"]}]},w=()=>{m.value=!0,Z().then(e=>{p.value=e,v.value=X(e),x(()=>{V()}),m.value=!1})},R=()=>{var a,n;const e=(a=l.value)==null?void 0:a.getCheckedKeys(),t=(n=l.value)==null?void 0:n.getHalfCheckedKeys();return e==null||e.unshift.apply(e,t),e},V=()=>{s.menu_id.forEach(e=>{x(()=>{var t;(t=l.value)==null||t.setChecked(e,!0,!1)})})},A=e=>{const t=p.value;for(let a=0;a<t.length;a++)l.value.store.nodesMap[t[a].id].expanded=e},D=e=>{var t,a;e?(t=l.value)==null||t.setCheckedKeys(v.value.map(n=>n.id)):(a=l.value)==null||a.setCheckedKeys([])},K=async()=>{var e,t;await((e=h.value)==null?void 0:e.validate()),s.menu_id=R(),await Q(s),(t=u.value)==null||t.close(),_("success")},B=()=>{_("close")},S=()=>{var e;(e=u.value)==null||e.open()},T=async e=>{for(const t in s)e[t]!=null&&e[t]!=null&&(s[t]=e[t])};return w(),C({open:S,setFormData:T}),(e,t)=>{const a=P,n=q,F=G,L=H,M=I,N=J;return k(),W("div",te,[o(U,{ref_key:"popupRef",ref:u,title:"分配权限",async:!0,width:"550px",onConfirm:K,onClose:B},{default:d(()=>[Y((k(),$(M,{class:"ls-form",ref_key:"formRef",ref:h,rules:E,model:c(s),"label-width":"60px"},{default:d(()=>[o(L,{class:"h-[400px] sm:h-[600px]"},{default:d(()=>[o(F,{label:"权限",prop:"menu_id"},{default:d(()=>[y("div",null,[o(a,{label:"展开/折叠",onChange:A}),o(a,{label:"全选/不全选",onChange:D}),o(a,{modelValue:c(i),"onUpdate:modelValue":t[0]||(t[0]=O=>ee(i)?i.value=O:null),label:"父子联动"},null,8,["modelValue"]),y("div",null,[o(n,{ref_key:"treeRef",ref:l,data:c(p),props:{label:"name",children:"children"},"check-strictly":!c(i),"node-key":"id","default-expand-all":c(g),"show-checkbox":""},null,8,["data","check-strictly","default-expand-all"])])])]),_:1})]),_:1})]),_:1},8,["model"])),[[N,c(m)]])]),_:1},512)])}}});export{ie as _};
